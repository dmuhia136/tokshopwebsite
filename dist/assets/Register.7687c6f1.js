var W=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var L=(n,e,t)=>e in n?W(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_=(n,e)=>{for(var t in e||(e={}))Z.call(e,t)&&L(n,t,e[t]);if(q)for(var t of q(e))$.call(e,t)&&L(n,t,e[t]);return n},A=(n,e)=>X(n,Y(e));import{r as i,e as I,a as m,j as o,m as ee}from"./moreBigLibs.00d880fd.js";import{u as O,g as R,y as ae,z as te,A as se,q as le,F as re,f as oe,L as ne,i as ie}from"./index.cb0bc5b0.js";import{S as T}from"./bigLibs.c150cb44.js";import"./agora.0fcbc9c9.js";import"./stripe.ab219216.js";const ce=()=>{const[n,e]=i.exports.useState(""),[t,c]=i.exports.useState(""),[f,p]=i.exports.useState(""),[d,h]=i.exports.useState(""),[u,s]=i.exports.useState(""),[l,g]=i.exports.useState(""),[v,x]=i.exports.useState(""),[w,N]=i.exports.useState(""),[U,z]=i.exports.useState(""),[B,D]=i.exports.useState(),[H,S]=i.exports.useState(!1),[M,V]=i.exports.useState(""),[G,b]=i.exports.useState({}),J=I(O);let K=R();return{mailError:n,passError:t,email:f,password:d,fname:l,lname:v,bio:w,userName:U,handleChange:r=>{switch(b(""),r.target.id){case"email":p(r.target.value),r.target.value.toLowerCase().match(te)?e(""):e("Invalid email");break;case"pass":h(r.target.value),r.target.value.match(ae)?c(""):c("Password should be atleast six characters long"),r.target.value!==d?c("Password and Confirm passwords don't match"):c("");break;case"confirm":r.target.value!==d?c("Password and Confirm passwords don't match"):c(""),s(r.target.value);break;case"fname":g(r.target.value);break;case"lname":x(r.target.value);break;case"userName":z(r.target.value);break;case"bio":N(r.target.value);break}},load:H,errors:G,phone:B,handlePhoneChange:r=>{D(r)},confirmPassword:u,img:M,setImg:V,upload:async(r,P)=>{var C,y,k,E,j,F;try{const{data:a}=await se.post("/registerv1",A(_({},P),{profilePhoto:r})),Q={token:a.accessToken,_id:a.data._id,userName:a.data.userName,profilePhoto:a.data.profilePhoto,phoneNumber:a.data.phonenumber,email:a.data.email,firstName:a.data.firstName,lastName:a.data.lastName,wallet:a.data.wallet,roomuid:a.data.roomuid};J(Q),S(!1),b(""),K("/",{replace:!0})}catch(a){b((C=a==null?void 0:a.response)==null?void 0:C.data),S(!1),T.fire({icon:"error",title:((k=(y=a.response)==null?void 0:y.data)==null?void 0:k.message)||((F=(j=(E=a==null?void 0:a.response)==null?void 0:E.data)==null?void 0:j.info)==null?void 0:F.message)})}}}},me=({setFormValues:n})=>{var x,w,N;const{mailError:e,passError:t,email:c,password:f,fname:p,lname:d,userName:h,handleChange:u,errors:s,phone:l,handlePhoneChange:g,confirmPassword:v}=ce();return i.exports.useEffect(()=>{n({email:c,firstName:p,lastName:d,password:f,userName:h,phonenumber:l,profilePhoto:""})},[p,c,f,d,h,l]),m("div",{className:"flex flex-col gap-6 lg:gap-8 w-full items-center",children:[m("div",{className:"flex flex-col md:flex-row gap-6 lg:gap-10 w-full md:justify-center",children:[o("input",{onChange:u,value:p,required:!0,type:"text",id:"fname",placeholder:"First name",className:"inputs w-full lg:w-1/3"}),o("input",{onChange:u,value:d,required:!0,type:"text",id:"lname",placeholder:"Last name",className:"inputs w-full lg:w-1/3"})]}),m("div",{className:"flex flex-col md:flex-row gap-6 lg:gap-10 md:justify-center \r w-full items-center",children:[m("div",{className:"flex flex-col w-full lg:w-1/3",children:[o("input",{onChange:u,value:c,required:!0,type:"text",id:"email",placeholder:"Email address",className:"inputs w-full"}),o("p",{className:"text-red-600 font-bold text-[1rem] text-center",children:e||((x=s==null?void 0:s.email)==null?void 0:x.message)||(s==null?void 0:s.length)>1&&s.info.message})]}),o("div",{className:"flex flex-col w-full lg:w-1/3",children:o(ee,{required:!0,country:"ke",value:l,placeholder:"Phone number",onChange:g,className:"inputs w-full"})})]}),m("div",{className:"flex flex-col md:flex-row gap-6 lg:gap-10 md:justify-center w-full",children:[o("input",{onChange:u,value:h,required:!0,type:"text",id:"userName",placeholder:"user name",className:"inputs w-full lg:w-1/3"}),o("div",{className:"w-full lg:w-1/3"})]}),m("div",{className:"flex flex-col md:flex-row gap-6 lg:gap-10 md:justify-center w-full",children:[m("div",{className:"flex flex-col w-full lg:w-1/3",children:[o("input",{onChange:u,value:f,type:"password",id:"pass",placeholder:"Password",className:"inputs  w-full"}),o("p",{className:"text-red-600 font-bold text-[1rem] text-center",children:t||((w=s==null?void 0:s.password)==null?void 0:w.message)})]}),m("div",{className:"flex flex-col w-full lg:w-1/3",children:[o("input",{onChange:u,value:v,type:"password",id:"confirm",placeholder:"Confirm password",className:"inputs w-full"}),o("p",{className:"text-red-600 font-bold text-[1rem] text-center",children:t||((N=s==null?void 0:s.password)==null?void 0:N.message)})]})]})]})},ve=()=>{const{renderSpinner:n}=ie(),[e,t]=i.exports.useState({}),c=R(),{getObject:f,mongoErr:p,load:d}=le(),h=I(O);return m("div",{className:"flex w-full flex-col bg-teal-50 relative px-10 py-16 gap-6 overflow-x-clip",children:[o(re,{onClick:()=>c("/"),icon:oe,className:"top-4 right-4 text-5xl absolute"}),m("p",{className:"self-center text-2xl font-semibold my-4",children:["Tok",o("span",{className:"text-blue-40",children:"shop"})]}),m("form",{onSubmit:async s=>{s.preventDefault();let l=await f("/registerv1","POST",e);const g={token:l.accessToken,_id:l.data._id,userName:l.data.userName,profilePhoto:l.data.profilePhoto,phoneNumber:l.data.phonenumber,email:l.data.email,firstName:l.data.firstName,lastName:l.data.lastName,wallet:l.data.wallet,roomuid:l.data.roomuid};h(g),l.success&&c("/",{replace:!0}),p&&T.fire({icon:"error",text:p.info.message,timer:1500})},className:"flex flex-col gap-6 w-full",children:[o(me,{setFormValues:t}),n(d),o("button",{type:"submit",className:"red-btn w-48 self-center mt-8",children:"Submit"})]}),m("p",{className:"text-2xl text-black-80 font-medium tracking-w self-center",children:["Already have an account?",m(ne,{to:"/login",className:"text-blue-40",children:[" ","login"]})]})]})};export{ve as default};

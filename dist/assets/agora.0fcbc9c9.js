var lyt=Object.defineProperty;var dtt=Object.getOwnPropertySymbols;var dyt=Object.prototype.hasOwnProperty,hyt=Object.prototype.propertyIsEnumerable;var htt=(o,i,s)=>i in o?lyt(o,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[i]=s,ptt=(o,i)=>{for(var s in i||(i={}))dyt.call(i,s)&&htt(o,s,i[s]);if(dtt)for(var s of dtt(i))hyt.call(i,s)&&htt(o,s,i[s]);return o};import{c as commonjsGlobal,g as getDefaultExportFromCjs,r as react,j as jsx,R as React,a as jsxs,b as Fragment}from"./moreBigLibs.00d880fd.js";var AgoraRTC_NProduction={exports:{}};(function(o,i){(function(s,h){o.exports=h()})(commonjsGlobal,function(){var s=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof commonjsGlobal!="undefined"?commonjsGlobal:typeof self!="undefined"?self:{},h=function(e){return e&&e.Math==Math&&e},f=h(typeof globalThis=="object"&&globalThis)||h(typeof window=="object"&&window)||h(typeof self=="object"&&self)||h(typeof s=="object"&&s)||function(){return this}()||Function("return this")(),_={},w=function(e){try{return!!e()}catch{return!0}},j=!w(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),F=!w(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),K=F,_e=Function.prototype.call,_o=K?_e.bind(_e):function(){return _e.apply(_e,arguments)},ca={},_c={}.propertyIsEnumerable,ch=Object.getOwnPropertyDescriptor,Nf=ch&&!_c.call({1:2},1);ca.f=Nf?function(e){var l=ch(this,e);return!!l&&l.enumerable}:_c;var bh,_g,_v=function(e,l){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:l}},h0=F,A0=Function.prototype,M0=A0.bind,R0=A0.call,k0=h0&&M0.bind(R0,R0),G0=h0?function(e){return e&&k0(e)}:function(e){return e&&function(){return R0.apply(e,arguments)}},pI=G0,u0=pI({}.toString),C0=pI("".slice),v0=function(e){return C0(u0(e),8,-1)},T0=G0,Qv=w,r0=v0,a0=f.Object,I0=T0("".split),O0=Qv(function(){return!a0("z").propertyIsEnumerable(0)})?function(e){return r0(e)=="String"?I0(e,""):a0(e)}:a0,nI=f.TypeError,U0=function(e){if(e==null)throw nI("Can't call method on "+e);return e},_I=O0,dI=U0,QI=function(e){return _I(dI(e))},qI=function(e){return typeof e=="function"},T1=qI,h1=function(e){return typeof e=="object"?e!==null:T1(e)},M2=f,a3=qI,c3=function(e){return a3(e)?e:void 0},r_=function(e,l){return arguments.length<2?c3(M2[e]):M2[e]&&M2[e][l]},I_=G0({}.isPrototypeOf),DS=r_("navigator","userAgent")||"",V1=f,yI=DS,KI=V1.process,sI=V1.Deno,ZI=KI&&KI.versions||sI&&sI.version,q1=ZI&&ZI.v8;q1&&(_g=(bh=q1.split("."))[0]>0&&bh[0]<4?1:+(bh[0]+bh[1])),!_g&&yI&&(!(bh=yI.match(/Edge\/(\d+)/))||bh[1]>=74)&&(bh=yI.match(/Chrome\/(\d+)/))&&(_g=+bh[1]);var z_=_g,CT=z_,u3=w,f8=!!Object.getOwnPropertySymbols&&!u3(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&CT&&CT<41}),A8=f8&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Att=r_,gtt=qI,Ett=I_,mtt=A8,vtt=f.Object,l3=mtt?function(e){return typeof e=="symbol"}:function(e){var l=Att("Symbol");return gtt(l)&&Ett(l.prototype,vtt(e))},Itt=f.String,U2=function(e){try{return Itt(e)}catch{return"Object"}},_tt=qI,ytt=U2,btt=f.TypeError,ST=function(e){if(_tt(e))return e;throw btt(ytt(e)+" is not a function")},Ctt=ST,sN=function(e,l){var d=e[l];return d==null?void 0:Ctt(d)},d3=_o,h3=qI,p3=h1,Stt=f.TypeError,aN={exports:{}},g8=f,Rtt=Object.defineProperty,f3=function(e,l){try{Rtt(g8,e,{value:l,configurable:!0,writable:!0})}catch{g8[e]=l}return l},Ttt=f3,E8="__core-js_shared__",A3=f[E8]||Ttt(E8,{}),m8=A3;(aN.exports=function(e,l){return m8[e]||(m8[e]=l!==void 0?l:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var wtt=U0,Ott=f.Object,LR=function(e){return Ott(wtt(e))},Ntt=LR,ktt=G0({}.hasOwnProperty),W1=Object.hasOwn||function(e,l){return ktt(Ntt(e),l)},Dtt=G0,Ltt=0,Ptt=Math.random(),xtt=Dtt(1 .toString),g3=function(e){return"Symbol("+(e===void 0?"":e)+")_"+xtt(++Ltt+Ptt,36)},Btt=f,Mtt=aN.exports,v8=W1,Utt=g3,I8=f8,_8=A8,j2=Mtt("wks"),PR=Btt.Symbol,y8=PR&&PR.for,jtt=_8?PR:PR&&PR.withoutSetter||Utt,w1=function(e){if(!v8(j2,e)||!I8&&typeof j2[e]!="string"){var l="Symbol."+e;I8&&v8(PR,e)?j2[e]=PR[e]:j2[e]=_8&&y8?y8(l):jtt(l)}return j2[e]},Ftt=_o,b8=h1,C8=l3,Qtt=sN,Gtt=function(e,l){var d,p;if(l==="string"&&h3(d=e.toString)&&!p3(p=d3(d,e))||h3(d=e.valueOf)&&!p3(p=d3(d,e))||l!=="string"&&h3(d=e.toString)&&!p3(p=d3(d,e)))return p;throw Stt("Can't convert object to primitive value")},Vtt=w1,qtt=f.TypeError,Htt=Vtt("toPrimitive"),Ktt=function(e,l){if(!b8(e)||C8(e))return e;var d,p=Qtt(e,Htt);if(p){if(l===void 0&&(l="default"),d=Ftt(p,e,l),!b8(d)||C8(d))return d;throw qtt("Can't convert object to primitive value")}return l===void 0&&(l="number"),Gtt(e,l)},Ytt=l3,cN=function(e){var l=Ktt(e,"string");return Ytt(l)?l:l+""},S8=h1,E3=f.document,Wtt=S8(E3)&&S8(E3.createElement),uN=function(e){return Wtt?E3.createElement(e):{}},Jtt=uN,R8=!j&&!w(function(){return Object.defineProperty(Jtt("div"),"a",{get:function(){return 7}}).a!=7}),ztt=j,Xtt=_o,Ztt=ca,$tt=_v,tet=QI,eet=cN,net=W1,ret=R8,T8=Object.getOwnPropertyDescriptor;_.f=ztt?T8:function(e,l){if(e=tet(e),l=eet(l),ret)try{return T8(e,l)}catch{}if(net(e,l))return $tt(!Xtt(Ztt.f,e,l),e[l])};var J1={},w8=j&&w(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),O8=f,iet=h1,oet=O8.String,set=O8.TypeError,i_=function(e){if(iet(e))return e;throw set(oet(e)+" is not an object")},aet=j,cet=R8,uet=w8,lN=i_,N8=cN,det=f.TypeError,m3=Object.defineProperty,het=Object.getOwnPropertyDescriptor,pet="enumerable",fet="configurable",Aet="writable";J1.f=aet?uet?function(e,l,d){if(lN(e),l=N8(l),lN(d),typeof e=="function"&&l==="prototype"&&"value"in d&&Aet in d&&!d.writable){var p=het(e,l);p&&p.writable&&(e[l]=d.value,d={configurable:fet in d?d.configurable:p.configurable,enumerable:pet in d?d.enumerable:p.enumerable,writable:!1})}return m3(e,l,d)}:m3:function(e,l,d){if(lN(e),l=N8(l),lN(d),cet)try{return m3(e,l,d)}catch{}if("get"in d||"set"in d)throw det("Accessors not supported");return"value"in d&&(e[l]=d.value),e};var get=J1,Eet=_v,X_=j?function(e,l,d){return get.f(e,l,Eet(1,d))}:function(e,l,d){return e[l]=d,e},aS={exports:{}},met=qI,v3=A3,vet=G0(Function.toString);met(v3.inspectSource)||(v3.inspectSource=function(e){return vet(e)});var dN,F2,hN,pN=v3.inspectSource,Iet=qI,_et=pN,k8=f.WeakMap,yet=Iet(k8)&&/native code/.test(_et(k8)),bet=aN.exports,Cet=g3,D8=bet("keys"),I3=function(e){return D8[e]||(D8[e]=Cet(e))},_3={},Ret=yet,L8=f,y3=G0,Tet=h1,wet=X_,b3=W1,C3=A3,Oet=I3,Net=_3,P8="Object already initialized",S3=L8.TypeError,ket=L8.WeakMap;if(Ret||C3.state){var xR=C3.state||(C3.state=new ket),Det=y3(xR.get),x8=y3(xR.has),Let=y3(xR.set);dN=function(e,l){if(x8(xR,e))throw new S3(P8);return l.facade=e,Let(xR,e,l),l},F2=function(e){return Det(xR,e)||{}},hN=function(e){return x8(xR,e)}}else{var RT=Oet("state");Net[RT]=!0,dN=function(e,l){if(b3(e,RT))throw new S3(P8);return l.facade=e,wet(e,RT,l),l},F2=function(e){return b3(e,RT)?e[RT]:{}},hN=function(e){return b3(e,RT)}}var Z_={set:dN,get:F2,has:hN,enforce:function(e){return hN(e)?F2(e):dN(e,{})},getterFor:function(e){return function(l){var d;if(!Tet(l)||(d=F2(l)).type!==e)throw S3("Incompatible receiver, "+e+" required");return d}}},R3=j,Pet=W1,B8=Function.prototype,xet=R3&&Object.getOwnPropertyDescriptor,T3=Pet(B8,"name"),w3={EXISTS:T3,PROPER:T3&&function(){}.name==="something",CONFIGURABLE:T3&&(!R3||R3&&xet(B8,"name").configurable)},Bet=f,M8=qI,Met=W1,U8=X_,Uet=f3,jet=pN,Fet=w3.CONFIGURABLE,Qet=Z_.get,Get=Z_.enforce,Vet=String(String).split("String");(aS.exports=function(e,l,d,p){var A,y=!!p&&!!p.unsafe,g=!!p&&!!p.enumerable,b=!!p&&!!p.noTargetGet,I=p&&p.name!==void 0?p.name:l;M8(d)&&(String(I).slice(0,7)==="Symbol("&&(I="["+String(I).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Met(d,"name")||Fet&&d.name!==I)&&U8(d,"name",I),(A=Get(d)).source||(A.source=Vet.join(typeof I=="string"?I:""))),e!==Bet?(y?!b&&e[l]&&(g=!0):delete e[l],g?e[l]=d:U8(e,l,d)):g?e[l]=d:Uet(l,d)})(Function.prototype,"toString",function(){return M8(this)&&Qet(this).source||jet(this)});var Q2={},qet=Math.ceil,Het=Math.floor,oR=function(e){var l=+e;return l!=l||l===0?0:(l>0?Het:qet)(l)},Ket=oR,Yet=Math.max,Wet=Math.min,fN=function(e,l){var d=Ket(e);return d<0?Yet(d+l,0):Wet(d,l)},Jet=oR,zet=Math.min,TT=function(e){return e>0?zet(Jet(e),9007199254740991):0},Xet=TT,sR=function(e){return Xet(e.length)},Zet=QI,$et=fN,tnt=sR,j8=function(e){return function(l,d,p){var A,y=Zet(l),g=tnt(y),b=$et(p,g);if(e&&d!=d){for(;g>b;)if((A=y[b++])!=A)return!0}else for(;g>b;b++)if((e||b in y)&&y[b]===d)return e||b||0;return!e&&-1}},ent={includes:j8(!0),indexOf:j8(!1)},O3=W1,nnt=QI,rnt=ent.indexOf,int=_3,F8=G0([].push),Q8=function(e,l){var d,p=nnt(e),A=0,y=[];for(d in p)!O3(int,d)&&O3(p,d)&&F8(y,d);for(;l.length>A;)O3(p,d=l[A++])&&(~rnt(y,d)||F8(y,d));return y},N3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ont=Q8,snt=N3.concat("length","prototype");Q2.f=Object.getOwnPropertyNames||function(e){return ont(e,snt)};var G8={};G8.f=Object.getOwnPropertySymbols;var ant=r_,cnt=Q2,unt=G8,lnt=i_,dnt=G0([].concat),hnt=ant("Reflect","ownKeys")||function(e){var l=cnt.f(lnt(e)),d=unt.f;return d?dnt(l,d(e)):l},V8=W1,pnt=hnt,fnt=_,Ant=J1,k3=function(e,l,d){for(var p=pnt(l),A=Ant.f,y=fnt.f,g=0;g<p.length;g++){var b=p[g];V8(e,b)||d&&V8(d,b)||A(e,b,y(l,b))}},gnt=w,Ent=qI,mnt=/#|\.prototype\./,G2=function(e,l){var d=Int[vnt(e)];return d==ynt||d!=_nt&&(Ent(l)?gnt(l):!!l)},vnt=G2.normalize=function(e){return String(e).replace(mnt,".").toLowerCase()},Int=G2.data={},_nt=G2.NATIVE="N",ynt=G2.POLYFILL="P",D3=G2,L3=f,bnt=_.f,Cnt=X_,Snt=aS.exports,Rnt=f3,Tnt=k3,wnt=D3,P_=function(e,l){var d,p,A,y,g,b=e.target,I=e.global,k=e.stat;if(d=I?L3:k?L3[b]||Rnt(b,{}):(L3[b]||{}).prototype)for(p in l){if(y=l[p],A=e.noTargetGet?(g=bnt(d,p))&&g.value:d[p],!wnt(I?p:b+(k?".":"#")+p,e.forced)&&A!==void 0){if(typeof y==typeof A)continue;Tnt(y,A)}(e.sham||A&&A.sham)&&Cnt(y,"sham",!0),Snt(d,p,y,e)}},q8=f.Promise,Ont=aS.exports,H8=function(e,l,d){for(var p in l)Ont(e,p,l[p],d);return e},K8=f,Nnt=qI,knt=K8.String,Dnt=K8.TypeError,Lnt=G0,Pnt=i_,xnt=function(e){if(typeof e=="object"||Nnt(e))return e;throw Dnt("Can't set "+knt(e)+" as a prototype")},BR=Object.setPrototypeOf||("__proto__"in{}?function(){var e,l=!1,d={};try{(e=Lnt(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(d,[]),l=d instanceof Array}catch{}return function(p,A){return Pnt(p),xnt(A),l?e(p,A):p.__proto__=A,p}}():void 0),Bnt=J1.f,Mnt=W1,Y8=w1("toStringTag"),V2=function(e,l,d){e&&!d&&(e=e.prototype),e&&!Mnt(e,Y8)&&Bnt(e,Y8,{configurable:!0,value:l})},Unt=r_,jnt=J1,Fnt=j,W8=w1("species"),AN=function(e){var l=Unt(e),d=jnt.f;Fnt&&l&&!l[W8]&&d(l,W8,{configurable:!0,get:function(){return this}})},Qnt=I_,Gnt=f.TypeError,q2=function(e,l){if(Qnt(l,e))return e;throw Gnt("Incorrect invocation")},Vnt=ST,qnt=F,Hnt=G0(G0.bind),H2=function(e,l){return Vnt(e),l===void 0?e:qnt?Hnt(e,l):function(){return e.apply(l,arguments)}},K2={},Knt=K2,Ynt=w1("iterator"),Wnt=Array.prototype,J8=function(e){return e!==void 0&&(Knt.Array===e||Wnt[Ynt]===e)},z8={};z8[w1("toStringTag")]="z";var Jnt=f,znt=String(z8)==="[object z]",Xnt=qI,gN=v0,Znt=w1("toStringTag"),$nt=Jnt.Object,trt=gN(function(){return arguments}())=="Arguments",Y2=znt?gN:function(e){var l,d,p;return e===void 0?"Undefined":e===null?"Null":typeof(d=function(A,y){try{return A[y]}catch{}}(l=$nt(e),Znt))=="string"?d:trt?gN(l):(p=gN(l))=="Object"&&Xnt(l.callee)?"Arguments":p},ert=Y2,X8=sN,nrt=K2,rrt=w1("iterator"),P3=function(e){if(e!=null)return X8(e,rrt)||X8(e,"@@iterator")||nrt[ert(e)]},irt=_o,ort=ST,srt=i_,art=U2,crt=P3,urt=f.TypeError,Z8=function(e,l){var d=arguments.length<2?crt(e):l;if(ort(d))return srt(irt(d,e));throw urt(art(e)+" is not iterable")},lrt=_o,$8=i_,drt=sN,hrt=H2,prt=_o,frt=i_,Art=U2,grt=J8,Ert=sR,lj=I_,mrt=Z8,vrt=P3,mj=function(e,l,d){var p,A;$8(e);try{if(!(p=drt(e,"return"))){if(l==="throw")throw d;return d}p=lrt(p,e)}catch(y){A=!0,p=y}if(l==="throw")throw d;if(A)throw p;return $8(p),d},Irt=f.TypeError,EN=function(e,l){this.stopped=e,this.result=l},_j=EN.prototype,kj=w1("iterator"),jj=!1;try{var _rt=0,$j={next:function(){return{done:!!_rt++}},return:function(){jj=!0}};$j[kj]=function(){return this},Array.from($j,function(){throw 2})}catch{}var _F=function(e,l){if(!l&&!jj)return!1;var d=!1;try{var p={};p[kj]=function(){return{next:function(){return{done:d=!0}}}},e(p)}catch{}return d},yrt=G0,brt=w,tQ=qI,Crt=Y2,Srt=pN,eQ=function(){},Rrt=[],nQ=r_("Reflect","construct"),x3=/^\s*(?:class|function)\b/,Trt=yrt(x3.exec),wrt=!x3.exec(eQ),W2=function(e){if(!tQ(e))return!1;try{return nQ(eQ,Rrt,e),!0}catch{return!1}},rQ=function(e){if(!tQ(e))return!1;switch(Crt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return wrt||!!Trt(x3,Srt(e))}catch{return!0}};rQ.sham=!0;var J2,wT,iQ,B3,oQ=!nQ||brt(function(){var e;return W2(W2.call)||!W2(Object)||!W2(function(){e=!0})||e})?rQ:W2,Ort=oQ,Nrt=U2,krt=f.TypeError,sQ=function(e){if(Ort(e))return e;throw krt(Nrt(e)+" is not a constructor")},aQ=i_,Drt=sQ,Lrt=w1("species"),M3=function(e,l){var d,p=aQ(e).constructor;return p===void 0||(d=aQ(p)[Lrt])==null?l:Drt(d)},Prt=F,cQ=Function.prototype,uQ=cQ.apply,lQ=cQ.call,mN=typeof Reflect=="object"&&Reflect.apply||(Prt?lQ.bind(uQ):function(){return lQ.apply(uQ,arguments)}),dQ=r_("document","documentElement"),xrt=G0([].slice),hQ=/(?:ipad|iphone|ipod).*applewebkit/i.test(DS),vN=v0(f.process)=="process",x_=f,Brt=mN,Mrt=H2,pQ=qI,Urt=W1,jrt=w,fQ=dQ,Frt=xrt,AQ=uN,Qrt=hQ,Grt=vN,U3=x_.setImmediate,j3=x_.clearImmediate,Vrt=x_.process,F3=x_.Dispatch,qrt=x_.Function,gQ=x_.MessageChannel,Hrt=x_.String,Q3=0,z2={},Krt="onreadystatechange";try{J2=x_.location}catch{}var G3=function(e){if(Urt(z2,e)){var l=z2[e];delete z2[e],l()}},V3=function(e){return function(){G3(e)}},EQ=function(e){G3(e.data)},mQ=function(e){x_.postMessage(Hrt(e),J2.protocol+"//"+J2.host)};U3&&j3||(U3=function(e){var l=Frt(arguments,1);return z2[++Q3]=function(){Brt(pQ(e)?e:qrt(e),void 0,l)},wT(Q3),Q3},j3=function(e){delete z2[e]},Grt?wT=function(e){Vrt.nextTick(V3(e))}:F3&&F3.now?wT=function(e){F3.now(V3(e))}:gQ&&!Qrt?(B3=(iQ=new gQ).port2,iQ.port1.onmessage=EQ,wT=Mrt(B3.postMessage,B3)):x_.addEventListener&&pQ(x_.postMessage)&&!x_.importScripts&&J2&&J2.protocol!=="file:"&&!jrt(mQ)?(wT=mQ,x_.addEventListener("message",EQ,!1)):wT=Krt in AQ("script")?function(e){fQ.appendChild(AQ("script")).onreadystatechange=function(){fQ.removeChild(this),G3(e)}}:function(e){setTimeout(V3(e),0)});var X2,MR,Z2,OT,q3,H3,K3,vQ,IQ={set:U3,clear:j3},Yrt=f,Wrt=/ipad|iphone|ipod/i.test(DS)&&Yrt.Pebble!==void 0,Jrt=/web0s(?!.*chrome)/i.test(DS),UR=f,_Q=H2,zrt=_.f,Y3=IQ.set,Xrt=hQ,Zrt=Wrt,$rt=Jrt,W3=vN,yQ=UR.MutationObserver||UR.WebKitMutationObserver,bQ=UR.document,CQ=UR.process,IN=UR.Promise,SQ=zrt(UR,"queueMicrotask"),RQ=SQ&&SQ.value;RQ||(X2=function(){var e,l;for(W3&&(e=CQ.domain)&&e.exit();MR;){l=MR.fn,MR=MR.next;try{l()}catch(d){throw MR?OT():Z2=void 0,d}}Z2=void 0,e&&e.enter()},Xrt||W3||$rt||!yQ||!bQ?!Zrt&&IN&&IN.resolve?((K3=IN.resolve(void 0)).constructor=IN,vQ=_Q(K3.then,K3),OT=function(){vQ(X2)}):W3?OT=function(){CQ.nextTick(X2)}:(Y3=_Q(Y3,UR),OT=function(){Y3(X2)}):(q3=!0,H3=bQ.createTextNode(""),new yQ(X2).observe(H3,{characterData:!0}),OT=function(){H3.data=q3=!q3}));var tit=RQ||function(e){var l={fn:e,next:void 0};Z2&&(Z2.next=l),MR||(MR=l,OT()),Z2=l},J3={},TQ=ST,eit=function(e){var l,d;this.promise=new e(function(p,A){if(l!==void 0||d!==void 0)throw TypeError("Bad Promise constructor");l=p,d=A}),this.resolve=TQ(l),this.reject=TQ(d)};J3.f=function(e){return new eit(e)};var nit=i_,rit=h1,iit=J3,wQ=function(e,l){if(nit(e),rit(l)&&l.constructor===e)return l;var d=iit.f(e);return(0,d.resolve)(l),d.promise},oit=f,OQ=function(){this.head=null,this.tail=null};OQ.prototype={add:function(e){var l={item:e,next:null};this.head?this.tail.next=l:this.head=l,this.tail=l},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var z3,NQ,kQ,DQ,sit=OQ,ait=typeof window=="object",_N=P_,LS=f,cit=r_,PS=_o,yN=q8,LQ=aS.exports,uit=H8,PQ=BR,lit=V2,dit=AN,X3=ST,$2=qI,hit=h1,pit=q2,fit=pN,xQ=function(e,l,d){var p,A,y,g,b,I,k,B=d&&d.that,q=!(!d||!d.AS_ENTRIES),$=!(!d||!d.IS_ITERATOR),_t=!(!d||!d.INTERRUPTED),_r=hrt(l,B),_i=function(_u){return p&&mj(p,"normal",_u),new EN(!0,_u)},ga=function(_u){return q?(frt(_u),_t?_r(_u[0],_u[1],_i):_r(_u[0],_u[1])):_t?_r(_u,_i):_r(_u)};if($)p=e;else{if(!(A=vrt(e)))throw Irt(Art(e)+" is not iterable");if(grt(A)){for(y=0,g=Ert(e);g>y;y++)if((b=ga(e[y]))&&lj(_j,b))return b;return new EN(!1)}p=mrt(e,A)}for(I=p.next;!(k=prt(I,p)).done;){try{b=ga(k.value)}catch(_u){mj(p,"throw",_u)}if(typeof b=="object"&&b&&lj(_j,b))return b}return new EN(!1)},Ait=_F,git=M3,BQ=IQ.set,Z3=tit,Eit=wQ,mit=function(e,l){var d=oit.console;d&&d.error&&(arguments.length==1?d.error(e):d.error(e,l))},MQ=J3,$3=function(e){try{return{error:!1,value:e()}}catch(l){return{error:!0,value:l}}},vit=sit,tM=Z_,Iit=D3,_it=ait,bN=vN,UQ=z_,yit=w1("species"),vS="Promise",jQ=tM.getterFor(vS),bit=tM.set,Cit=tM.getterFor(vS),jR=yN&&yN.prototype,IS=yN,tO=jR,FQ=LS.TypeError,eM=LS.document,nM=LS.process,NT=MQ.f,Sit=NT,Rit=!!(eM&&eM.createEvent&&LS.dispatchEvent),QQ=$2(LS.PromiseRejectionEvent),GQ="unhandledrejection",VQ=!1,eO=Iit(vS,function(){var e=fit(IS),l=e!==String(IS);if(!l&&UQ===66)return!0;if(UQ>=51&&/native code/.test(e))return!1;var d=new IS(function(A){A(1)}),p=function(A){A(function(){},function(){})};return(d.constructor={})[yit]=p,!(VQ=d.then(function(){})instanceof p)||!l&&_it&&!QQ}),Tit=eO||!Ait(function(e){IS.all(e).catch(function(){})}),qQ=function(e){var l;return!(!hit(e)||!$2(l=e.then))&&l},HQ=function(e,l){var d,p,A,y=l.value,g=l.state==1,b=g?e.ok:e.fail,I=e.resolve,k=e.reject,B=e.domain;try{b?(g||(l.rejection===2&&Oit(l),l.rejection=1),b===!0?d=y:(B&&B.enter(),d=b(y),B&&(B.exit(),A=!0)),d===e.promise?k(FQ("Promise-chain cycle")):(p=qQ(d))?PS(p,d,I,k):I(d)):k(y)}catch(q){B&&!A&&B.exit(),k(q)}},KQ=function(e,l){e.notified||(e.notified=!0,Z3(function(){for(var d,p=e.reactions;d=p.get();)HQ(d,e);e.notified=!1,l&&!e.rejection&&wit(e)}))},YQ=function(e,l,d){var p,A;Rit?((p=eM.createEvent("Event")).promise=l,p.reason=d,p.initEvent(e,!1,!0),LS.dispatchEvent(p)):p={promise:l,reason:d},!QQ&&(A=LS["on"+e])?A(p):e===GQ&&mit("Unhandled promise rejection",d)},wit=function(e){PS(BQ,LS,function(){var l,d=e.facade,p=e.value;if(WQ(e)&&(l=$3(function(){bN?nM.emit("unhandledRejection",p,d):YQ(GQ,d,p)}),e.rejection=bN||WQ(e)?2:1,l.error))throw l.value})},WQ=function(e){return e.rejection!==1&&!e.parent},Oit=function(e){PS(BQ,LS,function(){var l=e.facade;bN?nM.emit("rejectionHandled",l):YQ("rejectionhandled",l,e.value)})},kT=function(e,l,d){return function(p){e(l,p,d)}},DT=function(e,l,d){e.done||(e.done=!0,d&&(e=d),e.value=l,e.state=2,KQ(e,!0))},rM=function(e,l,d){if(!e.done){e.done=!0,d&&(e=d);try{if(e.facade===l)throw FQ("Promise can't be resolved itself");var p=qQ(l);p?Z3(function(){var A={done:!1};try{PS(p,l,kT(rM,A,e),kT(DT,A,e))}catch(y){DT(A,y,e)}}):(e.value=l,e.state=1,KQ(e,!1))}catch(A){DT({done:!1},A,e)}}};if(eO&&(tO=(IS=function(e){pit(this,tO),X3(e),PS(z3,this);var l=jQ(this);try{e(kT(rM,l),kT(DT,l))}catch(d){DT(l,d)}}).prototype,(z3=function(e){bit(this,{type:vS,done:!1,notified:!1,parent:!1,reactions:new vit,rejection:!1,state:0,value:void 0})}).prototype=uit(tO,{then:function(e,l){var d=Cit(this),p=NT(git(this,IS));return d.parent=!0,p.ok=!$2(e)||e,p.fail=$2(l)&&l,p.domain=bN?nM.domain:void 0,d.state==0?d.reactions.add(p):Z3(function(){HQ(p,d)}),p.promise},catch:function(e){return this.then(void 0,e)}}),NQ=function(){var e=new z3,l=jQ(e);this.promise=e,this.resolve=kT(rM,l),this.reject=kT(DT,l)},MQ.f=NT=function(e){return e===IS||e===kQ?new NQ(e):Sit(e)},$2(yN)&&jR!==Object.prototype)){DQ=jR.then,VQ||(LQ(jR,"then",function(e,l){var d=this;return new IS(function(p,A){PS(DQ,d,p,A)}).then(e,l)},{unsafe:!0}),LQ(jR,"catch",tO.catch,{unsafe:!0}));try{delete jR.constructor}catch{}PQ&&PQ(jR,tO)}_N({global:!0,wrap:!0,forced:eO},{Promise:IS}),lit(IS,vS,!1),dit(vS),kQ=cit(vS),_N({target:vS,stat:!0,forced:eO},{reject:function(e){var l=NT(this);return PS(l.reject,void 0,e),l.promise}}),_N({target:vS,stat:!0,forced:eO},{resolve:function(e){return Eit(this,e)}}),_N({target:vS,stat:!0,forced:Tit},{all:function(e){var l=this,d=NT(l),p=d.resolve,A=d.reject,y=$3(function(){var g=X3(l.resolve),b=[],I=0,k=1;xQ(e,function(B){var q=I++,$=!1;k++,PS(g,l,B).then(function(_t){$||($=!0,b[q]=_t,--k||p(b))},A)}),--k||p(b)});return y.error&&A(y.value),d.promise},race:function(e){var l=this,d=NT(l),p=d.reject,A=$3(function(){var y=X3(l.resolve);xQ(e,function(g){PS(y,l,g).then(d.resolve,p)})});return A.error&&p(A.value),d.promise}});var Nit=P_,kit=r_,Dit=mN,nO=G0,Lit=w,Pit=f.Array,CN=kit("JSON","stringify"),SN=nO(/./.exec),JQ=nO("".charAt),xit=nO("".charCodeAt),Bit=nO("".replace),Mit=nO(1 .toString),Uit=/[\uD800-\uDFFF]/g,zQ=/^[\uD800-\uDBFF]$/,XQ=/^[\uDC00-\uDFFF]$/,jit=function(e,l,d){var p=JQ(d,l-1),A=JQ(d,l+1);return SN(zQ,e)&&!SN(XQ,A)||SN(XQ,e)&&!SN(zQ,p)?"\\u"+Mit(xit(e,0),16):e},Fit=Lit(function(){return CN("\uDF06\uD834")!=='"\\udf06\\ud834"'||CN("\uDEAD")!=='"\\udead"'});CN&&Nit({target:"JSON",stat:!0,forced:Fit},{stringify:function(e,l,d){for(var p=0,A=arguments.length,y=Pit(A);p<A;p++)y[p]=arguments[p];var g=Dit(CN,null,y);return typeof g=="string"?Bit(g,Uit,jit):g}});var m1=function(e){try{return!!e()}catch{return!0}},RN=!m1(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ZQ=RN,$Q=Function.prototype,Qit=$Q.bind,iM=$Q.call,Git=ZQ&&Qit.bind(iM,iM),t1=ZQ?function(e){return e&&Git(e)}:function(e){return e&&function(){return iM.apply(e,arguments)}},B_=t1({}.isPrototypeOf),TN=function(e){return e&&e.Math==Math&&e},II=TN(typeof globalThis=="object"&&globalThis)||TN(typeof window=="object"&&window)||TN(typeof self=="object"&&self)||TN(typeof s=="object"&&s)||function(){return this}()||Function("return this")(),Vit=RN,t9=Function.prototype,e9=t9.apply,n9=t9.call,oM=typeof Reflect=="object"&&Reflect.apply||(Vit?n9.bind(e9):function(){return n9.apply(e9,arguments)}),B1=function(e){return typeof e=="function"},rO={},$_=!m1(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),qit=RN,wN=Function.prototype.call,__=qit?wN.bind(wN):function(){return wN.apply(wN,arguments)},ON={},r9={}.propertyIsEnumerable,i9=Object.getOwnPropertyDescriptor,Hit=i9&&!r9.call({1:2},1);ON.f=Hit?function(e){var l=i9(this,e);return!!l&&l.enumerable}:r9;var aR,NN,cR=function(e,l){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:l}},o9=t1,Kit=o9({}.toString),Yit=o9("".slice),iO=function(e){return Yit(Kit(e),8,-1)},Wit=t1,Jit=m1,zit=iO,sM=II.Object,Xit=Wit("".split),kN=Jit(function(){return!sM("z").propertyIsEnumerable(0)})?function(e){return zit(e)=="String"?Xit(e,""):sM(e)}:sM,Zit=II.TypeError,DN=function(e){if(e==null)throw Zit("Can't call method on "+e);return e},$it=kN,tot=DN,uR=function(e){return $it(tot(e))},eot=B1,M_=function(e){return typeof e=="object"?e!==null:eot(e)},xS={},aM=xS,cM=II,not=B1,s9=function(e){return not(e)?e:void 0},cS=function(e,l){return arguments.length<2?s9(aM[e])||s9(cM[e]):aM[e]&&aM[e][l]||cM[e]&&cM[e][l]},FR=cS("navigator","userAgent")||"",a9=II,uM=FR,c9=a9.process,u9=a9.Deno,l9=c9&&c9.versions||u9&&u9.version,d9=l9&&l9.v8;d9&&(NN=(aR=d9.split("."))[0]>0&&aR[0]<4?1:+(aR[0]+aR[1])),!NN&&uM&&(!(aR=uM.match(/Edge\/(\d+)/))||aR[1]>=74)&&(aR=uM.match(/Chrome\/(\d+)/))&&(NN=+aR[1]);var LT=NN,h9=LT,rot=m1,lM=!!Object.getOwnPropertySymbols&&!rot(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&h9&&h9<41}),p9=lM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",iot=cS,oot=B1,sot=B_,aot=p9,cot=II.Object,dM=aot?function(e){return typeof e=="symbol"}:function(e){var l=iot("Symbol");return oot(l)&&sot(l.prototype,cot(e))},uot=II.String,LN=function(e){try{return uot(e)}catch{return"Object"}},lot=B1,dot=LN,hot=II.TypeError,BS=function(e){if(lot(e))return e;throw hot(dot(e)+" is not a function")},pot=BS,hM=function(e,l){var d=e[l];return d==null?void 0:pot(d)},pM=__,fM=B1,AM=M_,fot=II.TypeError,PN={exports:{}},f9=II,Aot=Object.defineProperty,got=function(e,l){try{Aot(f9,e,{value:l,configurable:!0,writable:!0})}catch{f9[e]=l}return l},A9="__core-js_shared__",gM=II[A9]||got(A9,{}),g9=gM;(PN.exports=function(e,l){return g9[e]||(g9[e]=l!==void 0?l:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var Eot=DN,mot=II.Object,_S=function(e){return mot(Eot(e))},vot=_S,Iot=t1({}.hasOwnProperty),z1=Object.hasOwn||function(e,l){return Iot(vot(e),l)},_ot=t1,yot=0,bot=Math.random(),Cot=_ot(1 .toString),EM=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Cot(++yot+bot,36)},Sot=II,Rot=PN.exports,E9=z1,Tot=EM,m9=lM,v9=p9,oO=Rot("wks"),QR=Sot.Symbol,I9=QR&&QR.for,wot=v9?QR:QR&&QR.withoutSetter||Tot,v1=function(e){if(!E9(oO,e)||!m9&&typeof oO[e]!="string"){var l="Symbol."+e;m9&&E9(QR,e)?oO[e]=QR[e]:oO[e]=v9&&I9?I9(l):wot(l)}return oO[e]},Oot=__,_9=M_,y9=dM,Not=hM,kot=function(e,l){var d,p;if(l==="string"&&fM(d=e.toString)&&!AM(p=pM(d,e))||fM(d=e.valueOf)&&!AM(p=pM(d,e))||l!=="string"&&fM(d=e.toString)&&!AM(p=pM(d,e)))return p;throw fot("Can't convert object to primitive value")},Dot=v1,Lot=II.TypeError,Pot=Dot("toPrimitive"),xot=function(e,l){if(!_9(e)||y9(e))return e;var d,p=Not(e,Pot);if(p){if(l===void 0&&(l="default"),d=Oot(p,e,l),!_9(d)||y9(d))return d;throw Lot("Can't convert object to primitive value")}return l===void 0&&(l="number"),kot(e,l)},Bot=dM,xN=function(e){var l=xot(e,"string");return Bot(l)?l:l+""},b9=M_,mM=II.document,Mot=b9(mM)&&b9(mM.createElement),vM=function(e){return Mot?mM.createElement(e):{}},Uot=vM,C9=!$_&&!m1(function(){return Object.defineProperty(Uot("div"),"a",{get:function(){return 7}}).a!=7}),jot=$_,Fot=__,Qot=ON,Got=cR,Vot=uR,qot=xN,Hot=z1,Kot=C9,S9=Object.getOwnPropertyDescriptor;rO.f=jot?S9:function(e,l){if(e=Vot(e),l=qot(l),Kot)try{return S9(e,l)}catch{}if(Hot(e,l))return Got(!Fot(Qot.f,e,l),e[l])};var Yot=m1,Wot=B1,Jot=/#|\.prototype\./,sO=function(e,l){var d=Xot[zot(e)];return d==$ot||d!=Zot&&(Wot(l)?Yot(l):!!l)},zot=sO.normalize=function(e){return String(e).replace(Jot,".").toLowerCase()},Xot=sO.data={},Zot=sO.NATIVE="N",$ot=sO.POLYFILL="P",R9=sO,tst=BS,est=RN,nst=t1(t1.bind),lR=function(e,l){return tst(e),l===void 0?e:est?nst(e,l):function(){return e.apply(l,arguments)}},uS={},T9=$_&&m1(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),w9=II,rst=M_,ist=w9.String,ost=w9.TypeError,U_=function(e){if(rst(e))return e;throw ost(ist(e)+" is not an object")},sst=$_,ast=C9,cst=T9,BN=U_,O9=xN,ust=II.TypeError,IM=Object.defineProperty,lst=Object.getOwnPropertyDescriptor,dst="enumerable",hst="configurable",pst="writable";uS.f=sst?cst?function(e,l,d){if(BN(e),l=O9(l),BN(d),typeof e=="function"&&l==="prototype"&&"value"in d&&pst in d&&!d.writable){var p=lst(e,l);p&&p.writable&&(e[l]=d.value,d={configurable:hst in d?d.configurable:p.configurable,enumerable:dst in d?d.enumerable:p.enumerable,writable:!1})}return IM(e,l,d)}:IM:function(e,l,d){if(BN(e),l=O9(l),BN(d),ast)try{return IM(e,l,d)}catch{}if("get"in d||"set"in d)throw ust("Accessors not supported");return"value"in d&&(e[l]=d.value),e};var fst=uS,Ast=cR,GR=$_?function(e,l,d){return fst.f(e,l,Ast(1,d))}:function(e,l,d){return e[l]=d,e},MN=II,gst=oM,Est=t1,mst=B1,vst=rO.f,Ist=R9,PT=xS,_st=lR,xT=GR,N9=z1,yst=function(e){var l=function(d,p,A){if(this instanceof l){switch(arguments.length){case 0:return new e;case 1:return new e(d);case 2:return new e(d,p)}return new e(d,p,A)}return gst(e,this,arguments)};return l.prototype=e.prototype,l},M1=function(e,l){var d,p,A,y,g,b,I,k,B=e.target,q=e.global,$=e.stat,_t=e.proto,_r=q?MN:$?MN[B]:(MN[B]||{}).prototype,_i=q?PT:PT[B]||xT(PT,B,{})[B],ga=_i.prototype;for(A in l)d=!Ist(q?A:B+($?".":"#")+A,e.forced)&&_r&&N9(_r,A),g=_i[A],d&&(b=e.noTargetGet?(k=vst(_r,A))&&k.value:_r[A]),y=d&&b?b:l[A],d&&typeof g==typeof y||(I=e.bind&&d?_st(y,MN):e.wrap&&d?yst(y):_t&&mst(y)?Est(y):y,(e.sham||y&&y.sham||g&&g.sham)&&xT(I,"sham",!0),xT(_i,A,I),_t&&(N9(PT,p=B+"Prototype")||xT(PT,p,{}),xT(PT[p],A,y),e.real&&ga&&!ga[A]&&xT(ga,A,y)))},bst=Math.ceil,Cst=Math.floor,_M=function(e){var l=+e;return l!=l||l===0?0:(l>0?Cst:bst)(l)},Sst=_M,Rst=Math.min,Tst=function(e){return e>0?Rst(Sst(e),9007199254740991):0},MS=function(e){return Tst(e.length)},wst=BS,Ost=_S,Nst=kN,kst=MS,Dst=II.TypeError,k9=function(e){return function(l,d,p,A){wst(d);var y=Ost(l),g=Nst(y),b=kst(y),I=e?b-1:0,k=e?-1:1;if(p<2)for(;;){if(I in g){A=g[I],I+=k;break}if(I+=k,e?I<0:b<=I)throw Dst("Reduce of empty array with no initial value")}for(;e?I>=0:b>I;I+=k)I in g&&(A=d(A,g[I],I,y));return A}},Lst={left:k9(!1),right:k9(!0)},Pst=m1,yM=function(e,l){var d=[][e];return!!d&&Pst(function(){d.call(null,l||function(){throw 1},1)})},UN=iO(II.process)=="process",xst=Lst.left,D9=LT,Bst=UN;M1({target:"Array",proto:!0,forced:!yM("reduce")||!Bst&&D9>79&&D9<83},{reduce:function(e){var l=arguments.length;return xst(this,e,l,l>1?arguments[1]:void 0)}});var Mst=xS,dR=function(e){return Mst[e+"Prototype"]},Ust=dR("Array").reduce,jst=B_,Fst=Ust,bM=Array.prototype,L9=function(e){var l=e.reduce;return e===bM||jst(bM,e)&&l===bM.reduce?Fst:l},VR=L9,Qst=Y2,Gst=f.String,BT=function(e){if(Qst(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Gst(e)},Vst=i_,P9=function(){var e=Vst(this),l="";return e.global&&(l+="g"),e.ignoreCase&&(l+="i"),e.multiline&&(l+="m"),e.dotAll&&(l+="s"),e.unicode&&(l+="u"),e.sticky&&(l+="y"),l},CM=w,SM=f.RegExp,RM=CM(function(){var e=SM("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),qst=RM||CM(function(){return!SM("a","y").sticky}),x9={BROKEN_CARET:RM||CM(function(){var e=SM("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),MISSED_STICKY:qst,UNSUPPORTED_Y:RM},TM={},Hst=Q8,Kst=N3,Yst=Object.keys||function(e){return Hst(e,Kst)},Wst=j,Jst=w8,zst=J1,Xst=i_,Zst=QI,$st=Yst;TM.f=Wst&&!Jst?Object.defineProperties:function(e,l){Xst(e);for(var d,p=Zst(l),A=$st(l),y=A.length,g=0;y>g;)zst.f(e,d=A[g++],p[d]);return e};var jN,tat=i_,eat=TM,B9=N3,nat=_3,rat=dQ,iat=uN,M9=I3("IE_PROTO"),wM=function(){},U9=function(e){return"<script>"+e+"<\/script>"},j9=function(e){e.write(U9("")),e.close();var l=e.parentWindow.Object;return e=null,l},FN=function(){try{jN=new ActiveXObject("htmlfile")}catch{}var e,l;FN=typeof document!="undefined"?document.domain&&jN?j9(jN):((l=iat("iframe")).style.display="none",rat.appendChild(l),l.src=String("javascript:"),(e=l.contentWindow.document).open(),e.write(U9("document.F=Object")),e.close(),e.F):j9(jN);for(var d=B9.length;d--;)delete FN.prototype[B9[d]];return FN()};nat[M9]=!0;var MT=Object.create||function(e,l){var d;return e!==null?(wM.prototype=tat(e),d=new wM,wM.prototype=null,d[M9]=e):d=FN(),l===void 0?d:eat.f(d,l)},oat=w,sat=f.RegExp,OM=oat(function(){var e=sat(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),aat=w,cat=f.RegExp,F9=aat(function(){var e=cat("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),UT=_o,QN=G0,uat=BT,lat=P9,dat=x9,hat=aN.exports,pat=MT,fat=Z_.get,Aat=OM,gat=F9,Eat=hat("native-string-replace",String.prototype.replace),GN=RegExp.prototype.exec,NM=GN,mat=QN("".charAt),vat=QN("".indexOf),Iat=QN("".replace),kM=QN("".slice),DM=function(){var e=/a/,l=/b*/g;return UT(GN,e,"a"),UT(GN,l,"a"),e.lastIndex!==0||l.lastIndex!==0}(),Q9=dat.BROKEN_CARET,LM=/()??/.exec("")[1]!==void 0;(DM||LM||Q9||Aat||gat)&&(NM=function(e){var l,d,p,A,y,g,b,I=this,k=fat(I),B=uat(e),q=k.raw;if(q)return q.lastIndex=I.lastIndex,l=UT(NM,q,B),I.lastIndex=q.lastIndex,l;var $=k.groups,_t=Q9&&I.sticky,_r=UT(lat,I),_i=I.source,ga=0,_u=B;if(_t&&(_r=Iat(_r,"y",""),vat(_r,"g")===-1&&(_r+="g"),_u=kM(B,I.lastIndex),I.lastIndex>0&&(!I.multiline||I.multiline&&mat(B,I.lastIndex-1)!==`
`)&&(_i="(?: "+_i+")",_u=" "+_u,ga++),d=new RegExp("^(?:"+_i+")",_r)),LM&&(d=new RegExp("^"+_i+"$(?!\\s)",_r)),DM&&(p=I.lastIndex),A=UT(GN,_t?d:I,_u),_t?A?(A.input=kM(A.input,ga),A[0]=kM(A[0],ga),A.index=I.lastIndex,I.lastIndex+=A[0].length):I.lastIndex=0:DM&&A&&(I.lastIndex=I.global?A.index+A[0].length:p),LM&&A&&A.length>1&&UT(Eat,A[0],d,function(){for(y=1;y<arguments.length-2;y++)arguments[y]===void 0&&(A[y]=void 0)}),A&&$)for(A.groups=g=pat(null),y=0;y<$.length;y++)g[(b=$[y])[0]]=A[b[1]];return A});var VN=NM;P_({target:"RegExp",proto:!0,forced:/./.exec!==VN},{exec:VN});var _at=MT,yat=J1,PM=w1("unscopables"),xM=Array.prototype;xM[PM]==null&&yat.f(xM,PM,{configurable:!0,value:_at(null)});var qR,G9,V9,bat=!w(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Cat=f,Sat=W1,Rat=qI,Tat=LR,wat=bat,q9=I3("IE_PROTO"),BM=Cat.Object,Oat=BM.prototype,qN=wat?BM.getPrototypeOf:function(e){var l=Tat(e);if(Sat(l,q9))return l[q9];var d=l.constructor;return Rat(d)&&l instanceof d?d.prototype:l instanceof BM?Oat:null},Nat=w,kat=qI,H9=qN,Dat=aS.exports,MM=w1("iterator"),K9=!1;[].keys&&("next"in(V9=[].keys())?(G9=H9(H9(V9)))!==Object.prototype&&(qR=G9):K9=!0),(qR==null||Nat(function(){var e={};return qR[MM].call(e)!==e}))&&(qR={}),kat(qR[MM])||Dat(qR,MM,function(){return this});var UM={IteratorPrototype:qR,BUGGY_SAFARI_ITERATORS:K9},Lat=UM.IteratorPrototype,Pat=MT,xat=_v,Bat=V2,Mat=K2,Uat=function(){return this},jat=P_,Fat=_o,Y9=w3,Qat=qI,Gat=function(e,l,d,p){var A=l+" Iterator";return e.prototype=Pat(Lat,{next:xat(+!p,d)}),Bat(e,A,!1),Mat[A]=Uat,e},W9=qN,J9=BR,Vat=V2,qat=X_,jM=aS.exports,Hat=K2,Kat=Y9.PROPER,Yat=Y9.CONFIGURABLE,z9=UM.IteratorPrototype,HN=UM.BUGGY_SAFARI_ITERATORS,aO=w1("iterator"),X9="keys",cO="values",Z9="entries",Wat=function(){return this},Jat=QI,FM=function(e){xM[PM][e]=!0},$9=K2,t7=Z_,zat=J1.f,Xat=function(e,l,d,p,A,y,g){Gat(d,l,p);var b,I,k,B=function(_u){if(_u===A&&_i)return _i;if(!HN&&_u in _t)return _t[_u];switch(_u){case X9:case cO:case Z9:return function(){return new d(this,_u)}}return function(){return new d(this)}},q=l+" Iterator",$=!1,_t=e.prototype,_r=_t[aO]||_t["@@iterator"]||A&&_t[A],_i=!HN&&_r||B(A),ga=l=="Array"&&_t.entries||_r;if(ga&&(b=W9(ga.call(new e)))!==Object.prototype&&b.next&&(W9(b)!==z9&&(J9?J9(b,z9):Qat(b[aO])||jM(b,aO,Wat)),Vat(b,q,!0)),Kat&&A==cO&&_r&&_r.name!==cO&&(Yat?qat(_t,"name",cO):($=!0,_i=function(){return Fat(_r,this)})),A)if(I={values:B(cO),keys:y?_i:B(X9),entries:B(Z9)},g)for(k in I)(HN||$||!(k in _t))&&jM(_t,k,I[k]);else jat({target:l,proto:!0,forced:HN||$},I);return _t[aO]!==_i&&jM(_t,aO,_i,{name:A}),Hat[l]=_i,I},Zat=j,e7="Array Iterator",$at=t7.set,tct=t7.getterFor(e7),ect=Xat(Array,"Array",function(e,l){$at(this,{type:e7,target:Jat(e),index:0,kind:l})},function(){var e=tct(this),l=e.target,d=e.kind,p=e.index++;return!l||p>=l.length?(e.target=void 0,{value:void 0,done:!0}):d=="keys"?{value:p,done:!1}:d=="values"?{value:l[p],done:!1}:{value:[p,l[p]],done:!1}},"values"),n7=$9.Arguments=$9.Array;if(FM("keys"),FM("values"),FM("entries"),Zat&&n7.name!=="values")try{zat(n7,"name",{value:"values"})}catch{}var QM=uN("span").classList,r7=QM&&QM.constructor&&QM.constructor.prototype,nct=r7===Object.prototype?void 0:r7,i7=f,o7={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},rct=nct,uO=ect,GM=X_,s7=w1,VM=s7("iterator"),a7=s7("toStringTag"),qM=uO.values,c7=function(e,l){if(e){if(e[VM]!==qM)try{GM(e,VM,qM)}catch{e[VM]=qM}if(e[a7]||GM(e,a7,l),o7[l]){for(var d in uO)if(e[d]!==uO[d])try{GM(e,d,uO[d])}catch{e[d]=uO[d]}}}};for(var HM in o7)c7(i7[HM]&&i7[HM].prototype,HM);c7(rct,"DOMTokenList");var ict=qI,oct=h1,u7=BR,KN=function(e,l,d){var p,A;return u7&&ict(p=l.constructor)&&p!==d&&oct(A=p.prototype)&&A!==d.prototype&&u7(e,A),e},sct=BT,YN=function(e,l){return e===void 0?arguments.length<2?"":l:sct(e)},act=h1,cct=X_,uct=G0("".replace),lct=String(Error("zxcasd").stack),l7=/\n\s*at [^:]*:[^\n]*/,dct=l7.test(lct),KM=function(e,l){if(dct&&typeof e=="string")for(;l--;)e=uct(e,l7,"");return e},hct=_v,pct=!w(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",hct(1,7)),e.stack!==7)}),d7=r_,fct=W1,YM=X_,Act=I_,h7=BR,p7=k3,gct=KN,Ect=YN,mct=function(e,l){act(l)&&"cause"in l&&cct(e,"cause",l.cause)},vct=KM,Ict=pct,f7=P_,yS=mN,A7=function(e,l,d,p){var A=p?2:1,y=e.split("."),g=y[y.length-1],b=d7.apply(null,y);if(b){var I=b.prototype;if(fct(I,"cause")&&delete I.cause,!d)return b;var k=d7("Error"),B=l(function(q,$){var _t=Ect(p?$:q,void 0),_r=p?new b(q):new b;return _t!==void 0&&YM(_r,"message",_t),Ict&&YM(_r,"stack",vct(_r.stack,2)),this&&Act(I,this)&&gct(_r,this,B),arguments.length>A&&mct(_r,arguments[A]),_r});B.prototype=I,g!=="Error"&&(h7?h7(B,k):p7(B,k,{name:!0})),p7(B,b);try{I.name!==g&&YM(I,"name",g),I.constructor=B}catch{}return B}},_ct="WebAssembly",g7=f.WebAssembly,WN=Error("e",{cause:7}).cause!==7,HR=function(e,l){var d={};d[e]=A7(e,l,WN),f7({global:!0,forced:WN},d)},WM=function(e,l){if(g7&&g7[e]){var d={};d[e]=A7("WebAssembly."+e,l,WN),f7({target:_ct,stat:!0,forced:WN},d)}};HR("Error",function(e){return function(l){return yS(e,this,arguments)}}),HR("EvalError",function(e){return function(l){return yS(e,this,arguments)}}),HR("RangeError",function(e){return function(l){return yS(e,this,arguments)}}),HR("ReferenceError",function(e){return function(l){return yS(e,this,arguments)}}),HR("SyntaxError",function(e){return function(l){return yS(e,this,arguments)}}),HR("TypeError",function(e){return function(l){return yS(e,this,arguments)}}),HR("URIError",function(e){return function(l){return yS(e,this,arguments)}}),WM("CompileError",function(e){return function(l){return yS(e,this,arguments)}}),WM("LinkError",function(e){return function(l){return yS(e,this,arguments)}}),WM("RuntimeError",function(e){return function(l){return yS(e,this,arguments)}});let E7=!0,m7=!0;function lO(e,l,d){const p=e.match(l);return p&&p.length>=d&&parseInt(p[d],10)}function jT(e,l,d){if(!e.RTCPeerConnection)return;const p=e.RTCPeerConnection.prototype,A=p.addEventListener;p.addEventListener=function(g,b){if(g!==l)return A.apply(this,arguments);const I=k=>{const B=d(k);B&&(b.handleEvent?b.handleEvent(B):b(B))};return this._eventMap=this._eventMap||{},this._eventMap[l]||(this._eventMap[l]=new Map),this._eventMap[l].set(b,I),A.apply(this,[g,I])};const y=p.removeEventListener;p.removeEventListener=function(g,b){if(g!==l||!this._eventMap||!this._eventMap[l])return y.apply(this,arguments);if(!this._eventMap[l].has(b))return y.apply(this,arguments);const I=this._eventMap[l].get(b);return this._eventMap[l].delete(b),this._eventMap[l].size===0&&delete this._eventMap[l],Object.keys(this._eventMap).length===0&&delete this._eventMap,y.apply(this,[g,I])},Object.defineProperty(p,"on"+l,{get(){return this["_on"+l]},set(g){this["_on"+l]&&(this.removeEventListener(l,this["_on"+l]),delete this["_on"+l]),g&&this.addEventListener(l,this["_on"+l]=g)},enumerable:!0,configurable:!0})}function yct(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(E7=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function bct(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(m7=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function JM(){if(typeof window=="object"){if(E7)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function JN(e,l){m7&&console.warn(e+" is deprecated, please use "+l+" instead.")}function Cct(e){const l={browser:null,version:null};if(e===void 0||!e.navigator)return l.browser="Not a browser.",l;const{navigator:d}=e;if(d.mozGetUserMedia)l.browser="firefox",l.version=lO(d.userAgent,/Firefox\/(\d+)\./,1);else if(d.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)l.browser="chrome",l.version=lO(d.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(d.mediaDevices&&d.userAgent.match(/Edge\/(\d+).(\d+)$/))l.browser="edge",l.version=lO(d.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!d.userAgent.match(/AppleWebKit\/(\d+)\./))return l.browser="Not a supported browser.",l;l.browser="safari",l.version=lO(d.userAgent,/AppleWebKit\/(\d+)\./,1),l.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return l}function v7(e){return Object.prototype.toString.call(e)==="[object Object]"}function I7(e){var l;return v7(e)?VR(l=Object.keys(e)).call(l,function(d,p){const A=v7(e[p]),y=A?I7(e[p]):e[p],g=A&&!Object.keys(y).length;return y===void 0||g?d:Object.assign(d,{[p]:y})},{}):e}function _7(e,l,d){const p=d?"outbound-rtp":"inbound-rtp",A=new Map;if(l===null)return A;const y=[];return e.forEach(g=>{g.type==="track"&&g.trackIdentifier===l.id&&y.push(g)}),y.forEach(g=>{e.forEach(b=>{b.type===p&&b.trackId===g.id&&function I(k,B,q){B&&!q.has(B.id)&&(q.set(B.id,B),Object.keys(B).forEach($=>{$.endsWith("Id")?I(k,k.get(B[$]),q):$.endsWith("Ids")&&B[$].forEach(_t=>{I(k,k.get(_t),q)})}))}(e,b,A)})}),A}var Sct=PN.exports,Rct=EM,y7=Sct("keys"),zN=function(e){return y7[e]||(y7[e]=Rct(e))},Tct=!m1(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),wct=II,Oct=z1,Nct=B1,kct=_S,Dct=Tct,b7=zN("IE_PROTO"),zM=wct.Object,Lct=zM.prototype,XM=Dct?zM.getPrototypeOf:function(e){var l=kct(e);if(Oct(l,b7))return l[b7];var d=l.constructor;return Nct(d)&&l instanceof d?d.prototype:l instanceof zM?Lct:null},C7=II,Pct=B1,xct=C7.String,Bct=C7.TypeError,Mct=t1,Uct=U_,jct=function(e){if(typeof e=="object"||Pct(e))return e;throw Bct("Can't set "+xct(e)+" as a prototype")},Fct=Object.setPrototypeOf||("__proto__"in{}?function(){var e,l=!1,d={};try{(e=Mct(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(d,[]),l=d instanceof Array}catch{}return function(p,A){return Uct(p),jct(A),l?e(p,A):p.__proto__=A,p}}():void 0),XN={},Qct=_M,Gct=Math.max,Vct=Math.min,ZM=function(e,l){var d=Qct(e);return d<0?Gct(d+l,0):Vct(d,l)},qct=uR,Hct=ZM,Kct=MS,S7=function(e){return function(l,d,p){var A,y=qct(l),g=Kct(y),b=Hct(p,g);if(e&&d!=d){for(;g>b;)if((A=y[b++])!=A)return!0}else for(;g>b;b++)if((e||b in y)&&y[b]===d)return e||b||0;return!e&&-1}},Yct={includes:S7(!0),indexOf:S7(!1)},ZN={},$M=z1,Wct=uR,Jct=Yct.indexOf,zct=ZN,R7=t1([].push),T7=function(e,l){var d,p=Wct(e),A=0,y=[];for(d in p)!$M(zct,d)&&$M(p,d)&&R7(y,d);for(;l.length>A;)$M(p,d=l[A++])&&(~Jct(y,d)||R7(y,d));return y},tU=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xct=T7,Zct=tU.concat("length","prototype");XN.f=Object.getOwnPropertyNames||function(e){return Xct(e,Zct)};var $N={};$N.f=Object.getOwnPropertySymbols;var $ct=cS,tut=XN,eut=$N,nut=U_,rut=t1([].concat),iut=$ct("Reflect","ownKeys")||function(e){var l=tut.f(nut(e)),d=eut.f;return d?rut(l,d(e)):l},w7=z1,out=iut,sut=rO,aut=uS,_k={},cut=T7,uut=tU,_D=Object.keys||function(e){return cut(e,uut)},lut=$_,dut=T9,hut=uS,put=U_,fut=uR,Aut=_D;_k.f=lut&&!dut?Object.defineProperties:function(e,l){put(e);for(var d,p=fut(l),A=Aut(l),y=A.length,g=0;y>g;)hut.f(e,d=A[g++],p[d]);return e};var tL,O7=cS("document","documentElement"),gut=U_,Eut=_k,N7=tU,mut=ZN,vut=O7,Iut=vM,k7=zN("IE_PROTO"),eU=function(){},D7=function(e){return"<script>"+e+"<\/script>"},L7=function(e){e.write(D7("")),e.close();var l=e.parentWindow.Object;return e=null,l},eL=function(){try{tL=new ActiveXObject("htmlfile")}catch{}var e,l;eL=typeof document!="undefined"?document.domain&&tL?L7(tL):((l=Iut("iframe")).style.display="none",vut.appendChild(l),l.src=String("javascript:"),(e=l.contentWindow.document).open(),e.write(D7("document.F=Object")),e.close(),e.F):L7(tL);for(var d=N7.length;d--;)delete eL.prototype[N7[d]];return eL()};mut[k7]=!0;var dO=Object.create||function(e,l){var d;return e!==null?(eU.prototype=gut(e),d=new eU,eU.prototype=null,d[k7]=e):d=eL(),l===void 0?d:Eut.f(d,l)},_ut=t1("".replace),yut=String(Error("zxcasd").stack),P7=/\n\s*at [^:]*:[^\n]*/,but=P7.test(yut),Cut=M_,Sut=GR,FT={},Rut=FT,Tut=v1("iterator"),wut=Array.prototype,x7=function(e){return e!==void 0&&(Rut.Array===e||wut[Tut]===e)},B7={};B7[v1("toStringTag")]="z";var nU=String(B7)==="[object z]",Out=II,Nut=nU,kut=B1,nL=iO,Dut=v1("toStringTag"),Lut=Out.Object,Put=nL(function(){return arguments}())=="Arguments",US=Nut?nL:function(e){var l,d,p;return e===void 0?"Undefined":e===null?"Null":typeof(d=function(A,y){try{return A[y]}catch{}}(l=Lut(e),Dut))=="string"?d:Put?nL(l):(p=nL(l))=="Object"&&kut(l.callee)?"Arguments":p},xut=US,M7=hM,But=FT,Mut=v1("iterator"),rL=function(e){if(e!=null)return M7(e,Mut)||M7(e,"@@iterator")||But[xut(e)]},Uut=__,jut=BS,Fut=U_,Qut=LN,Gut=rL,Vut=II.TypeError,rU=function(e,l){var d=arguments.length<2?Gut(e):l;if(jut(d))return Fut(Uut(d,e));throw Vut(Qut(e)+" is not iterable")},qut=__,U7=U_,Hut=hM,j7=function(e,l,d){var p,A;U7(e);try{if(!(p=Hut(e,"return"))){if(l==="throw")throw d;return d}p=qut(p,e)}catch(y){A=!0,p=y}if(l==="throw")throw d;if(A)throw p;return U7(p),d},Kut=lR,Yut=__,Wut=U_,Jut=LN,zut=x7,Xut=MS,F7=B_,Zut=rU,$ut=rL,Q7=j7,tlt=II.TypeError,iL=function(e,l){this.stopped=e,this.result=l},G7=iL.prototype,oL=function(e,l,d){var p,A,y,g,b,I,k,B=d&&d.that,q=!(!d||!d.AS_ENTRIES),$=!(!d||!d.IS_ITERATOR),_t=!(!d||!d.INTERRUPTED),_r=Kut(l,B),_i=function(_u){return p&&Q7(p,"normal",_u),new iL(!0,_u)},ga=function(_u){return q?(Wut(_u),_t?_r(_u[0],_u[1],_i):_r(_u[0],_u[1])):_t?_r(_u,_i):_r(_u)};if($)p=e;else{if(!(A=$ut(e)))throw tlt(Jut(e)+" is not iterable");if(zut(A)){for(y=0,g=Xut(e);g>y;y++)if((b=ga(e[y]))&&F7(G7,b))return b;return new iL(!1)}p=Zut(e,A)}for(I=p.next;!(k=Yut(I,p)).done;){try{b=ga(k.value)}catch(_u){Q7(p,"throw",_u)}if(typeof b=="object"&&b&&F7(G7,b))return b}return new iL(!1)},elt=US,nlt=II.String,hR=function(e){if(elt(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return nlt(e)},rlt=hR,ilt=cR,olt=!m1(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",ilt(1,7)),e.stack!==7)}),slt=M1,alt=II,clt=B_,ult=XM,sL=Fct,llt=function(e,l,d){for(var p=out(l),A=aut.f,y=sut.f,g=0;g<p.length;g++){var b=p[g];w7(e,b)||d&&w7(d,b)||A(e,b,y(l,b))}},V7=dO,aL=GR,iU=cR,dlt=function(e,l){if(but&&typeof e=="string")for(;l--;)e=_ut(e,P7,"");return e},hlt=function(e,l){Cut(l)&&"cause"in l&&Sut(e,"cause",l.cause)},plt=oL,flt=function(e,l){return e===void 0?arguments.length<2?"":l:rlt(e)},Alt=olt,glt=v1("toStringTag"),cL=alt.Error,Elt=[].push,hO=function(e,l){var d,p=arguments.length>2?arguments[2]:void 0,A=clt(oU,this);sL?d=sL(new cL,A?ult(this):oU):(d=A?this:V7(oU),aL(d,glt,"Error")),l!==void 0&&aL(d,"message",flt(l)),Alt&&aL(d,"stack",dlt(d.stack,1)),hlt(d,p);var y=[];return plt(e,Elt,{that:y}),aL(d,"errors",y),d};sL?sL(hO,cL):llt(hO,cL,{name:!0});var oU=hO.prototype=V7(cL.prototype,{constructor:iU(1,hO),message:iU(1,""),name:iU(1,"AggregateError")});slt({global:!0},{AggregateError:hO});var mlt=B1,sU=gM,vlt=t1(Function.toString);mlt(sU.inspectSource)||(sU.inspectSource=function(e){return vlt(e)});var uL,pO,lL,aU=sU.inspectSource,Ilt=B1,_lt=aU,q7=II.WeakMap,ylt=Ilt(q7)&&/native code/.test(_lt(q7)),H7=II,cU=t1,blt=M_,Clt=GR,uU=z1,lU=gM,Slt=zN,Rlt=ZN,K7="Object already initialized",dU=H7.TypeError,Tlt=H7.WeakMap;if(ylt||lU.state){var KR=lU.state||(lU.state=new Tlt),wlt=cU(KR.get),Y7=cU(KR.has),Olt=cU(KR.set);uL=function(e,l){if(Y7(KR,e))throw new dU(K7);return l.facade=e,Olt(KR,e,l),l},pO=function(e){return wlt(KR,e)||{}},lL=function(e){return Y7(KR,e)}}else{var QT=Slt("state");Rlt[QT]=!0,uL=function(e,l){if(uU(e,QT))throw new dU(K7);return l.facade=e,Clt(e,QT,l),l},pO=function(e){return uU(e,QT)?e[QT]:{}},lL=function(e){return uU(e,QT)}}var YR,W7,J7,GT={set:uL,get:pO,has:lL,enforce:function(e){return lL(e)?pO(e):uL(e,{})},getterFor:function(e){return function(l){var d;if(!blt(l)||(d=pO(l)).type!==e)throw dU("Incompatible receiver, "+e+" required");return d}}},hU=$_,Nlt=z1,z7=Function.prototype,klt=hU&&Object.getOwnPropertyDescriptor,pU=Nlt(z7,"name"),X7={EXISTS:pU,PROPER:pU&&function(){}.name==="something",CONFIGURABLE:pU&&(!hU||hU&&klt(z7,"name").configurable)},Dlt=GR,VT=function(e,l,d,p){p&&p.enumerable?e[l]=d:Dlt(e,l,d)},Llt=m1,Plt=B1,xlt=dO,Z7=XM,Blt=VT,fU=v1("iterator"),$7=!1;[].keys&&("next"in(J7=[].keys())?(W7=Z7(Z7(J7)))!==Object.prototype&&(YR=W7):$7=!0);var Mlt=YR==null||Llt(function(){var e={};return YR[fU].call(e)!==e});Plt((YR=Mlt?{}:xlt(YR))[fU])||Blt(YR,fU,function(){return this});var tG={IteratorPrototype:YR,BUGGY_SAFARI_ITERATORS:$7},Ult=US,jlt=nU?{}.toString:function(){return"[object "+Ult(this)+"]"},Flt=nU,Qlt=uS.f,Glt=GR,Vlt=z1,qlt=jlt,eG=v1("toStringTag"),WR=function(e,l,d,p){if(e){var A=d?e:e.prototype;Vlt(A,eG)||Qlt(A,eG,{configurable:!0,value:l}),p&&!Flt&&Glt(A,"toString",qlt)}},Hlt=tG.IteratorPrototype,Klt=dO,Ylt=cR,Wlt=WR,Jlt=FT,zlt=function(){return this},nG=function(e,l,d,p){var A=l+" Iterator";return e.prototype=Klt(Hlt,{next:Ylt(+!p,d)}),Wlt(e,A,!1,!0),Jlt[A]=zlt,e},Xlt=M1,Zlt=__,$lt=nG,tdt=XM,edt=WR,rG=VT,iG=FT,ndt=X7.PROPER,dL=tG.BUGGY_SAFARI_ITERATORS,AU=v1("iterator"),oG="keys",hL="values",sG="entries",rdt=function(){return this},cG=function(e,l,d,p,A,y,g){$lt(d,l,p);var b,I,k,B=function(_u){if(_u===A&&_i)return _i;if(!dL&&_u in _t)return _t[_u];switch(_u){case oG:case hL:case sG:return function(){return new d(this,_u)}}return function(){return new d(this)}},q=l+" Iterator",$=!1,_t=e.prototype,_r=_t[AU]||_t["@@iterator"]||A&&_t[A],_i=!dL&&_r||B(A),ga=l=="Array"&&_t.entries||_r;if(ga&&(b=tdt(ga.call(new e)))!==Object.prototype&&b.next&&(edt(b,q,!0,!0),iG[q]=rdt),ndt&&A==hL&&_r&&_r.name!==hL&&($=!0,_i=function(){return Zlt(_r,this)}),A)if(I={values:B(hL),keys:y?_i:B(oG),entries:B(sG)},g)for(k in I)(dL||$||!(k in _t))&&rG(_t,k,I[k]);else Xlt({target:l,proto:!0,forced:dL||$},I);return g&&_t[AU]!==_i&&rG(_t,AU,_i,{name:A}),iG[l]=_i,I},idt=uR,uG=FT,lG=GT;uS.f;var odt=cG,dG="Array Iterator",sdt=lG.set,adt=lG.getterFor(dG);odt(Array,"Array",function(e,l){sdt(this,{type:dG,target:idt(e),index:0,kind:l})},function(){var e=adt(this),l=e.target,d=e.kind,p=e.index++;return!l||p>=l.length?(e.target=void 0,{value:void 0,done:!0}):d=="keys"?{value:p,done:!1}:d=="values"?{value:l[p],done:!1}:{value:[p,l[p]],done:!1}},"values"),uG.Arguments=uG.Array;var hG=II.Promise,cdt=VT,pG=function(e,l,d){for(var p in l)d&&d.unsafe&&e[p]?e[p]=l[p]:cdt(e,p,l[p],d);return e},udt=cS,ldt=uS,ddt=$_,fG=v1("species"),hdt=B_,pdt=II.TypeError,gU=function(e,l){if(hdt(l,e))return e;throw pdt("Incorrect invocation")},AG=v1("iterator"),gG=!1;try{var fdt=0,EG={next:function(){return{done:!!fdt++}},return:function(){gG=!0}};EG[AG]=function(){return this},Array.from(EG,function(){throw 2})}catch{}var Adt=t1,gdt=m1,mG=B1,Edt=US,mdt=aU,vG=function(){},vdt=[],IG=cS("Reflect","construct"),EU=/^\s*(?:class|function)\b/,Idt=Adt(EU.exec),_dt=!EU.exec(vG),fO=function(e){if(!mG(e))return!1;try{return IG(vG,vdt,e),!0}catch{return!1}},_G=function(e){if(!mG(e))return!1;switch(Edt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _dt||!!Idt(EU,mdt(e))}catch{return!0}};_G.sham=!0;var AO,qT,yG,mU,pL=!IG||gdt(function(){var e;return fO(fO.call)||!fO(Object)||!fO(function(){e=!0})||e})?_G:fO,ydt=pL,bdt=LN,Cdt=II.TypeError,CG=U_,Sdt=function(e){if(ydt(e))return e;throw Cdt(bdt(e)+" is not a constructor")},Rdt=v1("species"),SG=function(e,l){var d,p=CG(e).constructor;return p===void 0||(d=CG(p)[Rdt])==null?l:Sdt(d)},vU=t1([].slice),RG=/(?:ipad|iphone|ipod).*applewebkit/i.test(FR),j_=II,Tdt=oM,wdt=lR,TG=B1,Odt=z1,Ndt=m1,wG=O7,kdt=vU,OG=vM,Ddt=RG,Ldt=UN,IU=j_.setImmediate,_U=j_.clearImmediate,Pdt=j_.process,yU=j_.Dispatch,xdt=j_.Function,NG=j_.MessageChannel,Bdt=j_.String,bU=0,gO={},Mdt="onreadystatechange";try{AO=j_.location}catch{}var CU=function(e){if(Odt(gO,e)){var l=gO[e];delete gO[e],l()}},SU=function(e){return function(){CU(e)}},kG=function(e){CU(e.data)},DG=function(e){j_.postMessage(Bdt(e),AO.protocol+"//"+AO.host)};IU&&_U||(IU=function(e){var l=kdt(arguments,1);return gO[++bU]=function(){Tdt(TG(e)?e:xdt(e),void 0,l)},qT(bU),bU},_U=function(e){delete gO[e]},Ldt?qT=function(e){Pdt.nextTick(SU(e))}:yU&&yU.now?qT=function(e){yU.now(SU(e))}:NG&&!Ddt?(mU=(yG=new NG).port2,yG.port1.onmessage=kG,qT=wdt(mU.postMessage,mU)):j_.addEventListener&&TG(j_.postMessage)&&!j_.importScripts&&AO&&AO.protocol!=="file:"&&!Ndt(DG)?(qT=DG,j_.addEventListener("message",kG,!1)):qT=Mdt in OG("script")?function(e){wG.appendChild(OG("script")).onreadystatechange=function(){wG.removeChild(this),CU(e)}}:function(e){setTimeout(SU(e),0)});var EO,JR,mO,HT,RU,TU,wU,LG,PG={set:IU,clear:_U},Udt=II,jdt=/ipad|iphone|ipod/i.test(FR)&&Udt.Pebble!==void 0,Fdt=/web0s(?!.*chrome)/i.test(FR),zR=II,xG=lR,Qdt=rO.f,OU=PG.set,Gdt=RG,Vdt=jdt,qdt=Fdt,NU=UN,BG=zR.MutationObserver||zR.WebKitMutationObserver,MG=zR.document,UG=zR.process,fL=zR.Promise,jG=Qdt(zR,"queueMicrotask"),FG=jG&&jG.value;FG||(EO=function(){var e,l;for(NU&&(e=UG.domain)&&e.exit();JR;){l=JR.fn,JR=JR.next;try{l()}catch(d){throw JR?HT():mO=void 0,d}}mO=void 0,e&&e.enter()},Gdt||NU||qdt||!BG||!MG?!Vdt&&fL&&fL.resolve?((wU=fL.resolve(void 0)).constructor=fL,LG=xG(wU.then,wU),HT=function(){LG(EO)}):NU?HT=function(){UG.nextTick(EO)}:(OU=xG(OU,zR),HT=function(){OU(EO)}):(RU=!0,TU=MG.createTextNode(""),new BG(EO).observe(TU,{characterData:!0}),HT=function(){TU.data=RU=!RU}));var Hdt=FG||function(e){var l={fn:e,next:void 0};mO&&(mO.next=l),JR||(JR=l,HT()),mO=l},KT={},QG=BS,Kdt=function(e){var l,d;this.promise=new e(function(p,A){if(l!==void 0||d!==void 0)throw TypeError("Bad Promise constructor");l=p,d=A}),this.resolve=QG(l),this.reject=QG(d)};KT.f=function(e){return new Kdt(e)};var Ydt=U_,Wdt=M_,Jdt=KT,GG=function(e,l){if(Ydt(e),Wdt(l)&&l.constructor===e)return l;var d=Jdt.f(e);return(0,d.resolve)(l),d.promise},zdt=II,AL=function(e){try{return{error:!1,value:e()}}catch(l){return{error:!0,value:l}}},VG=function(){this.head=null,this.tail=null};VG.prototype={add:function(e){var l={item:e,next:null};this.head?this.tail.next=l:this.head=l,this.tail=l},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var kU,qG,DU,Xdt=typeof window=="object",gL=M1,jS=II,Zdt=cS,pR=__,LU=hG,$dt=pG,tht=WR,eht=function(e){var l=udt(e),d=ldt.f;ddt&&l&&!l[fG]&&d(l,fG,{configurable:!0,get:function(){return this}})},PU=BS,EL=B1,nht=M_,rht=gU,iht=aU,HG=oL,oht=function(e,l){if(!l&&!gG)return!1;var d=!1;try{var p={};p[AG]=function(){return{next:function(){return{done:d=!0}}}},e(p)}catch{}return d},sht=SG,KG=PG.set,xU=Hdt,aht=GG,cht=function(e,l){var d=zdt.console;d&&d.error&&(arguments.length==1?d.error(e):d.error(e,l))},YG=KT,BU=AL,uht=VG,MU=GT,lht=R9,dht=Xdt,mL=UN,WG=LT,hht=v1("species"),bS="Promise",JG=MU.getterFor(bS),pht=MU.set,fht=MU.getterFor(bS),Aht=LU&&LU.prototype,CS=LU,vL=Aht,zG=jS.TypeError,UU=jS.document,jU=jS.process,YT=YG.f,ght=YT,Eht=!!(UU&&UU.createEvent&&jS.dispatchEvent),XG=EL(jS.PromiseRejectionEvent),ZG="unhandledrejection",IL=lht(bS,function(){var e=iht(CS),l=e!==String(CS);if(!l&&WG===66||!vL.finally)return!0;if(WG>=51&&/native code/.test(e))return!1;var d=new CS(function(A){A(1)}),p=function(A){A(function(){},function(){})};return(d.constructor={})[hht]=p,!(d.then(function(){})instanceof p)||!l&&dht&&!XG}),mht=IL||!oht(function(e){CS.all(e).catch(function(){})}),$G=function(e){var l;return!(!nht(e)||!EL(l=e.then))&&l},tV=function(e,l){var d,p,A,y=l.value,g=l.state==1,b=g?e.ok:e.fail,I=e.resolve,k=e.reject,B=e.domain;try{b?(g||(l.rejection===2&&Iht(l),l.rejection=1),b===!0?d=y:(B&&B.enter(),d=b(y),B&&(B.exit(),A=!0)),d===e.promise?k(zG("Promise-chain cycle")):(p=$G(d))?pR(p,d,I,k):I(d)):k(y)}catch(q){B&&!A&&B.exit(),k(q)}},eV=function(e,l){e.notified||(e.notified=!0,xU(function(){for(var d,p=e.reactions;d=p.get();)tV(d,e);e.notified=!1,l&&!e.rejection&&vht(e)}))},nV=function(e,l,d){var p,A;Eht?((p=UU.createEvent("Event")).promise=l,p.reason=d,p.initEvent(e,!1,!0),jS.dispatchEvent(p)):p={promise:l,reason:d},!XG&&(A=jS["on"+e])?A(p):e===ZG&&cht("Unhandled promise rejection",d)},vht=function(e){pR(KG,jS,function(){var l,d=e.facade,p=e.value;if(rV(e)&&(l=BU(function(){mL?jU.emit("unhandledRejection",p,d):nV(ZG,d,p)}),e.rejection=mL||rV(e)?2:1,l.error))throw l.value})},rV=function(e){return e.rejection!==1&&!e.parent},Iht=function(e){pR(KG,jS,function(){var l=e.facade;mL?jU.emit("rejectionHandled",l):nV("rejectionhandled",l,e.value)})},WT=function(e,l,d){return function(p){e(l,p,d)}},JT=function(e,l,d){e.done||(e.done=!0,d&&(e=d),e.value=l,e.state=2,eV(e,!0))},FU=function(e,l,d){if(!e.done){e.done=!0,d&&(e=d);try{if(e.facade===l)throw zG("Promise can't be resolved itself");var p=$G(l);p?xU(function(){var A={done:!1};try{pR(p,l,WT(FU,A,e),WT(JT,A,e))}catch(y){JT(A,y,e)}}):(e.value=l,e.state=1,eV(e,!1))}catch(A){JT({done:!1},A,e)}}};IL&&(vL=(CS=function(e){rht(this,vL),PU(e),pR(kU,this);var l=JG(this);try{e(WT(FU,l),WT(JT,l))}catch(d){JT(l,d)}}).prototype,(kU=function(e){pht(this,{type:bS,done:!1,notified:!1,parent:!1,reactions:new uht,rejection:!1,state:0,value:void 0})}).prototype=$dt(vL,{then:function(e,l){var d=fht(this),p=YT(sht(this,CS));return d.parent=!0,p.ok=!EL(e)||e,p.fail=EL(l)&&l,p.domain=mL?jU.domain:void 0,d.state==0?d.reactions.add(p):xU(function(){tV(p,d)}),p.promise},catch:function(e){return this.then(void 0,e)}}),qG=function(){var e=new kU,l=JG(e);this.promise=e,this.resolve=WT(FU,l),this.reject=WT(JT,l)},YG.f=YT=function(e){return e===CS||e===DU?new qG(e):ght(e)}),gL({global:!0,wrap:!0,forced:IL},{Promise:CS}),tht(CS,bS,!1,!0),eht(bS),DU=Zdt(bS),gL({target:bS,stat:!0,forced:IL},{reject:function(e){var l=YT(this);return pR(l.reject,void 0,e),l.promise}}),gL({target:bS,stat:!0,forced:!0},{resolve:function(e){return aht(this===DU?CS:this,e)}}),gL({target:bS,stat:!0,forced:mht},{all:function(e){var l=this,d=YT(l),p=d.resolve,A=d.reject,y=BU(function(){var g=PU(l.resolve),b=[],I=0,k=1;HG(e,function(B){var q=I++,$=!1;k++,pR(g,l,B).then(function(_t){$||($=!0,b[q]=_t,--k||p(b))},A)}),--k||p(b)});return y.error&&A(y.value),d.promise},race:function(e){var l=this,d=YT(l),p=d.reject,A=BU(function(){var y=PU(l.resolve);HG(e,function(g){pR(y,l,g).then(d.resolve,p)})});return A.error&&p(A.value),d.promise}});var _ht=__,yht=BS,bht=KT,Cht=AL,Sht=oL;M1({target:"Promise",stat:!0},{allSettled:function(e){var l=this,d=bht.f(l),p=d.resolve,A=d.reject,y=Cht(function(){var g=yht(l.resolve),b=[],I=0,k=1;Sht(e,function(B){var q=I++,$=!1;k++,_ht(g,l,B).then(function(_t){$||($=!0,b[q]={status:"fulfilled",value:_t},--k||p(b))},function(_t){$||($=!0,b[q]={status:"rejected",reason:_t},--k||p(b))})}),--k||p(b)});return y.error&&A(y.value),d.promise}});var Rht=BS,Tht=cS,wht=__,Oht=KT,Nht=AL,kht=oL,iV="No one promise resolved";M1({target:"Promise",stat:!0},{any:function(e){var l=this,d=Tht("AggregateError"),p=Oht.f(l),A=p.resolve,y=p.reject,g=Nht(function(){var b=Rht(l.resolve),I=[],k=0,B=1,q=!1;kht(e,function($){var _t=k++,_r=!1;B++,wht(b,l,$).then(function(_i){_r||q||(q=!0,A(_i))},function(_i){_r||q||(_r=!0,I[_t]=_i,--B||y(new d(I,iV)))})}),--B||y(new d(I,iV))});return g.error&&y(g.value),p.promise}});var oV=hG,Dht=cS,Lht=B1,Pht=SG,sV=GG;M1({target:"Promise",proto:!0,real:!0,forced:!!oV&&m1(function(){oV.prototype.finally.call({then:function(){}},function(){})})},{finally:function(e){var l=Pht(this,Dht("Promise")),d=Lht(e);return this.then(d?function(p){return sV(l,e()).then(function(){return p})}:e,d?function(p){return sV(l,e()).then(function(){throw p})}:e)}});var QU=t1,xht=_M,Bht=hR,Mht=DN,Uht=QU("".charAt),aV=QU("".charCodeAt),jht=QU("".slice),cV=function(e){return function(l,d){var p,A,y=Bht(Mht(l)),g=xht(d),b=y.length;return g<0||g>=b?e?"":void 0:(p=aV(y,g))<55296||p>56319||g+1===b||(A=aV(y,g+1))<56320||A>57343?e?Uht(y,g):p:e?jht(y,g,g+2):A-56320+(p-55296<<10)+65536}},uV={codeAt:cV(!1),charAt:cV(!0)},Fht=uV.charAt,Qht=hR,lV=GT,Ght=cG,dV="String Iterator",Vht=lV.set,qht=lV.getterFor(dV);Ght(String,"String",function(e){Vht(this,{type:dV,string:Qht(e),index:0})},function(){var e,l=qht(this),d=l.string,p=l.index;return p>=d.length?{value:void 0,done:!0}:(e=Fht(d,p),l.index+=e.length,{value:e,done:!1})});var Hht=xS.Promise,Kht={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Yht=II,Wht=US,Jht=GR,hV=FT,pV=v1("toStringTag");for(var GU in Kht){var fV=Yht[GU],VU=fV&&fV.prototype;VU&&Wht(VU)!==pV&&Jht(VU,pV,GU),hV[GU]=hV.Array}var AV=Hht,Y0=AV,zht=vN,Xht=j,Zht=w,$ht=i_,tpt=MT,gV=YN,_L=Error.prototype.toString,ept=Zht(function(){if(Xht){var e=tpt(Object.defineProperty({},"name",{get:function(){return this===e}}));if(_L.call(e)!=="true")return!0}return _L.call({message:1,name:2})!=="2: 1"||_L.call({})!=="Error"})?function(){var e=$ht(this),l=gV(e.name,"Error"),d=gV(e.message);return l?d?l+": "+d:l:d}:_L,EV={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},npt=P_,rpt=function(e){try{if(zht)return Function('return require("'+e+'")')()}catch{}},yL=r_,qU=w,ipt=MT,HU=_v,vO=J1.f,opt=TM.f,spt=aS.exports,bL=W1,apt=q2,cpt=i_,mV=ept,vV=YN,zT=EV,upt=KM,IV=Z_,KU=j,XT="DOMException",lpt="DATA_CLONE_ERR",CL=yL("Error"),FS=yL(XT)||function(){try{new(yL("MessageChannel")||rpt("worker_threads").MessageChannel)().port1.postMessage(new WeakMap)}catch(e){if(e.name==lpt&&e.code==25)return e.constructor}}(),dpt=FS&&FS.prototype,_V=CL.prototype,hpt=IV.set,ppt=IV.getterFor(XT),fpt="stack"in CL(XT),yV=function(e){return bL(zT,e)&&zT[e].m?zT[e].c:0},YU=function(){apt(this,WU);var e=arguments.length,l=vV(e<1?void 0:arguments[0]),d=vV(e<2?void 0:arguments[1],"Error"),p=yV(d);if(hpt(this,{type:XT,name:d,message:l,code:p}),KU||(this.name=d,this.message=l,this.code=p),fpt){var A=CL(l);A.name=XT,vO(this,"stack",HU(1,upt(A.stack,1)))}},WU=YU.prototype=ipt(_V),bV=function(e){return{enumerable:!0,configurable:!0,get:e}},JU=function(e){return bV(function(){return ppt(this)[e]})};KU&&opt(WU,{name:JU("name"),message:JU("message"),code:JU("code")}),vO(WU,"constructor",HU(1,YU));var IO=qU(function(){return!(new FS instanceof CL)}),Apt=IO||qU(function(){return _V.toString!==mV||String(new FS(1,2))!=="2: 1"}),gpt=IO||qU(function(){return new FS(1,"DataCloneError").code!==25});IO||FS.DATA_CLONE_ERR!==25||dpt.DATA_CLONE_ERR,npt({global:!0,forced:IO},{DOMException:IO?YU:FS});var _O=yL(XT),SL=_O.prototype;for(var CV in Apt&&FS===_O&&spt(SL,"toString",mV),gpt&&KU&&FS===_O&&vO(SL,"code",bV(function(){return yV(cpt(this).name)})),zT)if(bL(zT,CV)){var SV=zT[CV],RL=SV.s,RV=HU(6,SV.c);bL(_O,RL)||vO(_O,RL,RV),bL(SL,RL)||vO(SL,RL,RV)}var Ept=P_,zU=r_,XU=_v,ZU=J1.f,TV=W1,mpt=q2,vpt=KN,wV=YN,$U=EV,Ipt=KM,TL="DOMException",OV=zU("Error"),wL=zU(TL),t4=function(){mpt(this,_pt);var e=arguments.length,l=wV(e<1?void 0:arguments[0]),d=wV(e<2?void 0:arguments[1],"Error"),p=new wL(l,d),A=OV(l);return A.name=TL,ZU(p,"stack",XU(1,Ipt(A.stack,1))),vpt(p,this,t4),p},_pt=t4.prototype=wL.prototype,ypt="stack"in OV(TL),bpt="stack"in new wL(1,2),NV=ypt&&!bpt;Ept({global:!0,forced:NV},{DOMException:NV?t4:wL});var yO=zU(TL),kV=yO.prototype;if(kV.constructor!==yO){for(var DV in ZU(kV,"constructor",XU(1,yO)),$U)if(TV($U,DV)){var LV=$U[DV],PV=LV.s;TV(yO,PV)||ZU(yO,PV,XU(6,LV.c))}}var xV="DOMException";V2(r_(xV),xV);var BV=G0,MV=aS.exports,Cpt=VN,UV=w,jV=w1,Spt=X_,Rpt=jV("species"),e4=RegExp.prototype,n4=G0,Tpt=oR,wpt=BT,Opt=U0,Npt=n4("".charAt),FV=n4("".charCodeAt),kpt=n4("".slice),QV=function(e){return function(l,d){var p,A,y=wpt(Opt(l)),g=Tpt(d),b=y.length;return g<0||g>=b?e?"":void 0:(p=FV(y,g))<55296||p>56319||g+1===b||(A=FV(y,g+1))<56320||A>57343?e?Npt(y,g):p:e?kpt(y,g,g+2):A-56320+(p-55296<<10)+65536}},Dpt={codeAt:QV(!1),charAt:QV(!0)}.charAt,r4=G0,Lpt=LR,Ppt=Math.floor,i4=r4("".charAt),xpt=r4("".replace),o4=r4("".slice),Bpt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Mpt=/\$([$&'`]|\d{1,2})/g,GV=_o,Upt=i_,jpt=qI,Fpt=v0,Qpt=VN,Gpt=f.TypeError,Vpt=mN,VV=_o,OL=G0,qpt=function(e,l,d,p){var A=jV(e),y=!UV(function(){var k={};return k[A]=function(){return 7},""[e](k)!=7}),g=y&&!UV(function(){var k=!1,B=/a/;return e==="split"&&((B={}).constructor={},B.constructor[Rpt]=function(){return B},B.flags="",B[A]=/./[A]),B.exec=function(){return k=!0,null},B[A](""),!k});if(!y||!g||d){var b=BV(/./[A]),I=l(A,""[e],function(k,B,q,$,_t){var _r=BV(k),_i=B.exec;return _i===Cpt||_i===e4.exec?y&&!_t?{done:!0,value:b(B,q,$)}:{done:!0,value:_r(q,B,$)}:{done:!1}});MV(String.prototype,e,I[0]),MV(e4,A,I[1])}p&&Spt(e4[A],"sham",!0)},Hpt=w,Kpt=i_,Ypt=qI,Wpt=oR,Jpt=TT,ZT=BT,zpt=U0,Xpt=function(e,l,d){return l+(d?Dpt(e,l).length:1)},Zpt=sN,$pt=function(e,l,d,p,A,y){var g=d+e.length,b=p.length,I=Mpt;return A!==void 0&&(A=Lpt(A),I=Bpt),xpt(y,I,function(k,B){var q;switch(i4(B,0)){case"$":return"$";case"&":return e;case"`":return o4(l,0,d);case"'":return o4(l,g);case"<":q=A[o4(B,1,-1)];break;default:var $=+B;if($===0)return k;if($>b){var _t=Ppt($/10);return _t===0?k:_t<=b?p[_t-1]===void 0?i4(B,1):p[_t-1]+i4(B,1):k}q=p[$-1]}return q===void 0?"":q})},tft=function(e,l){var d=e.exec;if(jpt(d)){var p=GV(d,e,l);return p!==null&&Upt(p),p}if(Fpt(e)==="RegExp")return GV(Qpt,e,l);throw Gpt("RegExp#exec called on incompatible receiver")},s4=w1("replace"),eft=Math.max,nft=Math.min,rft=OL([].concat),a4=OL([].push),qV=OL("".indexOf),HV=OL("".slice),ift="a".replace(/./,"$0")==="$0",KV=!!/./[s4]&&/./[s4]("a","$0")==="";qpt("replace",function(e,l,d){var p=KV?"$":"$0";return[function(A,y){var g=zpt(this),b=A==null?void 0:Zpt(A,s4);return b?VV(b,A,g,y):VV(l,ZT(g),A,y)},function(A,y){var g=Kpt(this),b=ZT(A);if(typeof y=="string"&&qV(y,p)===-1&&qV(y,"$<")===-1){var I=d(l,g,b,y);if(I.done)return I.value}var k=Ypt(y);k||(y=ZT(y));var B=g.global;if(B){var q=g.unicode;g.lastIndex=0}for(var $=[];;){var _t=tft(g,b);if(_t===null||(a4($,_t),!B))break;ZT(_t[0])===""&&(g.lastIndex=Xpt(b,Jpt(g.lastIndex),q))}for(var _r,_i="",ga=0,_u=0;_u<$.length;_u++){for(var ah=ZT((_t=$[_u])[0]),_h=eft(nft(Wpt(_t.index),b.length),0),_A=[],n0=1;n0<_t.length;n0++)a4(_A,(_r=_t[n0])===void 0?_r:String(_r));var f0=_t.groups;if(k){var E0=rft([ah],_A,_h,b);f0!==void 0&&a4(E0,f0);var m0=ZT(Vpt(y,void 0,E0))}else m0=$pt(ah,b,_h,_A,f0,y);_h>=ga&&(_i+=HV(b,ga,_h)+m0,ga=_h+ah.length)}return _i+HV(b,ga)}]},!!Hpt(function(){var e=/./;return e.exec=function(){var l=[];return l.groups={a:"7"},l},"".replace(e,"$<a>")!=="7"})||!ift||KV);var oft=h1,sft=v0,aft=w1("match"),cft=j,c4=f,$T=G0,uft=D3,lft=KN,dft=X_,hft=J1.f,pft=Q2.f,YV=I_,fft=function(e){var l;return oft(e)&&((l=e[aft])!==void 0?!!l:sft(e)=="RegExp")},WV=BT,Aft=P9,JV=x9,gft=aS.exports,Eft=w,mft=W1,vft=Z_.enforce,Ift=AN,zV=OM,XV=F9,_ft=w1("match"),QS=c4.RegExp,_w=QS.prototype,yft=c4.SyntaxError,bft=$T(Aft),Cft=$T(_w.exec),NL=$T("".charAt),ZV=$T("".replace),$V=$T("".indexOf),Sft=$T("".slice),Rft=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,XR=/a/g,u4=/a/g,Tft=new QS(XR)!==XR,_q=JV.MISSED_STICKY,wft=JV.UNSUPPORTED_Y,Oft=cft&&(!Tft||_q||zV||XV||Eft(function(){return u4[_ft]=!1,QS(XR)!=XR||QS(u4)==u4||QS(XR,"i")!="/a/i"}));if(uft("RegExp",Oft)){for(var fR=function(e,l){var d,p,A,y,g,b,I=YV(_w,this),k=fft(e),B=l===void 0,q=[],$=e;if(!I&&k&&B&&e.constructor===fR)return e;if((k||YV(_w,e))&&(e=e.source,B&&(l="flags"in $?$.flags:bft($))),e=e===void 0?"":WV(e),l=l===void 0?"":WV(l),$=e,zV&&"dotAll"in XR&&(p=!!l&&$V(l,"s")>-1)&&(l=ZV(l,/s/g,"")),d=l,_q&&"sticky"in XR&&(A=!!l&&$V(l,"y")>-1)&&wft&&(l=ZV(l,/y/g,"")),XV&&(e=(y=function(_t){for(var _r,_i=_t.length,ga=0,_u="",ah=[],_h={},_A=!1,n0=!1,f0=0,E0="";ga<=_i;ga++){if((_r=NL(_t,ga))==="\\")_r+=NL(_t,++ga);else if(_r==="]")_A=!1;else if(!_A)switch(!0){case _r==="[":_A=!0;break;case _r==="(":Cft(Rft,Sft(_t,ga+1))&&(ga+=2,n0=!0),_u+=_r,f0++;continue;case(_r===">"&&n0):if(E0===""||mft(_h,E0))throw new yft("Invalid capture group name");_h[E0]=!0,ah[ah.length]=[E0,f0],n0=!1,E0="";continue}n0?E0+=_r:_u+=_r}return[_u,ah]}(e))[0],q=y[1]),g=lft(QS(e,l),I?this:_w,fR),(p||A||q.length)&&(b=vft(g),p&&(b.dotAll=!0,b.raw=fR(function(_t){for(var _r,_i=_t.length,ga=0,_u="",ah=!1;ga<=_i;ga++)(_r=NL(_t,ga))!=="\\"?ah||_r!=="."?(_r==="["?ah=!0:_r==="]"&&(ah=!1),_u+=_r):_u+="[\\s\\S]":_u+=_r+NL(_t,++ga);return _u}(e),d)),A&&(b.sticky=!0),q.length&&(b.groups=q)),e!==$)try{dft(g,"source",$===""?"(?:)":$)}catch{}return g},Nft=function(e){e in fR||hft(fR,e,{configurable:!0,get:function(){return QS[e]},set:function(l){QS[e]=l}})},tH=pft(QS),eH=0;tH.length>eH;)Nft(tH[eH++]);_w.constructor=fR,fR.prototype=_w,gft(c4,"RegExp",fR)}Ift("RegExp");var kft=f,Dft=j,Lft=OM,Pft=v0,xft=J1.f,Bft=Z_.get,nH=RegExp.prototype,Mft=kft.TypeError;Dft&&Lft&&xft(nH,"dotAll",{configurable:!0,get:function(){if(this!==nH){if(Pft(this)==="RegExp")return!!Bft(this).dotAll;throw Mft("Incompatible receiver, RegExp required")}}});const rH=JM;function iH(e,l){const d=e&&e.navigator;if(!d.mediaDevices)return;const p=function(g){if(typeof g!="object"||g.mandatory||g.optional)return g;const b={};return Object.keys(g).forEach(I=>{if(I==="require"||I==="advanced"||I==="mediaSource")return;const k=typeof g[I]=="object"?g[I]:{ideal:g[I]};k.exact!==void 0&&typeof k.exact=="number"&&(k.min=k.max=k.exact);const B=function(q,$){return q?q+$.charAt(0).toUpperCase()+$.slice(1):$==="deviceId"?"sourceId":$};if(k.ideal!==void 0){b.optional=b.optional||[];let q={};typeof k.ideal=="number"?(q[B("min",I)]=k.ideal,b.optional.push(q),q={},q[B("max",I)]=k.ideal,b.optional.push(q)):(q[B("",I)]=k.ideal,b.optional.push(q))}k.exact!==void 0&&typeof k.exact!="number"?(b.mandatory=b.mandatory||{},b.mandatory[B("",I)]=k.exact):["min","max"].forEach(q=>{k[q]!==void 0&&(b.mandatory=b.mandatory||{},b.mandatory[B(q,I)]=k[q])})}),g.advanced&&(b.optional=(b.optional||[]).concat(g.advanced)),b},A=function(g,b){if(l.version>=61)return b(g);if((g=JSON.parse(JSON.stringify(g)))&&typeof g.audio=="object"){const I=function(k,B,q){B in k&&!(q in k)&&(k[q]=k[B],delete k[B])};I((g=JSON.parse(JSON.stringify(g))).audio,"autoGainControl","googAutoGainControl"),I(g.audio,"noiseSuppression","googNoiseSuppression"),g.audio=p(g.audio)}if(g&&typeof g.video=="object"){let I=g.video.facingMode;I=I&&(typeof I=="object"?I:{ideal:I});const k=l.version<66;if(I&&(I.exact==="user"||I.exact==="environment"||I.ideal==="user"||I.ideal==="environment")&&(!d.mediaDevices.getSupportedConstraints||!d.mediaDevices.getSupportedConstraints().facingMode||k)){let B;if(delete g.video.facingMode,I.exact==="environment"||I.ideal==="environment"?B=["back","rear"]:I.exact!=="user"&&I.ideal!=="user"||(B=["front"]),B)return d.mediaDevices.enumerateDevices().then(q=>{let $=(q=q.filter(_t=>_t.kind==="videoinput")).find(_t=>B.some(_r=>_t.label.toLowerCase().includes(_r)));return!$&&q.length&&B.includes("back")&&($=q[q.length-1]),$&&(g.video.deviceId=I.exact?{exact:$.deviceId}:{ideal:$.deviceId}),g.video=p(g.video),rH("chrome: "+JSON.stringify(g)),b(g)})}g.video=p(g.video)}return rH("chrome: "+JSON.stringify(g)),b(g)},y=function(g){return l.version>=64?g:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[g.name]||g.name,message:g.message,constraint:g.constraint||g.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(d.getUserMedia=function(g,b,I){A(g,k=>{d.webkitGetUserMedia(k,b,B=>{I&&I(y(B))})})}.bind(d),d.mediaDevices.getUserMedia){const g=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(b){return A(b,I=>g(I).then(k=>{if(I.audio&&!k.getAudioTracks().length||I.video&&!k.getVideoTracks().length)throw k.getTracks().forEach(B=>{B.stop()}),new DOMException("","NotFoundError");return k},k=>Y0.reject(y(k))))}}}function oH(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function sH(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(d){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=d)},enumerable:!0,configurable:!0});const l=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=d=>{d.stream.addEventListener("addtrack",p=>{let A;A=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(g=>g.track&&g.track.id===p.track.id):{track:p.track};const y=new Event("track");y.track=p.track,y.receiver=A,y.transceiver={receiver:A},y.streams=[d.stream],this.dispatchEvent(y)}),d.stream.getTracks().forEach(p=>{let A;A=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(g=>g.track&&g.track.id===p.id):{track:p};const y=new Event("track");y.track=p,y.receiver=A,y.transceiver={receiver:A},y.streams=[d.stream],this.dispatchEvent(y)})},this.addEventListener("addstream",this._ontrackpoly)),l.apply(this,arguments)}}else jT(e,"track",l=>(l.transceiver||Object.defineProperty(l,"transceiver",{value:{receiver:l.receiver}}),l))}function aH(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const l=function(A,y){return{track:y,get dtmf(){return this._dtmf===void 0&&(y.kind==="audio"?this._dtmf=A.createDTMFSender(y):this._dtmf=null),this._dtmf},_pc:A}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const A=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(g,b){let I=A.apply(this,arguments);return I||(I=l(this,g),this._senders.push(I)),I};const y=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(g){y.apply(this,arguments);const b=this._senders.indexOf(g);b!==-1&&this._senders.splice(b,1)}}const d=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(A){this._senders=this._senders||[],d.apply(this,[A]),A.getTracks().forEach(y=>{this._senders.push(l(this,y))})};const p=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(A){this._senders=this._senders||[],p.apply(this,[A]),A.getTracks().forEach(y=>{const g=this._senders.find(b=>b.track===y);g&&this._senders.splice(this._senders.indexOf(g),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const l=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const d=l.apply(this,[]);return d.forEach(p=>p._pc=this),d},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function cH(e){if(!e.RTCPeerConnection)return;const l=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[d,p,A]=arguments;if(arguments.length>0&&typeof d=="function")return l.apply(this,arguments);if(l.length===0&&(arguments.length===0||typeof d!="function"))return l.apply(this,[]);const y=function(b){const I={};return b.result().forEach(k=>{const B={id:k.id,timestamp:k.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[k.type]||k.type};k.names().forEach(q=>{B[q]=k.stat(q)}),I[B.id]=B}),I},g=function(b){return new Map(Object.keys(b).map(I=>[I,b[I]]))};if(arguments.length>=2){const b=function(I){p(g(y(I)))};return l.apply(this,[b,d])}return new Y0((b,I)=>{l.apply(this,[function(k){b(g(y(k)))},I])}).then(p,A)}}function uH(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const d=e.RTCPeerConnection.prototype.getSenders;d&&(e.RTCPeerConnection.prototype.getSenders=function(){const A=d.apply(this,[]);return A.forEach(y=>y._pc=this),A});const p=e.RTCPeerConnection.prototype.addTrack;p&&(e.RTCPeerConnection.prototype.addTrack=function(){const A=p.apply(this,arguments);return A._pc=this,A}),e.RTCRtpSender.prototype.getStats=function(){const A=this;return this._pc.getStats().then(y=>_7(y,A.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const d=e.RTCPeerConnection.prototype.getReceivers;d&&(e.RTCPeerConnection.prototype.getReceivers=function(){const p=d.apply(this,[]);return p.forEach(A=>A._pc=this),p}),jT(e,"track",p=>(p.receiver._pc=p.srcElement,p)),e.RTCRtpReceiver.prototype.getStats=function(){const p=this;return this._pc.getStats().then(A=>_7(A,p.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const l=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const d=arguments[0];let p,A,y;return this.getSenders().forEach(g=>{g.track===d&&(p?y=!0:p=g)}),this.getReceivers().forEach(g=>(g.track===d&&(A?y=!0:A=g),g.track===d)),y||p&&A?Y0.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):p?p.getStats():A?A.getStats():Y0.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return l.apply(this,arguments)}}function lH(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(y=>this._shimmedLocalStreams[y][0])};const l=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(y,g){if(!g)return l.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const b=l.apply(this,arguments);return this._shimmedLocalStreams[g.id]?this._shimmedLocalStreams[g.id].indexOf(b)===-1&&this._shimmedLocalStreams[g.id].push(b):this._shimmedLocalStreams[g.id]=[g,b],b};const d=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(y){this._shimmedLocalStreams=this._shimmedLocalStreams||{},y.getTracks().forEach(I=>{if(this.getSenders().find(k=>k.track===I))throw new DOMException("Track already exists.","InvalidAccessError")});const g=this.getSenders();d.apply(this,arguments);const b=this.getSenders().filter(I=>g.indexOf(I)===-1);this._shimmedLocalStreams[y.id]=[y].concat(b)};const p=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(y){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[y.id],p.apply(this,arguments)};const A=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(y){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},y&&Object.keys(this._shimmedLocalStreams).forEach(g=>{const b=this._shimmedLocalStreams[g].indexOf(y);b!==-1&&this._shimmedLocalStreams[g].splice(b,1),this._shimmedLocalStreams[g].length===1&&delete this._shimmedLocalStreams[g]}),A.apply(this,arguments)}}function dH(e,l){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&l.version>=65)return lH(e);const d=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const k=d.apply(this);return this._reverseStreams=this._reverseStreams||{},k.map(B=>this._reverseStreams[B.id])};const p=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(k){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},k.getTracks().forEach(B=>{if(this.getSenders().find(q=>q.track===B))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[k.id]){const B=new e.MediaStream(k.getTracks());this._streams[k.id]=B,this._reverseStreams[B.id]=k,k=B}p.apply(this,[k])};const A=e.RTCPeerConnection.prototype.removeStream;function y(k,B){let q=B.sdp;return Object.keys(k._reverseStreams||[]).forEach($=>{const _t=k._reverseStreams[$],_r=k._streams[_t.id];q=q.replace(new RegExp(_r.id,"g"),_t.id)}),new RTCSessionDescription({type:B.type,sdp:q})}function g(k,B){let q=B.sdp;return Object.keys(k._reverseStreams||[]).forEach($=>{const _t=k._reverseStreams[$],_r=k._streams[_t.id];q=q.replace(new RegExp(_t.id,"g"),_r.id)}),new RTCSessionDescription({type:B.type,sdp:q})}e.RTCPeerConnection.prototype.removeStream=function(k){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},A.apply(this,[this._streams[k.id]||k]),delete this._reverseStreams[this._streams[k.id]?this._streams[k.id].id:k.id],delete this._streams[k.id]},e.RTCPeerConnection.prototype.addTrack=function(k,B){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const q=[].slice.call(arguments,1);if(q.length!==1||!q[0].getTracks().find(_r=>_r===k))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(_r=>_r.track===k))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _t=this._streams[B.id];if(_t)_t.addTrack(k),Y0.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const _r=new e.MediaStream([k]);this._streams[B.id]=_r,this._reverseStreams[_r.id]=B,this.addStream(_r)}return this.getSenders().find(_r=>_r.track===k)},["createOffer","createAnswer"].forEach(function(k){const B=e.RTCPeerConnection.prototype[k],q={[k](){const $=arguments;return arguments.length&&typeof arguments[0]=="function"?B.apply(this,[_t=>{const _r=y(this,_t);$[0].apply(null,[_r])},_t=>{$[1]&&$[1].apply(null,_t)},arguments[2]]):B.apply(this,arguments).then(_t=>y(this,_t))}};e.RTCPeerConnection.prototype[k]=q[k]});const b=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=g(this,arguments[0]),b.apply(this,arguments)):b.apply(this,arguments)};const I=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const k=I.get.apply(this);return k.type===""?k:y(this,k)}}),e.RTCPeerConnection.prototype.removeTrack=function(k){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!k._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(k._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let B;this._streams=this._streams||{},Object.keys(this._streams).forEach(q=>{this._streams[q].getTracks().find($=>k.track===$)&&(B=this._streams[q])}),B&&(B.getTracks().length===1?this.removeStream(this._reverseStreams[B.id]):B.removeTrack(k.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l4(e,l){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&l.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const p=e.RTCPeerConnection.prototype[d],A={[d](){return arguments[0]=new(d==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),p.apply(this,arguments)}};e.RTCPeerConnection.prototype[d]=A[d]})}function hH(e,l){jT(e,"negotiationneeded",d=>{const p=d.target;if(!(l.version<72||p.getConfiguration&&p.getConfiguration().sdpSemantics==="plan-b")||p.signalingState==="stable")return d})}var pH=Object.freeze({__proto__:null,shimMediaStream:oH,shimOnTrack:sH,shimGetSendersWithDtmf:aH,shimGetStats:cH,shimSenderReceiverGetStats:uH,shimAddTrackRemoveTrackWithNative:lH,shimAddTrackRemoveTrack:dH,shimPeerConnection:l4,fixNegotiationNeeded:hH,shimGetUserMedia:iH,shimGetDisplayMedia:function(e,l){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof l=="function"?e.navigator.mediaDevices.getDisplayMedia=function(d){return l(d).then(p=>{const A=d.video&&d.video.width,y=d.video&&d.video.height,g=d.video&&d.video.frameRate;return d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:p,maxFrameRate:g||3}},A&&(d.video.mandatory.maxWidth=A),y&&(d.video.mandatory.maxHeight=y),e.navigator.mediaDevices.getUserMedia(d)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),fH={exports:{}};(function(e){var l={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};l.localCName=l.generateIdentifier(),l.splitLines=function(d){return d.trim().split(`
`).map(function(p){return p.trim()})},l.splitSections=function(d){return d.split(`
m=`).map(function(p,A){return(A>0?"m="+p:p).trim()+`\r
`})},l.getDescription=function(d){var p=l.splitSections(d);return p&&p[0]},l.getMediaSections=function(d){var p=l.splitSections(d);return p.shift(),p},l.matchPrefix=function(d,p){return l.splitLines(d).filter(function(A){return A.indexOf(p)===0})},l.parseCandidate=function(d){for(var p,A={foundation:(p=d.indexOf("a=candidate:")===0?d.substring(12).split(" "):d.substring(10).split(" "))[0],component:parseInt(p[1],10),protocol:p[2].toLowerCase(),priority:parseInt(p[3],10),ip:p[4],address:p[4],port:parseInt(p[5],10),type:p[7]},y=8;y<p.length;y+=2)switch(p[y]){case"raddr":A.relatedAddress=p[y+1];break;case"rport":A.relatedPort=parseInt(p[y+1],10);break;case"tcptype":A.tcpType=p[y+1];break;case"ufrag":A.ufrag=p[y+1],A.usernameFragment=p[y+1];break;default:A[p[y]]=p[y+1]}return A},l.writeCandidate=function(d){var p=[];p.push(d.foundation),p.push(d.component),p.push(d.protocol.toUpperCase()),p.push(d.priority),p.push(d.address||d.ip),p.push(d.port);var A=d.type;return p.push("typ"),p.push(A),A!=="host"&&d.relatedAddress&&d.relatedPort&&(p.push("raddr"),p.push(d.relatedAddress),p.push("rport"),p.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(p.push("tcptype"),p.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(p.push("ufrag"),p.push(d.usernameFragment||d.ufrag)),"candidate:"+p.join(" ")},l.parseIceOptions=function(d){return d.substr(14).split(" ")},l.parseRtpMap=function(d){var p=d.substr(9).split(" "),A={payloadType:parseInt(p.shift(),10)};return p=p[0].split("/"),A.name=p[0],A.clockRate=parseInt(p[1],10),A.channels=p.length===3?parseInt(p[2],10):1,A.numChannels=A.channels,A},l.writeRtpMap=function(d){var p=d.payloadType;d.preferredPayloadType!==void 0&&(p=d.preferredPayloadType);var A=d.channels||d.numChannels||1;return"a=rtpmap:"+p+" "+d.name+"/"+d.clockRate+(A!==1?"/"+A:"")+`\r
`},l.parseExtmap=function(d){var p=d.substr(9).split(" ");return{id:parseInt(p[0],10),direction:p[0].indexOf("/")>0?p[0].split("/")[1]:"sendrecv",uri:p[1]}},l.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+`\r
`},l.parseFmtp=function(d){for(var p,A={},y=d.substr(d.indexOf(" ")+1).split(";"),g=0;g<y.length;g++)A[(p=y[g].trim().split("="))[0].trim()]=p[1];return A},l.writeFmtp=function(d){var p="",A=d.payloadType;if(d.preferredPayloadType!==void 0&&(A=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){var y=[];Object.keys(d.parameters).forEach(function(g){d.parameters[g]?y.push(g+"="+d.parameters[g]):y.push(g)}),p+="a=fmtp:"+A+" "+y.join(";")+`\r
`}return p},l.parseRtcpFb=function(d){var p=d.substr(d.indexOf(" ")+1).split(" ");return{type:p.shift(),parameter:p.join(" ")}},l.writeRtcpFb=function(d){var p="",A=d.payloadType;return d.preferredPayloadType!==void 0&&(A=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(function(y){p+="a=rtcp-fb:"+A+" "+y.type+(y.parameter&&y.parameter.length?" "+y.parameter:"")+`\r
`}),p},l.parseSsrcMedia=function(d){var p=d.indexOf(" "),A={ssrc:parseInt(d.substr(7,p-7),10)},y=d.indexOf(":",p);return y>-1?(A.attribute=d.substr(p+1,y-p-1),A.value=d.substr(y+1)):A.attribute=d.substr(p+1),A},l.parseSsrcGroup=function(d){var p=d.substr(13).split(" ");return{semantics:p.shift(),ssrcs:p.map(function(A){return parseInt(A,10)})}},l.getMid=function(d){var p=l.matchPrefix(d,"a=mid:")[0];if(p)return p.substr(6)},l.parseFingerprint=function(d){var p=d.substr(14).split(" ");return{algorithm:p[0].toLowerCase(),value:p[1]}},l.getDtlsParameters=function(d,p){return{role:"auto",fingerprints:l.matchPrefix(d+p,"a=fingerprint:").map(l.parseFingerprint)}},l.writeDtlsParameters=function(d,p){var A="a=setup:"+p+`\r
`;return d.fingerprints.forEach(function(y){A+="a=fingerprint:"+y.algorithm+" "+y.value+`\r
`}),A},l.getIceParameters=function(d,p){var A=l.splitLines(d);return{usernameFragment:(A=A.concat(l.splitLines(p))).filter(function(y){return y.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:A.filter(function(y){return y.indexOf("a=ice-pwd:")===0})[0].substr(10)}},l.writeIceParameters=function(d){return"a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`},l.parseRtpParameters=function(d){for(var p={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=l.splitLines(d)[0].split(" "),y=3;y<A.length;y++){var g=A[y],b=l.matchPrefix(d,"a=rtpmap:"+g+" ")[0];if(b){var I=l.parseRtpMap(b),k=l.matchPrefix(d,"a=fmtp:"+g+" ");switch(I.parameters=k.length?l.parseFmtp(k[0]):{},I.rtcpFeedback=l.matchPrefix(d,"a=rtcp-fb:"+g+" ").map(l.parseRtcpFb),p.codecs.push(I),I.name.toUpperCase()){case"RED":case"ULPFEC":p.fecMechanisms.push(I.name.toUpperCase())}}}return l.matchPrefix(d,"a=extmap:").forEach(function(B){p.headerExtensions.push(l.parseExtmap(B))}),p},l.writeRtpDescription=function(d,p){var A="";A+="m="+d+" ",A+=p.codecs.length>0?"9":"0",A+=" UDP/TLS/RTP/SAVPF ",A+=p.codecs.map(function(g){return g.preferredPayloadType!==void 0?g.preferredPayloadType:g.payloadType}).join(" ")+`\r
`,A+=`c=IN IP4 0.0.0.0\r
`,A+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,p.codecs.forEach(function(g){A+=l.writeRtpMap(g),A+=l.writeFmtp(g),A+=l.writeRtcpFb(g)});var y=0;return p.codecs.forEach(function(g){g.maxptime>y&&(y=g.maxptime)}),y>0&&(A+="a=maxptime:"+y+`\r
`),A+=`a=rtcp-mux\r
`,p.headerExtensions&&p.headerExtensions.forEach(function(g){A+=l.writeExtmap(g)}),A},l.parseRtpEncodingParameters=function(d){var p,A=[],y=l.parseRtpParameters(d),g=y.fecMechanisms.indexOf("RED")!==-1,b=y.fecMechanisms.indexOf("ULPFEC")!==-1,I=l.matchPrefix(d,"a=ssrc:").map(function($){return l.parseSsrcMedia($)}).filter(function($){return $.attribute==="cname"}),k=I.length>0&&I[0].ssrc,B=l.matchPrefix(d,"a=ssrc-group:FID").map(function($){return $.substr(17).split(" ").map(function(_t){return parseInt(_t,10)})});B.length>0&&B[0].length>1&&B[0][0]===k&&(p=B[0][1]),y.codecs.forEach(function($){if($.name.toUpperCase()==="RTX"&&$.parameters.apt){var _t={ssrc:k,codecPayloadType:parseInt($.parameters.apt,10)};k&&p&&(_t.rtx={ssrc:p}),A.push(_t),g&&((_t=JSON.parse(JSON.stringify(_t))).fec={ssrc:k,mechanism:b?"red+ulpfec":"red"},A.push(_t))}}),A.length===0&&k&&A.push({ssrc:k});var q=l.matchPrefix(d,"b=");return q.length&&(q=q[0].indexOf("b=TIAS:")===0?parseInt(q[0].substr(7),10):q[0].indexOf("b=AS:")===0?1e3*parseInt(q[0].substr(5),10)*.95-16e3:void 0,A.forEach(function($){$.maxBitrate=q})),A},l.parseRtcpParameters=function(d){var p={},A=l.matchPrefix(d,"a=ssrc:").map(function(b){return l.parseSsrcMedia(b)}).filter(function(b){return b.attribute==="cname"})[0];A&&(p.cname=A.value,p.ssrc=A.ssrc);var y=l.matchPrefix(d,"a=rtcp-rsize");p.reducedSize=y.length>0,p.compound=y.length===0;var g=l.matchPrefix(d,"a=rtcp-mux");return p.mux=g.length>0,p},l.parseMsid=function(d){var p,A=l.matchPrefix(d,"a=msid:");if(A.length===1)return{stream:(p=A[0].substr(7).split(" "))[0],track:p[1]};var y=l.matchPrefix(d,"a=ssrc:").map(function(g){return l.parseSsrcMedia(g)}).filter(function(g){return g.attribute==="msid"});return y.length>0?{stream:(p=y[0].value.split(" "))[0],track:p[1]}:void 0},l.generateSessionId=function(){return Math.random().toString().substr(2,21)},l.writeSessionBoilerplate=function(d,p,A){var y=p!==void 0?p:2;return`v=0\r
o=`+(A||"thisisadapterortc")+" "+(d||l.generateSessionId())+" "+y+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},l.writeMediaSection=function(d,p,A,y){var g=l.writeRtpDescription(d.kind,p);if(g+=l.writeIceParameters(d.iceGatherer.getLocalParameters()),g+=l.writeDtlsParameters(d.dtlsTransport.getLocalParameters(),A==="offer"?"actpass":"active"),g+="a=mid:"+d.mid+`\r
`,d.direction?g+="a="+d.direction+`\r
`:d.rtpSender&&d.rtpReceiver?g+=`a=sendrecv\r
`:d.rtpSender?g+=`a=sendonly\r
`:d.rtpReceiver?g+=`a=recvonly\r
`:g+=`a=inactive\r
`,d.rtpSender){var b="msid:"+y.id+" "+d.rtpSender.track.id+`\r
`;g+="a="+b,g+="a=ssrc:"+d.sendEncodingParameters[0].ssrc+" "+b,d.sendEncodingParameters[0].rtx&&(g+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" "+b,g+="a=ssrc-group:FID "+d.sendEncodingParameters[0].ssrc+" "+d.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return g+="a=ssrc:"+d.sendEncodingParameters[0].ssrc+" cname:"+l.localCName+`\r
`,d.rtpSender&&d.sendEncodingParameters[0].rtx&&(g+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" cname:"+l.localCName+`\r
`),g},l.getDirection=function(d,p){for(var A=l.splitLines(d),y=0;y<A.length;y++)switch(A[y]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return A[y].substr(2)}return p?l.getDirection(p):"sendrecv"},l.getKind=function(d){return l.splitLines(d)[0].split(" ")[0].substr(2)},l.isRejected=function(d){return d.split(" ",2)[1]==="0"},l.parseMLine=function(d){var p=l.splitLines(d)[0].substr(2).split(" ");return{kind:p[0],port:parseInt(p[1],10),protocol:p[2],fmt:p.slice(3).join(" ")}},l.parseOLine=function(d){var p=l.matchPrefix(d,"o=")[0].substr(2).split(" ");return{username:p[0],sessionId:p[1],sessionVersion:parseInt(p[2],10),netType:p[3],addressType:p[4],address:p[5]}},l.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;for(var p=l.splitLines(d),A=0;A<p.length;A++)if(p[A].length<2||p[A].charAt(1)!=="=")return!1;return!0},e.exports=l})(fH);var EI=fH.exports;function AH(e,l,d,p,A){var y=EI.writeRtpDescription(e.kind,l);if(y+=EI.writeIceParameters(e.iceGatherer.getLocalParameters()),y+=EI.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),d==="offer"?"actpass":A||"active"),y+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?y+=`a=sendrecv\r
`:e.rtpSender?y+=`a=sendonly\r
`:e.rtpReceiver?y+=`a=recvonly\r
`:y+=`a=inactive\r
`,e.rtpSender){var g=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=g;var b="msid:"+(p?p.id:"-")+" "+g+`\r
`;y+="a="+b,y+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+b,e.sendEncodingParameters[0].rtx&&(y+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+b,y+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return y+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+EI.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(y+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+EI.localCName+`\r
`),y}function kL(e,l){var d={codecs:[],headerExtensions:[],fecMechanisms:[]},p=function(y,g){y=parseInt(y,10);for(var b=0;b<g.length;b++)if(g[b].payloadType===y||g[b].preferredPayloadType===y)return g[b]},A=function(y,g,b,I){var k=p(y.parameters.apt,b),B=p(g.parameters.apt,I);return k&&B&&k.name.toLowerCase()===B.name.toLowerCase()};return e.codecs.forEach(function(y){for(var g=0;g<l.codecs.length;g++){var b=l.codecs[g];if(y.name.toLowerCase()===b.name.toLowerCase()&&y.clockRate===b.clockRate){if(y.name.toLowerCase()==="rtx"&&y.parameters&&b.parameters.apt&&!A(y,b,e.codecs,l.codecs))continue;(b=JSON.parse(JSON.stringify(b))).numChannels=Math.min(y.numChannels,b.numChannels),d.codecs.push(b),b.rtcpFeedback=b.rtcpFeedback.filter(function(I){for(var k=0;k<y.rtcpFeedback.length;k++)if(y.rtcpFeedback[k].type===I.type&&y.rtcpFeedback[k].parameter===I.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(y){for(var g=0;g<l.headerExtensions.length;g++){var b=l.headerExtensions[g];if(y.uri===b.uri){d.headerExtensions.push(b);break}}}),d}function gH(e,l,d){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[l][e].indexOf(d)!==-1}function d4(e,l){var d=e.getRemoteCandidates().find(function(p){return l.foundation===p.foundation&&l.ip===p.ip&&l.port===p.port&&l.priority===p.priority&&l.protocol===p.protocol&&l.type===p.type});return d||e.addRemoteCandidate(l),!d}function o_(e,l){var d=new Error(l);return d.name=e,d.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],d}var Uft=function(e,l){function d(g,b){b.addTrack(g),b.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:g}))}function p(g,b,I,k){var B=new Event("track");B.track=b,B.receiver=I,B.transceiver={receiver:I},B.streams=k,e.setTimeout(function(){g._dispatchEvent("track",B)})}var A=function(g){var b=this,I=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(B){b[B]=I[B].bind(I)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",g=JSON.parse(JSON.stringify(g||{})),this.usingBundle=g.bundlePolicy==="max-bundle",g.rtcpMuxPolicy==="negotiate")throw o_("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(g.rtcpMuxPolicy||(g.rtcpMuxPolicy="require"),g.iceTransportPolicy){case"all":case"relay":break;default:g.iceTransportPolicy="all"}switch(g.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:g.bundlePolicy="balanced"}if(g.iceServers=function(B,q){var $=!1;return(B=JSON.parse(JSON.stringify(B))).filter(function(_t){if(_t&&(_t.urls||_t.url)){var _r=_t.urls||_t.url;_t.url&&!_t.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var _i=typeof _r=="string";return _i&&(_r=[_r]),_r=_r.filter(function(ga){return ga.indexOf("turn:")!==0||ga.indexOf("transport=udp")===-1||ga.indexOf("turn:[")!==-1||$?ga.indexOf("stun:")===0&&q>=14393&&ga.indexOf("?transport=udp")===-1:($=!0,!0)}),delete _t.url,_t.urls=_i?_r[0]:_r,!!_r.length}})}(g.iceServers||[],l),this._iceGatherers=[],g.iceCandidatePoolSize)for(var k=g.iceCandidatePoolSize;k>0;k--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:g.iceServers,gatherPolicy:g.iceTransportPolicy}));else g.iceCandidatePoolSize=0;this._config=g,this.transceivers=[],this._sdpSessionId=EI.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(A.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(A.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),A.prototype.onicecandidate=null,A.prototype.onaddstream=null,A.prototype.ontrack=null,A.prototype.onremovestream=null,A.prototype.onsignalingstatechange=null,A.prototype.oniceconnectionstatechange=null,A.prototype.onconnectionstatechange=null,A.prototype.onicegatheringstatechange=null,A.prototype.onnegotiationneeded=null,A.prototype.ondatachannel=null,A.prototype._dispatchEvent=function(g,b){this._isClosed||(this.dispatchEvent(b),typeof this["on"+g]=="function"&&this["on"+g](b))},A.prototype._emitGatheringStateChange=function(){var g=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",g)},A.prototype.getConfiguration=function(){return this._config},A.prototype.getLocalStreams=function(){return this.localStreams},A.prototype.getRemoteStreams=function(){return this.remoteStreams},A.prototype._createTransceiver=function(g,b){var I=this.transceivers.length>0,k={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:g,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&I)k.iceTransport=this.transceivers[0].iceTransport,k.dtlsTransport=this.transceivers[0].dtlsTransport;else{var B=this._createIceAndDtlsTransports();k.iceTransport=B.iceTransport,k.dtlsTransport=B.dtlsTransport}return b||this.transceivers.push(k),k},A.prototype.addTrack=function(g,b){if(this._isClosed)throw o_("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var I;if(this.transceivers.find(function(B){return B.track===g}))throw o_("InvalidAccessError","Track already exists.");for(var k=0;k<this.transceivers.length;k++)this.transceivers[k].track||this.transceivers[k].kind!==g.kind||(I=this.transceivers[k]);return I||(I=this._createTransceiver(g.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(b)===-1&&this.localStreams.push(b),I.track=g,I.stream=b,I.rtpSender=new e.RTCRtpSender(g,I.dtlsTransport),I.rtpSender},A.prototype.addStream=function(g){var b=this;if(l>=15025)g.getTracks().forEach(function(k){b.addTrack(k,g)});else{var I=g.clone();g.getTracks().forEach(function(k,B){var q=I.getTracks()[B];k.addEventListener("enabled",function($){q.enabled=$.enabled})}),I.getTracks().forEach(function(k){b.addTrack(k,I)})}},A.prototype.removeTrack=function(g){if(this._isClosed)throw o_("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(g instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(k){return k.rtpSender===g});if(!b)throw o_("InvalidAccessError","Sender was not created by this connection.");var I=b.stream;b.rtpSender.stop(),b.rtpSender=null,b.track=null,b.stream=null,this.transceivers.map(function(k){return k.stream}).indexOf(I)===-1&&this.localStreams.indexOf(I)>-1&&this.localStreams.splice(this.localStreams.indexOf(I),1),this._maybeFireNegotiationNeeded()},A.prototype.removeStream=function(g){var b=this;g.getTracks().forEach(function(I){var k=b.getSenders().find(function(B){return B.track===I});k&&b.removeTrack(k)})},A.prototype.getSenders=function(){return this.transceivers.filter(function(g){return!!g.rtpSender}).map(function(g){return g.rtpSender})},A.prototype.getReceivers=function(){return this.transceivers.filter(function(g){return!!g.rtpReceiver}).map(function(g){return g.rtpReceiver})},A.prototype._createIceGatherer=function(g,b){var I=this;if(b&&g>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var k=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(k,"state",{value:"new",writable:!0}),this.transceivers[g].bufferedCandidateEvents=[],this.transceivers[g].bufferCandidates=function(B){var q=!B.candidate||Object.keys(B.candidate).length===0;k.state=q?"completed":"gathering",I.transceivers[g].bufferedCandidateEvents!==null&&I.transceivers[g].bufferedCandidateEvents.push(B)},k.addEventListener("localcandidate",this.transceivers[g].bufferCandidates),k},A.prototype._gather=function(g,b){var I=this,k=this.transceivers[b].iceGatherer;if(!k.onlocalcandidate){var B=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null,k.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates),k.onlocalcandidate=function(q){if(!(I.usingBundle&&b>0)){var $=new Event("icecandidate");$.candidate={sdpMid:g,sdpMLineIndex:b};var _t=q.candidate,_r=!_t||Object.keys(_t).length===0;if(_r)k.state!=="new"&&k.state!=="gathering"||(k.state="completed");else{k.state==="new"&&(k.state="gathering"),_t.component=1,_t.ufrag=k.getLocalParameters().usernameFragment;var _i=EI.writeCandidate(_t);$.candidate=Object.assign($.candidate,EI.parseCandidate(_i)),$.candidate.candidate=_i,$.candidate.toJSON=function(){return{candidate:$.candidate.candidate,sdpMid:$.candidate.sdpMid,sdpMLineIndex:$.candidate.sdpMLineIndex,usernameFragment:$.candidate.usernameFragment}}}var ga=EI.getMediaSections(I._localDescription.sdp);ga[$.candidate.sdpMLineIndex]+=_r?`a=end-of-candidates\r
`:"a="+$.candidate.candidate+`\r
`,I._localDescription.sdp=EI.getDescription(I._localDescription.sdp)+ga.join("");var _u=I.transceivers.every(function(ah){return ah.iceGatherer&&ah.iceGatherer.state==="completed"});I.iceGatheringState!=="gathering"&&(I.iceGatheringState="gathering",I._emitGatheringStateChange()),_r||I._dispatchEvent("icecandidate",$),_u&&(I._dispatchEvent("icecandidate",new Event("icecandidate")),I.iceGatheringState="complete",I._emitGatheringStateChange())}},e.setTimeout(function(){B.forEach(function(q){k.onlocalcandidate(q)})},0)}},A.prototype._createIceAndDtlsTransports=function(){var g=this,b=new e.RTCIceTransport(null);b.onicestatechange=function(){g._updateIceConnectionState(),g._updateConnectionState()};var I=new e.RTCDtlsTransport(b);return I.ondtlsstatechange=function(){g._updateConnectionState()},I.onerror=function(){Object.defineProperty(I,"state",{value:"failed",writable:!0}),g._updateConnectionState()},{iceTransport:b,dtlsTransport:I}},A.prototype._disposeIceAndDtlsTransports=function(g){var b=this.transceivers[g].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[g].iceGatherer);var I=this.transceivers[g].iceTransport;I&&(delete I.onicestatechange,delete this.transceivers[g].iceTransport);var k=this.transceivers[g].dtlsTransport;k&&(delete k.ondtlsstatechange,delete k.onerror,delete this.transceivers[g].dtlsTransport)},A.prototype._transceive=function(g,b,I){var k=kL(g.localCapabilities,g.remoteCapabilities);b&&g.rtpSender&&(k.encodings=g.sendEncodingParameters,k.rtcp={cname:EI.localCName,compound:g.rtcpParameters.compound},g.recvEncodingParameters.length&&(k.rtcp.ssrc=g.recvEncodingParameters[0].ssrc),g.rtpSender.send(k)),I&&g.rtpReceiver&&k.codecs.length>0&&(g.kind==="video"&&g.recvEncodingParameters&&l<15019&&g.recvEncodingParameters.forEach(function(B){delete B.rtx}),g.recvEncodingParameters.length?k.encodings=g.recvEncodingParameters:k.encodings=[{}],k.rtcp={compound:g.rtcpParameters.compound},g.rtcpParameters.cname&&(k.rtcp.cname=g.rtcpParameters.cname),g.sendEncodingParameters.length&&(k.rtcp.ssrc=g.sendEncodingParameters[0].ssrc),g.rtpReceiver.receive(k))},A.prototype.setLocalDescription=function(g){var b,I,k=this;if(["offer","answer"].indexOf(g.type)===-1)return Promise.reject(o_("TypeError",'Unsupported type "'+g.type+'"'));if(!gH("setLocalDescription",g.type,k.signalingState)||k._isClosed)return Promise.reject(o_("InvalidStateError","Can not set local "+g.type+" in state "+k.signalingState));if(g.type==="offer")b=EI.splitSections(g.sdp),I=b.shift(),b.forEach(function(q,$){var _t=EI.parseRtpParameters(q);k.transceivers[$].localCapabilities=_t}),k.transceivers.forEach(function(q,$){k._gather(q.mid,$)});else if(g.type==="answer"){b=EI.splitSections(k._remoteDescription.sdp),I=b.shift();var B=EI.matchPrefix(I,"a=ice-lite").length>0;b.forEach(function(q,$){var _t=k.transceivers[$],_r=_t.iceGatherer,_i=_t.iceTransport,ga=_t.dtlsTransport,_u=_t.localCapabilities,ah=_t.remoteCapabilities;if(!(EI.isRejected(q)&&EI.matchPrefix(q,"a=bundle-only").length===0)&&!_t.rejected){var _h=EI.getIceParameters(q,I),_A=EI.getDtlsParameters(q,I);B&&(_A.role="server"),k.usingBundle&&$!==0||(k._gather(_t.mid,$),_i.state==="new"&&_i.start(_r,_h,B?"controlling":"controlled"),ga.state==="new"&&ga.start(_A));var n0=kL(_u,ah);k._transceive(_t,n0.codecs.length>0,!1)}})}return k._localDescription={type:g.type,sdp:g.sdp},g.type==="offer"?k._updateSignalingState("have-local-offer"):k._updateSignalingState("stable"),Promise.resolve()},A.prototype.setRemoteDescription=function(g){var b=this;if(["offer","answer"].indexOf(g.type)===-1)return Promise.reject(o_("TypeError",'Unsupported type "'+g.type+'"'));if(!gH("setRemoteDescription",g.type,b.signalingState)||b._isClosed)return Promise.reject(o_("InvalidStateError","Can not set remote "+g.type+" in state "+b.signalingState));var I={};b.remoteStreams.forEach(function(_i){I[_i.id]=_i});var k=[],B=EI.splitSections(g.sdp),q=B.shift(),$=EI.matchPrefix(q,"a=ice-lite").length>0,_t=EI.matchPrefix(q,"a=group:BUNDLE ").length>0;b.usingBundle=_t;var _r=EI.matchPrefix(q,"a=ice-options:")[0];return b.canTrickleIceCandidates=!!_r&&_r.substr(14).split(" ").indexOf("trickle")>=0,B.forEach(function(_i,ga){var _u=EI.splitLines(_i),ah=EI.getKind(_i),_h=EI.isRejected(_i)&&EI.matchPrefix(_i,"a=bundle-only").length===0,_A=_u[0].substr(2).split(" ")[2],n0=EI.getDirection(_i,q),f0=EI.parseMsid(_i),E0=EI.getMid(_i)||EI.generateIdentifier();if(_h||ah==="application"&&(_A==="DTLS/SCTP"||_A==="UDP/DTLS/SCTP"))b.transceivers[ga]={mid:E0,kind:ah,protocol:_A,rejected:!0};else{var m0,V0,D0,j0,c0,_m,t0,s0,P0;!_h&&b.transceivers[ga]&&b.transceivers[ga].rejected&&(b.transceivers[ga]=b._createTransceiver(ah,!0));var Rv,e0,l0=EI.parseRtpParameters(_i);_h||(Rv=EI.getIceParameters(_i,q),(e0=EI.getDtlsParameters(_i,q)).role="client"),t0=EI.parseRtpEncodingParameters(_i);var w0=EI.parseRtcpParameters(_i),B0=EI.matchPrefix(_i,"a=end-of-candidates",q).length>0,g0=EI.matchPrefix(_i,"a=candidate:").map(function(_p){return EI.parseCandidate(_p)}).filter(function(_p){return _p.component===1});if((g.type==="offer"||g.type==="answer")&&!_h&&_t&&ga>0&&b.transceivers[ga]&&(b._disposeIceAndDtlsTransports(ga),b.transceivers[ga].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[ga].iceTransport=b.transceivers[0].iceTransport,b.transceivers[ga].dtlsTransport=b.transceivers[0].dtlsTransport,b.transceivers[ga].rtpSender&&b.transceivers[ga].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[ga].rtpReceiver&&b.transceivers[ga].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport)),g.type!=="offer"||_h)g.type==="answer"&&!_h&&(V0=(m0=b.transceivers[ga]).iceGatherer,D0=m0.iceTransport,j0=m0.dtlsTransport,c0=m0.rtpReceiver,_m=m0.sendEncodingParameters,s0=m0.localCapabilities,b.transceivers[ga].recvEncodingParameters=t0,b.transceivers[ga].remoteCapabilities=l0,b.transceivers[ga].rtcpParameters=w0,g0.length&&D0.state==="new"&&(!$&&!B0||_t&&ga!==0?g0.forEach(function(_p){d4(m0.iceTransport,_p)}):D0.setRemoteCandidates(g0)),_t&&ga!==0||(D0.state==="new"&&D0.start(V0,Rv,"controlling"),j0.state==="new"&&j0.start(e0)),!kL(m0.localCapabilities,m0.remoteCapabilities).codecs.filter(function(_p){return _p.name.toLowerCase()==="rtx"}).length&&m0.sendEncodingParameters[0].rtx&&delete m0.sendEncodingParameters[0].rtx,b._transceive(m0,n0==="sendrecv"||n0==="recvonly",n0==="sendrecv"||n0==="sendonly"),!c0||n0!=="sendrecv"&&n0!=="sendonly"?delete m0.rtpReceiver:(P0=c0.track,f0?(I[f0.stream]||(I[f0.stream]=new e.MediaStream),d(P0,I[f0.stream]),k.push([P0,c0,I[f0.stream]])):(I.default||(I.default=new e.MediaStream),d(P0,I.default),k.push([P0,c0,I.default]))));else{(m0=b.transceivers[ga]||b._createTransceiver(ah)).mid=E0,m0.iceGatherer||(m0.iceGatherer=b._createIceGatherer(ga,_t)),g0.length&&m0.iceTransport.state==="new"&&(!B0||_t&&ga!==0?g0.forEach(function(_p){d4(m0.iceTransport,_p)}):m0.iceTransport.setRemoteCandidates(g0)),s0=e.RTCRtpReceiver.getCapabilities(ah),l<15019&&(s0.codecs=s0.codecs.filter(function(_p){return _p.name!=="rtx"})),_m=m0.sendEncodingParameters||[{ssrc:1001*(2*ga+2)}];var _n,_l=!1;n0==="sendrecv"||n0==="sendonly"?(_l=!m0.rtpReceiver,c0=m0.rtpReceiver||new e.RTCRtpReceiver(m0.dtlsTransport,ah),_l&&(P0=c0.track,f0&&f0.stream==="-"||(f0?(I[f0.stream]||(I[f0.stream]=new e.MediaStream,Object.defineProperty(I[f0.stream],"id",{get:function(){return f0.stream}})),Object.defineProperty(P0,"id",{get:function(){return f0.track}}),_n=I[f0.stream]):(I.default||(I.default=new e.MediaStream),_n=I.default)),_n&&(d(P0,_n),m0.associatedRemoteMediaStreams.push(_n)),k.push([P0,c0,_n]))):m0.rtpReceiver&&m0.rtpReceiver.track&&(m0.associatedRemoteMediaStreams.forEach(function(_p){var p0=_p.getTracks().find(function(L0){return L0.id===m0.rtpReceiver.track.id});p0&&function(L0,oI){oI.removeTrack(L0),oI.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:L0}))}(p0,_p)}),m0.associatedRemoteMediaStreams=[]),m0.localCapabilities=s0,m0.remoteCapabilities=l0,m0.rtpReceiver=c0,m0.rtcpParameters=w0,m0.sendEncodingParameters=_m,m0.recvEncodingParameters=t0,b._transceive(b.transceivers[ga],!1,_l)}}}),b._dtlsRole===void 0&&(b._dtlsRole=g.type==="offer"?"active":"passive"),b._remoteDescription={type:g.type,sdp:g.sdp},g.type==="offer"?b._updateSignalingState("have-remote-offer"):b._updateSignalingState("stable"),Object.keys(I).forEach(function(_i){var ga=I[_i];if(ga.getTracks().length){if(b.remoteStreams.indexOf(ga)===-1){b.remoteStreams.push(ga);var _u=new Event("addstream");_u.stream=ga,e.setTimeout(function(){b._dispatchEvent("addstream",_u)})}k.forEach(function(ah){var _h=ah[0],_A=ah[1];ga.id===ah[2].id&&p(b,_h,_A,[ga])})}}),k.forEach(function(_i){_i[2]||p(b,_i[0],_i[1],[])}),e.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(_i){_i.iceTransport&&_i.iceTransport.state==="new"&&_i.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),_i.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},A.prototype.close=function(){this.transceivers.forEach(function(g){g.iceTransport&&g.iceTransport.stop(),g.dtlsTransport&&g.dtlsTransport.stop(),g.rtpSender&&g.rtpSender.stop(),g.rtpReceiver&&g.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},A.prototype._updateSignalingState=function(g){this.signalingState=g;var b=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",b)},A.prototype._maybeFireNegotiationNeeded=function(){var g=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,e.setTimeout(function(){if(g.needNegotiation){g.needNegotiation=!1;var b=new Event("negotiationneeded");g._dispatchEvent("negotiationneeded",b)}},0))},A.prototype._updateIceConnectionState=function(){var g,b={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(k){k.iceTransport&&!k.rejected&&b[k.iceTransport.state]++}),g="new",b.failed>0?g="failed":b.checking>0?g="checking":b.disconnected>0?g="disconnected":b.new>0?g="new":b.connected>0?g="connected":b.completed>0&&(g="completed"),g!==this.iceConnectionState){this.iceConnectionState=g;var I=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",I)}},A.prototype._updateConnectionState=function(){var g,b={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(k){k.iceTransport&&k.dtlsTransport&&!k.rejected&&(b[k.iceTransport.state]++,b[k.dtlsTransport.state]++)}),b.connected+=b.completed,g="new",b.failed>0?g="failed":b.connecting>0?g="connecting":b.disconnected>0?g="disconnected":b.new>0?g="new":b.connected>0&&(g="connected"),g!==this.connectionState){this.connectionState=g;var I=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",I)}},A.prototype.createOffer=function(){var g=this;if(g._isClosed)return Promise.reject(o_("InvalidStateError","Can not call createOffer after close"));var b=g.transceivers.filter(function($){return $.kind==="audio"}).length,I=g.transceivers.filter(function($){return $.kind==="video"}).length,k=arguments[0];if(k){if(k.mandatory||k.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");k.offerToReceiveAudio!==void 0&&(b=k.offerToReceiveAudio===!0?1:k.offerToReceiveAudio===!1?0:k.offerToReceiveAudio),k.offerToReceiveVideo!==void 0&&(I=k.offerToReceiveVideo===!0?1:k.offerToReceiveVideo===!1?0:k.offerToReceiveVideo)}for(g.transceivers.forEach(function($){$.kind==="audio"?--b<0&&($.wantReceive=!1):$.kind==="video"&&--I<0&&($.wantReceive=!1)});b>0||I>0;)b>0&&(g._createTransceiver("audio"),b--),I>0&&(g._createTransceiver("video"),I--);var B=EI.writeSessionBoilerplate(g._sdpSessionId,g._sdpSessionVersion++);g.transceivers.forEach(function($,_t){var _r=$.track,_i=$.kind,ga=$.mid||EI.generateIdentifier();$.mid=ga,$.iceGatherer||($.iceGatherer=g._createIceGatherer(_t,g.usingBundle));var _u=e.RTCRtpSender.getCapabilities(_i);l<15019&&(_u.codecs=_u.codecs.filter(function(_h){return _h.name!=="rtx"})),_u.codecs.forEach(function(_h){_h.name==="H264"&&_h.parameters["level-asymmetry-allowed"]===void 0&&(_h.parameters["level-asymmetry-allowed"]="1"),$.remoteCapabilities&&$.remoteCapabilities.codecs&&$.remoteCapabilities.codecs.forEach(function(_A){_h.name.toLowerCase()===_A.name.toLowerCase()&&_h.clockRate===_A.clockRate&&(_h.preferredPayloadType=_A.payloadType)})}),_u.headerExtensions.forEach(function(_h){($.remoteCapabilities&&$.remoteCapabilities.headerExtensions||[]).forEach(function(_A){_h.uri===_A.uri&&(_h.id=_A.id)})});var ah=$.sendEncodingParameters||[{ssrc:1001*(2*_t+1)}];_r&&l>=15019&&_i==="video"&&!ah[0].rtx&&(ah[0].rtx={ssrc:ah[0].ssrc+1}),$.wantReceive&&($.rtpReceiver=new e.RTCRtpReceiver($.dtlsTransport,_i)),$.localCapabilities=_u,$.sendEncodingParameters=ah}),g._config.bundlePolicy!=="max-compat"&&(B+="a=group:BUNDLE "+g.transceivers.map(function($){return $.mid}).join(" ")+`\r
`),B+=`a=ice-options:trickle\r
`,g.transceivers.forEach(function($,_t){B+=AH($,$.localCapabilities,"offer",$.stream,g._dtlsRole),B+=`a=rtcp-rsize\r
`,!$.iceGatherer||g.iceGatheringState==="new"||_t!==0&&g.usingBundle||($.iceGatherer.getLocalCandidates().forEach(function(_r){_r.component=1,B+="a="+EI.writeCandidate(_r)+`\r
`}),$.iceGatherer.state==="completed"&&(B+=`a=end-of-candidates\r
`))});var q=new e.RTCSessionDescription({type:"offer",sdp:B});return Promise.resolve(q)},A.prototype.createAnswer=function(){var g=this;if(g._isClosed)return Promise.reject(o_("InvalidStateError","Can not call createAnswer after close"));if(g.signalingState!=="have-remote-offer"&&g.signalingState!=="have-local-pranswer")return Promise.reject(o_("InvalidStateError","Can not call createAnswer in signalingState "+g.signalingState));var b=EI.writeSessionBoilerplate(g._sdpSessionId,g._sdpSessionVersion++);g.usingBundle&&(b+="a=group:BUNDLE "+g.transceivers.map(function(B){return B.mid}).join(" ")+`\r
`),b+=`a=ice-options:trickle\r
`;var I=EI.getMediaSections(g._remoteDescription.sdp).length;g.transceivers.forEach(function(B,q){if(!(q+1>I)){if(B.rejected)return B.kind==="application"?B.protocol==="DTLS/SCTP"?b+=`m=application 0 DTLS/SCTP 5000\r
`:b+="m=application 0 "+B.protocol+` webrtc-datachannel\r
`:B.kind==="audio"?b+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:B.kind==="video"&&(b+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(b+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+B.mid+`\r
`);var $;B.stream&&(B.kind==="audio"?$=B.stream.getAudioTracks()[0]:B.kind==="video"&&($=B.stream.getVideoTracks()[0]),$&&l>=15019&&B.kind==="video"&&!B.sendEncodingParameters[0].rtx&&(B.sendEncodingParameters[0].rtx={ssrc:B.sendEncodingParameters[0].ssrc+1}));var _t=kL(B.localCapabilities,B.remoteCapabilities);!_t.codecs.filter(function(_r){return _r.name.toLowerCase()==="rtx"}).length&&B.sendEncodingParameters[0].rtx&&delete B.sendEncodingParameters[0].rtx,b+=AH(B,_t,"answer",B.stream,g._dtlsRole),B.rtcpParameters&&B.rtcpParameters.reducedSize&&(b+=`a=rtcp-rsize\r
`)}});var k=new e.RTCSessionDescription({type:"answer",sdp:b});return Promise.resolve(k)},A.prototype.addIceCandidate=function(g){var b,I=this;return g&&g.sdpMLineIndex===void 0&&!g.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(k,B){if(!I._remoteDescription)return B(o_("InvalidStateError","Can not add ICE candidate without a remote description"));if(g&&g.candidate!==""){var q=g.sdpMLineIndex;if(g.sdpMid){for(var $=0;$<I.transceivers.length;$++)if(I.transceivers[$].mid===g.sdpMid){q=$;break}}var _t=I.transceivers[q];if(!_t)return B(o_("OperationError","Can not add ICE candidate"));if(_t.rejected)return k();var _r=Object.keys(g.candidate).length>0?EI.parseCandidate(g.candidate):{};if(_r.protocol==="tcp"&&(_r.port===0||_r.port===9)||_r.component&&_r.component!==1)return k();if((q===0||q>0&&_t.iceTransport!==I.transceivers[0].iceTransport)&&!d4(_t.iceTransport,_r))return B(o_("OperationError","Can not add ICE candidate"));var _i=g.candidate.trim();_i.indexOf("a=")===0&&(_i=_i.substr(2)),(b=EI.getMediaSections(I._remoteDescription.sdp))[q]+="a="+(_r.type?_i:"end-of-candidates")+`\r
`,I._remoteDescription.sdp=EI.getDescription(I._remoteDescription.sdp)+b.join("")}else for(var ga=0;ga<I.transceivers.length&&(I.transceivers[ga].rejected||(I.transceivers[ga].iceTransport.addRemoteCandidate({}),(b=EI.getMediaSections(I._remoteDescription.sdp))[ga]+=`a=end-of-candidates\r
`,I._remoteDescription.sdp=EI.getDescription(I._remoteDescription.sdp)+b.join(""),!I.usingBundle));ga++);k()})},A.prototype.getStats=function(g){if(g&&g instanceof e.MediaStreamTrack){var b=null;if(this.transceivers.forEach(function(k){k.rtpSender&&k.rtpSender.track===g?b=k.rtpSender:k.rtpReceiver&&k.rtpReceiver.track===g&&(b=k.rtpReceiver)}),!b)throw o_("InvalidAccessError","Invalid selector.");return b.getStats()}var I=[];return this.transceivers.forEach(function(k){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(B){k[B]&&I.push(k[B].getStats())})}),Promise.all(I).then(function(k){var B=new Map;return k.forEach(function(q){q.forEach(function($){B.set($.id,$)})}),B})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(g){var b=e[g];if(b&&b.prototype&&b.prototype.getStats){var I=b.prototype.getStats;b.prototype.getStats=function(){return I.apply(this).then(function(k){var B=new Map;return Object.keys(k).forEach(function(q){var $;k[q].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[($=k[q]).type]||$.type,B.set(q,k[q])}),B})}}});var y=["createOffer","createAnswer"];return y.forEach(function(g){var b=A.prototype[g];A.prototype[g]=function(){var I=arguments;return typeof I[0]=="function"||typeof I[1]=="function"?b.apply(this,[arguments[2]]).then(function(k){typeof I[0]=="function"&&I[0].apply(null,[k])},function(k){typeof I[1]=="function"&&I[1].apply(null,[k])}):b.apply(this,arguments)}}),(y=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(g){var b=A.prototype[g];A.prototype[g]=function(){var I=arguments;return typeof I[1]=="function"||typeof I[2]=="function"?b.apply(this,arguments).then(function(){typeof I[1]=="function"&&I[1].apply(null)},function(k){typeof I[2]=="function"&&I[2].apply(null,[k])}):b.apply(this,arguments)}}),["getStats"].forEach(function(g){var b=A.prototype[g];A.prototype[g]=function(){var I=arguments;return typeof I[1]=="function"?b.apply(this,arguments).then(function(){typeof I[1]=="function"&&I[1].apply(null)}):b.apply(this,arguments)}}),A};function EH(e){const l=e&&e.navigator,d=l.mediaDevices.getUserMedia.bind(l.mediaDevices);l.mediaDevices.getUserMedia=function(p){return d(p).catch(A=>Y0.reject(function(y){return{name:{PermissionDeniedError:"NotAllowedError"}[y.name]||y.name,message:y.message,constraint:y.constraint,toString(){return this.name}}}(A)))}}function mH(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function h4(e,l){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(p){return p}),e.RTCSessionDescription||(e.RTCSessionDescription=function(p){return p}),l.version<15025)){const p=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(A){p.set.call(this,A);const y=new Event("enabled");y.enabled=A,this.dispatchEvent(y)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const d=Uft(e,l.version);e.RTCPeerConnection=function(p){return p&&p.iceServers&&(p.iceServers=function(A,y){let g=!1;return(A=JSON.parse(JSON.stringify(A))).filter(b=>{if(b&&(b.urls||b.url)){let I=b.urls||b.url;b.url&&!b.urls&&JN("RTCIceServer.url","RTCIceServer.urls");const k=typeof I=="string";return k&&(I=[I]),I=I.filter(B=>{if(B.indexOf("stun:")===0)return!1;const q=B.startsWith("turn")&&!B.startsWith("turn:[")&&B.includes("transport=udp");return q&&!g?(g=!0,!0):q&&!g}),delete b.url,b.urls=k?I[0]:I,!!I.length}})}(p.iceServers,l.version),JM("ICE servers after filtering:",p.iceServers)),new d(p)},e.RTCPeerConnection.prototype=d.prototype}function vH(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var IH=Object.freeze({__proto__:null,shimPeerConnection:h4,shimReplaceTrack:vH,shimGetUserMedia:EH,shimGetDisplayMedia:mH}),jft=P_,bO=q8,Fft=w,_H=r_,yH=qI,Qft=M3,bH=wQ,Gft=aS.exports;if(jft({target:"Promise",proto:!0,real:!0,forced:!!bO&&Fft(function(){bO.prototype.finally.call({then:function(){}},function(){})})},{finally:function(e){var l=Qft(this,_H("Promise")),d=yH(e);return this.then(d?function(p){return bH(l,e()).then(function(){return p})}:e,d?function(p){return bH(l,e()).then(function(){throw p})}:e)}}),yH(bO)){var CH=_H("Promise").prototype.finally;bO.prototype.finally!==CH&&Gft(bO.prototype,"finally",CH,{unsafe:!0})}function SH(e,l){const d=e&&e.navigator,p=e&&e.MediaStreamTrack;if(d.getUserMedia=function(A,y,g){JN("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),d.mediaDevices.getUserMedia(A).then(y,g)},!(l.version>55&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){const A=function(g,b,I){b in g&&!(I in g)&&(g[I]=g[b],delete g[b])},y=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(g){return typeof g=="object"&&typeof g.audio=="object"&&(g=JSON.parse(JSON.stringify(g)),A(g.audio,"autoGainControl","mozAutoGainControl"),A(g.audio,"noiseSuppression","mozNoiseSuppression")),y(g)},p&&p.prototype.getSettings){const g=p.prototype.getSettings;p.prototype.getSettings=function(){const b=g.apply(this,arguments);return A(b,"mozAutoGainControl","autoGainControl"),A(b,"mozNoiseSuppression","noiseSuppression"),b}}if(p&&p.prototype.applyConstraints){const g=p.prototype.applyConstraints;p.prototype.applyConstraints=function(b){return this.kind==="audio"&&typeof b=="object"&&(b=JSON.parse(JSON.stringify(b)),A(b,"autoGainControl","mozAutoGainControl"),A(b,"noiseSuppression","mozNoiseSuppression")),g.apply(this,[b])}}}}function RH(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function p4(e,l){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),l.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(A){const y=e.RTCPeerConnection.prototype[A],g={[A](){return arguments[0]=new(A==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),y.apply(this,arguments)}};e.RTCPeerConnection.prototype[A]=g[A]});const d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},p=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[A,y,g]=arguments;return p.apply(this,[A||null]).then(b=>{if(l.version<53&&!y)try{b.forEach(I=>{I.type=d[I.type]||I.type})}catch(I){if(I.name!=="TypeError")throw I;b.forEach((k,B)=>{b.set(B,Object.assign({},k,{type:d[k.type]||k.type}))})}return b}).then(y,g)}}function TH(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const l=e.RTCPeerConnection.prototype.getSenders;l&&(e.RTCPeerConnection.prototype.getSenders=function(){const p=l.apply(this,[]);return p.forEach(A=>A._pc=this),p});const d=e.RTCPeerConnection.prototype.addTrack;d&&(e.RTCPeerConnection.prototype.addTrack=function(){const p=d.apply(this,arguments);return p._pc=this,p}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Y0.resolve(new Map)}}function wH(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const l=e.RTCPeerConnection.prototype.getReceivers;l&&(e.RTCPeerConnection.prototype.getReceivers=function(){const d=l.apply(this,[]);return d.forEach(p=>p._pc=this),d}),jT(e,"track",d=>(d.receiver._pc=d.srcElement,d)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function OH(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(l){JN("removeStream","removeTrack"),this.getSenders().forEach(d=>{d.track&&l.getTracks().includes(d.track)&&this.removeTrack(d)})})}function NH(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function kH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const l=e.RTCPeerConnection.prototype.addTransceiver;l&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const d=arguments[1],p=d&&"sendEncodings"in d;p&&d.sendEncodings.forEach(y=>{if("rid"in y&&!/^[a-z0-9]{0,16}$/i.test(y.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in y&&!(parseFloat(y.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in y&&!(parseFloat(y.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const A=l.apply(this,arguments);if(p){const{sender:y}=A,g=y.getParameters();(!("encodings"in g)||g.encodings.length===1&&Object.keys(g.encodings[0]).length===0)&&(g.encodings=d.sendEncodings,y.sendEncodings=d.sendEncodings,this.setParametersPromises.push(y.setParameters(g).then(()=>{delete y.sendEncodings}).catch(()=>{delete y.sendEncodings})))}return A})}function DH(e){if(typeof e!="object"||!e.RTCRtpSender)return;const l=e.RTCRtpSender.prototype.getParameters;l&&(e.RTCRtpSender.prototype.getParameters=function(){const d=l.apply(this,arguments);return"encodings"in d||(d.encodings=[].concat(this.sendEncodings||[{}])),d})}function LH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const l=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Y0.all(this.setParametersPromises).then(()=>l.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):l.apply(this,arguments)}}function PH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const l=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Y0.all(this.setParametersPromises).then(()=>l.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):l.apply(this,arguments)}}var xH=Object.freeze({__proto__:null,shimOnTrack:RH,shimPeerConnection:p4,shimSenderGetStats:TH,shimReceiverGetStats:wH,shimRemoveStream:OH,shimRTCDataChannel:NH,shimAddTransceiver:kH,shimGetParameters:DH,shimCreateOffer:LH,shimCreateAnswer:PH,shimGetUserMedia:SH,shimGetDisplayMedia:function(e,l){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video){const p=new DOMException("getDisplayMedia without video constraints is undefined");return p.name="NotFoundError",p.code=8,Y0.reject(p)}return d.video===!0?d.video={mediaSource:l}:d.video.mediaSource=l,e.navigator.mediaDevices.getUserMedia(d)})}});function BH(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const l=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(d){this._localStreams||(this._localStreams=[]),this._localStreams.includes(d)||this._localStreams.push(d),d.getAudioTracks().forEach(p=>l.call(this,p,d)),d.getVideoTracks().forEach(p=>l.call(this,p,d))},e.RTCPeerConnection.prototype.addTrack=function(d){for(var p=arguments.length,A=new Array(p>1?p-1:0),y=1;y<p;y++)A[y-1]=arguments[y];return A&&A.forEach(g=>{this._localStreams?this._localStreams.includes(g)||this._localStreams.push(g):this._localStreams=[g]}),l.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(l){this._localStreams||(this._localStreams=[]);const d=this._localStreams.indexOf(l);if(d===-1)return;this._localStreams.splice(d,1);const p=l.getTracks();this.getSenders().forEach(A=>{p.includes(A.track)&&this.removeTrack(A)})})}}function MH(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(d){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=d),this.addEventListener("track",this._onaddstreampoly=p=>{p.streams.forEach(A=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(A))return;this._remoteStreams.push(A);const y=new Event("addstream");y.stream=A,this.dispatchEvent(y)})})}});const l=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const d=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(p){p.streams.forEach(A=>{if(d._remoteStreams||(d._remoteStreams=[]),d._remoteStreams.indexOf(A)>=0)return;d._remoteStreams.push(A);const y=new Event("addstream");y.stream=A,d.dispatchEvent(y)})}),l.apply(d,arguments)}}}function UH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const l=e.RTCPeerConnection.prototype,d=l.createOffer,p=l.createAnswer,A=l.setLocalDescription,y=l.setRemoteDescription,g=l.addIceCandidate;l.createOffer=function(I,k){const B=arguments.length>=2?arguments[2]:arguments[0],q=d.apply(this,[B]);return k?(q.then(I,k),Y0.resolve()):q},l.createAnswer=function(I,k){const B=arguments.length>=2?arguments[2]:arguments[0],q=p.apply(this,[B]);return k?(q.then(I,k),Y0.resolve()):q};let b=function(I,k,B){const q=A.apply(this,[I]);return B?(q.then(k,B),Y0.resolve()):q};l.setLocalDescription=b,b=function(I,k,B){const q=y.apply(this,[I]);return B?(q.then(k,B),Y0.resolve()):q},l.setRemoteDescription=b,b=function(I,k,B){const q=g.apply(this,[I]);return B?(q.then(k,B),Y0.resolve()):q},l.addIceCandidate=b}function jH(e){const l=e&&e.navigator;if(l.mediaDevices&&l.mediaDevices.getUserMedia){const d=l.mediaDevices,p=d.getUserMedia.bind(d);l.mediaDevices.getUserMedia=A=>p(FH(A))}!l.getUserMedia&&l.mediaDevices&&l.mediaDevices.getUserMedia&&(l.getUserMedia=function(d,p,A){l.mediaDevices.getUserMedia(d).then(p,A)}.bind(l))}function FH(e){return e&&e.video!==void 0?Object.assign({},e,{video:I7(e.video)}):e}function QH(e){if(!e.RTCPeerConnection)return;const l=e.RTCPeerConnection;e.RTCPeerConnection=function(d,p){if(d&&d.iceServers){const A=[];for(let y=0;y<d.iceServers.length;y++){let g=d.iceServers[y];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(JN("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,A.push(g)):A.push(d.iceServers[y])}d.iceServers=A}return new l(d,p)},e.RTCPeerConnection.prototype=l.prototype,"generateCertificate"in l&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>l.generateCertificate})}function GH(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function VH(e){const l=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(d){if(d){d.offerToReceiveAudio!==void 0&&(d.offerToReceiveAudio=!!d.offerToReceiveAudio);const p=this.getTransceivers().find(y=>y.receiver.track.kind==="audio");d.offerToReceiveAudio===!1&&p?p.direction==="sendrecv"?p.setDirection?p.setDirection("sendonly"):p.direction="sendonly":p.direction==="recvonly"&&(p.setDirection?p.setDirection("inactive"):p.direction="inactive"):d.offerToReceiveAudio!==!0||p||this.addTransceiver("audio"),d.offerToReceiveVideo!==void 0&&(d.offerToReceiveVideo=!!d.offerToReceiveVideo);const A=this.getTransceivers().find(y=>y.receiver.track.kind==="video");d.offerToReceiveVideo===!1&&A?A.direction==="sendrecv"?A.setDirection?A.setDirection("sendonly"):A.direction="sendonly":A.direction==="recvonly"&&(A.setDirection?A.setDirection("inactive"):A.direction="inactive"):d.offerToReceiveVideo!==!0||A||this.addTransceiver("video")}return l.apply(this,arguments)}}function qH(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var HH=Object.freeze({__proto__:null,shimLocalStreamsAPI:BH,shimRemoteStreamsAPI:MH,shimCallbacksAPI:UH,shimGetUserMedia:jH,shimConstraints:FH,shimRTCIceServerUrls:QH,shimTrackEventTransceiver:GH,shimCreateOfferLegacy:VH,shimAudioContext:qH}),Vft=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,qft=DN,Hft=hR,KH=t1("".replace),DL=`[	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]`,Kft=RegExp("^"+DL+DL+"*"),Yft=RegExp(DL+DL+"*$"),f4=function(e){return function(l){var d=Hft(qft(l));return 1&e&&(d=KH(d,Kft,"")),2&e&&(d=KH(d,Yft,"")),d}},Wft={start:f4(1),end:f4(2),trim:f4(3)},Jft=X7.PROPER,zft=m1,YH=Vft,Xft=Wft.trim;M1({target:"String",proto:!0,forced:function(e){return zft(function(){return!!YH[e]()||"\u200B\x85\u180E"[e]()!=="\u200B\x85\u180E"||Jft&&YH[e].name!==e})}("trim")},{trim:function(){return Xft(this)}});var Zft=dR("String").trim,$ft=B_,tAt=Zft,A4=String.prototype,ZR=function(e){var l=e.trim;return typeof e=="string"||e===A4||$ft(A4,e)&&l===A4.trim?tAt:l},eAt=_o;P_({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return eAt(URL.prototype.toString,this)}});var WH={exports:{}};(function(e){var l={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};l.localCName=l.generateIdentifier(),l.splitLines=function(d){return ZR(d).call(d).split(`
`).map(function(p){return ZR(p).call(p)})},l.splitSections=function(d){return d.split(`
m=`).map(function(p,A){var y;return ZR(y=A>0?"m="+p:p).call(y)+`\r
`})},l.getDescription=function(d){var p=l.splitSections(d);return p&&p[0]},l.getMediaSections=function(d){var p=l.splitSections(d);return p.shift(),p},l.matchPrefix=function(d,p){return l.splitLines(d).filter(function(A){return A.indexOf(p)===0})},l.parseCandidate=function(d){for(var p,A={foundation:(p=d.indexOf("a=candidate:")===0?d.substring(12).split(" "):d.substring(10).split(" "))[0],component:parseInt(p[1],10),protocol:p[2].toLowerCase(),priority:parseInt(p[3],10),ip:p[4],address:p[4],port:parseInt(p[5],10),type:p[7]},y=8;y<p.length;y+=2)switch(p[y]){case"raddr":A.relatedAddress=p[y+1];break;case"rport":A.relatedPort=parseInt(p[y+1],10);break;case"tcptype":A.tcpType=p[y+1];break;case"ufrag":A.ufrag=p[y+1],A.usernameFragment=p[y+1];break;default:A[p[y]]=p[y+1]}return A},l.writeCandidate=function(d){var p=[];p.push(d.foundation),p.push(d.component),p.push(d.protocol.toUpperCase()),p.push(d.priority),p.push(d.address||d.ip),p.push(d.port);var A=d.type;return p.push("typ"),p.push(A),A!=="host"&&d.relatedAddress&&d.relatedPort&&(p.push("raddr"),p.push(d.relatedAddress),p.push("rport"),p.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(p.push("tcptype"),p.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(p.push("ufrag"),p.push(d.usernameFragment||d.ufrag)),"candidate:"+p.join(" ")},l.parseIceOptions=function(d){return d.substr(14).split(" ")},l.parseRtpMap=function(d){var p=d.substr(9).split(" "),A={payloadType:parseInt(p.shift(),10)};return p=p[0].split("/"),A.name=p[0],A.clockRate=parseInt(p[1],10),A.channels=p.length===3?parseInt(p[2],10):1,A.numChannels=A.channels,A},l.writeRtpMap=function(d){var p=d.payloadType;d.preferredPayloadType!==void 0&&(p=d.preferredPayloadType);var A=d.channels||d.numChannels||1;return"a=rtpmap:"+p+" "+d.name+"/"+d.clockRate+(A!==1?"/"+A:"")+`\r
`},l.parseExtmap=function(d){var p=d.substr(9).split(" ");return{id:parseInt(p[0],10),direction:p[0].indexOf("/")>0?p[0].split("/")[1]:"sendrecv",uri:p[1]}},l.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+`\r
`},l.parseFmtp=function(d){for(var p,A={},y=d.substr(d.indexOf(" ")+1).split(";"),g=0;g<y.length;g++){var b,I;p=ZR(b=y[g]).call(b).split("="),A[ZR(I=p[0]).call(I)]=p[1]}return A},l.writeFmtp=function(d){var p="",A=d.payloadType;if(d.preferredPayloadType!==void 0&&(A=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){var y=[];Object.keys(d.parameters).forEach(function(g){d.parameters[g]?y.push(g+"="+d.parameters[g]):y.push(g)}),p+="a=fmtp:"+A+" "+y.join(";")+`\r
`}return p},l.parseRtcpFb=function(d){var p=d.substr(d.indexOf(" ")+1).split(" ");return{type:p.shift(),parameter:p.join(" ")}},l.writeRtcpFb=function(d){var p="",A=d.payloadType;return d.preferredPayloadType!==void 0&&(A=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(function(y){p+="a=rtcp-fb:"+A+" "+y.type+(y.parameter&&y.parameter.length?" "+y.parameter:"")+`\r
`}),p},l.parseSsrcMedia=function(d){var p=d.indexOf(" "),A={ssrc:parseInt(d.substr(7,p-7),10)},y=d.indexOf(":",p);return y>-1?(A.attribute=d.substr(p+1,y-p-1),A.value=d.substr(y+1)):A.attribute=d.substr(p+1),A},l.parseSsrcGroup=function(d){var p=d.substr(13).split(" ");return{semantics:p.shift(),ssrcs:p.map(function(A){return parseInt(A,10)})}},l.getMid=function(d){var p=l.matchPrefix(d,"a=mid:")[0];if(p)return p.substr(6)},l.parseFingerprint=function(d){var p=d.substr(14).split(" ");return{algorithm:p[0].toLowerCase(),value:p[1]}},l.getDtlsParameters=function(d,p){return{role:"auto",fingerprints:l.matchPrefix(d+p,"a=fingerprint:").map(l.parseFingerprint)}},l.writeDtlsParameters=function(d,p){var A="a=setup:"+p+`\r
`;return d.fingerprints.forEach(function(y){A+="a=fingerprint:"+y.algorithm+" "+y.value+`\r
`}),A},l.parseCryptoLine=function(d){var p=d.substr(9).split(" ");return{tag:parseInt(p[0],10),cryptoSuite:p[1],keyParams:p[2],sessionParams:p.slice(3)}},l.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+(typeof d.keyParams=="object"?l.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+`\r
`},l.parseCryptoKeyParams=function(d){if(d.indexOf("inline:")!==0)return null;var p=d.substr(7).split("|");return{keyMethod:"inline",keySalt:p[0],lifeTime:p[1],mkiValue:p[2]?p[2].split(":")[0]:void 0,mkiLength:p[2]?p[2].split(":")[1]:void 0}},l.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")},l.getCryptoParameters=function(d,p){return l.matchPrefix(d+p,"a=crypto:").map(l.parseCryptoLine)},l.getIceParameters=function(d,p){var A=l.matchPrefix(d+p,"a=ice-ufrag:")[0],y=l.matchPrefix(d+p,"a=ice-pwd:")[0];return A&&y?{usernameFragment:A.substr(12),password:y.substr(10)}:null},l.writeIceParameters=function(d){return"a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`},l.parseRtpParameters=function(d){for(var p={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=l.splitLines(d)[0].split(" "),y=3;y<A.length;y++){var g=A[y],b=l.matchPrefix(d,"a=rtpmap:"+g+" ")[0];if(b){var I=l.parseRtpMap(b),k=l.matchPrefix(d,"a=fmtp:"+g+" ");switch(I.parameters=k.length?l.parseFmtp(k[0]):{},I.rtcpFeedback=l.matchPrefix(d,"a=rtcp-fb:"+g+" ").map(l.parseRtcpFb),p.codecs.push(I),I.name.toUpperCase()){case"RED":case"ULPFEC":p.fecMechanisms.push(I.name.toUpperCase())}}}return l.matchPrefix(d,"a=extmap:").forEach(function(B){p.headerExtensions.push(l.parseExtmap(B))}),p},l.writeRtpDescription=function(d,p){var A="";A+="m="+d+" ",A+=p.codecs.length>0?"9":"0",A+=" UDP/TLS/RTP/SAVPF ",A+=p.codecs.map(function(g){return g.preferredPayloadType!==void 0?g.preferredPayloadType:g.payloadType}).join(" ")+`\r
`,A+=`c=IN IP4 0.0.0.0\r
`,A+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,p.codecs.forEach(function(g){A+=l.writeRtpMap(g),A+=l.writeFmtp(g),A+=l.writeRtcpFb(g)});var y=0;return p.codecs.forEach(function(g){g.maxptime>y&&(y=g.maxptime)}),y>0&&(A+="a=maxptime:"+y+`\r
`),A+=`a=rtcp-mux\r
`,p.headerExtensions&&p.headerExtensions.forEach(function(g){A+=l.writeExtmap(g)}),A},l.parseRtpEncodingParameters=function(d){var p,A=[],y=l.parseRtpParameters(d),g=y.fecMechanisms.indexOf("RED")!==-1,b=y.fecMechanisms.indexOf("ULPFEC")!==-1,I=l.matchPrefix(d,"a=ssrc:").map(function($){return l.parseSsrcMedia($)}).filter(function($){return $.attribute==="cname"}),k=I.length>0&&I[0].ssrc,B=l.matchPrefix(d,"a=ssrc-group:FID").map(function($){return $.substr(17).split(" ").map(function(_t){return parseInt(_t,10)})});B.length>0&&B[0].length>1&&B[0][0]===k&&(p=B[0][1]),y.codecs.forEach(function($){if($.name.toUpperCase()==="RTX"&&$.parameters.apt){var _t={ssrc:k,codecPayloadType:parseInt($.parameters.apt,10)};k&&p&&(_t.rtx={ssrc:p}),A.push(_t),g&&((_t=JSON.parse(JSON.stringify(_t))).fec={ssrc:k,mechanism:b?"red+ulpfec":"red"},A.push(_t))}}),A.length===0&&k&&A.push({ssrc:k});var q=l.matchPrefix(d,"b=");return q.length&&(q=q[0].indexOf("b=TIAS:")===0?parseInt(q[0].substr(7),10):q[0].indexOf("b=AS:")===0?1e3*parseInt(q[0].substr(5),10)*.95-16e3:void 0,A.forEach(function($){$.maxBitrate=q})),A},l.parseRtcpParameters=function(d){var p={},A=l.matchPrefix(d,"a=ssrc:").map(function(b){return l.parseSsrcMedia(b)}).filter(function(b){return b.attribute==="cname"})[0];A&&(p.cname=A.value,p.ssrc=A.ssrc);var y=l.matchPrefix(d,"a=rtcp-rsize");p.reducedSize=y.length>0,p.compound=y.length===0;var g=l.matchPrefix(d,"a=rtcp-mux");return p.mux=g.length>0,p},l.parseMsid=function(d){var p,A=l.matchPrefix(d,"a=msid:");if(A.length===1)return{stream:(p=A[0].substr(7).split(" "))[0],track:p[1]};var y=l.matchPrefix(d,"a=ssrc:").map(function(g){return l.parseSsrcMedia(g)}).filter(function(g){return g.attribute==="msid"});return y.length>0?{stream:(p=y[0].value.split(" "))[0],track:p[1]}:void 0},l.parseSctpDescription=function(d){var p,A=l.parseMLine(d),y=l.matchPrefix(d,"a=max-message-size:");y.length>0&&(p=parseInt(y[0].substr(19),10)),isNaN(p)&&(p=65536);var g=l.matchPrefix(d,"a=sctp-port:");if(g.length>0)return{port:parseInt(g[0].substr(12),10),protocol:A.fmt,maxMessageSize:p};if(l.matchPrefix(d,"a=sctpmap:").length>0){var b=l.matchPrefix(d,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(b[0],10),protocol:b[1],maxMessageSize:p}}},l.writeSctpDescription=function(d,p){var A=[];return A=d.protocol!=="DTLS/SCTP"?["m="+d.kind+" 9 "+d.protocol+" "+p.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+p.port+`\r
`]:["m="+d.kind+" 9 "+d.protocol+" "+p.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+p.port+" "+p.protocol+` 65535\r
`],p.maxMessageSize!==void 0&&A.push("a=max-message-size:"+p.maxMessageSize+`\r
`),A.join("")},l.generateSessionId=function(){return Math.random().toString().substr(2,21)},l.writeSessionBoilerplate=function(d,p,A){var y=p!==void 0?p:2;return`v=0\r
o=`+(A||"thisisadapterortc")+" "+(d||l.generateSessionId())+" "+y+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},l.writeMediaSection=function(d,p,A,y){var g=l.writeRtpDescription(d.kind,p);if(g+=l.writeIceParameters(d.iceGatherer.getLocalParameters()),g+=l.writeDtlsParameters(d.dtlsTransport.getLocalParameters(),A==="offer"?"actpass":"active"),g+="a=mid:"+d.mid+`\r
`,d.direction?g+="a="+d.direction+`\r
`:d.rtpSender&&d.rtpReceiver?g+=`a=sendrecv\r
`:d.rtpSender?g+=`a=sendonly\r
`:d.rtpReceiver?g+=`a=recvonly\r
`:g+=`a=inactive\r
`,d.rtpSender){var b="msid:"+y.id+" "+d.rtpSender.track.id+`\r
`;g+="a="+b,g+="a=ssrc:"+d.sendEncodingParameters[0].ssrc+" "+b,d.sendEncodingParameters[0].rtx&&(g+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" "+b,g+="a=ssrc-group:FID "+d.sendEncodingParameters[0].ssrc+" "+d.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return g+="a=ssrc:"+d.sendEncodingParameters[0].ssrc+" cname:"+l.localCName+`\r
`,d.rtpSender&&d.sendEncodingParameters[0].rtx&&(g+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" cname:"+l.localCName+`\r
`),g},l.getDirection=function(d,p){for(var A=l.splitLines(d),y=0;y<A.length;y++)switch(A[y]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return A[y].substr(2)}return p?l.getDirection(p):"sendrecv"},l.getKind=function(d){return l.splitLines(d)[0].split(" ")[0].substr(2)},l.isRejected=function(d){return d.split(" ",2)[1]==="0"},l.parseMLine=function(d){var p=l.splitLines(d)[0].substr(2).split(" ");return{kind:p[0],port:parseInt(p[1],10),protocol:p[2],fmt:p.slice(3).join(" ")}},l.parseOLine=function(d){var p=l.matchPrefix(d,"o=")[0].substr(2).split(" ");return{username:p[0],sessionId:p[1],sessionVersion:parseInt(p[2],10),netType:p[3],addressType:p[4],address:p[5]}},l.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;for(var p=l.splitLines(d),A=0;A<p.length;A++)if(p[A].length<2||p[A].charAt(1)!=="=")return!1;return!0},e.exports=l})(WH);var LL=WH.exports;function PL(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const l=e.RTCIceCandidate;e.RTCIceCandidate=function(d){if(typeof d=="object"&&d.candidate&&d.candidate.indexOf("a=")===0&&((d=JSON.parse(JSON.stringify(d))).candidate=d.candidate.substr(2)),d.candidate&&d.candidate.length){const p=new l(d),A=LL.parseCandidate(d.candidate),y=Object.assign(p,A);return y.toJSON=function(){return{candidate:y.candidate,sdpMid:y.sdpMid,sdpMLineIndex:y.sdpMLineIndex,usernameFragment:y.usernameFragment}},y}return new l(d)},e.RTCIceCandidate.prototype=l.prototype,jT(e,"icecandidate",d=>(d.candidate&&Object.defineProperty(d,"candidate",{value:new e.RTCIceCandidate(d.candidate),writable:"false"}),d))}function CO(e,l){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const d=function(b){if(!b||!b.sdp)return!1;const I=LL.splitSections(b.sdp);return I.shift(),I.some(k=>{const B=LL.parseMLine(k);return B&&B.kind==="application"&&B.protocol.indexOf("SCTP")!==-1})},p=function(b){const I=b.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(I===null||I.length<2)return-1;const k=parseInt(I[1],10);return k!=k?-1:k},A=function(b){let I=65536;return l.browser==="firefox"&&(I=l.version<57?b===-1?16384:2147483637:l.version<60?l.version===57?65535:65536:2147483637),I},y=function(b,I){let k=65536;l.browser==="firefox"&&l.version===57&&(k=65535);const B=LL.matchPrefix(b.sdp,"a=max-message-size:");return B.length>0?k=parseInt(B[0].substr(19),10):l.browser==="firefox"&&I!==-1&&(k=2147483637),k},g=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,l.browser==="chrome"&&l.version>=76){const{sdpSemantics:b}=this.getConfiguration();b==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(d(arguments[0])){const b=p(arguments[0]),I=A(b),k=y(arguments[0],b);let B;B=I===0&&k===0?Number.POSITIVE_INFINITY:I===0||k===0?Math.max(I,k):Math.min(I,k);const q={};Object.defineProperty(q,"maxMessageSize",{get:()=>B}),this._sctp=q}return g.apply(this,arguments)}}function SO(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function l(p,A){const y=p.send;p.send=function(){const g=arguments[0],b=g.length||g.size||g.byteLength;if(p.readyState==="open"&&A.sctp&&b>A.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+A.sctp.maxMessageSize+" bytes)");return y.apply(p,arguments)}}const d=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const p=d.apply(this,arguments);return l(p,this),p},jT(e,"datachannel",p=>(l(p.channel,p.target),p))}function g4(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const l=e.RTCPeerConnection.prototype;Object.defineProperty(l,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(l,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(d){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),d&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=d)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(d=>{const p=l[d];l[d]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=A=>{const y=A.target;if(y._lastConnectionState!==y.connectionState){y._lastConnectionState=y.connectionState;const g=new Event("connectionstatechange",A);y.dispatchEvent(g)}return A},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),p.apply(this,arguments)}})}function E4(e,l){if(!e.RTCPeerConnection||l.browser==="chrome"&&l.version>=71||l.browser==="safari"&&l.version>=605)return;const d=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(p){if(p&&p.sdp&&p.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const A=p.sdp.split(`
`).filter(y=>ZR(y).call(y)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&p instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:p.type,sdp:A}):p.sdp=A}return d.apply(this,arguments)}}function xL(e,l){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const d=e.RTCPeerConnection.prototype.addIceCandidate;d&&d.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(l.browser==="chrome"&&l.version<78||l.browser==="firefox"&&l.version<68||l.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Y0.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Y0.resolve())})}var nAt=Object.freeze({__proto__:null,shimRTCIceCandidate:PL,shimMaxMessageSize:CO,shimSendThrowTypeError:SO,shimConnectionState:g4,removeExtmapAllowMixed:E4,shimAddIceCandidateNullOrEmpty:xL});let C1,DI;(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const d=JM,p=Cct(e),A={browserDetails:p,commonShim:nAt,extractVersion:lO,disableLog:yct,disableWarnings:bct};switch(p.browser){case"chrome":if(!pH||!l4||!l.shimChrome)return d("Chrome shim is not included in this adapter release."),A;if(p.version===null)return d("Chrome shim can not determine version, not shimming."),A;d("adapter.js shimming chrome."),A.browserShim=pH,xL(e,p),iH(e,p),oH(e),l4(e,p),sH(e),dH(e,p),aH(e),cH(e),uH(e),hH(e,p),PL(e),g4(e),CO(e,p),SO(e),E4(e,p);break;case"firefox":if(!xH||!p4||!l.shimFirefox)return d("Firefox shim is not included in this adapter release."),A;d("adapter.js shimming firefox."),A.browserShim=xH,xL(e,p),SH(e,p),p4(e,p),RH(e),OH(e),TH(e),wH(e),NH(e),kH(e),DH(e),LH(e),PH(e),PL(e),g4(e),CO(e,p),SO(e);break;case"edge":if(!IH||!h4||!l.shimEdge)return d("MS edge shim is not included in this adapter release."),A;d("adapter.js shimming edge."),A.browserShim=IH,EH(e),mH(e),h4(e,p),vH(e),CO(e,p),SO(e);break;case"safari":if(!HH||!l.shimSafari)return d("Safari shim is not included in this adapter release."),A;d("adapter.js shimming safari."),A.browserShim=HH,xL(e,p),QH(e),VH(e),UH(e),BH(e),MH(e),GH(e),jH(e),qH(e),PL(e),CO(e,p),SO(e),E4(e,p);break;default:d("Unsupported browser!")}})({window:typeof window=="undefined"?void 0:window}),function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(C1||(C1={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(DI||(DI={}));var m4={exports:{}};/*!@license
	 * UAParser.js v0.7.28
	 * Lightweight JavaScript-based User-Agent string parser
	 * https://github.com/faisalman/ua-parser-js
	 *
	 * Copyright  2012-2021 Faisal Salman <f@faisalman.com>
	 * Licensed under MIT License
	 */(function(e,l){(function(d,p){var A="function",y="object",g="string",b="model",I="name",k="type",B="vendor",q="version",$="architecture",_t="console",_r="mobile",_i="tablet",ga="smarttv",_u="wearable",ah="embedded",_h={extend:function(D0,j0){var c0={};for(var _m in D0)j0[_m]&&j0[_m].length%2==0?c0[_m]=j0[_m].concat(D0[_m]):c0[_m]=D0[_m];return c0},has:function(D0,j0){return typeof D0===g&&j0.toLowerCase().indexOf(D0.toLowerCase())!==-1},lowerize:function(D0){return D0.toLowerCase()},major:function(D0){return typeof D0===g?D0.replace(/[^\d\.]/g,"").split(".")[0]:p},trim:function(D0,j0){return D0=D0.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),j0===void 0?D0:D0.substring(0,255)}},_A={rgx:function(D0,j0){for(var c0,_m,t0,s0,P0,Rv,e0=0;e0<j0.length&&!P0;){var l0=j0[e0],w0=j0[e0+1];for(c0=_m=0;c0<l0.length&&!P0;)if(P0=l0[c0++].exec(D0))for(t0=0;t0<w0.length;t0++)Rv=P0[++_m],typeof(s0=w0[t0])===y&&s0.length>0?s0.length==2?typeof s0[1]==A?this[s0[0]]=s0[1].call(this,Rv):this[s0[0]]=s0[1]:s0.length==3?typeof s0[1]!==A||s0[1].exec&&s0[1].test?this[s0[0]]=Rv?Rv.replace(s0[1],s0[2]):p:this[s0[0]]=Rv?s0[1].call(this,Rv,s0[2]):p:s0.length==4&&(this[s0[0]]=Rv?s0[3].call(this,Rv.replace(s0[1],s0[2])):p):this[s0]=Rv||p;e0+=2}},str:function(D0,j0){for(var c0 in j0)if(typeof j0[c0]===y&&j0[c0].length>0){for(var _m=0;_m<j0[c0].length;_m++)if(_h.has(j0[c0][_m],D0))return c0==="?"?p:c0}else if(_h.has(j0[c0],D0))return c0==="?"?p:c0;return D0}},n0={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},f0={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[q,[I,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[q,[I,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[I,q],[/opios[\/\s]+([\w\.]+)/i],[q,[I,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[q,[I,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[I,q],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[q,[I,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[q,[I,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[q,[I,"WeChat"]],[/konqueror\/([\w\.]+)/i],[q,[I,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[q,[I,"IE"]],[/yabrowser\/([\w\.]+)/i],[q,[I,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[I,/(.+)/,"$1 Secure Browser"],q],[/focus\/([\w\.]+)/i],[q,[I,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[q,[I,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[q,[I,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[q,[I,"Dolphin"]],[/coast\/([\w\.]+)/i],[q,[I,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[q,[I,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[q,[I,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[I,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[I,/(.+)/,"$1 Browser"],q],[/(comodo_dragon)\/([\w\.]+)/i],[[I,/_/g," "],q],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[I,q],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[I],[/;fbav\/([\w\.]+);/i],[q,[I,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[I,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[I,q],[/\bgsa\/([\w\.]+)\s.*safari\//i],[q,[I,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[q,[I,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[I,"Chrome WebView"],q],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[q,[I,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[I,q],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[q,[I,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[q,I],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[I,[q,_A.str,n0.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[I,q],[/(navigator|netscape)\/([\w\.-]+)/i],[[I,"Netscape"],q],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[q,[I,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[I,q]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[$,"amd64"]],[/(ia32(?=;))/i],[[$,_h.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[$,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[$,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[$,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[$,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[$,/ower/,"",_h.lowerize]],[/(sun4\w)[;\)]/i],[[$,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[$,_h.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[b,[B,"Samsung"],[k,_i]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[b,[B,"Samsung"],[k,_r]],[/\((ip(?:hone|od)[\s\w]*);/i],[b,[B,"Apple"],[k,_r]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[b,[B,"Apple"],[k,_i]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[b,[B,"Huawei"],[k,_i]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[b,[B,"Huawei"],[k,_r]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[b,/_/g," "],[B,"Xiaomi"],[k,_r]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[b,/_/g," "],[B,"Xiaomi"],[k,_i]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[b,[B,"OPPO"],[k,_r]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[b,[B,"Vivo"],[k,_r]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[b,[B,"Realme"],[k,_r]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[b,[B,"Motorola"],[k,_r]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[b,[B,"Motorola"],[k,_i]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[b,[B,"LG"],[k,_i]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[b,[B,"LG"],[k,_r]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[b,[B,"Lenovo"],[k,_i]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[b,/_/g," "],[B,"Nokia"],[k,_r]],[/droid.+;\s(pixel\sc)[\s)]/i],[b,[B,"Google"],[k,_i]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[b,[B,"Google"],[k,_r]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[b,[B,"Sony"],[k,_r]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[b,"Xperia Tablet"],[B,"Sony"],[k,_i]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[b,[B,"OnePlus"],[k,_r]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[b,[B,"Amazon"],[k,_i]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[b,"Fire Phone"],[B,"Amazon"],[k,_r]],[/\((playbook);[\w\s\),;-]+(rim)/i],[b,B,[k,_i]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[b,[B,"BlackBerry"],[k,_r]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[b,[B,"ASUS"],[k,_i]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[b,[B,"ASUS"],[k,_r]],[/(nexus\s9)/i],[b,[B,"HTC"],[k,_i]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[B,[b,/_/g," "],[k,_r]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[b,[B,"Acer"],[k,_i]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[b,[B,"Meizu"],[k,_r]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[B,b,[k,_r]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[B,b,[k,_i]],[/\s(surface\sduo)\s/i],[b,[B,"Microsoft"],[k,_i]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[b,[B,"Fairphone"],[k,_r]],[/\s(u304aa)\sbuild/i],[b,[B,"AT&T"],[k,_r]],[/sie-(\w*)/i],[b,[B,"Siemens"],[k,_r]],[/[;\/]\s?(rct\w+)\sbuild/i],[b,[B,"RCA"],[k,_i]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[b,[B,"Dell"],[k,_i]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[b,[B,"Verizon"],[k,_i]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[b,[B,"Barnes & Noble"],[k,_i]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[b,[B,"NuVision"],[k,_i]],[/;\s(k88)\sbuild/i],[b,[B,"ZTE"],[k,_i]],[/;\s(nx\d{3}j)\sbuild/i],[b,[B,"ZTE"],[k,_r]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[b,[B,"Swiss"],[k,_r]],[/[;\/]\s?(zur\d{3})\sbuild/i],[b,[B,"Swiss"],[k,_i]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[b,[B,"Zeki"],[k,_i]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[B,"Dragon Touch"],b,[k,_i]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[b,[B,"Insignia"],[k,_i]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[b,[B,"NextBook"],[k,_i]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[B,"Voice"],b,[k,_r]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[B,"LvTel"],b,[k,_r]],[/;\s(ph-1)\s/i],[b,[B,"Essential"],[k,_r]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[b,[B,"Envizen"],[k,_i]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[b,[B,"MachSpeed"],[k,_i]],[/[;\/]\s?tu_(1491)\sbuild/i],[b,[B,"Rotor"],[k,_i]],[/(shield[\w\s]+)\sbuild/i],[b,[B,"Nvidia"],[k,_i]],[/(sprint)\s(\w+)/i],[B,b,[k,_r]],[/(kin\.[onetw]{3})/i],[[b,/\./g," "],[B,"Microsoft"],[k,_r]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[b,[B,"Zebra"],[k,_i]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[b,[B,"Zebra"],[k,_r]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[B,b,[k,_t]],[/droid.+;\s(shield)\sbuild/i],[b,[B,"Nvidia"],[k,_t]],[/(playstation\s[345portablevi]+)/i],[b,[B,"Sony"],[k,_t]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[b,[B,"Microsoft"],[k,_t]],[/smart-tv.+(samsung)/i],[B,[k,ga]],[/hbbtv.+maple;(\d+)/i],[[b,/^/,"SmartTV"],[B,"Samsung"],[k,ga]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[B,"LG"],[k,ga]],[/(apple)\s?tv/i],[B,[b,"Apple TV"],[k,ga]],[/crkey/i],[[b,"Chromecast"],[B,"Google"],[k,ga]],[/droid.+aft([\w])(\sbuild\/|\))/i],[b,[B,"Amazon"],[k,ga]],[/\(dtv[\);].+(aquos)/i],[b,[B,"Sharp"],[k,ga]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[B,_h.trim],[b,_h.trim],[k,ga]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[k,ga]],[/((pebble))app\/[\d\.]+\s/i],[B,b,[k,_u]],[/droid.+;\s(glass)\s\d/i],[b,[B,"Google"],[k,_u]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[b,[B,"Zebra"],[k,_u]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[B,[k,ah]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[b,[k,_r]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[b,[k,_i]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[k,_h.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[b,[B,"Generic"]],[/(phone)/i],[[k,_r]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[q,[I,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[q,[I,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[I,q],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[q,I]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[I,q],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[I,[q,_A.str,n0.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[I,"Windows"],[q,_A.str,n0.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[q,/_/g,"."],[I,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[I,"Mac OS"],[q,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[I,q],[/\(bb(10);/i],[q,[I,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[q,[I,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[I,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[q,[I,"webOS"]],[/crkey\/([\d\.]+)/i],[q,[I,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[I,"Chromium OS"],q],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[I,q],[/(sunos)\s?([\w\.\d]*)/i],[[I,"Solaris"],q],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[I,q]]},E0=function(D0,j0){if(typeof D0=="object"&&(j0=D0,D0=p),!(this instanceof E0))return new E0(D0,j0).getResult();var c0=D0||(d!==void 0&&d.navigator&&d.navigator.userAgent?d.navigator.userAgent:""),_m=j0?_h.extend(f0,j0):f0;return this.getBrowser=function(){var t0={name:p,version:p};return _A.rgx.call(t0,c0,_m.browser),t0.major=_h.major(t0.version),t0},this.getCPU=function(){var t0={architecture:p};return _A.rgx.call(t0,c0,_m.cpu),t0},this.getDevice=function(){var t0={vendor:p,model:p,type:p};return _A.rgx.call(t0,c0,_m.device),t0},this.getEngine=function(){var t0={name:p,version:p};return _A.rgx.call(t0,c0,_m.engine),t0},this.getOS=function(){var t0={name:p,version:p};return _A.rgx.call(t0,c0,_m.os),t0},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return c0},this.setUA=function(t0){return c0=typeof t0===g&&t0.length>255?_h.trim(t0,255):t0,this},this.setUA(c0),this};E0.VERSION="0.7.28",E0.BROWSER={NAME:I,MAJOR:"major",VERSION:q},E0.CPU={ARCHITECTURE:$},E0.DEVICE={MODEL:b,VENDOR:B,TYPE:k,CONSOLE:_t,MOBILE:_r,SMARTTV:ga,TABLET:_i,WEARABLE:_u,EMBEDDED:ah},E0.ENGINE={NAME:I,VERSION:q},E0.OS={NAME:I,VERSION:q},e.exports&&(l=e.exports=E0),l.UAParser=E0;var m0=d!==void 0&&(d.jQuery||d.Zepto);if(m0&&!m0.ua){var V0=new E0;m0.ua=V0.getResult(),m0.ua.get=function(){return V0.getUA()},m0.ua.set=function(D0){V0.setUA(D0);var j0=V0.getResult();for(var c0 in j0)m0.ua[c0]=j0[c0]}}})(typeof window=="object"?window:s)})(m4,m4.exports);const v4=new m4.exports;let GS=v4.getResult();function MI(e){return e&&v4.setUA(e),GS=v4.getResult(),{name:rAt(GS),version:iAt(GS),os:oAt(GS),osVersion:GS.os.version}}function rAt(e){if(e.engine.name==="Blink"&&e.browser.name!=="WeChat")return DI.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return DI.CHROME;case"Safari":case"Mobile Safari":return DI.SAFARI;case"Edge":return DI.EDGE;case"Firefox":return DI.FIREFOX;case"QQBrowser":return DI.QQ;case"Opera":return DI.OPERA;case"WeChat":return DI.WECHAT;default:return e.browser.name||""}}function iAt(e){let l;return l=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",l.split(".")[0]}function oAt(e){switch(e.os.name){case"Windows":return e.os.version?e.os.name+" "+e.os.version:e.os.name;default:return e.os.name||""}}function JH(){return MI().os}function BL(){const e=MI();return!!(GS.engine.name==="WebKit"&&e.os===C1.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==DI.SAFARI||h_()&&e.name!==DI.SAFARI)}function sAt(){const e=MI();if(BL()){if(e.os===C1.MAC_OS)return!0;if(e.os===C1.IOS){const l=GS.os.version&&GS.os.version.split(".");if(l&&Number(l[0])===14&&l[1]&&Number(l[1])>=3||l&&Number(l[0])>14)return!0}}return!1}function aAt(){return GS.engine.name==="WebKit"}function I4(){return MI().name===DI.CHROME}function y_(){return MI().name===DI.SAFARI}function d_(){return MI().name===DI.FIREFOX}function h_(){return MI().os===C1.IOS}function zH(){const e=MI();if(e.os!==C1.IOS||!e.osVersion)return!1;const l=e.osVersion.split(".");return Number(l[0])===13}function t2(){const e=MI();if(e.os!==C1.IOS||!e.osVersion)return!1;const l=e.osVersion.split(".");return Number(l[0])===15}function XH(){const e=MI();if(e.os!==C1.IOS||!e.osVersion)return!1;const l=e.osVersion.split(".");return Number(l[0])===15&&Number(l[1])===0}function ZH(){const e=MI();if(e.os!==C1.IOS||!e.osVersion)return!1;const l=e.osVersion.split(".");return Number(l[0])===15&&Number(l[1])>=1}function _4(){const e=MI();if(e.os!==C1.IOS||!e.osVersion)return!1;const l=e.osVersion.split(".");return Number(l[0])===15&&Number(l[1])>=2}function VS(){return y_()&&navigator.maxTouchPoints>0}function $H(){return MI().name===DI.WECHAT}function tK(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function e2(){const e=MI();return e.name===DI.EDGE||e.name===DI.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function eK(){return MI().os===C1.ANDROID}var nK={exports:{}},cAt=M1,uAt=$_,rK=uS.f;cAt({target:"Object",stat:!0,forced:Object.defineProperty!==rK,sham:!uAt},{defineProperty:rK});var iK=xS.Object,lAt=nK.exports=function(e,l,d){return iK.defineProperty(e,l,d)};iK.defineProperty.sham&&(lAt.sham=!0);var oK=nK.exports;function _s(e,l,d){return l in e?oK(e,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):e[l]=d,e}var y4={exports:{}},sK=function(e,l){return function(){for(var d=new Array(arguments.length),p=0;p<d.length;p++)d[p]=arguments[p];return e.apply(l,d)}},dAt=sK,hAt=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)},n2=Object.prototype.toString;function aK(e){return n2.call(e)==="[object Array]"}function cK(e){return e!==null&&typeof e=="object"}function uK(e){return n2.call(e)==="[object Function]"}function ML(e,l){if(e!=null)if(typeof e!="object"&&(e=[e]),aK(e))for(var d=0,p=e.length;d<p;d++)l.call(null,e[d],d,e);else for(var A in e)Object.prototype.hasOwnProperty.call(e,A)&&l.call(null,e[A],A,e)}var F_={isArray:aK,isArrayBuffer:function(e){return n2.call(e)==="[object ArrayBuffer]"},isBuffer:hAt,isFormData:function(e){return typeof FormData!="undefined"&&e instanceof FormData},isArrayBufferView:function(e){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return typeof e=="string"},isNumber:function(e){return typeof e=="number"},isObject:cK,isUndefined:function(e){return e===void 0},isDate:function(e){return n2.call(e)==="[object Date]"},isFile:function(e){return n2.call(e)==="[object File]"},isBlob:function(e){return n2.call(e)==="[object Blob]"},isFunction:uK,isStream:function(e){return cK(e)&&uK(e.pipe)},isURLSearchParams:function(e){return typeof URLSearchParams!="undefined"&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return(typeof navigator=="undefined"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window!="undefined"&&typeof document!="undefined"},forEach:ML,merge:function e(){var l={};function d(y,g){typeof l[g]=="object"&&typeof y=="object"?l[g]=e(l[g],y):l[g]=y}for(var p=0,A=arguments.length;p<A;p++)ML(arguments[p],d);return l},deepMerge:function e(){var l={};function d(y,g){typeof l[g]=="object"&&typeof y=="object"?l[g]=e(l[g],y):l[g]=typeof y=="object"?e({},y):y}for(var p=0,A=arguments.length;p<A;p++)ML(arguments[p],d);return l},extend:function(e,l,d){return ML(l,function(p,A){e[A]=d&&typeof p=="function"?dAt(p,d):p}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}},r2=F_;function lK(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var dK=function(e,l,d){if(!l)return e;var p;if(d)p=d(l);else if(r2.isURLSearchParams(l))p=l.toString();else{var A=[];r2.forEach(l,function(g,b){g!=null&&(r2.isArray(g)?b+="[]":g=[g],r2.forEach(g,function(I){r2.isDate(I)?I=I.toISOString():r2.isObject(I)&&(I=JSON.stringify(I)),A.push(lK(b)+"="+lK(I))}))}),p=A.join("&")}if(p){var y=e.indexOf("#");y!==-1&&(e=e.slice(0,y)),e+=(e.indexOf("?")===-1?"?":"&")+p}return e},pAt=F_;function UL(){this.handlers=[]}UL.prototype.use=function(e,l){return this.handlers.push({fulfilled:e,rejected:l}),this.handlers.length-1},UL.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},UL.prototype.forEach=function(e){pAt.forEach(this.handlers,function(l){l!==null&&e(l)})};var fAt=UL,AAt=F_,hK=function(e){return!(!e||!e.__CANCEL__)},gAt=F_,EAt=function(e,l,d,p,A){return e.config=l,d&&(e.code=d),e.request=p,e.response=A,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},pK=function(e,l,d,p,A){var y=new Error(e);return EAt(y,l,d,p,A)},mAt=pK,b4=F_,vAt=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],fK=F_,IAt=fK.isStandardBrowserEnv()?function(){var e,l=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a");function p(A){var y=A;return l&&(d.setAttribute("href",y),y=d.href),d.setAttribute("href",y),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return e=p(window.location.href),function(A){var y=fK.isString(A)?p(A):A;return y.protocol===e.protocol&&y.host===e.host}}():function(){return!0},jL=F_,_At=jL.isStandardBrowserEnv()?{write:function(e,l,d,p,A,y){var g=[];g.push(e+"="+encodeURIComponent(l)),jL.isNumber(d)&&g.push("expires="+new Date(d).toGMTString()),jL.isString(p)&&g.push("path="+p),jL.isString(A)&&g.push("domain="+A),y===!0&&g.push("secure"),document.cookie=g.join("; ")},read:function(e){var l=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return l?decodeURIComponent(l[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},C4=F_,yAt=function(e,l,d){var p=d.config.validateStatus;!p||p(d.status)?e(d):l(mAt("Request failed with status code "+d.status,d.config,null,d.request,d))},bAt=dK,CAt=function(e){var l,d,p,A={};return e&&b4.forEach(e.split(`
`),function(y){if(p=y.indexOf(":"),l=b4.trim(y.substr(0,p)).toLowerCase(),d=b4.trim(y.substr(p+1)),l){if(A[l]&&vAt.indexOf(l)>=0)return;A[l]=l==="set-cookie"?(A[l]?A[l]:[]).concat([d]):A[l]?A[l]+", "+d:d}}),A},SAt=IAt,S4=pK,RAt=function(e){return new Promise(function(l,d){var p=e.data,A=e.headers;C4.isFormData(p)&&delete A["Content-Type"];var y=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",b=e.auth.password||"";A.Authorization="Basic "+btoa(g+":"+b)}if(y.open(e.method.toUpperCase(),bAt(e.url,e.params,e.paramsSerializer),!0),y.timeout=e.timeout,y.onreadystatechange=function(){if(y&&y.readyState===4&&(y.status!==0||y.responseURL&&y.responseURL.indexOf("file:")===0)){var B="getAllResponseHeaders"in y?CAt(y.getAllResponseHeaders()):null,q={data:e.responseType&&e.responseType!=="text"?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:B,config:e,request:y};yAt(l,d,q),y=null}},y.onabort=function(){y&&(d(S4("Request aborted",e,"ECONNABORTED",y)),y=null)},y.onerror=function(){d(S4("Network Error",e,null,y)),y=null},y.ontimeout=function(){d(S4("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",y)),y=null},C4.isStandardBrowserEnv()){var I=_At,k=(e.withCredentials||SAt(e.url))&&e.xsrfCookieName?I.read(e.xsrfCookieName):void 0;k&&(A[e.xsrfHeaderName]=k)}if("setRequestHeader"in y&&C4.forEach(A,function(B,q){p===void 0&&q.toLowerCase()==="content-type"?delete A[q]:y.setRequestHeader(q,B)}),e.withCredentials&&(y.withCredentials=!0),e.responseType)try{y.responseType=e.responseType}catch(B){if(e.responseType!=="json")throw B}typeof e.onDownloadProgress=="function"&&y.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&y.upload&&y.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(B){y&&(y.abort(),d(B),y=null)}),p===void 0&&(p=null),y.send(p)})},b_=F_,AK=function(e,l){gAt.forEach(e,function(d,p){p!==l&&p.toUpperCase()===l.toUpperCase()&&(e[l]=d,delete e[p])})},TAt={"Content-Type":"application/x-www-form-urlencoded"};function gK(e,l){!b_.isUndefined(e)&&b_.isUndefined(e["Content-Type"])&&(e["Content-Type"]=l)}var EK,FL={adapter:((typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]"||typeof XMLHttpRequest!="undefined")&&(EK=RAt),EK),transformRequest:[function(e,l){return AK(l,"Accept"),AK(l,"Content-Type"),b_.isFormData(e)||b_.isArrayBuffer(e)||b_.isBuffer(e)||b_.isStream(e)||b_.isFile(e)||b_.isBlob(e)?e:b_.isArrayBufferView(e)?e.buffer:b_.isURLSearchParams(e)?(gK(l,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):b_.isObject(e)?(gK(l,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if(typeof e=="string")try{e=JSON.parse(e)}catch{}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};FL.headers={common:{Accept:"application/json, text/plain, */*"}},b_.forEach(["delete","get","head"],function(e){FL.headers[e]={}}),b_.forEach(["post","put","patch"],function(e){FL.headers[e]=b_.merge(TAt)});var mK=FL,vK=F_,R4=function(e,l,d){return AAt.forEach(d,function(p){e=p(e,l)}),e},wAt=hK,OAt=mK,NAt=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},kAt=function(e,l){return l?e.replace(/\/+$/,"")+"/"+l.replace(/^\/+/,""):e};function T4(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var $R=F_,IK=function(e,l){l=l||{};var d={};return $R.forEach(["url","method","params","data"],function(p){l[p]!==void 0&&(d[p]=l[p])}),$R.forEach(["headers","auth","proxy"],function(p){$R.isObject(l[p])?d[p]=$R.deepMerge(e[p],l[p]):l[p]!==void 0?d[p]=l[p]:$R.isObject(e[p])?d[p]=$R.deepMerge(e[p]):e[p]!==void 0&&(d[p]=e[p])}),$R.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(p){l[p]!==void 0?d[p]=l[p]:e[p]!==void 0&&(d[p]=e[p])}),d},QL=F_,DAt=dK,_K=fAt,LAt=function(e){return T4(e),e.baseURL&&!NAt(e.url)&&(e.url=kAt(e.baseURL,e.url)),e.headers=e.headers||{},e.data=R4(e.data,e.headers,e.transformRequest),e.headers=vK.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),vK.forEach(["delete","get","head","post","put","patch","common"],function(l){delete e.headers[l]}),(e.adapter||OAt.adapter)(e).then(function(l){return T4(e),l.data=R4(l.data,l.headers,e.transformResponse),l},function(l){return wAt(l)||(T4(e),l&&l.response&&(l.response.data=R4(l.response.data,l.response.headers,e.transformResponse))),Promise.reject(l)})},yK=IK;function RO(e){this.defaults=e,this.interceptors={request:new _K,response:new _K}}RO.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=yK(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var l=[LAt,void 0],d=Promise.resolve(e);for(this.interceptors.request.forEach(function(p){l.unshift(p.fulfilled,p.rejected)}),this.interceptors.response.forEach(function(p){l.push(p.fulfilled,p.rejected)});l.length;)d=d.then(l.shift(),l.shift());return d},RO.prototype.getUri=function(e){return e=yK(this.defaults,e),DAt(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},QL.forEach(["delete","get","head","options"],function(e){RO.prototype[e]=function(l,d){return this.request(QL.merge(d||{},{method:e,url:l}))}}),QL.forEach(["post","put","patch"],function(e){RO.prototype[e]=function(l,d,p){return this.request(QL.merge(p||{},{method:e,url:l,data:d}))}});var PAt=RO;function w4(e){this.message=e}w4.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},w4.prototype.__CANCEL__=!0;var bK=w4,xAt=bK;function GL(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var l;this.promise=new Promise(function(p){l=p});var d=this;e(function(p){d.reason||(d.reason=new xAt(p),l(d.reason))})}GL.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},GL.source=function(){var e;return{token:new GL(function(l){e=l}),cancel:e}};var BAt=GL,CK=F_,MAt=sK,VL=PAt,UAt=IK;function SK(e){var l=new VL(e),d=MAt(VL.prototype.request,l);return CK.extend(d,VL.prototype,l),CK.extend(d,l),d}var SS=SK(mK);SS.Axios=VL,SS.create=function(e){return SK(UAt(SS.defaults,e))},SS.Cancel=bK,SS.CancelToken=BAt,SS.isCancel=hK,SS.all=function(e){return Promise.all(e)},SS.spread=function(e){return function(l){return e.apply(null,l)}},y4.exports=SS,y4.exports.default=SS;var lS=y4.exports;class jAt{constructor(l){_s(this,"logger",void 0),_s(this,"prefixLists",[]),this.logger=l}debug(){for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];this.logger.debug(...this.prefixLists,...d)}info(){for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];this.logger.info(...this.prefixLists,...d)}warning(){for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];this.logger.warning(...this.prefixLists,...d)}error(){for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];this.logger.error(...this.prefixLists,...d)}prefix(l){return this.prefixLists.push(l),this}popPrefix(){return this.prefixLists.pop(),this}}class e1{constructor(){_s(this,"_events",{}),_s(this,"addListener",this.on)}getListeners(l){return this._events[l]?this._events[l].map(d=>d.listener):[]}on(l,d){this._events[l]||(this._events[l]=[]);const p=this._events[l];this._indexOfListener(p,d)===-1&&p.push({listener:d,once:!1})}once(l,d){this._events[l]||(this._events[l]=[]);const p=this._events[l];this._indexOfListener(p,d)===-1&&p.push({listener:d,once:!0})}off(l,d){if(!this._events[l])return;const p=this._events[l],A=this._indexOfListener(p,d);A!==-1&&p.splice(A,1),this._events[l].length===0&&delete this._events[l]}removeAllListeners(l){l?delete this._events[l]:this._events={}}emit(l){this._events[l]||(this._events[l]=[]);const d=this._events[l].map(g=>g);for(var p=arguments.length,A=new Array(p>1?p-1:0),y=1;y<p;y++)A[y-1]=arguments[y];for(let g=0;g<d.length;g+=1){const b=d[g];b.once&&this.off(l,b.listener),b.listener.apply(this,A||[])}}_indexOfListener(l,d){let p=l.length;for(;p--;)if(l[p].listener===d)return p;return-1}}const qL=new class extends e1{reportLogUploadError(e){this.emit("REPORT_LOG_UPLOAD",e)}};let _f;(function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT"})(_f||(_f={}));class _E extends Error{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",p=arguments.length>2?arguments[2]:void 0;super(d),_s(this,"code",void 0),_s(this,"message",void 0),_s(this,"data",void 0),_s(this,"name","AgoraRTCException"),this.code=l,this.message="AgoraRTCError ".concat(this.code,": ").concat(d),this.data=p}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return l==="error"&&_a.error(this.toString()),l==="warning"&&_a.warning(this.toString()),this}throw(){throw this.print(),this}}const a1={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function O4(e,l){const d=Math.floor(l.timeout*Math.pow(l.timeoutFactor,e));return Math.min(l.maxRetryTimeout,d)}function Q_(e,l,d,p){const A=Object.assign({},a1,p);let y=A.timeout;const g=async()=>{await function(k){return new Y0(B=>{window.setTimeout(B,k)})}(y),y*=A.timeoutFactor,y=Math.min(A.maxRetryTimeout,y)};let b=!1;const I=new Y0(async(k,B)=>{l=l||(()=>!1),d=d||(()=>!0);for(let q=0;q<A.maxRetryCount;q+=1){if(b)return B(new _E(_f.OPERATION_ABORTED));try{const $=await e();if(!l($,q)||q+1===A.maxRetryCount)return k($);await g()}catch($){if(!d($,q)||q+1===A.maxRetryCount)return B($);await g()}}});return I.cancel=()=>b=!0,I}function N4(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const G_={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},HL=Date.now(),k4=e=>{for(const l in G_)if(Object.prototype.hasOwnProperty.call(G_,l)&&G_[l]===e)return l;return"DEFAULT"},_a=new class{constructor(){_s(this,"proxyServerURL",void 0),_s(this,"logLevel",G_.DEBUG),_s(this,"uploadState","collecting"),_s(this,"uploadLogWaitingList",[]),_s(this,"uploadLogUploadingList",[]),_s(this,"uploadErrorCount",0),_s(this,"currentLogID",0),_s(this,"url",void 0),_s(this,"extLog",(e,l)=>{this.appendLogToWaitingList(e,l)})}debug(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];const p=[G_.DEBUG].concat(l);this.log.apply(this,p)}info(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];const p=[G_.INFO].concat(l);this.log.apply(this,p)}warning(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];const p=[G_.WARNING].concat(l);this.log.apply(this,p)}error(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];const p=[G_.ERROR].concat(l);this.log.apply(this,p)}upload(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];const p=[G_.DEBUG].concat(l);this.uploadLog.apply(this,p)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){H1("UPLOAD_LOG",!0)}disableLogUpload(){H1("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new jAt(this).prefix(e)}log(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];if(Date.now()-HL<100)return void setTimeout(()=>{this.log(...l)},Date.now()-HL);const p=Math.max(0,Math.min(4,l[0]));if(l[0]=N4()+" Agora-SDK [".concat(k4(p),"]:"),this.appendLogToWaitingList(p,l),p<this.logLevel)return;const A=N4()+" %cAgora-SDK [".concat(k4(p),"]:");let y=[];if(!y0("USE_NEW_LOG"))switch(p){case G_.DEBUG:y=[A,"color: #64B5F6;"].concat(l.slice(1)),console.log.apply(console,y);break;case G_.INFO:y=[A,"color: #1E88E5; font-weight: bold;"].concat(l.slice(1)),console.log.apply(console,y);break;case G_.WARNING:y=[A,"color: #FB8C00; font-weight: bold;"].concat(l.slice(1)),console.warn.apply(console,y);break;case G_.ERROR:y=[A,"color: #B00020; font-weight: bold;"].concat(l.slice(1)),console.error.apply(console,y)}}uploadLog(){for(var e=arguments.length,l=new Array(e),d=0;d<e;d++)l[d]=arguments[d];if(Date.now()-HL<100)return void setTimeout(()=>{this.uploadLog(...l)},Date.now()-HL);const p=Math.max(0,Math.min(4,l[0]));l[0]=N4()+" Agora-SDK [".concat(k4(p),"]:"),this.appendLogToWaitingList(p,l)}appendLogToWaitingList(e){if(!y0("UPLOAD_LOG"))return;let l="";for(var d=arguments.length,p=new Array(d>1?d-1:0),A=1;A<d;A++)p[A-1]=arguments[A];p.forEach(y=>{typeof y=="object"&&(y=JSON.stringify(y)),l+="".concat(y," ")}),this.uploadLogWaitingList.push({payload_str:l,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,l={sdk_version:s_,process_id:y0("PROCESS_ID"),payload:JSON.stringify(e)};return Q_(async()=>{const d=await lS.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(y0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(y0("LOG_UPLOAD_SERVER"),"/upload/v1")),l,{responseType:"text"});if(d.data!=="OK"){const p=new Error("unexpected upload log response");throw p.response=d,p}},()=>(this.uploadLogUploadingList=[],!1),d=>(d.response?qL.reportLogUploadError({status:d.response.status,data:d.response.data,headers:d.response.headers,message:d.message}):d.request?qL.reportLogUploadError({status:d.request.status,message:d.message}):qL.reportLogUploadError({status:-1,message:d.message}),!0),{timeout:2e3,maxRetryTimeout:2e4})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,10)),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),3e3)}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),200):window.setTimeout(()=>this.uploadLogInterval(),1e3)}))}},KL={debug:console.log,info:console.log,warning:console.warn,error:console.error},YL={debug:"color: #64B5F6;",info:"color: #1E88E5; font-weight: bold;",warning:"color: #FB8C00; font-weight: bold;",error:"color: #B00020; font-weight: bold;"},FAt={debug:0,info:1,warning:2,error:3},WL=[];let D4,RK=0,TK=0,wK=!1;function JL(){const e=new Date;return[e.getTime(),e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()]}function zL(e){if(!y0("UPLOAD_LOG"))return;let l;switch(e.type){case UI.MISC:l=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.msg]];break;case UI.INTERNAL_EVENT:case UI.PUBLIC_EVENT:case UI.WEB_EVENT:l=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.event,e.msg]];break;case UI.INTERNAL_API:case UI.PUBLIC_API:case UI.WEB_API:l=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.api,e.args,e.result]]}WL.push(l)}function OK(e,l){const[d,p]=JL(),A="warning",y="".concat(p," %cAgora-SDK [").concat(A,"] [INTERNAL API]:"),g={[UI.WEB_API]:"logWebAPI",[UI.PUBLIC_API]:"logPublicAPI",[UI.INTERNAL_API]:"logInternalAPI",[UI.WEB_EVENT]:"logWebEvent",[UI.PUBLIC_EVENT]:"logPublicEvent",[UI.INTERNAL_EVENT]:"logInternalEvent",[UI.MISC]:"logMisc"}[e],b=[y,YL.warning,"Log.".concat(g),l];y0("USE_NEW_LOG")&&(XL(A)&&KL.warning.apply(console,b),zL({timestamp:d,level:A,module:"Log",instanceId:void 0,type:UI.INTERNAL_API,api:g,args:void 0,result:l.toString()}))}function L4(e){if(Array.isArray(e)){let[p,A]=e;return p||(p="Global"),{module:p,instanceId:A}}let l,d;if(typeof e.__moduleName!="string")throw new Error("Cannot get __moduleName from log instance.");l=e.__moduleName;try{d=e.__instanceId}catch{throw new Error("Cannot get __instanceId from log instance.")}return{module:l,instanceId:d}}function XL(e){return FAt[e]>=TK}function P4(e,l,d,p,A,y){if(e===UI.PUBLIC_API||e===UI.WEB_API||e===UI.INTERNAL_API)try{const{module:g,instanceId:b}=L4(d);A=A&&JSON.stringify(A),y=y instanceof Error?y.toString():y&&JSON.stringify(y);const[I,k]=JL(),B=["".concat(k," %cAgora-SDK [").concat(l,"] [").concat({[UI.PUBLIC_API]:"PUBLIC API",[UI.WEB_API]:"WEB API",[UI.INTERNAL_API]:"INTERNAL API"}[e],"]:"),YL[l],"".concat(g).concat(b?"<".concat(b,">"):"",".").concat(p),A,y];y0("USE_NEW_LOG")&&(XL(l)&&KL[l].apply(console,B),zL({timestamp:I,level:l,module:g,instanceId:b,type:e,api:p,args:A,result:y}))}catch(g){OK(e,g)}}function x4(e,l,d,p,A){if(e===UI.WEB_EVENT||e===UI.INTERNAL_EVENT||e===UI.PUBLIC_EVENT)try{const{module:y,instanceId:g}=L4(d);typeof A!="string"&&(A=A instanceof Error?A.toString():JSON.stringify(A));const[b,I]=JL(),k=["".concat(I," %cAgora-SDK [").concat(l,"] [").concat({[UI.WEB_EVENT]:"WEB EVENT",[UI.PUBLIC_EVENT]:"PUBLIC EVENT",[UI.INTERNAL_EVENT]:"INTERNAL EVENT"}[e],"]:"),YL[l],"".concat(y).concat(g?"<".concat(g,">"):"",".on(").concat(p,")"),A||""];y0("USE_NEW_LOG")&&(XL(l)&&KL[l].apply(console,k),zL({timestamp:b,level:l,module:y,instanceId:g,type:e,event:p,msg:A}))}catch(y){OK(e,y)}}function tT(e){D4=e}function H0(e,l,d){try{const{module:p,instanceId:A}=L4(l),[y,g]=JL(),b=["".concat(g," %cAgora-SDK [").concat(e,"] [MISC]:"),YL[e],"".concat(p).concat(A?"<".concat(A,">"):""),'"'.concat(d,'"')];y0("USE_NEW_LOG")&&(XL(e)&&KL[e].apply(console,b),zL({timestamp:y,level:e,module:p,instanceId:A,type:UI.MISC,msg:d}))}catch(p){b0("warning",["log"],"logMisc",void 0,p)}}function VI(e,l,d,p){x4(UI.INTERNAL_EVENT,e,l,d,p)}function V_(e,l,d,p){x4(UI.PUBLIC_EVENT,e,l,d,p)}function qS(e,l,d,p){x4(UI.WEB_EVENT,e,l,d,p)}function b0(e,l,d,p,A){P4(UI.INTERNAL_API,e,l,d,p,A)}function i2(e,l,d,p,A){P4(UI.WEB_API,e,l,d,p,A)}function Z0(e,l,d,p,A){P4(UI.PUBLIC_API,e,l,d,p,A)}function U1(e,l){return function(d){return class extends d{get __moduleName(){return e}get __instanceId(){if(l){if(typeof this[l]=="function")return this[l]();{const p=l.split(".");return p.length>0?VR(p).call(p,(A,y)=>{try{return A&&A[y]}catch{return}},this):this[l]}}}}}}async function ZL(e){if(!e&&wK)return;if(wK=!0,!y0("UPLOAD_LOG"))return void setTimeout(()=>ZL(!0),5e3);if(WL.length===0)return void setTimeout(()=>ZL(!0),3e3);const l=WL.slice(0,10),d={sdk_version:s_,log_version:y0("LOG_VERSION"),process_id:y0("PROCESS_ID"),index:RK,logs:JSON.stringify(l)};await Q_(async()=>{const p=await lS.post(D4?"https://".concat(D4,"/ls/?h=").concat(y0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(y0("LOG_UPLOAD_SERVER"),"/upload/v1"),d,{responseType:"text"});if(p.data!=="OK")throw new Error("Log service response error ".concat(p.data));return p},void 0,void 0,{timeout:3e3,maxRetryTimeout:1e4}),WL.splice(0,10),RK+=l.length,setTimeout(()=>ZL(!0),3e3)}const $L="v4.11.1-0-gcd0777ab(5/9/2022, 6:52:38 PM)",s_=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const l=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(l&&l[1]&&l[2]){const p=l[1],A=l[2];return"".concat(p,".").concat(A)}const d=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(d&&d[1]&&d[2]){const p=d[1],A=d[2];return"".concat(p,".").concat(100*(Number(A)+1))}return"4.0.0.999"}("4.11.1"),B4=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),p1={username:"test",password:"111111",turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1},QAt={"90p":gI(160,90),"90p_1":gI(160,90),"120p":gI(160,120,15,30,65),"120p_1":gI(160,120,15,30,65),"120p_3":gI(120,120,15,30,50),"120p_4":gI(212,120),"180p":gI(320,180,15,30,140),"180p_1":gI(320,180,15,30,140),"180p_3":gI(180,180,15,30,100),"180p_4":gI(240,180,15,30,120),"240p":gI(320,240,15,40,200),"240p_1":gI(320,240,15,40,200),"240p_3":gI(240,240,15,40,140),"240p_4":gI(424,240,15,40,220),"360p":gI(640,360,15,80,400),"360p_1":gI(640,360,15,80,400),"360p_3":gI(360,360,15,80,260),"360p_4":gI(640,360,30,80,600),"360p_6":gI(360,360,30,80,400),"360p_7":gI(480,360,15,80,320),"360p_8":gI(480,360,30,80,490),"360p_9":gI(640,360,15,80,800),"360p_10":gI(640,360,24,80,800),"360p_11":gI(640,360,24,80,1e3),"480p":gI(640,480,15,100,500),"480p_1":gI(640,480,15,100,500),"480p_2":gI(640,480,30,100,1e3),"480p_3":gI(480,480,15,100,400),"480p_4":gI(640,480,30,100,750),"480p_6":gI(480,480,30,100,600),"480p_8":gI(848,480,15,100,610),"480p_9":gI(848,480,30,100,930),"480p_10":gI(640,480,10,100,400),"720p":gI(1280,720,15,120,1130),"720p_1":gI(1280,720,15,120,1130),"720p_2":gI(1280,720,30,120,2e3),"720p_3":gI(1280,720,30,120,1710),"720p_5":gI(960,720,15,120,910),"720p_6":gI(960,720,30,120,1380),"1080p":gI(1920,1080,15,120,2080),"1080p_1":gI(1920,1080,15,120,2080),"1080p_2":gI(1920,1080,30,120,3e3),"1080p_3":gI(1920,1080,30,120,3150),"1080p_5":gI(1920,1080,60,120,4780),"1440p":gI(2560,1440,30,120,4850),"1440p_1":gI(2560,1440,30,120,4850),"1440p_2":gI(2560,1440,60,120,7350),"4k":gI(3840,2160,30,120,8910),"4k_1":gI(3840,2160,30,120,8910),"4k_3":gI(3840,2160,60,120,13500)},GAt={"480p":_y(640,480,5),"480p_1":_y(640,480,5),"480p_2":_y(640,480,30),"480p_3":_y(640,480,15),"720p":_y(1280,720,5),"720p_1":_y(1280,720,5),"720p_2":_y(1280,720,30),"720p_3":_y(1280,720,15),"1080p":_y(1920,1080,5),"1080p_1":_y(1920,1080,5),"1080p_2":_y(1920,1080,30),"1080p_3":_y(1920,1080,15)},VAt={"1SL1TL":j4(1,1),"3SL3TL":j4(3,3),"2SL3TL":j4(2,3)};function o2(e){return typeof e=="string"?Object.assign({},QAt[e]):e}function M4(e){return typeof e=="string"?Object.assign({},GAt[e]):e}function tP(e){return typeof e=="string"?Object.assign({},VAt[e]):e}const qAt={speech_low_quality:s2(16e3,!1),speech_standard:s2(32e3,!1,18),music_standard:s2(48e3,!1),standard_stereo:s2(48e3,!0,56),high_quality:s2(48e3,!1,128),high_quality_stereo:s2(48e3,!0,192)};function eP(e){return typeof e=="string"?Object.assign({},qAt[e]):e}function H1(e,l,d){Object.keys(a_).includes(e)&&(!d&&Object.keys(U4).includes(e)||(a_[e]=l))}function y0(e){return a_[e]}const a_={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},STATS_COLLECTOR_PORT:443},U4={};function s2(e,l,d){return{sampleRate:e,stereo:l,bitrate:d}}function gI(e,l,d,p,A){return{width:e,height:l,frameRate:d,bitrateMin:p,bitrateMax:A}}function _y(e,l,d,p,A){return{width:{max:e},height:{max:l},frameRate:d,bitrateMin:p,bitrateMax:A}}function j4(e,l){return{numSpatialLayers:e,numTemporalLayers:l}}B4||(a_.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],a_.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],a_.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],a_.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],a_.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],a_.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],a_.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",a_.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",a_.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",a_.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",a_.AREAS=["NORTH_AMERICA","OVERSEA"]);const HAt=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],a2=[],TO=[];var KAt=xN,YAt=uS,WAt=cR,nP=function(e,l,d){var p=KAt(l);p in e?YAt.f(e,p,WAt(0,d)):e[p]=d},NK=ZM,JAt=MS,zAt=nP,XAt=II.Array,ZAt=Math.max,F4=function(e,l,d){for(var p=JAt(e),A=NK(l,p),y=NK(d===void 0?p:d,p),g=XAt(ZAt(y-A,0)),b=0;A<y;A++,b++)zAt(g,b,e[A]);return g.length=b,g},kK=F4,$At=Math.floor,Q4=function(e,l){var d=e.length,p=$At(d/2);return d<8?tgt(e,l):egt(e,Q4(kK(e,0,p),l),Q4(kK(e,p),l),l)},tgt=function(e,l){for(var d,p,A=e.length,y=1;y<A;){for(p=y,d=e[y];p&&l(e[p-1],d)>0;)e[p]=e[--p];p!==y++&&(e[p]=d)}return e},egt=function(e,l,d,p){for(var A=l.length,y=d.length,g=0,b=0;g<A||b<y;)e[g+b]=g<A&&b<y?p(l[g],d[b])<=0?l[g++]:d[b++]:g<A?l[g++]:d[b++];return e},DK=Q4,LK=FR.match(/firefox\/(\d+)/i),ngt=!!LK&&+LK[1],rgt=/MSIE|Trident/.test(FR),PK=FR.match(/AppleWebKit\/(\d+)\./),igt=!!PK&&+PK[1],ogt=M1,xK=t1,sgt=BS,agt=_S,cgt=MS,BK=hR,G4=m1,ugt=DK,lgt=yM,MK=ngt,dgt=rgt,UK=LT,jK=igt,AR=[],FK=xK(AR.sort),hgt=xK(AR.push),pgt=G4(function(){AR.sort(void 0)}),fgt=G4(function(){AR.sort(null)}),Agt=lgt("sort"),QK=!G4(function(){if(UK)return UK<70;if(!(MK&&MK>3)){if(dgt)return!0;if(jK)return jK<603;var e,l,d,p,A="";for(e=65;e<76;e++){switch(l=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:d=3;break;case 68:case 71:d=4;break;default:d=2}for(p=0;p<47;p++)AR.push({k:l+p,v:d})}for(AR.sort(function(y,g){return g.v-y.v}),p=0;p<AR.length;p++)l=AR[p].k.charAt(0),A.charAt(A.length-1)!==l&&(A+=l);return A!=="DGBEFHACIJK"}});ogt({target:"Array",proto:!0,forced:pgt||!fgt||!Agt||!QK},{sort:function(e){e!==void 0&&sgt(e);var l=agt(this);if(QK)return e===void 0?FK(l):FK(l,e);var d,p,A=[],y=cgt(l);for(p=0;p<y;p++)p in l&&hgt(A,l[p]);for(ugt(A,function(g){return function(b,I){return I===void 0?-1:b===void 0?1:g!==void 0?+g(b,I)||0:BK(b)>BK(I)?1:-1}}(e)),d=A.length,p=0;p<d;)l[p]=A[p++];for(;p<y;)delete l[p++];return l}});var ggt=dR("Array").sort,Egt=B_,mgt=ggt,V4=Array.prototype,q4=function(e){var l=e.sort;return e===V4||Egt(V4,e)&&l===V4.sort?mgt:l};function rP(e,l){if(typeof e!="boolean")throw new _E(_f.INVALID_PARAMS,"Invalid ".concat(l,": The value is of the boolean type."))}function O1(e,l,d){if(!d.includes(e))throw new _E(_f.INVALID_PARAMS,"".concat(l," can only be set as ").concat(JSON.stringify(d)))}function jI(e,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4,A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e<d||e>p||A&&!vgt(e))throw new _E(_f.INVALID_PARAMS,"invalid ".concat(l,": the value range is [").concat(d,", ").concat(p,"]. integer only"))}function K1(e,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new _E(_f.INVALID_PARAMS,"".concat(l||"param"," cannot be empty"));if(!GK(e,d,p,A))throw new _E(_f.INVALID_PARAMS,"Invalid ".concat(l||"string param",": Length of the string: [").concat(d,",").concat(p,"].").concat(A?" ASCII characters only.":""))}function wO(e,l){if(!Array.isArray(e))throw new _E(_f.INVALID_PARAMS,"".concat(l," should be an array"))}function H4(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw _a.error("Invalid Channel Name ".concat(e)),new _E(_f.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function K4(e){if(l=e,!(typeof l=="number"&&Math.floor(l)===l&&0<=l&&l<=4294967295||GK(e,1,255)))throw _a.error("Invalid UID ".concat(e," ").concat(typeof e)),new _E(_f.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var l;typeof e=="string"&&_a.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function GI(e){return e==null}function GK(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,p=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=d&&e.length>=l&&(!p||Igt(e))}function vgt(e){return typeof e=="number"&&e%1==0}function Igt(e){if(typeof e!="string")return!1;for(let l=0;l<e.length;l+=1){const d=e.charCodeAt(l);if(d<0||d>255)return!1}return!0}let VK,UI,j1;(function(e){e.FREE="free",e.UPLOADING="uploading"})(VK||(VK={})),function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}(UI||(UI={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata"}(j1||(j1={}));const Y4={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function _gt(e){return K1(e.reportId,"params.reportId",0,100,!1),K1(e.category,"params.category",0,100,!1),K1(e.event,"params.event",0,100,!1),K1(e.label,"params.label",0,100,!1),jI(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const ygt={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let N1,WI,qK,$0,z0,eT,HS,c2,OO,C_,k1,eI,W4,I1,mI,X1,_1,fI,vI,c_,xI,HK,p_;function KK(e){return jI(e.timeout,"config.timeout",0,1e5),jI(e.timeoutFactor,"config.timeoutFactor",0,100,!1),jI(e.maxRetryCount,"config.maxRetryConfig",0,1/0),jI(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function bgt(e){return O1(e.codec,"config.codec",["vp8","vp9","av1","h264"]),O1(e.mode,"config.mode",["rtc","live"]),e.audioCodec!==void 0&&O1(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),e.proxyServer!==void 0&&K1(e.proxyServer,"config.proxyServer",1,1e4),e.turnServer!==void 0&&YK(e.turnServer),e.httpRetryConfig!==void 0&&KK(e.httpRetryConfig),e.websocketRetryConfig!==void 0&&KK(e.websocketRetryConfig),!0}function J4(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(l=>{if(!l.urls)throw Error()})}catch{return!1}return!0}function YK(e){return K1(e.turnServerURL,"turnServerURL"),K1(e.username,"username"),K1(e.password,"password"),e.udpport&&jI(e.udpport,"udpport",1,99999,!0),e.forceturn&&rP(e.forceturn,"forceturn"),e.security&&rP(e.security,"security"),e.tcpport&&jI(e.tcpport,"tcpport",1,99999,!0),!0}function WK(e){return e.level!==void 0&&O1(e.level,"level",[1,2,3]),!0}(function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"})(N1||(N1={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(WI||(WI={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(qK||(qK={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}($0||($0={})),function(e){e.TRACER="tracer"}(z0||(z0={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(eT||(eT={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(HS||(HS={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(c2||(c2={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(OO||(OO={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(C_||(C_={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(k1||(k1={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(eI||(eI={})),function(e){e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(W4||(W4={})),function(e){e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.FALLBACK="FALLBACK"}(I1||(I1={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list"}(mI||(mI={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK"}(X1||(X1={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(_1||(_1={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response"}(fI||(fI={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile"}(vI||(vI={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.TRANSPORT_STATS="transport_stats"}(c_||(c_={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list"}(xI||(xI={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(HK||(HK={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source"}(p_||(p_={}));const z4={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},X4={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},JK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Cgt={uplinkNetworkQuality:0,downlinkNetworkQuality:0},zK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let SI,n1,gR;(function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection"})(SI||(SI={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(n1||(n1={})),function(e){e[e.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",e[e.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",e[e.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",e[e.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",e[e.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",e[e.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",e[e.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",e[e.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",e[e.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(gR||(gR={}));const Sgt={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},Z4={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function $4(e,l){K1(e.url,"".concat(l,".url"),1,1e3,!1),GI(e.x)||jI(e.x,"".concat(l,".x"),0,1e4),GI(e.y)||jI(e.y,"".concat(l,".y"),0,1e4),GI(e.width)||jI(e.width,"".concat(l,".width"),0,1e4),GI(e.height)||jI(e.height,"".concat(l,".height"),0,1e4),GI(e.zOrder)||jI(e.zOrder,"".concat(l,".zOrder"),0,255),GI(e.alpha)||jI(e.alpha,"".concat(l,".alpha"),0,1,!1)}const Rgt={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Tgt={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let _b,u2,JI,XK,Y1,dS,Z1,ER,r1,c1,XI,tI,F1,t5,e5,mR,l2,RI;function ZK(e){if(!e.channelName)throw new _E(_f.INVALID_PARAMS,"invalid channelName in info");if(!e.uid||typeof e.uid!="number")throw new _E(_f.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&K1(e.token,"info.token",1,2047),K4(e.uid),H4(e.channelName),!0}function $K(e){return O1(e,"mediaSource",["screen","window","application"]),!0}(function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(_b||(_b={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(u2||(u2={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(JI||(JI={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(XK||(XK={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(Y1||(Y1={})),function(e){e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(dS||(dS={})),function(e){e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(Z1||(Z1={})),function(e){e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(ER||(ER={})),function(e){e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low"}(r1||(r1={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response"}(c1||(c1={})),function(e){e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data"}(XI||(XI={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track"}(tI||(tI={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(F1||(F1={})),function(e){e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM"}(t5||(t5={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY"}(e5||(e5={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed"}(mR||(mR={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(l2||(l2={})),function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(RI||(RI={}));const wgt=[RI.AFRICA,RI.ASIA,RI.CHINA,RI.EUROPE,RI.GLOBAL,RI.INDIA,RI.JAPAN,RI.NORTH_AMERICA,RI.OCEANIA,RI.OVERSEA,RI.SOUTH_AMERICA];let f1;(function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"})(f1||(f1={}));const n5={CHINA:{},ASIA:{CODE:f1.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:f1.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:f1.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:f1.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:f1.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:f1.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:f1.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:f1.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:f1.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:f1.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:f1.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:f1.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:f1.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let NO,tY,AI,Q0,S_,TI,f_,nT;B4&&(n5.CHINA={CODE:f1.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(NO||(NO={}));class eY extends e1{constructor(l,d){super(),_s(this,"onICEConnectionStateChange",void 0),_s(this,"onConnectionStateChange",void 0),_s(this,"onDTLSTransportStateChange",void 0),_s(this,"onDTLSTransportError",void 0),_s(this,"onICETransportStateChange",void 0),_s(this,"onFirstAudioReceived",void 0),_s(this,"onFirstVideoReceived",void 0),_s(this,"onFirstAudioDecoded",void 0),_s(this,"onFirstVideoDecoded",void 0),_s(this,"onSelectedLocalCandidateChanged",void 0),_s(this,"onSelectedRemoteCandidateChanged",void 0)}}(function(e){e.SEND="sendonly",e.RECV="recvonly",e.SENDRECV="sendrecv",e.INACTIVE="inactive"})(tY||(tY={})),function(e){e.VIDEO="video",e.AUDIO="audio"}(AI||(AI={})),function(e){e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack"}(Q0||(Q0={})),function(e){e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected"}(S_||(S_={})),function(e){e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange"}(TI||(TI={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(f_||(f_={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(nT||(nT={}));const Ogt={join:["startJoin","startRequestAp","startJoinGateway","finishJoin"],publish:["startPublish"]};let R_,u_;(function(e){e.ON_TRACK="on_track",e.ON_NODE="on_node"})(R_||(R_={})),function(e){e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints"}(u_||(u_={}));const $1={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};function t_(){return $1}var nY=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined",Ngt=oR,kgt=TT,Dgt=f.RangeError,rY=function(e){if(e===void 0)return 0;var l=Ngt(e),d=kgt(l);if(l!==d)throw Dgt("Wrong length or index");return d},Lgt=f.Array,Pgt=Math.abs,KS=Math.pow,xgt=Math.floor,Bgt=Math.log,Mgt=Math.LN2,Ugt={pack:function(e,l,d){var p,A,y,g=Lgt(d),b=8*d-l-1,I=(1<<b)-1,k=I>>1,B=l===23?KS(2,-24)-KS(2,-77):0,q=e<0||e===0&&1/e<0?1:0,$=0;for((e=Pgt(e))!=e||e===1/0?(A=e!=e?1:0,p=I):(p=xgt(Bgt(e)/Mgt),e*(y=KS(2,-p))<1&&(p--,y*=2),(e+=p+k>=1?B/y:B*KS(2,1-k))*y>=2&&(p++,y/=2),p+k>=I?(A=0,p=I):p+k>=1?(A=(e*y-1)*KS(2,l),p+=k):(A=e*KS(2,k-1)*KS(2,l),p=0));l>=8;)g[$++]=255&A,A/=256,l-=8;for(p=p<<l|A,b+=l;b>0;)g[$++]=255&p,p/=256,b-=8;return g[--$]|=128*q,g},unpack:function(e,l){var d,p=e.length,A=8*p-l-1,y=(1<<A)-1,g=y>>1,b=A-7,I=p-1,k=e[I--],B=127&k;for(k>>=7;b>0;)B=256*B+e[I--],b-=8;for(d=B&(1<<-b)-1,B>>=-b,b+=l;b>0;)d=256*d+e[I--],b-=8;if(B===0)B=1-g;else{if(B===y)return d?NaN:k?-1/0:1/0;d+=KS(2,l),B-=g}return(k?-1:1)*d*KS(2,B-l)}},jgt=LR,iY=fN,Fgt=sR,Qgt=cN,Ggt=J1,Vgt=_v,oY=fN,qgt=sR,Hgt=function(e,l,d){var p=Qgt(l);p in e?Ggt.f(e,p,Vgt(0,d)):e[p]=d},Kgt=f.Array,Ygt=Math.max,sY=function(e,l,d){for(var p=qgt(e),A=oY(l,p),y=oY(d===void 0?p:d,p),g=Kgt(Ygt(y-A,0)),b=0;A<y;A++,b++)Hgt(g,b,e[A]);return g.length=b,g},iP=f,r5=G0,i5=j,Wgt=nY,aY=w3,cY=X_,uY=H8,o5=w,oP=q2,Jgt=oR,zgt=TT,sP=rY,lY=Ugt,Xgt=qN,dY=BR,Zgt=Q2.f,$gt=J1.f,tEt=function(e){for(var l=jgt(this),d=Fgt(l),p=arguments.length,A=iY(p>1?arguments[1]:void 0,d),y=p>2?arguments[2]:void 0,g=y===void 0?d:iY(y,d);g>A;)l[A++]=e;return l},eEt=sY,hY=V2,nEt=aY.PROPER,pY=aY.CONFIGURABLE,d2=Z_.get,fY=Z_.set,s5="ArrayBuffer",rEt="DataView",AY="Wrong index",hS=iP.ArrayBuffer,pS=hS,h2=pS&&pS.prototype,YS=iP.DataView,rT=YS&&YS.prototype,gY=Object.prototype,iEt=iP.Array,aP=iP.RangeError,oEt=r5(tEt),sEt=r5([].reverse),EY=lY.pack,mY=lY.unpack,vY=function(e){return[255&e]},IY=function(e){return[255&e,e>>8&255]},_Y=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},yY=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},aEt=function(e){return EY(e,23,4)},cEt=function(e){return EY(e,52,8)},cP=function(e,l){$gt(e.prototype,l,{get:function(){return d2(this)[l]}})},vR=function(e,l,d,p){var A=sP(d),y=d2(e);if(A+l>y.byteLength)throw aP(AY);var g=d2(y.buffer).bytes,b=A+y.byteOffset,I=eEt(g,b,b+l);return p?I:sEt(I)},IR=function(e,l,d,p,A,y){var g=sP(d),b=d2(e);if(g+l>b.byteLength)throw aP(AY);for(var I=d2(b.buffer).bytes,k=g+b.byteOffset,B=p(+A),q=0;q<l;q++)I[k+q]=B[y?q:l-q-1]};if(Wgt){var bY=nEt&&hS.name!==s5;if(o5(function(){hS(1)})&&o5(function(){new hS(-1)})&&!o5(function(){return new hS,new hS(1.5),new hS(NaN),bY&&!pY}))bY&&pY&&cY(hS,"name",s5);else{(pS=function(e){return oP(this,h2),new hS(sP(e))}).prototype=h2;for(var a5,CY=Zgt(hS),SY=0;CY.length>SY;)(a5=CY[SY++])in pS||cY(pS,a5,hS[a5]);h2.constructor=pS}dY&&Xgt(rT)!==gY&&dY(rT,gY);var uP=new YS(new pS(2)),RY=r5(rT.setInt8);uP.setInt8(0,2147483648),uP.setInt8(1,2147483649),!uP.getInt8(0)&&uP.getInt8(1)||uY(rT,{setInt8:function(e,l){RY(this,e,l<<24>>24)},setUint8:function(e,l){RY(this,e,l<<24>>24)}},{unsafe:!0})}else h2=(pS=function(e){oP(this,h2);var l=sP(e);fY(this,{bytes:oEt(iEt(l),0),byteLength:l}),i5||(this.byteLength=l)}).prototype,rT=(YS=function(e,l,d){oP(this,rT),oP(e,h2);var p=d2(e).byteLength,A=Jgt(l);if(A<0||A>p)throw aP("Wrong offset");if(A+(d=d===void 0?p-A:zgt(d))>p)throw aP("Wrong length");fY(this,{buffer:e,byteLength:d,byteOffset:A}),i5||(this.buffer=e,this.byteLength=d,this.byteOffset=A)}).prototype,i5&&(cP(pS,"byteLength"),cP(YS,"buffer"),cP(YS,"byteLength"),cP(YS,"byteOffset")),uY(rT,{getInt8:function(e){return vR(this,1,e)[0]<<24>>24},getUint8:function(e){return vR(this,1,e)[0]},getInt16:function(e){var l=vR(this,2,e,arguments.length>1?arguments[1]:void 0);return(l[1]<<8|l[0])<<16>>16},getUint16:function(e){var l=vR(this,2,e,arguments.length>1?arguments[1]:void 0);return l[1]<<8|l[0]},getInt32:function(e){return yY(vR(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return yY(vR(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return mY(vR(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return mY(vR(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,l){IR(this,1,e,vY,l)},setUint8:function(e,l){IR(this,1,e,vY,l)},setInt16:function(e,l){IR(this,2,e,IY,l,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,l){IR(this,2,e,IY,l,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,l){IR(this,4,e,_Y,l,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,l){IR(this,4,e,_Y,l,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,l){IR(this,4,e,aEt,l,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,l){IR(this,8,e,cEt,l,arguments.length>2?arguments[2]:void 0)}});hY(pS,s5),hY(YS,rEt);var lP={ArrayBuffer:pS,DataView:YS},uEt=P_,c5=G0,lEt=w,TY=i_,wY=fN,dEt=TT,hEt=M3,u5=lP.ArrayBuffer,l5=lP.DataView,OY=l5.prototype,NY=c5(u5.prototype.slice),pEt=c5(OY.getUint8),fEt=c5(OY.setUint8);uEt({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:lEt(function(){return!new u5(2).slice(1,void 0).byteLength})},{slice:function(e,l){if(NY&&l===void 0)return NY(TY(this),e);for(var d=TY(this).byteLength,p=wY(e,d),A=wY(l===void 0?d:l,d),y=new(hEt(this,u5))(dEt(A-p)),g=new l5(this),b=new l5(y),I=0;p<A;)fEt(b,I++,pEt(g,p++));return y}});var T_,p2,dP,RS={exports:{}},AEt=nY,d5=j,A_=f,kY=qI,h5=h1,iT=W1,p5=Y2,gEt=U2,f5=X_,A5=aS.exports,EEt=J1.f,mEt=I_,g5=qN,f2=BR,vEt=w1,DY=g3,hP=A_.Int8Array,E5=hP&&hP.prototype,LY=A_.Uint8ClampedArray,PY=LY&&LY.prototype,TS=hP&&g5(hP),fS=E5&&g5(E5),IEt=Object.prototype,m5=A_.TypeError,xY=vEt("toStringTag"),v5=DY("TYPED_ARRAY_TAG"),I5=DY("TYPED_ARRAY_CONSTRUCTOR"),WS=AEt&&!!f2&&p5(A_.opera)!=="Opera",BY=!1,JS={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},_5={BigInt64Array:8,BigUint64Array:8},MY=function(e){if(!h5(e))return!1;var l=p5(e);return iT(JS,l)||iT(_5,l)};for(T_ in JS)(dP=(p2=A_[T_])&&p2.prototype)?f5(dP,I5,p2):WS=!1;for(T_ in _5)(dP=(p2=A_[T_])&&p2.prototype)&&f5(dP,I5,p2);if((!WS||!kY(TS)||TS===Function.prototype)&&(TS=function(){throw m5("Incorrect invocation")},WS))for(T_ in JS)A_[T_]&&f2(A_[T_],TS);if((!WS||!fS||fS===IEt)&&(fS=TS.prototype,WS))for(T_ in JS)A_[T_]&&f2(A_[T_].prototype,fS);if(WS&&g5(PY)!==fS&&f2(PY,fS),d5&&!iT(fS,xY))for(T_ in BY=!0,EEt(fS,xY,{get:function(){return h5(this)?this[v5]:void 0}}),JS)A_[T_]&&f5(A_[T_],v5,T_);var oT={NATIVE_ARRAY_BUFFER_VIEWS:WS,TYPED_ARRAY_CONSTRUCTOR:I5,TYPED_ARRAY_TAG:BY&&v5,aTypedArray:function(e){if(MY(e))return e;throw m5("Target is not a typed array")},aTypedArrayConstructor:function(e){if(kY(e)&&(!f2||mEt(TS,e)))return e;throw m5(gEt(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,l,d,p){if(d5){if(d)for(var A in JS){var y=A_[A];if(y&&iT(y.prototype,e))try{delete y.prototype[e]}catch{try{y.prototype[e]=l}catch{}}}fS[e]&&!d||A5(fS,e,d?l:WS&&E5[e]||l,p)}},exportTypedArrayStaticMethod:function(e,l,d){var p,A;if(d5){if(f2){if(d){for(p in JS)if((A=A_[p])&&iT(A,e))try{delete A[e]}catch{}}if(TS[e]&&!d)return;try{return A5(TS,e,d?l:WS&&TS[e]||l)}catch{}}for(p in JS)!(A=A_[p])||A[e]&&!d||A5(A,e,l)}},isView:function(e){if(!h5(e))return!1;var l=p5(e);return l==="DataView"||iT(JS,l)||iT(_5,l)},isTypedArray:MY,TypedArray:TS,TypedArrayPrototype:fS},UY=f,y5=w,_Et=_F,yEt=oT.NATIVE_ARRAY_BUFFER_VIEWS,bEt=UY.ArrayBuffer,sT=UY.Int8Array,CEt=!yEt||!y5(function(){sT(1)})||!y5(function(){new sT(-1)})||!_Et(function(e){new sT,new sT(null),new sT(1.5),new sT(e)},!0)||y5(function(){return new sT(new bEt(2),1,void 0).length!==1}),SEt=h1,REt=Math.floor,TEt=Number.isInteger||function(e){return!SEt(e)&&isFinite(e)&&REt(e)===e},wEt=oR,OEt=f.RangeError,NEt=function(e){var l=wEt(e);if(l<0)throw OEt("The argument can't be less than 0");return l},kEt=f.RangeError,jY=function(e,l){var d=NEt(e);if(d%l)throw kEt("Wrong offset");return d},DEt=H2,LEt=_o,PEt=sQ,xEt=LR,BEt=sR,MEt=Z8,UEt=P3,jEt=J8,FEt=oT.aTypedArrayConstructor,QEt=v0,GEt=f,FY=Array.isArray||function(e){return QEt(e)=="Array"},VEt=oQ,qEt=h1,HEt=w1("species"),QY=GEt.Array,KEt=function(e){var l;return FY(e)&&(l=e.constructor,(VEt(l)&&(l===QY||FY(l.prototype))||qEt(l)&&(l=l[HEt])===null)&&(l=void 0)),l===void 0?QY:l},YEt=H2,WEt=O0,JEt=LR,zEt=sR,XEt=function(e,l){return new(KEt(e))(l===0?0:l)},GY=G0([].push),_R=function(e){var l=e==1,d=e==2,p=e==3,A=e==4,y=e==6,g=e==7,b=e==5||y;return function(I,k,B,q){for(var $,_t,_r=JEt(I),_i=WEt(_r),ga=YEt(k,B),_u=zEt(_i),ah=0,_h=q||XEt,_A=l?_h(I,_u):d||g?_h(I,0):void 0;_u>ah;ah++)if((b||ah in _i)&&(_t=ga($=_i[ah],ah,_r),e))if(l)_A[ah]=_t;else if(_t)switch(e){case 3:return!0;case 5:return $;case 6:return ah;case 2:GY(_A,$)}else switch(e){case 4:return!1;case 7:GY(_A,$)}return y?-1:p||A?A:_A}},ZEt={forEach:_R(0),map:_R(1),filter:_R(2),some:_R(3),every:_R(4),find:_R(5),findIndex:_R(6),filterReject:_R(7)},VY=P_,qY=f,HY=_o,$Et=j,tmt=CEt,aT=oT,KY=lP,YY=q2,emt=_v,A2=X_,nmt=TEt,rmt=TT,WY=rY,b5=jY,JY=cN,kO=W1,imt=Y2,C5=h1,omt=l3,smt=MT,amt=I_,pP=BR,cmt=Q2.f,zY=function(e){var l,d,p,A,y,g,b=PEt(this),I=xEt(e),k=arguments.length,B=k>1?arguments[1]:void 0,q=B!==void 0,$=UEt(I);if($&&!jEt($))for(g=(y=MEt(I,$)).next,I=[];!(A=LEt(g,y)).done;)I.push(A.value);for(q&&k>2&&(B=DEt(B,arguments[2])),d=BEt(I),p=new(FEt(b))(d),l=0;d>l;l++)p[l]=q?B(I[l],l):I[l];return p},umt=ZEt.forEach,lmt=AN,XY=J1,ZY=_,dmt=KN,S5=Z_.get,hmt=Z_.set,R5=XY.f,pmt=ZY.f,fmt=Math.round,T5=qY.RangeError,$Y=KY.ArrayBuffer,Amt=$Y.prototype,gmt=KY.DataView,fP=aT.NATIVE_ARRAY_BUFFER_VIEWS,Emt=aT.TYPED_ARRAY_CONSTRUCTOR,tW=aT.TYPED_ARRAY_TAG,eW=aT.TypedArray,DO=aT.TypedArrayPrototype,mmt=aT.aTypedArrayConstructor,w5=aT.isTypedArray,AP="BYTES_PER_ELEMENT",O5="Wrong length",nW=function(e,l){mmt(e);for(var d=0,p=l.length,A=new e(p);p>d;)A[d]=l[d++];return A},gP=function(e,l){R5(e,l,{get:function(){return S5(this)[l]}})},rW=function(e){var l;return amt(Amt,e)||(l=imt(e))=="ArrayBuffer"||l=="SharedArrayBuffer"},iW=function(e,l){return w5(e)&&!omt(l)&&l in e&&nmt(+l)&&l>=0},oW=function(e,l){return l=JY(l),iW(e,l)?emt(2,e[l]):pmt(e,l)},sW=function(e,l,d){return l=JY(l),!(iW(e,l)&&C5(d)&&kO(d,"value"))||kO(d,"get")||kO(d,"set")||d.configurable||kO(d,"writable")&&!d.writable||kO(d,"enumerable")&&!d.enumerable?R5(e,l,d):(e[l]=d.value,e)};$Et?(fP||(ZY.f=oW,XY.f=sW,gP(DO,"buffer"),gP(DO,"byteOffset"),gP(DO,"byteLength"),gP(DO,"length")),VY({target:"Object",stat:!0,forced:!fP},{getOwnPropertyDescriptor:oW,defineProperty:sW}),RS.exports=function(e,l,d){var p=e.match(/\d+$/)[0]/8,A=e+(d?"Clamped":"")+"Array",y="get"+e,g="set"+e,b=qY[A],I=b,k=I&&I.prototype,B={},q=function($,_t){R5($,_t,{get:function(){return function(_r,_i){var ga=S5(_r);return ga.view[y](_i*p+ga.byteOffset,!0)}(this,_t)},set:function(_r){return function(_i,ga,_u){var ah=S5(_i);d&&(_u=(_u=fmt(_u))<0?0:_u>255?255:255&_u),ah.view[g](ga*p+ah.byteOffset,_u,!0)}(this,_t,_r)},enumerable:!0})};fP?tmt&&(I=l(function($,_t,_r,_i){return YY($,k),dmt(C5(_t)?rW(_t)?_i!==void 0?new b(_t,b5(_r,p),_i):_r!==void 0?new b(_t,b5(_r,p)):new b(_t):w5(_t)?nW(I,_t):HY(zY,I,_t):new b(WY(_t)),$,I)}),pP&&pP(I,eW),umt(cmt(b),function($){$ in I||A2(I,$,b[$])}),I.prototype=k):(I=l(function($,_t,_r,_i){YY($,k);var ga,_u,ah,_h=0,_A=0;if(C5(_t)){if(!rW(_t))return w5(_t)?nW(I,_t):HY(zY,I,_t);ga=_t,_A=b5(_r,p);var n0=_t.byteLength;if(_i===void 0){if(n0%p||(_u=n0-_A)<0)throw T5(O5)}else if((_u=rmt(_i)*p)+_A>n0)throw T5(O5);ah=_u/p}else ah=WY(_t),ga=new $Y(_u=ah*p);for(hmt($,{buffer:ga,byteOffset:_A,byteLength:_u,length:ah,view:new gmt(ga)});_h<ah;)q($,_h++)}),pP&&pP(I,eW),k=I.prototype=smt(DO)),k.constructor!==I&&A2(k,"constructor",I),A2(k,Emt,I),tW&&A2(k,tW,A),B[A]=I,VY({global:!0,forced:I!=b,sham:!fP},B),AP in I||A2(I,AP,p),AP in k||A2(k,AP,p),lmt(A)}):RS.exports=function(){},(0,RS.exports)("Uint8",function(e){return function(l,d,p){return e(this,l,d,p)}});var vmt=sR,Imt=oR,_mt=oT.aTypedArray;(0,oT.exportTypedArrayMethod)("at",function(e){var l=_mt(this),d=vmt(l),p=Imt(e),A=p>=0?p:d+p;return A<0||A>=d?void 0:l[A]});var aW=f,cW=_o,N5=oT,ymt=sR,bmt=jY,Cmt=LR,uW=w,Smt=aW.RangeError,k5=aW.Int8Array,lW=k5&&k5.prototype,dW=lW&&lW.set,Rmt=N5.aTypedArray,Tmt=N5.exportTypedArrayMethod,D5=!uW(function(){var e=new Uint8ClampedArray(2);return cW(dW,e,{length:1,0:3},1),e[1]!==3}),wmt=D5&&N5.NATIVE_ARRAY_BUFFER_VIEWS&&uW(function(){var e=new k5(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});Tmt("set",function(e){Rmt(this);var l=bmt(arguments.length>1?arguments[1]:void 0,1),d=Cmt(e);if(D5)return cW(dW,this,d,l);var p=this.length,A=ymt(d),y=0;if(A+l>p)throw Smt("Wrong length");for(;y<A;)this[l+y]=d[y++]},!D5||wmt);var hW=sY,Omt=Math.floor,L5=function(e,l){var d=e.length,p=Omt(d/2);return d<8?Nmt(e,l):kmt(e,L5(hW(e,0,p),l),L5(hW(e,p),l),l)},Nmt=function(e,l){for(var d,p,A=e.length,y=1;y<A;){for(p=y,d=e[y];p&&l(e[p-1],d)>0;)e[p]=e[--p];p!==y++&&(e[p]=d)}return e},kmt=function(e,l,d,p){for(var A=l.length,y=d.length,g=0,b=0;g<A||b<y;)e[g+b]=g<A&&b<y?p(l[g],d[b])<=0?l[g++]:d[b++]:g<A?l[g++]:d[b++];return e},Dmt=L5,pW=DS.match(/firefox\/(\d+)/i),Lmt=!!pW&&+pW[1],Pmt=/MSIE|Trident/.test(DS),fW=DS.match(/AppleWebKit\/(\d+)\./),xmt=!!fW&&+fW[1],AW=f,Bmt=G0,P5=w,Mmt=ST,Umt=Dmt,gW=oT,EW=Lmt,jmt=Pmt,mW=z_,vW=xmt,Fmt=AW.Array,Qmt=gW.aTypedArray,Gmt=gW.exportTypedArrayMethod,LO=AW.Uint16Array,g2=LO&&Bmt(LO.prototype.sort),Vmt=!(!g2||P5(function(){g2(new LO(2),null)})&&P5(function(){g2(new LO(2),{})})),IW=!!g2&&!P5(function(){if(mW)return mW<74;if(EW)return EW<67;if(jmt)return!0;if(vW)return vW<602;var e,l,d=new LO(516),p=Fmt(516);for(e=0;e<516;e++)l=e%4,d[e]=515-e,p[e]=e-2*l+3;for(g2(d,function(A,y){return(A/4|0)-(y/4|0)}),e=0;e<516;e++)if(d[e]!==p[e])return!0});Gmt("sort",function(e){return e!==void 0&&Mmt(e),IW?g2(this,e):Umt(Qmt(this),function(l){return function(d,p){return l!==void 0?+l(d,p)||0:p!=p?-1:d!=d?1:d===0&&p===0?1/d>0&&1/p<0?1:-1:d>p}}(e))},!IW||Vmt);var qmt=AN,Hmt="ArrayBuffer",_W=lP.ArrayBuffer;let l1;P_({global:!0,forced:f.ArrayBuffer!==_W},{ArrayBuffer:_W}),qmt(Hmt),function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(l1||(l1={}));var Kmt=iO,PO=Array.isArray||function(e){return Kmt(e)=="Array"},Ymt=II,yW=PO,Wmt=pL,Jmt=M_,zmt=v1("species"),bW=Ymt.Array,Xmt=function(e){var l;return yW(e)&&(l=e.constructor,(Wmt(l)&&(l===bW||yW(l.prototype))||Jmt(l)&&(l=l[zmt])===null)&&(l=void 0)),l===void 0?bW:l},CW=function(e,l){return new(Xmt(e))(l===0?0:l)},Zmt=lR,$mt=kN,tvt=_S,evt=MS,nvt=CW,SW=t1([].push),yR=function(e){var l=e==1,d=e==2,p=e==3,A=e==4,y=e==6,g=e==7,b=e==5||y;return function(I,k,B,q){for(var $,_t,_r=tvt(I),_i=$mt(_r),ga=Zmt(k,B),_u=evt(_i),ah=0,_h=q||nvt,_A=l?_h(I,_u):d||g?_h(I,0):void 0;_u>ah;ah++)if((b||ah in _i)&&(_t=ga($=_i[ah],ah,_r),e))if(l)_A[ah]=_t;else if(_t)switch(e){case 3:return!0;case 5:return $;case 6:return ah;case 2:SW(_A,$)}else switch(e){case 4:return!1;case 7:SW(_A,$)}return y?-1:p||A?A:_A}},RW={forEach:yR(0),map:yR(1),filter:yR(2),some:yR(3),every:yR(4),find:yR(5),findIndex:yR(6),filterReject:yR(7)},rvt=RW.forEach,TW=yM("forEach")?[].forEach:function(e){return rvt(this,e,arguments.length>1?arguments[1]:void 0)};M1({target:"Array",proto:!0,forced:[].forEach!=TW},{forEach:TW});var ivt=dR("Array").forEach,ovt=US,svt=z1,avt=B_,cvt=ivt,x5=Array.prototype,uvt={DOMTokenList:!0,NodeList:!0},lvt=function(e){var l=e.forEach;return e===x5||avt(x5,e)&&l===x5.forEach||svt(uvt,ovt(e))?cvt:l},dvt=_S,wW=_D;M1({target:"Object",stat:!0,forced:m1(function(){wW(1)})},{keys:function(e){return wW(dvt(e))}});var hvt=xS.Object.keys,pvt=L9,fvt=M1,Avt=PO,gvt=t1([].reverse),OW=[1,2];fvt({target:"Array",proto:!0,forced:String(OW)===String(OW.reverse())},{reverse:function(){return Avt(this)&&(this.length=this.length),gvt(this)}});var Evt=dR("Array").reverse,mvt=B_,vvt=Evt,B5=Array.prototype,Ivt=function(e){var l=e.reverse;return e===B5||mvt(B5,e)&&l===B5.reverse?vvt:l},_vt=m1,yvt=LT,bvt=v1("species"),NW=function(e){return yvt>=51||!_vt(function(){var l=[];return(l.constructor={})[bvt]=function(){return{foo:1}},l[e](Boolean).foo!==1})},Cvt=M1,Svt=II,kW=PO,Rvt=pL,Tvt=M_,DW=ZM,wvt=MS,Ovt=uR,Nvt=nP,kvt=v1,Dvt=vU,Lvt=NW("slice"),Pvt=kvt("species"),M5=Svt.Array,xvt=Math.max;Cvt({target:"Array",proto:!0,forced:!Lvt},{slice:function(e,l){var d,p,A,y=Ovt(this),g=wvt(y),b=DW(e,g),I=DW(l===void 0?g:l,g);if(kW(y)&&(d=y.constructor,(Rvt(d)&&(d===M5||kW(d.prototype))||Tvt(d)&&(d=d[Pvt])===null)&&(d=void 0),d===M5||d===void 0))return Dvt(y,b,I);for(p=new(d===void 0?M5:d)(xvt(I-b,0)),A=0;b<I;b++,A++)b in y&&Nvt(p,A,y[b]);return p.length=A,p}});var Bvt=dR("Array").slice,Mvt=B_,Uvt=Bvt,U5=Array.prototype,jvt=function(e){var l=e.slice;return e===U5||Mvt(U5,e)&&l===U5.slice?Uvt:l};function X0(e,l,d,p,A){var y,g,b,I={};return lvt(y=hvt(p)).call(y,function(k){I[k]=p[k]}),I.enumerable=!!I.enumerable,I.configurable=!!I.configurable,("value"in I||I.initializer)&&(I.writable=!0),I=pvt(g=Ivt(b=jvt(d).call(d)).call(b)).call(g,function(k,B){return B(e,l,k)||k},I),A&&I.initializer!==void 0&&(I.value=I.initializer?I.initializer.call(A):void 0,I.initializer=void 0),I.initializer===void 0&&(oK(e,l,I),I=null),I}var Fvt=dR("Array").values,Qvt=US,Gvt=z1,Vvt=B_,qvt=Fvt,j5=Array.prototype,Hvt={DOMTokenList:!0,NodeList:!0},zS=function(e){var l=e.values;return e===j5||Vvt(j5,e)&&l===j5.values||Gvt(Hvt,Qvt(e))?qvt:l},Kvt=dR("Array").keys,Yvt=US,Wvt=z1,Jvt=B_,zvt=Kvt,F5=Array.prototype,Xvt={DOMTokenList:!0,NodeList:!0},cT=function(e){var l=e.keys;return e===F5||Jvt(F5,e)&&l===F5.keys||Wvt(Xvt,Yvt(e))?zvt:l};function LW(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function PW(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?LW(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):LW(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let EP=0,Q5=0;function Pb(e,l,d){return new Y0((p,A)=>{l.timeout=l.timeout||y0("HTTP_CONNECT_TIMEOUT"),l.responseType=l.responseType||"json",l.data&&!d?(l.data=JSON.stringify(l.data),EP+=_2(l.data)):d&&(l.data.size?EP+=l.data.size:l.data instanceof FormData?EP+=function(y){let g=0;return/DingTalk/i.test(navigator.userAgent)&&y.realFormData&&(y=y.realFormData),y.forEach(b=>{g+=typeof b=="string"?_2(b):b.size}),g+138}(l.data):EP+=_2(JSON.stringify(l.data))),l.headers=l.headers||{},l.headers["Content-Type"]=l.headers["Content-Type"]||"application/json",l.method="POST",l.url=e,lS.request(l).then(y=>{typeof y.data=="string"?Q5+=_2(y.data):y.data instanceof ArrayBuffer||y.data instanceof Uint8Array?Q5+=y.data.byteLength:Q5+=_2(JSON.stringify(y.data)),p(y.data)}).catch(y=>{lS.isCancel(y)?A(new _E(_f.OPERATION_ABORTED,"cancel token canceled")):y.code==="ECONNABORTED"?A(new _E(_f.NETWORK_TIMEOUT,y.message)):y.response?A(new _E(_f.NETWORK_RESPONSE_ERROR,y.response.status)):A(new _E(_f.NETWORK_ERROR,y.message))})})}async function Zvt(e,l){const d=new Blob([l.data],{type:"buffer"});return await Pb(e,PW(PW({},l),{},{data:d,headers:{"Content-Type":"application/octet-stream"}}),!0)}const S1=new class extends e1{set networkState(e){_a.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+e),this.emit(nT.NETWORK_STATE_CHANGE,e,this._networkState),e===f_.ONLINE?this.emit(nT.ONLINE):e===f_.OFFLINE&&(this.onlineWaiter=new Y0(l=>{this.once(nT.ONLINE,()=>{this.onlineWaiter=void 0,l(f_.ONLINE)})}),this.emit(nT.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}constructor(){super(),_s(this,"_moduleName","network-indicator"),_s(this,"_networkState",f_.ONLINE),_s(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=f_.ONLINE}),window.addEventListener("offline",()=>{this.networkState=f_.OFFLINE})}};let G5=!1;const w_=new class extends e1{constructor(){super(...arguments),_s(this,"onAutoplayFailed",void 0),_s(this,"onAudioAutoplayFailed",void 0)}};function xW(){const e=MI();if(!G5){const l=d=>{d.preventDefault(),G5=!1,e.os!=="Android"||e.name!=="Chrome"&&e.name!==DI.WECHAT?(document.body.removeEventListener("touchstart",l,!0),document.body.removeEventListener("mousedown",l,!0)):document.body.removeEventListener("click",l,!0)};G5=!0,e.os!=="Android"||e.name!=="Chrome"&&e.name!==DI.WECHAT?(document.body.addEventListener("touchstart",l,!0),document.body.addEventListener("mousedown",l,!0)):document.body.addEventListener("click",l,!0),_a.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),w_.onAutoplayFailed?w_.onAutoplayFailed():w_.onAudioAutoplayFailed?_a.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):_a.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),w_.emit("autoplay-failed")}}var BW;function MW(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function hI(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?MW(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):MW(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function E2(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{report:_0};return function(l,d,p){const A=l[d];if(typeof A=="function"){const y=l.constructor.name==="AgoraRTCClient"?"Client":l.constructor.name;p.value=function(){for(var g=arguments.length,b=new Array(g),I=0;I<g;I++)b[I]=arguments[I];const k=e.report.reportApiInvoke(this._sessionId||null,{name:"".concat(y,".").concat(d),options:b,tag:z0.TRACER,reportResult:e.reportResult});try{const B=A.apply(this,b);return k.onSuccess(e.reportResult&&B),B}catch(B){throw k.onError(B),B}}}return p}}function mP(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{report:_0};return function(l,d,p){const A=l[d];if(typeof A=="function"){const y=l.constructor.name==="AgoraRTCClient"?"Client":l.constructor.name;p.value=async function(){for(var g=arguments.length,b=new Array(g),I=0;I<g;I++)b[I]=arguments[I];const k=e.report.reportApiInvoke(this._sessionId||null,{name:"".concat(y,".").concat(d),options:b,tag:z0.TRACER});try{const B=await A.apply(this,b);return k.onSuccess(),B}catch(B){throw k.onError(B),B}}}return p}}const _0=new(U1("AgoraRTCEventReport")(BW=class{constructor(){_s(this,"baseInfoMap",new Map),_s(this,"proxyServer",void 0),_s(this,"clientList",a2),_s(this,"eventUploadTimer",void 0),_s(this,"setSessionIdTimer",void 0),_s(this,"url",void 0),_s(this,"backupUrl",void 0),_s(this,"keyEventUploadPendingItems",[]),_s(this,"normalEventUploadPendingItems",[]),_s(this,"apiInvokeUploadPendingItems",[]),_s(this,"apiInvokeCount",0),_s(this,"ltsList",[]),_s(this,"lastSendNormalEventTime",Date.now()),_s(this,"customReportCounterTimer",void 0),_s(this,"customReportCount",0),_s(this,"extApiInvoke",async e=>{for(const l of e){const d=hI(hI({},l),{},{sid:null,invokeId:++this.apiInvokeCount,tag:z0.TRACER});this.sendApiInvoke(d)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),y0("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),y0("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return _a.error("adjust session ".concat(e," start time, sid is not exist or info is undefined")),void b0("error",this,"adjustSessionStartTime","adjust session ".concat(e," start time, sid is not exist or info is undefined"));const l=this.baseInfoMap.get(e),d=Date.now(),p=l.startTime;l.startTime=d,_a.debug("rewrite session ".concat(e," startTime: ").concat(d," , ").concat(d-p,"ms")),b0("debug",this,"adjustSessionStartTime",void 0,"rewrite session ".concat(e," startTime: ").concat(d," , ").concat(d-p,"ms")),this.baseInfoMap.set(e,l)}reportApiInvoke(e,l,d){l.timeout=l.timeout||6e4,l.reportResult=l.reportResult===void 0||l.reportResult;const p=Date.now();this.apiInvokeCount+=1;const A=this.apiInvokeCount,y=()=>({tag:l.tag,invokeId:A,sid:e,name:l.name,apiInvokeTime:p,options:l.options,states:l.states||null}),g=!!y0("SHOW_REPORT_INVOKER_LOG");g&&_a.info("".concat(l.name," start"),l.options);let b=!1;Q1(l.timeout).then(()=>{b||(this.sendApiInvoke(hI(hI({},y()),{},{error:_f.API_INVOKE_TIMEOUT,success:!1})),_a.debug("".concat(l.name," timeout")))});const I=new _E(_f.UNEXPECTED_ERROR,"".concat(l.name,": this api invoke is end"));return{onSuccess:k=>{const B=()=>{if(b)throw I;return b=!0,this.sendApiInvoke(hI(hI({},y()),{},{success:!0},l.reportResult&&{result:k})),g&&_a.info("".concat(l.name," onSuccess")),k};return d?xJ(B,l.name+"Success",d,()=>b=!0):B()},onError:k=>{const B=()=>{if(b)throw k;b=!0,this.sendApiInvoke(hI(hI({},y()),{},{success:!1,error:k.toString()})),g&&_a.info("".concat(l.name," onFailure"),k.toString())};return d?xJ(B,l.name+"Error",d,()=>b=!0):B()}}}sessionInit(e,l){if(this.baseInfoMap.has(e))return;const d=Date.now(),p=this.createBaseInfo(e,d);p.cname=l.cname;const A=Object.assign({},{willUploadConsoleLog:y0("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:B4?"global":"oversea",areas:y0("AREAS")&&y0("AREAS").join(",")},l.extend),y=Date.now(),g=hI(hI({},p),{},{eventType:N1.SESSION_INIT,appid:l.appid,browser:navigator.userAgent,build:$L,lts:y,elapse:y-d,extend:JSON.stringify(A),mode:l.mode,process:y0("PROCESS_ID"),success:!0,version:s_});this.send({type:WI.SESSION,data:g},!0)}joinChooseServer(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.JOIN_CHOOSE_SERVER,lts:A,eventElapse:A-l.lts,chooseServerAddr:l.csAddr,errorCode:l.ec,elapse:A-d.startTime,success:l.succ,chooseServerAddrList:JSON.stringify(l.serverList),uid:l.uid?parseInt(l.uid):null,cid:l.cid?parseInt(l.cid):null,chooseServerIp:l.csIp||"",opid:l.opid,unilbsServerIds:l.unilbsServerIds,extend:l.extend||void 0});this.send({type:WI.JOIN_CHOOSE_SERVER,data:y},!0)}reqUserAccount(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.REQ_USER_ACCOUNT,lts:A,success:l.success,serverAddress:l.serverAddr,stringUid:l.stringUid,uid:l.uid,errorCode:l.errorCode,elapse:A-d.startTime,eventElapse:A-l.lts,extend:JSON.stringify(l.extend)});this.send({type:WI.REQ_USER_ACCOUNT,data:y},!0)}joinGateway(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info;l.vid&&(p.vid=l.vid),p.uid=l.uid,p.cid=l.cid;const A=Date.now(),{firstSuccess:y,avoidJoinStartTime:g,isProxy:b,addr:I}=l,k=A-(y&&g?g:d.startTime),B=hI(hI({},p),{},{eventType:N1.JOIN_GATEWAY,lts:A,gatewayAddr:l.addr,success:l.succ,errorCode:l.ec,elapse:k,eventElapse:A-l.lts,firstSuccess:y}),q=B.success?1:0;if(l.succ&&(d.lastJoinSuccessTime=A),y)this.send({type:WI.JOIN_GATEWAT,data:B},!0);else{let $;if(I)if(b){const _r=I.match(/h=(\d{1,3}-){3}\d{1,3}/g),_i=I.match(/p=[0-9]{1,6}/g);$={isSuccess:q,gatewayIp:_r&&_r.length?_r[0].split("=")[1].replace(/-/g,"."):"",port:_i&&_i.length?_i[0].split("=")[1]:"",isProxy:b?1:0}}else{const _r=I.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),_i=I.match(/:[0-9]{1,6}/g);$={isSuccess:q,gatewayIp:_r&&_r.length?_r[0].split("//")[1].replace(/-/g,"."):"",port:_i&&_i.length?_i[0].split(":")[1]:"",isProxy:b?1:0}}else $={isSuccess:q,gatewayIp:"",port:"",isProxy:b?1:0};delete B.success,delete B.eventType,delete B.firstSuccess,B.vid=Number(B.vid);const _t=Object.assign({},B,$,{eventType:N1.REJOIN_GATEWAY});this.send({type:WI.RE_JOIN_GATEWAY,data:_t},!0)}}joinChannelTimeout(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=Date.now(),A=hI(hI({},d.info),{},{lts:p,timeout:l,elapse:p-d.startTime});this.send({type:WI.JOIN_CHANNEL_TIMEOUT,data:A},!0)}publish(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.PUBLISH,lts:A,eventElapse:l.eventElapse,elapse:A-d.startTime,success:l.succ,errorCode:l.ec,videoName:l.videoName,audioName:l.audioName,screenName:l.screenName,screenshare:l.screenshare,audio:l.audio,video:l.video,p2pid:l.p2pid,publishRequestid:l.publishRequestid});this.send({type:WI.PUBLISH,data:y},!0)}subscribe(e,l,d){const p=this.baseInfoMap.get(e);if(!p)return;const A=p.info,y=Date.now(),g=hI(hI({},A),{},{eventType:N1.SUBSCRIBE,lts:y,eventElapse:l.eventElapse,elapse:y-p.startTime,success:l.succ,errorCode:l.ec,video:l.video,audio:l.audio,subscribeRequestid:l.subscribeRequestid,p2pid:l.p2pid},d&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof l.peerid=="string"?g.peerSuid=l.peerid:g.peer=l.peerid,this.send({type:WI.SUBSCRIBE,data:g},!0)}wsCompressorInit(e){var l;const d=[...cT(l=this.baseInfoMap).call(l)],p=d.length?d[0]:"UnableToGetSid",A=this.baseInfoMap.get(p);if(!A)return;const y=A.info,g=Date.now(),b=hI(hI({},y),{},{eventType:N1.WS_COMPRESSOR_INIT,lts:g,eventElapse:e.eventElapse,elapse:g-A.startTime,status:e.status?1:2});this.send({type:WI.WS_COMPRESSOR_INIT,data:b},!0)}firstRemoteFrame(e,l,d,p){const A=this.baseInfoMap.get(e);if(!A)return;const y=A.info,g=Date.now(),b=hI(hI(hI({},y),p),{},{elapse:g-A.startTime,eventType:l,lts:g});this.send({type:d,data:b},!0)}onGatewayStream(e,l,d,p){const A=this.baseInfoMap.get(e);if(!A)return;const y=A.info,g=Date.now(),b=hI(hI(hI({},y),p),{},{eventType:l,lts:g});this.send({type:d,data:b},!0)}streamSwitch(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.STREAM_SWITCH,lts:A,isDual:l.isdual,elapse:A-d.startTime,success:l.succ});this.send({type:WI.STREAM_SWITCH,data:y},!0)}requestProxyAppCenter(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.REQUEST_PROXY_APPCENTER,lts:A,eventElapse:A-l.lts,elapse:A-d.startTime,APAddr:l.APAddr,workerManagerList:l.workerManagerList,response:l.response,errorCode:l.ec,success:l.succ});this.send({type:WI.REQUEST_PROXY_APPCENTER,data:y},!0)}requestProxyWorkerManager(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{eventType:N1.REQUEST_PROXY_WORKER_MANAGER,lts:A,eventElapse:A-l.lts,elapse:A-d.startTime,workerManagerAddr:l.workerManagerAddr,response:l.response,errorCode:l.ec,success:l.succ});this.send({type:WI.REQUEST_PROXY_WORKER_MANAGER,data:y},!0)}setProxyServer(e){this.proxyServer=e,e?_a.debug("reportProxyServerurl: ".concat(e)):_a.debug("disable reportProxyServerurl: ".concat(e)),b0("debug",this,"setProxyServer",e)}peerPublishStatus(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI({},p),{},{subscribeElapse:l.subscribeElapse,peer:l.peer,peerPublishDuration:Math.max(l.audioPublishDuration,l.videoPublishDuration),audiotag:l.audioPublishDuration>0?1:-1,videotag:l.videoPublishDuration>0?1:-1,lts:A,elapse:A-d.startTime,joinChannelSuccessElapse:A-(d.lastJoinSuccessTime||A)});this.send({type:WI.PEER_PUBLISH_STATUS,data:y},!0)}workerEvent(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now();(function(y,g,b){const I=y[g];if(!I||typeof I!="string")return[y];y[g]="";const k=_2(JSON.stringify(y));let B=0;const q=[];let $=0;for(let _t=0;_t<I.length;_t++)$+=I.charCodeAt(_t)<=127?1:3,$<=b-k||(q[q.length]=dT(dT({},y),{},{[g]:I.substring(B,_t)}),B=_t,$=I.charCodeAt(_t)<=127?1:3);return B!==I.length-1&&(q[q.length]=dT(dT({},y),{},{[g]:I.substring(B)})),q})(hI(hI(hI({},p),l),{},{elapse:A-d.startTime,lts:A,productType:"WebRTC"}),"payload",1300).forEach(y=>this.send({type:WI.WORKER_EVENT,data:y},!0))}apworkerEvent(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI(hI({},p),l),{},{elapse:A-d.startTime,lts:A});this.send({type:WI.AP_WORKER_EVENT,data:y},!0)}joinWebProxyAP(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI(hI({},p),l),{},{elapse:A-d.startTime,lts:A,extend:l.extend||void 0});this.send({type:WI.JOIN_WEB_PROXY_AP,data:y},!0)}WebSocketQuit(e,l){const d=this.baseInfoMap.get(e);if(!d)return;const p=d.info,A=Date.now(),y=hI(hI(hI({},p),l),{},{elapse:A-d.startTime,lts:A});this.send({type:WI.WEBSOCKET_QUIT,data:y},!0)}async sendCustomReportMessage(e,l){if(this.customReportCount+=l.length,this.customReportCount>y0("CUSTOM_REPORT_LIMIT"))throw new _E(_f.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const d=l.map(A=>({type:WI.USER_ANALYTICS,data:hI({sid:e},A)})),p={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:d.map(A=>JSON.stringify(A))};try{await this.postDataToStatsCollector(p)}catch(A){throw _a.error("send custom report message failed",A.toString()),new _E(_f.CUSTOM_REPORT_SEND_FAILED,A.message)}}autoplayFailed(e,l,d,p){if(!e)return;const A=this.baseInfoMap.get(e);if(!A)return;const y=A.info,g=Date.now(),b=hI(hI({},y),{},{vid:y.vid===void 0?0:Number(y.vid),lts:g,elapse:g-A.startTime,cbRegistered:w_.onAutoplayFailed||w_.onAudioAutoplayFailed?1:-1,errorMsg:d,mediaType:l,trackId:p,extend:void 0});this.send({type:WI.AUTOPLAY_FAILED,data:b},!0)}sendApiInvoke(e){const l=y0("NOT_REPORT_EVENT");if(e.tag&&l.includes&&l.includes(e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const d=this.baseInfoMap.get(e.sid);if(!d)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:p,uid:A,cid:y}=d.info;e.lts=e.lts||Date.now();const g={invokeId:e.invokeId,sid:e.sid,cname:p,cid:y,uid:A,lts:e.lts,success:e.success,elapse:e.lts-d.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?JSON.stringify(e.error):void 0};return this.send({type:WI.API_INVOKE,data:g},!1),!0}appendSessionId(){this.clientList.forEach(e=>{if(e._sessionId){const l=this.apiInvokeUploadPendingItems.length;for(let d=0;d<l;d++){const p=this.apiInvokeUploadPendingItems.shift();p&&(p.sid=e._sessionId,this.sendApiInvoke(Object.assign({},p)))}}})}send(e,l){if(l)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>y0("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,l){const d=[],p=[];for(;e.length;){const g=e.shift();d.length<20?d.push(g):p.push(g)}e.push(...p);for(const g of[...d]){var A;this.ltsList.indexOf(g.data.lts)!==-1?(g.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(g.data.lts)):(this.ltsList.push(g.data.lts),q4(A=this.ltsList).call(A,(b,I)=>b-I))}l||(this.lastSendNormalEventTime=Date.now());const y={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:d.map(g=>JSON.stringify(g)),vid:(g=>{const b=g&&g.data.sid&&this.baseInfoMap.get(g.data.sid);return b&&b.info.vid&&+b.info.vid||0})(d[0])};return d.length&&this.postDataToStatsCollector(y).catch((g=>b=>{y0("EVENT_REPORT_RETRY")&&(l?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(g):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(g),this.normalEventUploadPendingItems.length>y0("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-y0("NORMAL_EVENT_QUEUE_CAPACITY")),_a.warning("report: drop normal events"))))})(d)),e}async postDataToStatsCollector(e){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];S1.networkState===f_.OFFLINE&&await Y0.race([S1.onlineWaiter,Q1(2*a1.maxRetryTimeout)]);const d=l?"/events/proto-raws":"/events/messages";let p=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(y0("EVENT_REPORT_DOMAIN"),"&p=").concat(y0("STATS_COLLECTOR_PORT"),"&d=").concat(d):"https://".concat(y0("EVENT_REPORT_DOMAIN"),":").concat(y0("STATS_COLLECTOR_PORT")).concat(d));for(let A=0;A<2;A+=1){A===1&&(p=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(y0("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(y0("STATS_COLLECTOR_PORT"),"&d=").concat(d):"https://".concat(y0("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(y0("STATS_COLLECTOR_PORT")).concat(d)));try{l?await Zvt(p,{timeout:1e4,data:e}):await Pb(p,{timeout:1e4,data:e})}catch(y){if(A===1)throw y;continue}return}}createBaseInfo(e,l){const d=Object.assign({},ygt);return d.sid=e,this.baseInfoMap.set(e,{info:d,startTime:l}),d}reportResourceTiming(e,l){const d=performance.getEntriesByName(e),p=d[d.length-1];p&&this.reportApiInvoke(l,{name:"Client.resourceTiming",options:p,tag:z0.TRACER}).onSuccess()}})||BW);qL.on("REPORT_LOG_UPLOAD",e=>{e.networkState=S1.networkState,_0.reportApiInvoke(null,{name:"logUploadError",options:e,tag:z0.TRACER})});class UW extends e1{constructor(l,d){super(),_s(this,"trackMediaType",void 0),_s(this,"_ID",void 0),_s(this,"_hints",[]),_s(this,"_isClosed",!1),_s(this,"_originMediaStreamTrack",void 0),_s(this,"_mediaStreamTrack",void 0),_s(this,"_external",{}),this._ID=d||i1(8,"track-"),this._originMediaStreamTrack=l,this._mediaStreamTrack=l,function(p){TO.includes(p)||TO.push(p)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(l){if(!l){const d=_0.reportApiInvoke(null,{name:$0.GET_MEDIA_STREAM_TRACK,options:[],tag:z0.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?d.onSuccess(this._mediaStreamTrack.label):d.onSuccess("")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(l){const d=TO.indexOf(l);d!==-1&&TO.splice(d,1)}(this),this.emit(mR.CLOSED)}}let d1,V5,jW,$vt=1;class g_{constructor(l){_s(this,"lockingPromise",Y0.resolve()),_s(this,"locks",0),_s(this,"name",""),_s(this,"lockId",void 0),this.lockId=$vt++,l&&(this.name=l),_a.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(l){let d;this.locks+=1,_a.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof l=="string"?l:""));const p=new Y0(y=>{d=()=>{this.locks-=1,_a.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof l=="string"?l:"")),y()}}),A=this.lockingPromise.then(()=>d);return this.lockingPromise=this.lockingPromise.then(()=>p),A}}function m2(e,l){return function(d,p,A){const y=d[p];if(typeof y!="function")throw new Error("Cannot use mutex on object property.");return A.value=async function(){const g=this[l];if(!g)throw new Error("mutex property key ".concat(l," doesn't exist on ").concat(e));const b=await g.lock("From ".concat(e,".").concat(p));try{for(var I=arguments.length,k=new Array(I),B=0;B<I;B++)k[B]=arguments[B];return await y.apply(this,k)}finally{b()}},A}}class q5 extends UW{get muted(){return this._muted}get enabled(){return this._enabled}constructor(l,d){super(l,d),_s(this,"_enabled",!0),_s(this,"_muted",!1),_s(this,"_isClosed",!1),_s(this,"_trackProcessors",[]),_s(this,"_enabledMutex",void 0),_s(this,"processor",void 0),_s(this,"processorContext",void 0),_s(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new g_("".concat(d)),l.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._trackProcessors.forEach(l=>l.destroy()),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,_a.debug("[".concat(this.getTrackId(),"] close")),b0("debug",this,"close"),this.emit(tI.NEED_CLOSE),super.close())}async _registerTrackProcessor(l){if(this._trackProcessors.indexOf(l)!==-1)return;const d=this._trackProcessors[this._trackProcessors.length-1];this._trackProcessors.push(l),l.onOutputChange=async()=>{const p=l.output||this._originMediaStreamTrack;this._mediaStreamTrack=p,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this)},d?(d.onOutputChange=async()=>{d.output&&await l.setInput(d.output)},await l.setInput(d.output||d.input||this._originMediaStreamTrack)):await l.setInput(this._originMediaStreamTrack)}_getOutputFromProcessors(){if(this._trackProcessors.length===0)return this._originMediaStreamTrack;const l=this._trackProcessors[this._trackProcessors.length-1];return l.output||l.input||this._originMediaStreamTrack}async _updateOriginMediaStreamTrack(l,d){if(l!==this._originMediaStreamTrack){if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),d&&this._originMediaStreamTrack.stop(),l.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=l,this._trackProcessors.length>0){await this._trackProcessors[0].setInput(l);const p=this._getOutputFromProcessors();this._mediaStreamTrack=p}else this._mediaStreamTrack=this._originMediaStreamTrack;this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}}_getDefaultPlayerConfig(){return{}}onTrackEnded(){_a.debug("[".concat(this.getTrackId(),"] track ended")),qS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(mR.TRACK_ENDED)}stateCheck(l,d){if(_a.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(l,": ").concat(d,"]")),b0("debug",this,"stateCheck",{stateName:l,state:d,muted:this._muted,enabled:this._enabled}),rP(d,l),this._enabled&&this._muted&&l==="enabled"&&d===!1)throw new _E(_f.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&l==="muted"&&d===!0)throw new _E(_f.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}}(function(e){e.IOS_15_INTERRUPTION_START="ios15-interruption-start",e.IOS_15_INTERRUPTION_END="ios15-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change"})(d1||(d1={})),function(e){e.AUDIO_CONTEXT_CREATED="audio_context_created"}(V5||(V5={})),function(e){e.AIDenoiser="AIDenoiser"}(jW||(jW={}));const H5={audioContextInitOptions:{}},vP=new class extends e1{constructor(){super(),_s(this,"registeredPlugins",[])}setOptions(e,l){H5[e]&&(H5[e]=l)}getOptions(e){return H5[e]}installPlugin(e){e instanceof Object&&e.name&&this.registeredPlugins.push(e.name)}},FW=window.AudioContext||window.webkitAudioContext;let q_=null;const bI=new class extends e1{constructor(){super(...arguments),_s(this,"prevState",void 0),_s(this,"curState",void 0),_s(this,"interruptDetectorTrack",void 0),_s(this,"onLocalAudioTrackMute",()=>{_a.info("ios15-interruption-start"),VI("info",["WebAudio"],"ios15-interruption-start"),this.emit(d1.IOS_15_INTERRUPTION_START)}),_s(this,"onLocalAudioTrackUnmute",async()=>{_a.info("ios15-interruption-end"),VI("info",["WebAudio"],"ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?_a.info("ios15-interruption-end-canceled"):(q_&&await q_.suspend(),this.emit(d1.IOS_15_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){_a.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),b0("debug",["WebAudio"],"bindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){_a.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),b0("debug",["WebAudio"],"unbindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function t0t(){if(!FW)return _a.error("your browser is not support web audio"),void H0("error",["WebAudio"],"your browser is not support web audio");_a.info("create audio context"),i2("info",["WebAudio"],"WebAudioContext");const e=vP.getOptions("audioContextInitOptions");_a.debug("audio content init option:",JSON.stringify(e)),q_=new FW(e),vP.emit(V5.AUDIO_CONTEXT_CREATED,q_),bI.curState=q_.state,q_.onstatechange=()=>{bI.prevState=bI.curState,bI.curState=q_?q_.state:void 0,(h_()||VS())&&bI.prevState==="running"&&bI.curState==="interrupted"&&(_a.info("ios-interruption-start"),VI("info",["AudioState"],"ios-interruption-start"),bI.emit(d1.IOS_INTERRUPTION_START)),(h_()||VS())&&bI.prevState==="interrupted"&&bI.curState==="running"&&(_a.info("ios-interruption-end"),VI("info",["AudioState"],"ios-interruption-end"),bI.emit(d1.IOS_INTERRUPTION_END)),bI.prevState!==bI.curState&&(_a.debug("AudioContext State Change","".concat(bI.prevState,"=>").concat(bI.curState)),qS("debug",["AudioContext",void 0],"statechange","".concat(bI.prevState,"=>").concat(bI.curState)),bI.emit(d1.STATE_CHANGE))},async function(l){const d=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let p,A=!1,y=!1,g=!1;function b(ga){l.state==="running"?I(!1):h_()||VS()?l.state==="suspended"&&(I(!0),ga&&l.resume().then(B,B)):l.state!=="closed"&&(I(!0),ga&&l.resume().then(B,B))}function I(ga){if(A!==ga){A=ga;for(let _u=0,ah=d;_u<ah.length;_u+=1){const _h=ah[_u];ga?window.addEventListener(_h,q,{capture:!0,passive:!0}):window.removeEventListener(_h,q,{capture:!0,passive:!0})}}}function k(){b(!0)}function B(){b(!1)}function q(){b(!0)}function $(ga){if(!g)if(p.paused)if(ga){_t(!1),g=!0;let _u;try{_u=p.play(),_u?_u.then(_r,_r):(p.addEventListener("playing",_r),p.addEventListener("abort",_r),p.addEventListener("error",_r))}catch{_r()}}else _t(!0);else _t(!1)}function _t(ga){if(y!==ga){y=ga;for(let _u=0,ah=d;_u<ah.length;_u++){const _h=ah[_u];ga?window.addEventListener(_h,_i,{capture:!0,passive:!0}):window.removeEventListener(_h,_i,{capture:!0,passive:!0})}}}function _r(){p.removeEventListener("playing",_r),p.removeEventListener("abort",_r),p.removeEventListener("error",_r),g=!1,$(!1)}function _i(){$(!0)}if(h_()){const ga=l.createMediaStreamDestination(),_u=document.createElement("div");_u.innerHTML="<audio x-webkit-airplay='deny'></audio>",p=_u.children.item(0),p.controls=!1,p.disableRemotePlayback=!0,p.preload="auto",p.srcObject=ga.stream,$(!0)}bI.on(d1.STATE_CHANGE,k),b(!1)}(q_)}function xO(){if(!q_){if(t0t(),!q_)throw new _E(_f.NOT_SUPPORTED,"can not create audio context");return q_}return q_}function BO(e){if(function(){if(K5!==null)return K5;const p=xO(),A=p.createBufferSource(),y=p.createGain(),g=p.createGain();A.connect(y),A.connect(g),A.disconnect(y);let b=!1;try{A.disconnect(y)}catch{b=!0}return A.disconnect(),K5=b,b}())return;b0("debug",["WebAudio"],"polyfillAudioNode");const l=e.connect,d=e.disconnect;e.connect=(p,A,y)=>(e._inputNodes||(e._inputNodes=[]),e._inputNodes.includes(p)||(p instanceof AudioNode?(e._inputNodes.push(p),l.call(e,p,A,y)):l.call(e,p,A)),e),e.disconnect=(p,A,y)=>{d.call(e),p?Z5(e._inputNodes,p):e._inputNodes=[];for(const g of e._inputNodes)l.call(e,g)}}let K5=null;function Y5(e,l){const d=1/l,p=xO();let A=p.createGain();A.gain.value=0,A.connect(p.destination);let y=!1;const g=()=>{if(y)return void(A=null);const b=p.createOscillator();b.onended=g,b.connect(A),b.start(0),b.stop(p.currentTime+d),e(p.currentTime)};return g(),()=>{y=!0}}const bR=_a.prefix("[inject-node]");class e0t{constructor(){_s(this,"nodeLists",[]),_s(this,"prevNode",void 0),_s(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(l,d){bR.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),l.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(d),this.nodeLists.forEach((p,A)=>{const y=this.nodeLists[A+1];y&&p.connect(y)})):l.connect(d),this.nextNode=d,this.prevNode=l}disconnect(){var l;bR.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach(d=>{d.disconnect()}),(l=this.prevNode)===null||l===void 0||l.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(l){bR.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(bR.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(l),l.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(l),l.connect(this.nextNode)),this.nodeLists.push(l)):bR.debug("add node is called before inject node connected")}removeNode(l){bR.debug("remove node in inject node, current list:",this.nodeLists.length);const d=this.nodeLists.indexOf(l);if(d===-1)return void bR.debug("$[inject-node] cannot find the node to be removed");const p=this.nodeLists[d+1],A=this.nodeLists[d-1];d===0&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(l),p?this.prevNode.connect(p):this.prevNode.connect(this.nextNode)),d===this.nodeLists.length-1&&this.nextNode&&A&&(A.disconnect(l),A.connect(this.nextNode)),d!==0&&d!==this.nodeLists.length-1&&(A.disconnect(l),A.connect(p)),bR.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class QW extends e1{get processSourceNode(){return this.sourceNode}set processedNode(l){var d;if(!this.isDestroyed&&this._processedNode!==l){try{var p;(p=this.sourceNode)===null||p===void 0||p.disconnect(this.outputNode)}catch{}(d=this._processedNode)===null||d===void 0||d.disconnect(),this._processedNode=l,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),_s(this,"outputNode",void 0),_s(this,"outputTrack",void 0),_s(this,"isPlayed",!1),_s(this,"sourceNode",void 0),_s(this,"analyserNode",void 0),_s(this,"context",void 0),_s(this,"audioBufferNode",void 0),_s(this,"destNode",void 0),_s(this,"injectNode",void 0),_s(this,"audioOutputLevel",0),_s(this,"_processedNode",void 0),_s(this,"playNode",void 0),_s(this,"isDestroyed",!1),_s(this,"onNoAudioInput",void 0),_s(this,"isNoAudioInput",!1),_s(this,"_noAudioInputCount",0),this.context=xO(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),BO(this.outputNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.smoothingTimeConstant=.4,this.analyserNode.fftSize=2048,this.injectNode=new e0t}startGetAudioBuffer(l){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(l),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=d=>{this.emit(p_.ON_AUDIO_BUFFER,function(p){for(let A=0;A<p.outputBuffer.numberOfChannels;A+=1){const y=p.outputBuffer.getChannelData(A);for(let g=0;g<y.length;g+=1)y[g]=0}return p.inputBuffer}(d))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!t_().webAudioMediaStreamDest)throw new _E(_f.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(l){this.context.state!=="running"&&Y_(()=>{bI.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=l||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){if(!this.context||h_()||VS()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode)return 0;const l=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(l);let d=0;for(let p=0;p<l.length;p++)d+=p<64?Math.abs(10*l[p]):Math.abs(6*l[p]/15);return d/l.length/255}async checkHasAudioInput(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(l>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;if(h_()||VS()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume(),!this.analyserNode)return!1;const d=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(d);let p=!1;for(let A=0;A<d.length;A++)d[A]!==0&&(p=!0);return p?(this.isNoAudioInput=!1,!0):(await Q1(200),await this.checkHasAudioInput(l?l+1:1)&&p)}getAudioVolume(){return this.outputNode.gain.value}setVolume(l){this.outputNode.gain.setValueAtTime(l,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(l){this.injectNode.addNode(l)}removeAudioNode(l){this.injectNode.removeNode(l)}disconnect(){var l,d;(l=this.processedNode)===null||l===void 0||l.disconnect(),(d=this.sourceNode)===null||d===void 0||d.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var l;this.processedNode?(l=this.processedNode)===null||l===void 0||l.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode)}}class GW extends QW{get isFreeze(){return!1}constructor(l,d){var p;if(super(),_s(this,"sourceNode",void 0),_s(this,"track",void 0),_s(this,"audioElement",void 0),_s(this,"isCurrentTrackCloned",!1),_s(this,"isRemoteTrack",!1),_s(this,"rebuildWebAudio",async()=>{if(_a.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void _a.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>_a.info("resume success")),_a.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const g=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?g.stop():this.isCurrentTrackCloned=!0;const b=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(b),BO(this.sourceNode),this.analyserNode=this.context.createAnalyser();const I=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(I,this.context.currentTime),BO(this.outputNode),this.emit(p_.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=b,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),l.kind!=="audio")throw new _E(_f.UNEXPECTED_ERROR);this.track=l;const A=new MediaStream([this.track]);this.isRemoteTrack=!!d,this.sourceNode=this.context.createMediaStreamSource(A),BO(this.sourceNode),this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=A;const y=MI();d&&y.os===C1.IOS&&Number((p=y.osVersion)===null||p===void 0?void 0:p.split(".")[0])<15&&(bI.on(d1.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(g=>{g||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(l){this.sourceNode.disconnect(),this.track=l,this.isCurrentTrackCloned=!1;const d=new MediaStream([l]);this.sourceNode=this.context.createMediaStreamSource(d),BO(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(p_.UPDATE_SOURCE),this.audioElement.srcObject=d}destroy(){this.audioElement.srcObject=null,this.audioElement.remove(),bI.off("state-change",this.rebuildWebAudio),super.destroy()}}async function VW(e,l){const d=(A,y)=>A?typeof A!="number"?A.max||A.exact||A.ideal||A.min||y:A:y,p={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:d(l.height,1080),maxWidth:d(l.width,1920)}}};return l.frameRate&&typeof l.frameRate!="number"?(p.video.mandatory.maxFrameRate=l.frameRate.max,p.video.mandatory.minFrameRate=l.frameRate.min):typeof l.frameRate=="number"&&(p.video.mandatory.maxFrameRate=l.frameRate),await navigator.mediaDevices.getUserMedia(p)}async function n0t(e){const l=await qW(e.mediaSource),d=await function(p){return new Y0((A,y)=>{const g=document.createElement("div");g.innerText="share screen",g.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const b=document.createElement("div");b.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const I=document.createElement("div");I.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",I.setAttribute("style","height: 12%;");const k=document.createElement("div");k.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const B=document.createElement("div");B.setAttribute("style","text-align: right; padding: 16px 0;");const q=document.createElement("button");q.innerHTML="cancel",q.setAttribute("style","width: 85px;"),q.onclick=()=>{document.body.removeChild($);const _t=new Error("NotAllowedError");_t.name="NotAllowedError",y(_t)},B.appendChild(q),b.appendChild(I),b.appendChild(k),b.appendChild(B);const $=document.createElement("div");$.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),$.appendChild(g),$.appendChild(b),document.body.appendChild($),p.map(_t=>{if(_t.id){const _r=document.createElement("div");_r.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let _i=_t.thumbnail;const{width:ga}=_i.getSize();ga>1920&&(_i=_i.resize({width:1920})),_r.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+_i.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+(_t.name.replace(/[\u00A0-\u9999<>\&]/g,function(_u){return"&#"+_u.charCodeAt(0)+";"})+"</span>"),_r.onclick=()=>{document.body.removeChild($),A(_t.id)},k.appendChild(_r)}})})}(l);return await VW(d,e)}async function qW(e){let l=["window","screen"];e!=="application"&&e!=="window"||(l=["window"]),e==="screen"&&(l=["screen"]);const d=HW();if(!d)throw new _E(_f.ELECTRON_IS_NULL);let p=null;try{p=d.desktopCapturer.getSources({types:l})}catch{p=null}p&&p.then||(p=new Y0((A,y)=>{d.desktopCapturer.getSources({types:l},(g,b)=>{g?y(g):A(b)})}));try{return await p}catch(A){throw new _E(_f.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,A.toString())}}let IP=null;function HW(){if(IP)return IP;try{return IP=window.require("electron"),IP}catch{return null}}const W5=new g_("safari");let KW=!1,YW=!1;async function _C(e,l){let d=0,p=null;for(;d<2;)try{p=await r0t(e,l,d>0);break}catch(A){if(A instanceof _E)throw _a.error("[".concat(l,"] ").concat(A.toString())),b0("error",[],"getLocalStream",{config:e,id:l},A.toString()),A;const y=_P(A.name||A.code||A,A.message);if(y.code===_f.MEDIA_OPTION_INVALID){_a.debug("[".concat(l,"] detect media option invalid, retry")),H0("debug",[],"[".concat(l,"] detect media option invalid, retry")),d+=1,await Q1(500);continue}throw _a.error("[".concat(l,"] ").concat(y.toString())),b0("error",[],"getLocalStream",{config:e,id:l},y.toString()),y}if(!p)throw new _E(_f.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return p}async function r0t(e,l,d){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new _E(_f.NOT_SUPPORTED,"can not find getUserMedia");d&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const p=t_(),A=new MediaStream;if(e.audioSource&&A.addTrack(e.audioSource),e.videoSource&&A.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return _a.debug("Using Video Source/ Audio Source"),H0("debug",[],"Using Video Source/ Audio Source"),A;if(e.screen)if(HW())e.screen.sourceId?v2(A,await VW(e.screen.sourceId,e.screen)):v2(A,await n0t(e.screen));else if(I4()&&e.screen.extensionId&&e.screen.mandatory){if(!p.getStreamFromExtension)throw new _E(_f.NOT_SUPPORTED,"This browser does not support screen sharing");_a.debug("[".concat(l,'] Screen access on chrome stable, looking for extension"')),H0("debug",[],"[".concat(l,'] Screen access on chrome stable, looking for extension"'));const q=await(y=e.screen.extensionId,g=l,new Y0(($,_t)=>{try{chrome.runtime.sendMessage(y,{getStream:!0},_r=>{if(!_r||!_r.streamId)return _a.error("[".concat(g,"] No response from Chrome Plugin. Plugin not installed properly"),_r),b0("error",[],"getSourceIdFromExtension",{extensionId:y,streamId:g},"No response from Chrome Plugin. Plugin not installed properly, ".concat(_r)),void _t(new _E(_f.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));$(_r.streamId)})}catch(_r){_a.error("[".concat(g,"] AgoraRTC screensharing plugin is not accessible(").concat(y,")"),_r.toString()),b0("error",[],"getSourceIdFromExtension",{extensionId:y,streamId:g},"AgoraRTC screensharing plugin is not accessible(".concat(y,"), ").concat(_r.toString())),_t(new _E(_f.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=q,v2(A,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(p.getDisplayMedia){e.screen.mediaSource&&$K(e.screen.mediaSource);const q={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource};_a.debug("[".concat(l,"] getDisplayMedia:"),JSON.stringify({video:q,audio:!!e.screenAudio})),i2("debug",["mediaDevices",l],"getDisplayMedia",{video:q,audio:!!e.screenAudio,trackId:l}),v2(A,await navigator.mediaDevices.getDisplayMedia({video:q,audio:!!e.screenAudio}))}else{if(!d_())throw _a.error("[".concat(l,"] This browser does not support screenSharing")),new _E(_f.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&$K(e.screen.mediaSource);const q={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};_a.debug("[".concat(l,"] getUserMedia: ").concat(JSON.stringify(q))),i2("debug",["mediaDevices",l],"getUserMedia",q),v2(A,await navigator.mediaDevices.getUserMedia(q))}}var y,g;if(!e.video&&!e.audio)return A;let b={video:e.video,audio:e.audio},I=y0("MEDIA_DEVICE_CONSTRAINTS");if(I)try{typeof I=="string"&&(I=JSON.parse(I)),b=function q($,_t){if(!BJ($)||!BJ(_t)||Array.isArray($)&&!Array.isArray(_t)||!Array.isArray($)&&Array.isArray(_t))return _t;if(Array.isArray(_t)&&Array.isArray($)){const _r=[...$];for(let _i=0;_i<_t.length;_i++)_r[_i]=q($[_i],_t[_i]);return _r}{const _r=dT({},$);for(const _i in _t)Object.prototype.hasOwnProperty.call(_t,_i)&&(Object.prototype.hasOwnProperty.call($,_i)?_r[_i]=q($[_i],_t[_i]):_r[_i]=_t[_i]);return _r}}(b,I),H0("debug",["mediaDevices",l],"merge configConstraints ".concat(JSON.stringify(I)))}catch{}_a.debug("[".concat(l,"] GetUserMedia"),JSON.stringify(b)),i2("debug",["mediaDevices",l],"getUserMedia",b),MI();let k,B=null;(y_()||h_()||BL())&&(B=await W5.lock());try{k=await navigator.mediaDevices.getUserMedia(b)}catch(q){throw B&&B(),q}return b.audio&&(KW=!0),b.video&&(YW=!0),v2(A,k),B&&B(),A}function _P(e,l){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new _E(_f.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(l));case"NotFoundError":case"DevicesNotFoundError":return new _E(_f.DEVICE_NOT_FOUND,"".concat(e,": ").concat(l));case"NotSupportedError":return new _E(_f.NOT_SUPPORTED,"".concat(e,": ").concat(l));case"NotReadableError":return new _E(_f.NOT_READABLE,"".concat(e,": ").concat(l));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new _E(_f.PERMISSION_DENIED,"".concat(e,": ").concat(l));case"ConstraintNotSatisfiedError":return new _E(_f.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(l));default:return _a.error("getUserMedia unexpected error",e),b0("error",[],"handleGetUserMediaError",void 0,e),new _E(_f.UNEXPECTED_ERROR,"".concat(e,": ").concat(l))}}function v2(e,l){const d=e.getVideoTracks()[0],p=e.getAudioTracks()[0],A=l.getVideoTracks()[0],y=l.getAudioTracks()[0];y&&(p&&e.removeTrack(p),e.addTrack(y)),A&&(d&&e.removeTrack(d),e.addTrack(A))}const E_=new class extends e1{get state(){return this._state}set state(e){e!==this._state&&(this.emit(HS.STATE_CHANGE,e),this._state=e)}constructor(){super(),_s(this,"_state",eT.IDLE),_s(this,"isAccessMicrophonePermission",!1),_s(this,"isAccessCameraPermission",!1),_s(this,"lastAccessMicrophonePermission",!1),_s(this,"lastAccessCameraPermission",!1),_s(this,"checkdeviceMatched",!1),_s(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(y0("ENUMERATE_DEVICES_INTERVAL")||eK()&&e2())&&this.updateDevicesInfo()},y0("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>_a.error(e.toString()))}async enumerateDevices(e,l){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new _E(_f.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const p=await navigator.mediaDevices.enumerateDevices(),A=this.checkMediaDeviceInfoIsOk(p);let y=!this.isAccessMicrophonePermission&&e,g=!this.isAccessCameraPermission&&l;A.audio&&(y=!1),A.video&&(g=!1);let b=null,I=null,k=null;if(!d&&(y||g)){if(W5.isLocked&&(_a.debug("[device manager] wait GUM lock"),(await W5.lock())(),_a.debug("[device manager] GUM unlock")),KW&&(y=!1,this.isAccessMicrophonePermission=!0),YW&&(g=!1,this.isAccessCameraPermission=!0),_a.debug("[device manager] check media device permissions",e,l,y,g),y&&g){try{k=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(B){const q=_P(B.name||B.code||B,B.message);if(q.code===_f.PERMISSION_DENIED)throw q;_a.warning("getUserMedia failed in getDevices",q)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(y){try{b=await navigator.mediaDevices.getUserMedia({audio:e})}catch(B){const q=_P(B.name||B.code||B,B.message);if(q.code===_f.PERMISSION_DENIED)throw q;_a.warning("getUserMedia failed in getDevices",q)}this.isAccessMicrophonePermission=!0}else if(g){try{I=await navigator.mediaDevices.getUserMedia({video:l})}catch(B){const q=_P(B.name||B.code||B,B.message);if(q.code===_f.PERMISSION_DENIED)throw q;_a.warning("getUserMedia failed in getDevices",q)}this.isAccessCameraPermission=!0}_a.debug("[device manager] mic permission",e,"cam permission",l)}try{const B=await navigator.mediaDevices.enumerateDevices();return b&&b.getTracks().forEach(q=>q.stop()),I&&I.getTracks().forEach(q=>q.stop()),k&&k.getTracks().forEach(q=>q.stop()),b=null,I=null,k=null,B}catch(B){return b&&b.getTracks().forEach(q=>q.stop()),I&&I.getTracks().forEach(q=>q.stop()),k&&k.getTracks().forEach(q=>q.stop()),b=null,I=null,k=null,new _E(_f.ENUMERATE_DEVICES_FAILED,B.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(l=>l.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(l=>l.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(l=>l.kind==="audiooutput")}searchDeviceIdByName(e){let l=null;return this.deviceInfoMap.forEach(d=>{d.device.label===e&&(l=d.device.deviceId)}),l}async getDeviceById(e){const l=(await this.enumerateDevices(!0,!0,!0)).find(d=>d.deviceId===e);if(!l)throw new _E(_f.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return l}async init(){this.state=eT.INITING;try{await this.updateDevicesInfo(),this.state=eT.INITEND}catch(e){throw _a.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=eT.IDLE,!function(){return typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1"}()&&new _E(_f.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),l=Date.now(),d=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const A=e.find(g=>g.kind==="audioinput"&&g.deviceId==="default"),y=e.find(g=>g.kind==="audiooutput"&&g.deviceId==="default");A&&y?y.groupId===A.groupId?_a.debug("[device-check] default input ".concat(A.label," and output ").concat(y.label," is the same group")):_a.warning("[device-check] default input ".concat(A.label," and output ").concat(y.label," is not the same group")):_a.debug("[device-check] default input or output not found")}const p=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(A=>{if(!A.deviceId)return;const y=this.deviceInfoMap.get("".concat(A.kind,"_").concat(A.deviceId));if((y?y.state:"INACTIVE")!=="ACTIVE"){const g={initAt:l,updateAt:l,device:A,state:"ACTIVE"};this.deviceInfoMap.set("".concat(A.kind,"_").concat(A.deviceId),g),d.push(g)}y&&(y.updateAt=l)}),this.deviceInfoMap.forEach((A,y)=>{A.state==="ACTIVE"&&A.updateAt!==l&&(A.state="INACTIVE",d.push(A))}),this.state!==eT.INITEND)return p.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(p.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));d.forEach(A=>{switch(A.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(HS.RECORDING_DEVICE_CHANGED,A);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(HS.CAMERA_DEVICE_CHANGED,A);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(HS.PLAYOUT_DEVICE_CHANGED,A)}}),p.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),p.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const l=e.filter(A=>A.kind==="audioinput"),d=e.filter(A=>A.kind==="videoinput"),p={audio:!1,video:!1};for(const A of l)if(A.label&&A.deviceId){p.audio=!0;break}for(const A of d)if(A.label&&A.deviceId){p.video=!0;break}return p}};var WW;let i0t=U1("AudioElementPlayCenter")(WW=class{constructor(){_s(this,"onAutoplayFailed",void 0),_s(this,"elementMap",new Map),_s(this,"elementStateMap",new Map),_s(this,"elementsNeedToResume",[]),_s(this,"sinkIdMap",new Map),_s(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[l,d]=e;const p=this.elementStateMap.get(l),A=d.srcObject.getAudioTracks()[0];t2()?A&&A.readyState==="live"&&bI.curState==="running"&&(_a.debug("auto resume after interruption for iOS 15"),H0("debug",["AudioElementPlayCenter",l],"auto resume after interruption for iOS15"),d.pause(),d.play()):p&&p==="paused"&&A&&A.readyState==="live"&&bI.curState==="running"&&(_a.debug("auto resume after interruption for iOS"),H0("debug",["AudioElementPlayCenter",l],"auto resume after interruption for iOS"),d.play())})}),_s(this,"autoResumeAfterInterruptionOnIOS15",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[l,d]=e;const p=d.srcObject.getAudioTracks()[0];p&&p.readyState==="live"&&(_a.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),b0("debug",["AudioElementPlayCenter",l],"autoResumeAfterInterruptionOnIOS15"),d.pause(),d.play())})}),this.autoResumeAudioElement(),bI.on(d1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.on(d1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),bI.on(d1.STATE_CHANGE,()=>{h_()&&bI.prevState==="suspended"&&bI.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,l){const d=this.elementMap.get(e);if(this.sinkIdMap.set(e,l),d)try{await d.setSinkId(l)}catch(p){throw new _E(_f.PERMISSION_DENIED,"can not set sink id: "+p.toString())}}play(e,l,d,p){if(this.elementMap.has(l))return;const A=document.createElement("audio");A.autoplay=!0,A.srcObject=new MediaStream([e]),this.bindAudioElementEvents(l,A),this.elementMap.set(l,A),this.elementStateMap.set(l,j1.INIT),this.setVolume(l,d);const y=this.sinkIdMap.get(l);if(y)try{A.setSinkId(y).catch(b=>{_a.warning("[".concat(l,"] set sink id failed"),b.toString()),i2("warning",["HTMLAudioElement",l],"setSinkId",b.toString())})}catch(b){_a.warning("[".concat(l,"] set sink id failed"),b.toString())}const g=A.play();g&&g.then&&g.catch(b=>{p&&_0.autoplayFailed(p,"audio",b.message,l),_a.warning("audio element play warning",b.toString()),i2("warning",["HTMLAudioElement",l],"play",b.toString()),this.elementMap.has(l)&&b.name==="NotAllowedError"&&(_a.warning("detected audio element autoplay failed"),b0("warning",["AudioElementPlayCenter",l],"play",b.toString()),this.elementsNeedToResume.push(A),Y_(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),xW()}))})}updateTrack(e,l){const d=this.elementMap.get(e);d&&(d.srcObject=new MediaStream([l]))}isPlaying(e){return this.elementMap.has(e)}setVolume(e,l){const d=this.elementMap.get(e);d&&(l=Math.max(0,Math.min(100,l)),d.volume=l/100)}stop(e){const l=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!l)return;const d=this.elementsNeedToResume.indexOf(l);this.elementsNeedToResume.splice(d,1),l.srcObject=null,l.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,l){o0t.forEach(d=>{l.addEventListener(d,p=>{const A=this.elementStateMap.get(e),y=p.type==="pause"?"paused":p.type;_a.debug("[".concat(e,"] audio-element-status change ").concat(A," => ").concat(y)),qS("debug",["HTMLAudioElement",e],"statusChange","".concat(A," => ").concat(y)),this.elementStateMap.set(e,y)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(l=>{l.play().then(d=>{_a.debug("Auto resume audio element success"),b0("debug",["AudioElementPlayCenter"],"autoResumeAudioElement")}).catch(d=>{_a.warning("Auto resume audio element failed!",d),b0("warning",["AudioElementPlayCenter"],"autoResumeAudioElement",d.toString())})}),this.elementsNeedToResume=[]};new Y0(l=>{document.body?l():window.addEventListener("load",()=>l())}).then(()=>{const l=MI();l.os!=="Android"||l.name!=="Chrome"&&l.name!==DI.WECHAT?(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)):document.body.addEventListener("click",e,!0)})}})||WW;const o0t=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],m_=new i0t;function $I(){return function(e,l,d){const p=e[l];typeof p=="function"&&(d.value=function(){this._isClosed&&new _E(_f.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var A=arguments.length,y=new Array(A),g=0;g<A;g++)y[g]=arguments[g];const b=p.apply(this,y);return b instanceof Y0?new Y0((I,k)=>{b.then(I).catch(k)}):b})}}var JW,zW,XW,ZW,$W,tJ,eJ,nJ,rJ,iJ,oJ,sJ,y1,aJ,cJ,uJ,lJ,dJ,uT,hJ,pJ,fJ,AJ,gJ,EJ,mJ,l_,vJ;function IJ(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function J5(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?IJ(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):IJ(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let D1=(JW=U1("LocalAudioTrack","getTrackId"),zW=$I(),XW=m2("LocalAudioTrack","_enabledMutex"),ZW=$I(),$W=m2("LocalAudioTrack","_enabledMutex"),tJ=$I(),eJ=mP({report:_0}),nJ=$I(),rJ=$I(),iJ=$I(),oJ=$I(),JW((X0((y1=class extends q5{get isPlaying(){return this._useAudioElement?m_.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,l,d){super(e,d),_s(this,"trackMediaType","audio"),_s(this,"_encoderConfig",void 0),_s(this,"_source",void 0),_s(this,"_enabled",!0),_s(this,"_volume",100),_s(this,"_useAudioElement",!1),_s(this,"_bypassWebAudio",!1),_s(this,"processor",void 0),_s(this,"processorContext",void 0),_s(this,"processorDestination",void 0),this._encoderConfig=l,this._source=new GW(e),y0("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),this.processorContext=new c0t(this._source.context,this.getTrackId()),this.processorDestination=new a0t(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(p_.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setVolume(e){jI(e,"volume",0,1e3);const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&m_.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return _a.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void l.onSuccess();const d=this._source.createOutputTrack();this._mediaStreamTrack!==d&&(this._mediaStreamTrack=d,YI(this,tI.NEED_REPLACE_TRACK,this).then(()=>{_a.debug("[".concat(this.getTrackId(),"] replace web audio track success")),H0("debug",this,"replace web audio track success")}).catch(p=>{_a.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),p),H0("warning",this,"replace web audio track failed ".concat(p.toString()))}))}catch{}l.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new _E(_f.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await m_.setSinkID(this.getTrackId(),e)}catch(d){throw l.onError(d),d}l.onSuccess()}async setEnabled(e,l,d){if(!d){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_a.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),e){this._originMediaStreamTrack.enabled=!0;try{d||(this._enabled=!0),await YI(this,tI.NEED_ENABLE_TRACK,this),_a.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success")),b0("info",this,"setEnabled",e,"success")}catch(p){throw d||(this._enabled=!1),_a.error("[".concat(this.getTrackId(),"] setEnabled to true error"),p.toString()),b0("error",this,"setEnabled",e,p.toString()),p}}else{this._originMediaStreamTrack.enabled=!1,d||(this._enabled=!1);try{await YI(this,tI.NEED_DISABLE_TRACK,this)}catch(p){throw d||(this._enabled=!0),_a.error("[".concat(this.getTrackId(),"] setEnabled to false error"),p.toString()),b0("info",this,"setEnabled",e,p.toString()),p}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._mediaStreamTrack.enabled=!e,_a.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),b0("debug",this,"setMuted",e),e?await YI(this,tI.NEED_MUTE_TRACK,this):await YI(this,tI.NEED_UNMUTE_TRACK,this))}getStats(){return UO(()=>{_a.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead"),H0("warning",this,"LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),pT(this,tI.GET_STATS)||J5({},z4)}setAudioFrameCallback(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(p_.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(l),this._source.removeAllListeners(p_.ON_AUDIO_BUFFER),this._source.on(p_.ON_AUDIO_BUFFER,d=>e(d))}play(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});_a.debug("[".concat(this.getTrackId(),"] start audio playback")),b0("debug",this,"play"),this._useAudioElement?(_a.debug("[".concat(this.getTrackId(),"] start audio playback in element")),H0("debug",this,"start audio playback in element"),m_.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});_a.debug("[".concat(this.getTrackId(),"] stop audio playback")),b0("debug",this,"stop"),this._useAudioElement?m_.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){_a.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&m_.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,l){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),e.addEventListener("ended",this._handleTrackEnded),l&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=e,this.processor&&this.processor.updateInput({track:e,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack))}renewMediaStreamTrack(e){return Y0.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new _E(_f.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new _E(_f.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const l=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,l.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(R_.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(R_.ON_NODE,e=>{this._source.processedNode=e})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(R_.ON_TRACK),this.processorDestination.removeAllListeners(R_.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(u_.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(u_.REQUEST_CONSTRAINTS)}}).prototype,"setPlaybackDevice",[zW],Object.getOwnPropertyDescriptor(y1.prototype,"setPlaybackDevice"),y1.prototype),X0(y1.prototype,"setEnabled",[XW,ZW],Object.getOwnPropertyDescriptor(y1.prototype,"setEnabled"),y1.prototype),X0(y1.prototype,"setMuted",[$W,tJ,eJ],Object.getOwnPropertyDescriptor(y1.prototype,"setMuted"),y1.prototype),X0(y1.prototype,"getStats",[nJ],Object.getOwnPropertyDescriptor(y1.prototype,"getStats"),y1.prototype),X0(y1.prototype,"setAudioFrameCallback",[rJ],Object.getOwnPropertyDescriptor(y1.prototype,"setAudioFrameCallback"),y1.prototype),X0(y1.prototype,"play",[iJ],Object.getOwnPropertyDescriptor(y1.prototype,"play"),y1.prototype),X0(y1.prototype,"stop",[oJ],Object.getOwnPropertyDescriptor(y1.prototype,"stop"),y1.prototype),sJ=y1))||sJ),MO=(aJ=U1("MicrophoneAudioTrack","getTrackId"),cJ=$I(),uJ=m2("MicrophoneAudioTrack","_enabledMutex"),lJ=$I(),aJ((X0((uT=class extends D1{constructor(e,l,d,p){super(e,l.encoderConfig?eP(l.encoderConfig):{},p),_s(this,"_config",void 0),_s(this,"_deviceName","default"),_s(this,"_constraints",void 0),_s(this,"_originalConstraints",void 0),_s(this,"_enabled",!0),Z0("info",this,"constructor",{trackId:p,deviceId:e.label,constraints:d}),this._config=l,this._constraints=d,this._originalConstraints=d,this._deviceName=e.label,typeof l.bypassWebAudio=="boolean"&&(this._bypassWebAudio=l.bypassWebAudio),t2()&&bI.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}async setDevice(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(_a.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),b0("info",this,"setDevice",e),this._enabled)try{const d=await E_.getDeviceById(e),p={};p.audio=J5({},this._constraints),p.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let A=null;try{A=await _C(p,this.getTrackId())}catch(y){throw _a.error("[".concat(this.getTrackId(),"] setDevice failed"),y.toString()),b0("error",this,"setDevice",e,y.toString()),A=await _C({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(A.getAudioTracks()[0],!1),y}await this._updateOriginMediaStreamTrack(A.getAudioTracks()[0],!1),this._deviceName=d.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(d){throw l.onError(d),_a.error("[".concat(this.getTrackId(),"] setDevice error"),d.toString()),b0("error",this,"setDevice",e,d.toString()),d}else try{const d=await E_.getDeviceById(e);this._deviceName=d.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(d){throw l.onError(d),_a.error("[".concat(this.getTrackId(),"] setDevice error"),d.toString()),b0("error",this,"setDevice",e,d.toString()),d}l.onSuccess(),_a.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success")),b0("info",this,"setDevice",e,"success")}async setEnabled(e,l,d){if(l)return _a.debug("[".concat(this.getTrackId,"] setEnabled false (do not close microphone)")),H0("debug",this,"setEnabled false (do not close microphone)"),await super.setEnabled(e);if(!d){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_a.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),d||(this._enabled=!1);try{await YI(this,tI.NEED_DISABLE_TRACK,this)}catch(y){throw _a.error("[".concat(this.getTrackId(),"] setEnabled false failed"),y.toString()),b0("error",this,"setEnabled",e,y.toString()),y}return}const p=J5({},this._constraints),A=E_.searchDeviceIdByName(this._deviceName);A&&!p.deviceId&&(p.deviceId=A);try{d||(this._enabled=!0);const y=await _C({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(y.getAudioTracks()[0],!1),await YI(this,tI.NEED_ENABLE_TRACK,this)}catch(y){throw d||(this._enabled=!1),_a.error("[".concat(this.getTrackId(),"] setEnabled true failed"),y.toString()),b0("error",this,"setEnabled",e,y.toString()),y}_a.info("[".concat(this.getTrackId(),"] setEnabled success")),b0("info",this,"setEnabled",e,"success")}close(){super.close(),t2()&&bI.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((h_()||VS())&&this._enabled&&!this._isClosed&&bI.duringInterruption){const e=async()=>{bI.off(d1.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(_a.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),H0("debug",this,"try capture microphone media device for interrupted iOS device"),await this.setEnabled(!1),await this.setEnabled(!0))};bI.on(d1.IOS_INTERRUPTION_END,e)}else _a.debug("[".concat(this.getTrackId(),"] track ended")),qS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(mR.TRACK_ENDED)}async renewMediaStreamTrack(e){const l=e||this._constraints,d=E_.searchDeviceIdByName(this._deviceName);d&&!l.deviceId&&(l.deviceId=d),this._constraints=l,this._originMediaStreamTrack.stop();const p=await _C({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(p.getAudioTracks()[0],!0)}bindProcessorContextEvents(){this.processorContext.on(u_.REQUEST_UPDATE_CONSTRAINTS,async(e,l,d)=>{try{const p=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(p),l()}catch(p){d(p)}}),this.processorContext.on(u_.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[cJ],Object.getOwnPropertyDescriptor(uT.prototype,"setDevice"),uT.prototype),X0(uT.prototype,"setEnabled",[uJ,lJ],Object.getOwnPropertyDescriptor(uT.prototype,"setEnabled"),uT.prototype),dJ=uT))||dJ),s0t=(hJ=U1("BufferSourceAudioTrack","getTrackId"),pJ=$I(),fJ=$I(),AJ=$I(),gJ=$I(),EJ=$I(),hJ((X0((l_=class extends D1{constructor(e,l,d,p){super(l.createOutputTrack(),d,p),_s(this,"source",void 0),_s(this,"_bufferSource",void 0),Z0("info",this,"constructor",{trackId:p}),this.source=e,this._bufferSource=l,this._bufferSource.on(p_.AUDIO_SOURCE_STATE_CHANGE,A=>{this.emit(mR.SOURCE_STATE_CHANGE,A)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),l.onSuccess()}pauseProcessAudioBuffer(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}seekAudioBuffer(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),l.onSuccess()}resumeProcessAudioBuffer(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}stopProcessAudioBuffer(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}).prototype,"startProcessAudioBuffer",[pJ],Object.getOwnPropertyDescriptor(l_.prototype,"startProcessAudioBuffer"),l_.prototype),X0(l_.prototype,"pauseProcessAudioBuffer",[fJ],Object.getOwnPropertyDescriptor(l_.prototype,"pauseProcessAudioBuffer"),l_.prototype),X0(l_.prototype,"seekAudioBuffer",[AJ],Object.getOwnPropertyDescriptor(l_.prototype,"seekAudioBuffer"),l_.prototype),X0(l_.prototype,"resumeProcessAudioBuffer",[gJ],Object.getOwnPropertyDescriptor(l_.prototype,"resumeProcessAudioBuffer"),l_.prototype),X0(l_.prototype,"stopProcessAudioBuffer",[EJ],Object.getOwnPropertyDescriptor(l_.prototype,"stopProcessAudioBuffer"),l_.prototype),mJ=l_))||mJ),H_=U1("MixingAudioTrack","getTrackId")(vJ=class extends D1{get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=xO().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,i1(8,"track-mix-")),_s(this,"trackList",void 0),_s(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return this.trackList.indexOf(e)!==-1}addAudioTrack(e){if(this.trackList.indexOf(e)!==-1)return _a.debug("track ".concat(e.getTrackId()," is already added")),void H0("debug",this,"track already added");_a.debug("add ".concat(e.getTrackId()," to mixing track")),b0("debug",this,"addAudioTrack",e.getTrackId()),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()}removeAudioTrack(e){if(this.trackList.indexOf(e)!==-1){_a.debug("remove ".concat(e.getTrackId()," from mixing track")),b0("debug",this,"removeAudioTrack",e.getTrackId());try{e._source.outputNode.disconnect(this.destNode)}catch{}Z5(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach(l=>{l._encoderConfig&&((l._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=l._encoderConfig.bitrate),(l._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=l._encoderConfig.sampleRate),(l._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=l._encoderConfig.sampleSize),l._encoderConfig.stereo&&(e.stereo=!0))}),this._encoderConfig=e}})||vJ;class a0t extends e1{constructor(l){super(),_s(this,"name","AudioProcessorDestination"),_s(this,"ID","0"),_s(this,"inputTrack",void 0),_s(this,"inputNode",void 0),_s(this,"audioProcessorContext",void 0),_s(this,"_source",void 0),this.audioProcessorContext=l}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new _E(_f.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.emit(R_.ON_TRACK,void 0),this.emit(R_.ON_NODE,void 0)}updateInput(l){if(l.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);l.track&&this.inputTrack!==l.track&&(this.inputTrack=l.track,this.emit(R_.ON_TRACK,this.inputTrack)),l.node&&this.inputNode!==l.node&&(this.inputNode=l.node,this.emit(R_.ON_NODE,this.inputNode))}}class c0t extends e1{constructor(l,d){super(),_s(this,"constraintsMap",new Map),_s(this,"statsRegistry",[]),_s(this,"audioContext",void 0),_s(this,"trackId",void 0),this.audioContext=l,this.trackId=d}async getConstraints(){return O_(this,u_.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(l,d){var p;return _a.info("processor ".concat(d.name," requestApplyConstraints for ").concat(this.trackId)),l&&this.constraintsMap.set(d,l),YI(this,u_.REQUEST_UPDATE_CONSTRAINTS,Array.from(zS(p=this.constraintsMap).call(p)))}async requestRevertConstraints(l){var d;if(this.constraintsMap.has(l))return this.constraintsMap.delete(l),YI(this,u_.REQUEST_UPDATE_CONSTRAINTS,Array.from(zS(d=this.constraintsMap).call(d)))}registerStats(l,d,p){this.statsRegistry.find(A=>A.processorID===l.ID&&A.processorName===l.name&&A.type===d)||this.statsRegistry.push({processorName:l.name,processorID:l.ID,type:d,cb:p})}unregisterStats(l,d){}gatherStats(){return this.statsRegistry.map(l=>{let{processorID:d,processorName:p,type:A,cb:y}=l;return{processorID:d,processorName:p,type:A,stats:y()}})}}class u0t extends e1{constructor(){super(...arguments),_s(this,"resultStorage",new Map)}setLocalAudioStats(l,d,p){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",l,this.checkAudioInputLevel(p,d)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",l,this.checkSendAudioBitrate(p,d))}setLocalVideoStats(l,d,p){this.record("SEND_VIDEO_BITRATE_TOO_LOW",l,this.checkSendVideoBitrate(p,d)),this.record("FRAMERATE_INPUT_TOO_LOW",l,this.checkFramerateInput(p,d)),this.record("FRAMERATE_SENT_TOO_LOW",l,this.checkFramerateSent(p))}setRemoteAudioStats(l,d){const p=l.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",p,this.checkAudioOutputLevel(d))}setRemoteVideoStats(l,d){const p=l.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",p,this.checkVideoDecode(d))}record(l,d,p){this.resultStorage.has(l)||this.resultStorage.set(l,{result:[],isPrevNormal:!0});const A=this.resultStorage.get(l);if(A&&(A.result.push(p),A.result.length>=5)){const y=A.result.includes(!0);A.isPrevNormal&&!y&&this.emit("exception",_J[l],l,d),!A.isPrevNormal&&y&&this.emit("exception",_J[l]+2e3,l+"_RECOVER",d),A.isPrevNormal=y,A.result=[]}}checkAudioOutputLevel(l){return!(l.receiveBitrate>0&&l.receiveLevel===0)}checkAudioInputLevel(l,d){return d instanceof H_&&!d.isActive||!!d.muted||l.sendVolumeLevel!==0}checkFramerateInput(l,d){let p=null;d._encoderConfig&&d._encoderConfig.frameRate&&(p=CR(d._encoderConfig.frameRate));const A=l.captureFrameRate;return!p||!A||!(p>10&&A<5||p<10&&p>=5&&A<=1)}checkFramerateSent(l){return!(l.captureFrameRate&&l.sendFrameRate&&l.captureFrameRate>5&&l.sendFrameRate<=1)}checkSendVideoBitrate(l,d){return!!d.muted||l.sendBitrate!==0}checkSendAudioBitrate(l,d){return d instanceof H_&&!d.isActive||!!d.muted||l.sendBitrate!==0}checkVideoDecode(l){return l.receiveBitrate===0||l.decodeFrameRate!==0}}const _J={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},K_=new class{markSubscribeStart(e,l){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(l))}markPublishStart(e,l){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(l))}measureFromSubscribeStart(e,l){const d=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(l));if(d.length>0){const p=d[d.length-1];return Math.round(performance.now()-p.startTime)}return 0}measureFromPublishStart(e,l){const d=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(l));if(d.length>0){const p=d[d.length-1];return Math.round(performance.now()-p.startTime)}return 0}};function yJ(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function lT(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?yJ(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):yJ(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}class I2{constructor(l){_s(this,"store",void 0),_s(this,"onStatsException",void 0),_s(this,"onUploadPublishDuration",void 0),_s(this,"localStats",new Map),_s(this,"remoteStats",new Map),_s(this,"updateStatsInterval",void 0),_s(this,"trafficStats",void 0),_s(this,"trafficStatsPeerList",[]),_s(this,"uplinkStats",void 0),_s(this,"exceptionMonitor",void 0),_s(this,"p2pChannel",void 0),_s(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=l,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new u0t,this.exceptionMonitor.on("exception",(d,p,A)=>{this.onStatsException&&this.onStatsException(d,p,A)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Q0.LocalAudioTrack)||lT({},z4)}getLocalVideoTrackStats(){return this.localStats.get(Q0.LocalVideoTrack)||lT({},X4)}getRemoteAudioTrackStats(l){const d=(y,g)=>{if(!this.trafficStats)return g;const b=this.trafficStats.peer_delay.find(I=>I.peer_uid===y);return b&&(g.publishDuration=b.B_ppad+(Date.now()-this.trafficStats.timestamp)),g},p={};if(l){var A;const y=(A=this.remoteStats.get(l))===null||A===void 0?void 0:A.audioStats;y&&(p[l]=d(l,y))}else Array.from(this.remoteStats.entries()).forEach(y=>{let[g,{audioStats:b}]=y;b&&(p[g]=d(g,b))});return p}getRemoteNetworkQualityStats(l){const d={};if(l){var p;const A=(p=this.remoteStats.get(l))===null||p===void 0?void 0:p.networkStats;A&&(d[l]=A)}else Array.from(this.remoteStats.entries()).forEach(A=>{let[y,{networkStats:g}]=A;g&&(d[y]=g)});return d}getRemoteVideoTrackStats(l){const d=(y,g)=>{if(!this.trafficStats)return g;const b=this.trafficStats.peer_delay.find(I=>I.peer_uid===y);return b&&(g.publishDuration=b.B_ppvd+(Date.now()-this.trafficStats.timestamp)),g},p={};if(l){var A;const y=(A=this.remoteStats.get(l))===null||A===void 0?void 0:A.videoStats;y&&(p[l]=d(l,y))}else Array.from(this.remoteStats.entries()).forEach(y=>{let[g,{videoStats:b}]=y;b&&(p[g]=d(g,b))});return p}getRTCStats(){let l=0,d=0,p=0,A=0;const y=this.localStats.get(Q0.LocalAudioTrack);y&&(l+=y.sendBytes,d+=y.sendBitrate);const g=this.localStats.get(Q0.LocalVideoTrack);g&&(l+=g.sendBytes,d+=g.sendBitrate);const b=this.localStats.get(Q0.LocalVideoLowTrack);b&&(l+=b.sendBytes,d+=b.sendBitrate),this.remoteStats.forEach(k=>{let{audioStats:B,videoStats:q}=k;B&&(p+=B.receiveBytes,A+=B.receiveBitrate),q&&(p+=q.receiveBytes,A+=q.receiveBitrate)});let I=1;return this.trafficStats&&(I+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:I,SendBitrate:d,SendBytes:l,RecvBytes:p,RecvBitrate:A,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(l){this.localStats.set(l,void 0)}removeLocalStats(l){l?this.localStats.delete(l):this.localStats.clear()}addRemoteStats(l){this.remoteStats.set(l,{})}removeRemoteStats(l){l?this.remoteStats.delete(l):this.remoteStats.clear()}addP2PChannel(l){this.p2pChannel=l}updateTrafficStats(l){l.peer_delay=l.peer_delay.filter(d=>d.B_ppad!==void 0||d.B_ppvd!==void 0),l.peer_delay.filter(d=>this.trafficStatsPeerList.indexOf(d.peer_uid)===-1).forEach(d=>{var p;const A=(p=this.p2pChannel)===null||p===void 0?void 0:p.getRemoteMedia(d.peer_uid),y=A!=null&&A.videoSSRC?K_.measureFromSubscribeStart(this.store.clientId,A.videoSSRC):0,g=A!=null&&A.audioSSRC?K_.measureFromSubscribeStart(this.store.clientId,A.audioSSRC):0;d.B_ppad!==void 0&&d.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(d.peer_uid,d.B_ppad,d.B_ppvd,y>g?y:g),this.trafficStatsPeerList.push(d.peer_uid))}),this.trafficStats=l}updateUplinkStats(l){this.uplinkStats&&this.uplinkStats.B_fir!==l.B_fir&&_a.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(l.B_fir)),this.uplinkStats=l}static isRemoteVideoFreeze(l,d,p){if(!l)return!1;const A=!!p&&d.framesDecodeFreezeTime>p.framesDecodeFreezeTime,y=!p||d.framesDecodeCount>p.framesDecodeCount;return A||!y}static isRemoteAudioFreeze(l){return!!l&&l._isFreeze()}isLocalVideoFreeze(l){return!(!l.inputFrame||!l.sentFrame)&&l.inputFrame.frameRate>5&&l.sentFrame.frameRate<3}updateLocalStats(l){Array.from(this.localStats.entries()).forEach(d=>{let[p,A]=d;switch(p){case Q0.LocalVideoTrack:case Q0.LocalVideoLowTrack:{const y=A,g=lT({},X4),b=l.getStats(),I=l.getLocalMedia(p);if(b){const k=b.videoSend.find(B=>B.ssrc===(I==null?void 0:I.ssrcs[0].ssrcId));if(k){const B=l.getLocalVideoSize(),q=l.getEncoderConfig(Q0.LocalVideoTrack);k.codec!=="H264"&&k.codec!=="VP8"&&k.codec!=="VP9"&&k.codec!=="AV1X"&&k.codec!=="AV1"||(g.codecType=k.codec),g.sendBytes=k.bytes,g.sendBitrate=y?8*Math.max(0,g.sendBytes-y.sendBytes):0,k.inputFrame?(g.captureFrameRate=k.inputFrame.frameRate,g.captureResolutionHeight=k.inputFrame.height,g.captureResolutionWidth=k.inputFrame.width):B&&(g.captureResolutionWidth=B.width,g.captureResolutionHeight=B.height),k.sentFrame?(g.sendFrameRate=k.sentFrame.frameRate,g.sendResolutionHeight=k.sentFrame.height,g.sendResolutionWidth=k.sentFrame.width):B&&(g.sendResolutionWidth=B.width,g.sendResolutionHeight=B.height),k.avgEncodeMs&&(g.encodeDelay=k.avgEncodeMs),q&&q.bitrateMax&&(g.targetSendBitrate=1e3*q.bitrateMax),g.sendPackets=k.packets,g.sendPacketsLost=k.packetsLost,g.totalDuration=y?y.totalDuration+1:1,g.totalFreezeTime=y?y.totalFreezeTime:0,this.isLocalVideoFreeze(k)&&(g.totalFreezeTime+=1)}this.trafficStats&&(g.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(p,g),g&&I&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,I.track,g);break}case Q0.LocalAudioTrack:{const y=A,g=lT({},z4),b=l.getStats(),I=l.getLocalMedia(p);if(b){const k=b.audioSend.find(B=>B.ssrc===(I==null?void 0:I.ssrcs[0].ssrcId));if(k){if(k.codec!=="opus"&&k.codec!=="aac"&&k.codec!=="PCMU"&&k.codec!=="PCMA"&&k.codec!=="G722"||(g.codecType=k.codec),k.inputLevel)g.sendVolumeLevel=Math.round(32767*k.inputLevel);else{const B=l.getLocalAudioVolume();B&&(g.sendVolumeLevel=Math.round(32767*B))}g.sendBytes=k.bytes,g.sendPackets=k.packets,g.sendPacketsLost=k.packetsLost,g.sendBitrate=y?8*Math.max(0,g.sendBytes-y.sendBytes):0}}this.trafficStats&&(g.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(Q0.LocalAudioTrack,g),g&&I&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,I.track,g);break}}})}updateRemoteStats(l){Array.from(this.remoteStats.entries()).forEach(d=>{let[p,{videoStats:A,audioStats:y,videoPcStats:g}]=d;const b=y,I=A,k=g,B=lT({},JK),q=lT({},zK),$=lT({},Cgt),{audioTrack:_t,videoTrack:_r,audioSSRC:_i,videoSSRC:ga}=l.getRemoteMedia(p),_u=l.getStats(),ah=_u==null?void 0:_u.audioRecv.find(n0=>n0.ssrc===_i),_h=_u==null?void 0:_u.videoRecv.find(n0=>n0.ssrc===ga),_A=this.trafficStats&&this.trafficStats.peer_delay.find(n0=>n0.peer_uid===p);if(ah&&(ah.codec!=="opus"&&ah.codec!=="aac"&&ah.codec!=="PCMU"&&ah.codec!=="PCMA"&&ah.codec!=="G722"||(B.codecType=ah.codec),ah.outputLevel?B.receiveLevel=Math.round(32767*ah.outputLevel):_t&&(B.receiveLevel=Math.round(32767*_t.getVolumeLevel())),B.receiveBytes=ah.bytes,B.receivePackets=ah.packets,B.receivePacketsLost=ah.packetsLost,B.packetLossRate=B.receivePacketsLost/(B.receivePackets+B.receivePacketsLost),B.receiveBitrate=b?8*Math.max(0,B.receiveBytes-b.receiveBytes):0,B.totalDuration=b?b.totalDuration+1:1,B.totalFreezeTime=b?b.totalFreezeTime:0,B.freezeRate=B.totalFreezeTime/B.totalDuration,B.receiveDelay=ah.jitterBufferMs,B.totalDuration>10&&I2.isRemoteAudioFreeze(_t)&&(B.totalFreezeTime+=1)),_h){_h.codec!=="H264"&&_h.codec!=="VP8"&&_h.codec!=="VP9"&&_h.codec!=="AV1X"&&_h.codec!=="AV1"||(q.codecType=_h.codec),q.receiveBytes=_h.bytes,q.receiveBitrate=I?8*Math.max(0,q.receiveBytes-I.receiveBytes):0,q.decodeFrameRate=_h.decodeFrameRate<0?0:_h.decodeFrameRate,q.renderFrameRate=_h.decodeFrameRate<0?0:_h.decodeFrameRate,_h.outputFrame&&(q.renderFrameRate=_h.outputFrame.frameRate),_h.receivedFrame?(q.receiveFrameRate=_h.receivedFrame.frameRate,q.receiveResolutionHeight=_h.receivedFrame.height,q.receiveResolutionWidth=_h.receivedFrame.width):_r&&(q.receiveResolutionHeight=_r._videoHeight||0,q.receiveResolutionWidth=_r._videoWidth||0),_h.framesRateFirefox!==void 0&&(q.receiveFrameRate=Math.round(_h.framesRateFirefox)),q.receivePackets=_h.packets,q.receivePacketsLost=_h.packetsLost,q.packetLossRate=q.receivePacketsLost/(q.receivePackets+q.receivePacketsLost),q.totalDuration=I?I.totalDuration+1:1,q.totalFreezeTime=I?I.totalFreezeTime:0,q.receiveDelay=_h.jitterBufferMs||0;const n0=!!ga&&l.getRemoteVideoIsReady(ga);_r&&n0&&I2.isRemoteVideoFreeze(_r,_h,k)&&(q.totalFreezeTime+=1),q.freezeRate=q.totalFreezeTime/q.totalDuration}_A&&(B.end2EndDelay=_A.B_ad,q.end2EndDelay=_A.B_vd,B.transportDelay=_A.B_ed,q.transportDelay=_A.B_ed,B.currentPacketLossRate=_A.B_ealr4/100,q.currentPacketLossRate=_A.B_evlr4/100,$.uplinkNetworkQuality=_A.B_punq?_A.B_punq:0,$.downlinkNetworkQuality=_A.B_pdnq?_A.B_pdnq:0),this.remoteStats.set(p,{audioStats:B,videoStats:q,videoPcStats:_h,networkStats:$}),_t&&this.exceptionMonitor.setRemoteAudioStats(_t,B),_r&&this.exceptionMonitor.setRemoteVideoStats(_r,q)})}}function bJ(e){return new TextEncoder().encode(e)}const l0t=async e=>function(l,d){let p="";return new Uint8Array(l).forEach(A=>{p+=A.toString(d).padStart(2,"0")}),p}(await crypto.subtle.digest("SHA-256",bJ(e)),16);function CJ(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function yP(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?CJ(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):CJ(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function d0t(e){if(!e.address||!e.tcp)throw new _E(_f.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.\:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(_a.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),"".concat(e.address,":").concat(e.tcp))}function z5(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(y0("TURN_DOMAIN")):(_a.info("Cannot recognized as IP address ".concat(e,". Used As Host instead")),e)}function SJ(e,l){const d=y0("GATEWAY_DOMAINS");let p=d[1]&&l.indexOf(d[1])!==-1?1:0;return e.addresses=e.addresses||[],{gatewayAddrs:e.addresses.map(A=>A.domain_prefix?{address:"".concat(A.domain_prefix,".").concat(d[p++%d.length],":").concat(A.port)}:A.ip.match(/^[\.\:\d]+$/)?{ip:A.ip,port:A.port,address:"".concat(A.ip.replace(/[^\d]/g,"-"),".").concat(d[p++%d.length],":").concat(A.port)}:(_a.info("Cannot recognized as IP address ".concat(A.ip,". Used As Host instead")),{ip:A.ip,port:A.port,address:"".concat(A.ip,":").concat(A.port)})),uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function CR(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function RJ(e){const l=e._encoderConfig;if(!l)return{};const d={resolution:l.width&&l.height?"".concat(CR(l.width),"x").concat(CR(l.height)):void 0,maxVideoBW:l.bitrateMax,minVideoBW:l.bitrateMin};return typeof l.frameRate=="number"?(d.maxFrameRate=l.frameRate,d.minFrameRate=l.frameRate):l.frameRate&&(d.maxFrameRate=l.frameRate.max||l.frameRate.ideal||l.frameRate.exact||l.frameRate.min,d.minFrameRate=l.frameRate.min||l.frameRate.ideal||l.frameRate.exact||l.frameRate.max),d}function TJ(e,l,d){var p;const A=l.videoSend.find(b=>b.ssrc===e);if(!A)return null;const y=d==null||(p=d.videoSend.find(b=>b.ssrc===e))===null||p===void 0?void 0:p.inputFrame,g={id:i1(10,""),timestamp:new Date(l.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:A.ssrc.toString()};return A.inputFrame&&(y&&A.inputFrame.height===y.height||(g.A_fhi=A.inputFrame.height?A.inputFrame.height.toString():"0"),y&&A.inputFrame.width===y.width||(g.A_fwi=A.inputFrame.width?A.inputFrame.width.toString():"0"),y&&A.inputFrame.frameRate===y.frameRate||(g.A_fri=A.inputFrame.frameRate?A.inputFrame.frameRate.toString():"0")),g}function wJ(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function X5(e,l){let d,p,A;switch(l){case l1.CHOOSE_SERVER:d=4096,p="choose server";break;case l1.CLOUD_PROXY:d=1048576,p="proxy";break;case l1.CLOUD_PROXY_5:d=4194304,p="proxy5";break;case l1.CLOUD_PROXY_FALLBACK:d=4194310,p="proxy fallback";break;default:throw new _E(_f.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(y=>{y.buffer&&y.buffer.flag===d&&(A={code:y.buffer.code,addresses:(y.buffer.edges_services||[]).map(g=>yP(yP({},g),{},{ticket:y.buffer.cert})),server_ts:e.enter_ts,uid:y.buffer.uid,cid:y.buffer.cid,cname:y.buffer.cname,detail:yP(yP({},y.buffer.detail),e.detail),flag:y.buffer.flag,opid:e.opid})}),!A)throw new _E(_f.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(p," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return A}async function h0t(e,l){return await Y0.all(e.addresses.map(async d=>({address:z5(d.ip),tcpport:d.port,udpport:d.port,username:l&&y0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?l.toString():p1.username,password:l&&y0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await l0t(l.toString()):p1.password})))}function p0t(e,l){const d=l._videoHeight||l.getMediaStreamTrack(!0).getSettings().height;return d?d/CR(e.height):4}function SR(e){let{candidateType:l,relayProtocol:d,type:p,address:A,port:y,protocol:g}=e;return p==="local-candidate"?{candidateType:l,relayProtocol:d,protocol:g}:{candidateType:l,relayProtocol:d,address:A,port:y,protocol:g}}function OJ(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function dT(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?OJ(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):OJ(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function _2(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function Q1(e){return new Y0(l=>{window.setTimeout(l,e)})}function f0t(e){const l=new _E(_f.TIMEOUT,"timeout");return new Y0((d,p)=>{window.setTimeout(()=>p(l),e)})}function i1(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,l=arguments.length>1?arguments[1]:void 0;const d=Math.random().toString(16).substr(2,e).toLowerCase();return d.length===e?"".concat(l).concat(d):"".concat(l).concat(d)+i1(e-d.length,"")}function NJ(){return i1(32,"").toUpperCase()}const bP=()=>{};function kJ(e){return new Y0((l,d)=>{let p=!1;const A=document.createElement("video");A.setAttribute("autoplay",""),A.setAttribute("muted",""),A.muted=!0,A.autoplay=!0,A.setAttribute("playsinline",""),A.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(A);const y=h_()?"canplay":"playing";A.addEventListener(y,()=>{const g=A.videoWidth,b=A.videoHeight;!g&&d_()||(p=!0,A.srcObject=null,A.remove(),l([g,b]))}),A.srcObject=new MediaStream([e]),A.play().catch(bP),setTimeout(()=>{p||(A.srcObject=null,A.remove(),l([A.videoWidth,A.videoHeight]))},4e3)})}function hT(e){return Y0.all(e.map(l=>l.then(d=>{throw d},d=>d))).then(l=>{throw l},l=>l)}function O_(e,l){for(var d=arguments.length,p=new Array(d>2?d-2:0),A=2;A<d;A++)p[A-2]=arguments[A];return e.getListeners(l).length===0?Y0.reject(new _E(_f.UNEXPECTED_ERROR,"can not emit promise")):new Y0((y,g)=>{e.emit(l,...p,y,g)})}function YI(e,l){if(e.getListeners(l).length===0)return Y0.resolve();for(var d=arguments.length,p=new Array(d>2?d-2:0),A=2;A<d;A++)p[A-2]=arguments[A];return O_(e,l,...p)}function pT(e,l){if(e.getListeners(l).length===0)return null;for(var d=arguments.length,p=new Array(d>2?d-2:0),A=2;A<d;A++)p[A-2]=arguments[A];return CP(e,l,...p)}function CP(e,l){let d=null,p=null;for(var A=arguments.length,y=new Array(A>2?A-2:0),g=2;g<A;g++)y[g-2]=arguments[g];if(e.emit(l,...y,b=>{d=b},b=>{p=b}),p!==null)throw p;if(d===null)throw new _E(_f.UNEXPECTED_ERROR,"handler is not sync");return d}function Z5(e,l){const d=e.indexOf(l);d!==-1&&e.splice(d,1)}function DJ(e){const l=[];return e.forEach(d=>{l.indexOf(d)===-1&&l.push(d)}),l}function Y_(e){Y0.resolve().then(e)}function L1(e){return JSON.parse(JSON.stringify(e))}const LJ={};function UO(e,l){LJ[l]||(LJ[l]=!0,e())}function $5(e){const l=window.atob(e),d=new Uint8Array(new ArrayBuffer(l.length));for(let p=0;p<l.length;p+=1)d[p]=l.charCodeAt(p);return d}function SP(e){let l="";for(let d=0;d<e.length;d+=1)l+=String.fromCharCode(e[d]);return window.btoa(l)}const PJ=new class{constructor(){_s(this,"fnMap",new Map)}throttleByKey(e,l,d,p){for(var A=arguments.length,y=new Array(A>4?A-4:0),g=4;g<A;g++)y[g-4]=arguments[g];if(this.fnMap.has(l)){const b=this.fnMap.get(l);if(b.threshold!==d){b.fn(...b.args),clearTimeout(b.timer);const I=window.setTimeout(()=>{const k=this.fnMap.get(l);k&&k.fn(...k.args),this.fnMap.delete(l)},d);this.fnMap.set(l,{fn:e,threshold:d,timer:I,args:y,skipFn:p})}else b.skipFn&&b.skipFn(...b.args),this.fnMap.set(l,dT(dT({},b),{},{fn:e,args:y,skipFn:p}))}else{const b=window.setTimeout(()=>{const I=this.fnMap.get(l);I&&I.fn(...I.args),this.fnMap.delete(l)},d);this.fnMap.set(l,{fn:e,threshold:d,timer:b,args:y,skipFn:p})}}},xJ=PJ.throttleByKey.bind(PJ),fT=async e=>{let{fragementLength:l,referenceList:d,asyncMapHandler:p,allFailedhandler:A,promisesCollector:y}=e,g=0;const b=l;let I,k=0;const B=async()=>{const q=(()=>{const $=g*b,_t=$+b;return d.slice($,_t).map(p)})();y&&y.push(...q);try{I=await hT(q)}catch($){if(k+=b,g++,!(k>=d.length))return void await B();A($)}q.forEach($=>$.cancel())};return await B(),I};function BJ(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}var A0t=m1,g0t=v1("iterator"),MJ=!A0t(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),l=e.searchParams,d="";return e.pathname="c%20d",l.forEach(function(p,A){l.delete("b"),d+=A+p}),!e.toJSON||!l.sort||e.href!=="http://a/c%20d?a=1&c=3"||l.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!l[g0t]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"}),UJ=$_,E0t=t1,m0t=__,v0t=m1,t6=_D,I0t=$N,_0t=ON,y0t=_S,b0t=kN,y2=Object.assign,jJ=Object.defineProperty,C0t=E0t([].concat),S0t=!y2||v0t(function(){if(UJ&&y2({b:1},y2(jJ({},"a",{enumerable:!0,get:function(){jJ(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},l={},d=Symbol(),p="abcdefghijklmnopqrst";return e[d]=7,p.split("").forEach(function(A){l[A]=A}),y2({},e)[d]!=7||t6(y2({},l)).join("")!=p})?function(e,l){for(var d=y0t(e),p=arguments.length,A=1,y=I0t.f,g=_0t.f;p>A;)for(var b,I=b0t(arguments[A++]),k=y?C0t(t6(I),y(I)):t6(I),B=k.length,q=0;B>q;)b=k[q++],UJ&&!m0t(g,I,b)||(d[b]=I[b]);return d}:y2,R0t=U_,T0t=j7,w0t=lR,O0t=__,N0t=_S,k0t=function(e,l,d,p){try{return p?l(R0t(d)[0],d[1]):l(d)}catch(A){T0t(e,"throw",A)}},D0t=x7,L0t=pL,P0t=MS,FJ=nP,x0t=rU,B0t=rL,QJ=II.Array,AT=t1,e6=2147483647,M0t=/[^\0-\u007E]/,GJ=/[.\u3002\uFF0E\uFF61]/g,VJ="Overflow: input needs wider integers to process",qJ=II.RangeError,U0t=AT(GJ.exec),b2=Math.floor,n6=String.fromCharCode,HJ=AT("".charCodeAt),KJ=AT([].join),RR=AT([].push),j0t=AT("".replace),F0t=AT("".split),Q0t=AT("".toLowerCase),YJ=function(e){return e+22+75*(e<26)},G0t=function(e,l,d){var p=0;for(e=d?b2(e/700):e>>1,e+=b2(e/l);e>455;)e=b2(e/35),p+=36;return b2(p+36*e/(e+38))},V0t=function(e){var l,d,p=[],A=(e=function(_u){for(var ah=[],_h=0,_A=_u.length;_h<_A;){var n0=HJ(_u,_h++);if(n0>=55296&&n0<=56319&&_h<_A){var f0=HJ(_u,_h++);(64512&f0)==56320?RR(ah,((1023&n0)<<10)+(1023&f0)+65536):(RR(ah,n0),_h--)}else RR(ah,n0)}return ah}(e)).length,y=128,g=0,b=72;for(l=0;l<e.length;l++)(d=e[l])<128&&RR(p,n6(d));var I=p.length,k=I;for(I&&RR(p,"-");k<A;){var B=e6;for(l=0;l<e.length;l++)(d=e[l])>=y&&d<B&&(B=d);var q=k+1;if(B-y>b2((e6-g)/q))throw qJ(VJ);for(g+=(B-y)*q,y=B,l=0;l<e.length;l++){if((d=e[l])<y&&++g>e6)throw qJ(VJ);if(d==y){for(var $=g,_t=36;;){var _r=_t<=b?1:_t>=b+26?26:_t-b;if($<_r)break;var _i=$-_r,ga=36-_r;RR(p,n6(YJ(_r+_i%ga))),$=b2(_i/ga),_t+=36}RR(p,n6(YJ($))),b=G0t(g,q,k==I),g=0,k++}}g++,y++}return KJ(p,"")},q0t=II.TypeError,r6=M1,RP=II,i6=cS,TP=__,wS=t1,WJ=MJ,JJ=VT,H0t=pG,K0t=WR,Y0t=nG,o6=GT,zJ=gU,s6=B1,W0t=z1,J0t=lR,z0t=US,X0t=U_,XJ=M_,W_=hR,Z0t=dO,ZJ=cR,a6=rU,$0t=rL,C2=function(e,l){if(e<l)throw q0t("Not enough arguments");return e},tIt=DK,eIt=v1("iterator"),wP="URLSearchParams",$J="URLSearchParamsIterator",_z=o6.set,AS=o6.getterFor(wP),nIt=o6.getterFor($J),tX=i6("fetch"),OP=i6("Request"),jO=i6("Headers"),c6=OP&&OP.prototype,eX=jO&&jO.prototype,rIt=RP.RegExp,iIt=RP.TypeError,nX=RP.decodeURIComponent,oIt=RP.encodeURIComponent,sIt=wS("".charAt),rX=wS([].join),gT=wS([].push),u6=wS("".replace),aIt=wS([].shift),iX=wS([].splice),oX=wS("".split),cIt=wS("".slice),uIt=/\+/g,sX=Array(4),lIt=function(e){return sX[e-1]||(sX[e-1]=rIt("((?:%[\\da-f]{2}){"+e+"})","gi"))},dIt=function(e){try{return nX(e)}catch{return e}},aX=function(e){var l=u6(e,uIt," "),d=4;try{return nX(l)}catch{for(;d;)l=u6(l,lIt(d--),dIt);return l}},hIt=/[!'()~]|%20/g,pIt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},fIt=function(e){return pIt[e]},cX=function(e){return u6(oIt(e),hIt,fIt)},l6=Y0t(function(e,l){_z(this,{type:$J,iterator:a6(AS(e).entries),kind:l})},"Iterator",function(){var e=nIt(this),l=e.kind,d=e.iterator.next(),p=d.value;return d.done||(d.value=l==="keys"?p.key:l==="values"?p.value:[p.key,p.value]),d},!0),uX=function(e){this.entries=[],this.url=null,e!==void 0&&(XJ(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?sIt(e,0)==="?"?cIt(e,1):e:W_(e)))};uX.prototype={type:wP,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var l,d,p,A,y,g,b,I=$0t(e);if(I)for(d=(l=a6(e,I)).next;!(p=TP(d,l)).done;){if(y=(A=a6(X0t(p.value))).next,(g=TP(y,A)).done||(b=TP(y,A)).done||!TP(y,A).done)throw iIt("Expected sequence with length 2");gT(this.entries,{key:W_(g.value),value:W_(b.value)})}else for(var k in e)W0t(e,k)&&gT(this.entries,{key:k,value:W_(e[k])})},parseQuery:function(e){if(e)for(var l,d,p=oX(e,"&"),A=0;A<p.length;)(l=p[A++]).length&&(d=oX(l,"="),gT(this.entries,{key:aX(aIt(d)),value:aX(rX(d,"="))}))},serialize:function(){for(var e,l=this.entries,d=[],p=0;p<l.length;)e=l[p++],gT(d,cX(e.key)+"="+cX(e.value));return rX(d,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var NP=function(){zJ(this,FO);var e=arguments.length>0?arguments[0]:void 0;_z(this,new uX(e))},FO=NP.prototype;if(H0t(FO,{append:function(e,l){C2(arguments.length,2);var d=AS(this);gT(d.entries,{key:W_(e),value:W_(l)}),d.updateURL()},delete:function(e){C2(arguments.length,1);for(var l=AS(this),d=l.entries,p=W_(e),A=0;A<d.length;)d[A].key===p?iX(d,A,1):A++;l.updateURL()},get:function(e){C2(arguments.length,1);for(var l=AS(this).entries,d=W_(e),p=0;p<l.length;p++)if(l[p].key===d)return l[p].value;return null},getAll:function(e){C2(arguments.length,1);for(var l=AS(this).entries,d=W_(e),p=[],A=0;A<l.length;A++)l[A].key===d&&gT(p,l[A].value);return p},has:function(e){C2(arguments.length,1);for(var l=AS(this).entries,d=W_(e),p=0;p<l.length;)if(l[p++].key===d)return!0;return!1},set:function(e,l){C2(arguments.length,1);for(var d,p=AS(this),A=p.entries,y=!1,g=W_(e),b=W_(l),I=0;I<A.length;I++)(d=A[I]).key===g&&(y?iX(A,I--,1):(y=!0,d.value=b));y||gT(A,{key:g,value:b}),p.updateURL()},sort:function(){var e=AS(this);tIt(e.entries,function(l,d){return l.key>d.key?1:-1}),e.updateURL()},forEach:function(e){for(var l,d=AS(this).entries,p=J0t(e,arguments.length>1?arguments[1]:void 0),A=0;A<d.length;)p((l=d[A++]).value,l.key,this)},keys:function(){return new l6(this,"keys")},values:function(){return new l6(this,"values")},entries:function(){return new l6(this,"entries")}},{enumerable:!0}),JJ(FO,eIt,FO.entries,{name:"entries"}),JJ(FO,"toString",function(){return AS(this).serialize()},{enumerable:!0}),K0t(NP,wP),r6({global:!0,forced:!WJ},{URLSearchParams:NP}),!WJ&&s6(jO)){var AIt=wS(eX.has),gIt=wS(eX.set),lX=function(e){if(XJ(e)){var l,d=e.body;if(z0t(d)===wP)return l=e.headers?new jO(e.headers):new jO,AIt(l,"content-type")||gIt(l,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Z0t(e,{body:ZJ(0,W_(d)),headers:ZJ(0,l)})}return e};if(s6(tX)&&r6({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return tX(e,arguments.length>1?lX(arguments[1]):{})}}),s6(OP)){var d6=function(e){return zJ(this,c6),new OP(e,arguments.length>1?lX(arguments[1]):{})};c6.constructor=d6,d6.prototype=c6,r6({global:!0,forced:!0},{Request:d6})}}var tS,EIt={URLSearchParams:NP,getState:AS},mIt=M1,h6=$_,vIt=MJ,p6=II,dX=lR,eS=t1,IIt=_k.f,kP=VT,_It=gU,f6=z1,A6=S0t,S2=function(e){var l=N0t(e),d=L0t(this),p=arguments.length,A=p>1?arguments[1]:void 0,y=A!==void 0;y&&(A=w0t(A,p>2?arguments[2]:void 0));var g,b,I,k,B,q,$=B0t(l),_t=0;if(!$||this==QJ&&D0t($))for(g=P0t(l),b=d?new this(g):QJ(g);g>_t;_t++)q=y?A(l[_t],_t):l[_t],FJ(b,_t,q);else for(B=(k=x0t(l,$)).next,b=d?new this:[];!(I=O0t(B,k)).done;_t++)q=y?k0t(k,A,[I.value,_t],!0):I.value,FJ(b,_t,q);return b.length=_t,b},gS=F4,yIt=uV.codeAt,bIt=function(e){var l,d,p=[],A=F0t(j0t(Q0t(e),GJ,"."),".");for(l=0;l<A.length;l++)d=A[l],RR(p,U0t(M0t,d)?"xn--"+V0t(d):d);return KJ(p,".")},XS=hR,CIt=WR,hX=EIt,pX=GT,SIt=pX.set,DP=pX.getterFor("URL"),RIt=hX.URLSearchParams,TIt=hX.getState,QO=p6.URL,g6=p6.TypeError,LP=p6.parseInt,wIt=Math.floor,fX=Math.pow,nS=eS("".charAt),ES=eS(/./.exec),GO=eS([].join),OIt=eS(1 .toString),NIt=eS([].pop),R2=eS([].push),AX=eS("".replace),kIt=eS([].shift),DIt=eS("".split),VO=eS("".slice),PP=eS("".toLowerCase),LIt=eS([].unshift),E6="Invalid scheme",ET="Invalid host",gX="Invalid port",EX=/[a-z]/i,PIt=/[\d+-.a-z]/i,m6=/\d/,xIt=/^0x/i,BIt=/^[0-7]+$/,MIt=/^\d+$/,mX=/^[\da-f]+$/i,UIt=/[\0\t\n\r #%/:<>?@[\\\]^|]/,jIt=/[\0\t\n\r #/:<>?@[\\\]^|]/,FIt=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,QIt=/[\t\n\r]/g,qO=function(e){var l,d,p,A;if(typeof e=="number"){for(l=[],d=0;d<4;d++)LIt(l,e%256),e=wIt(e/256);return GO(l,".")}if(typeof e=="object"){for(l="",p=function(y){for(var g=null,b=1,I=null,k=0,B=0;B<8;B++)y[B]!==0?(k>b&&(g=I,b=k),I=null,k=0):(I===null&&(I=B),++k);return k>b&&(g=I,b=k),g}(e),d=0;d<8;d++)A&&e[d]===0||(A&&(A=!1),p===d?(l+=d?":":"::",A=!0):(l+=OIt(e[d],16),d<7&&(l+=":")));return"["+l+"]"}return e},xP={},vX=A6({},xP,{" ":1,'"':1,"<":1,">":1,"`":1}),IX=A6({},vX,{"#":1,"?":1,"{":1,"}":1}),v6=A6({},IX,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),TR=function(e,l){var d=yIt(e,0);return d>32&&d<127&&!f6(l,e)?e:encodeURIComponent(e)},BP={ftp:21,file:null,http:80,https:443,ws:80,wss:443},HO=function(e,l){var d;return e.length==2&&ES(EX,nS(e,0))&&((d=nS(e,1))==":"||!l&&d=="|")},_X=function(e){var l;return e.length>1&&HO(VO(e,0,2))&&(e.length==2||(l=nS(e,2))==="/"||l==="\\"||l==="?"||l==="#")},GIt=function(e){return e==="."||PP(e)==="%2e"},I6={},yX={},_6={},bX={},CX={},y6={},SX={},RX={},MP={},UP={},b6={},C6={},S6={},R6={},TX={},T6={},T2={},OS={},wX={},mT={},ZS={},w6=function(e,l,d){var p,A,y,g=XS(e);if(l){if(A=this.parse(g))throw g6(A);this.searchParams=null}else{if(d!==void 0&&(p=new w6(d,!0)),A=this.parse(g,null,p))throw g6(A);(y=TIt(new RIt)).bindURL(this),this.searchParams=y}};w6.prototype={type:"URL",parse:function(e,l,d){var p,A,y,g,b,I=this,k=l||I6,B=0,q="",$=!1,_t=!1,_r=!1;for(e=XS(e),l||(I.scheme="",I.username="",I.password="",I.host=null,I.port=null,I.path=[],I.query=null,I.fragment=null,I.cannotBeABaseURL=!1,e=AX(e,FIt,"")),e=AX(e,QIt,""),p=S2(e);B<=p.length;){switch(A=p[B],k){case I6:if(!A||!ES(EX,A)){if(l)return E6;k=_6;continue}q+=PP(A),k=yX;break;case yX:if(A&&(ES(PIt,A)||A=="+"||A=="-"||A=="."))q+=PP(A);else{if(A!=":"){if(l)return E6;q="",k=_6,B=0;continue}if(l&&(I.isSpecial()!=f6(BP,q)||q=="file"&&(I.includesCredentials()||I.port!==null)||I.scheme=="file"&&!I.host))return;if(I.scheme=q,l)return void(I.isSpecial()&&BP[I.scheme]==I.port&&(I.port=null));q="",I.scheme=="file"?k=R6:I.isSpecial()&&d&&d.scheme==I.scheme?k=bX:I.isSpecial()?k=RX:p[B+1]=="/"?(k=CX,B++):(I.cannotBeABaseURL=!0,R2(I.path,""),k=wX)}break;case _6:if(!d||d.cannotBeABaseURL&&A!="#")return E6;if(d.cannotBeABaseURL&&A=="#"){I.scheme=d.scheme,I.path=gS(d.path),I.query=d.query,I.fragment="",I.cannotBeABaseURL=!0,k=ZS;break}k=d.scheme=="file"?R6:y6;continue;case bX:if(A!="/"||p[B+1]!="/"){k=y6;continue}k=MP,B++;break;case CX:if(A=="/"){k=UP;break}k=OS;continue;case y6:if(I.scheme=d.scheme,A==tS)I.username=d.username,I.password=d.password,I.host=d.host,I.port=d.port,I.path=gS(d.path),I.query=d.query;else if(A=="/"||A=="\\"&&I.isSpecial())k=SX;else if(A=="?")I.username=d.username,I.password=d.password,I.host=d.host,I.port=d.port,I.path=gS(d.path),I.query="",k=mT;else{if(A!="#"){I.username=d.username,I.password=d.password,I.host=d.host,I.port=d.port,I.path=gS(d.path),I.path.length--,k=OS;continue}I.username=d.username,I.password=d.password,I.host=d.host,I.port=d.port,I.path=gS(d.path),I.query=d.query,I.fragment="",k=ZS}break;case SX:if(!I.isSpecial()||A!="/"&&A!="\\"){if(A!="/"){I.username=d.username,I.password=d.password,I.host=d.host,I.port=d.port,k=OS;continue}k=UP}else k=MP;break;case RX:if(k=MP,A!="/"||nS(q,B+1)!="/")continue;B++;break;case MP:if(A!="/"&&A!="\\"){k=UP;continue}break;case UP:if(A=="@"){$&&(q="%40"+q),$=!0,y=S2(q);for(var _i=0;_i<y.length;_i++){var ga=y[_i];if(ga!=":"||_r){var _u=TR(ga,v6);_r?I.password+=_u:I.username+=_u}else _r=!0}q=""}else if(A==tS||A=="/"||A=="?"||A=="#"||A=="\\"&&I.isSpecial()){if($&&q=="")return"Invalid authority";B-=S2(q).length+1,q="",k=b6}else q+=A;break;case b6:case C6:if(l&&I.scheme=="file"){k=T6;continue}if(A!=":"||_t){if(A==tS||A=="/"||A=="?"||A=="#"||A=="\\"&&I.isSpecial()){if(I.isSpecial()&&q=="")return ET;if(l&&q==""&&(I.includesCredentials()||I.port!==null))return;if(g=I.parseHost(q))return g;if(q="",k=T2,l)return;continue}A=="["?_t=!0:A=="]"&&(_t=!1),q+=A}else{if(q=="")return ET;if(g=I.parseHost(q))return g;if(q="",k=S6,l==C6)return}break;case S6:if(!ES(m6,A)){if(A==tS||A=="/"||A=="?"||A=="#"||A=="\\"&&I.isSpecial()||l){if(q!=""){var ah=LP(q,10);if(ah>65535)return gX;I.port=I.isSpecial()&&ah===BP[I.scheme]?null:ah,q=""}if(l)return;k=T2;continue}return gX}q+=A;break;case R6:if(I.scheme="file",A=="/"||A=="\\")k=TX;else{if(!d||d.scheme!="file"){k=OS;continue}if(A==tS)I.host=d.host,I.path=gS(d.path),I.query=d.query;else if(A=="?")I.host=d.host,I.path=gS(d.path),I.query="",k=mT;else{if(A!="#"){_X(GO(gS(p,B),""))||(I.host=d.host,I.path=gS(d.path),I.shortenPath()),k=OS;continue}I.host=d.host,I.path=gS(d.path),I.query=d.query,I.fragment="",k=ZS}}break;case TX:if(A=="/"||A=="\\"){k=T6;break}d&&d.scheme=="file"&&!_X(GO(gS(p,B),""))&&(HO(d.path[0],!0)?R2(I.path,d.path[0]):I.host=d.host),k=OS;continue;case T6:if(A==tS||A=="/"||A=="\\"||A=="?"||A=="#"){if(!l&&HO(q))k=OS;else if(q==""){if(I.host="",l)return;k=T2}else{if(g=I.parseHost(q))return g;if(I.host=="localhost"&&(I.host=""),l)return;q="",k=T2}continue}q+=A;break;case T2:if(I.isSpecial()){if(k=OS,A!="/"&&A!="\\")continue}else if(l||A!="?")if(l||A!="#"){if(A!=tS&&(k=OS,A!="/"))continue}else I.fragment="",k=ZS;else I.query="",k=mT;break;case OS:if(A==tS||A=="/"||A=="\\"&&I.isSpecial()||!l&&(A=="?"||A=="#")){if((b=PP(b=q))===".."||b==="%2e."||b===".%2e"||b==="%2e%2e"?(I.shortenPath(),A=="/"||A=="\\"&&I.isSpecial()||R2(I.path,"")):GIt(q)?A=="/"||A=="\\"&&I.isSpecial()||R2(I.path,""):(I.scheme=="file"&&!I.path.length&&HO(q)&&(I.host&&(I.host=""),q=nS(q,0)+":"),R2(I.path,q)),q="",I.scheme=="file"&&(A==tS||A=="?"||A=="#"))for(;I.path.length>1&&I.path[0]==="";)kIt(I.path);A=="?"?(I.query="",k=mT):A=="#"&&(I.fragment="",k=ZS)}else q+=TR(A,IX);break;case wX:A=="?"?(I.query="",k=mT):A=="#"?(I.fragment="",k=ZS):A!=tS&&(I.path[0]+=TR(A,xP));break;case mT:l||A!="#"?A!=tS&&(A=="'"&&I.isSpecial()?I.query+="%27":I.query+=A=="#"?"%23":TR(A,xP)):(I.fragment="",k=ZS);break;case ZS:A!=tS&&(I.fragment+=TR(A,vX))}B++}},parseHost:function(e){var l,d,p;if(nS(e,0)=="["){if(nS(e,e.length-1)!="]"||!(l=function(A){var y,g,b,I,k,B,q,$=[0,0,0,0,0,0,0,0],_t=0,_r=null,_i=0,ga=function(){return nS(A,_i)};if(ga()==":"){if(nS(A,1)!=":")return;_i+=2,_r=++_t}for(;ga();){if(_t==8)return;if(ga()!=":"){for(y=g=0;g<4&&ES(mX,ga());)y=16*y+LP(ga(),16),_i++,g++;if(ga()=="."){if(g==0||(_i-=g,_t>6))return;for(b=0;ga();){if(I=null,b>0){if(!(ga()=="."&&b<4))return;_i++}if(!ES(m6,ga()))return;for(;ES(m6,ga());){if(k=LP(ga(),10),I===null)I=k;else{if(I==0)return;I=10*I+k}if(I>255)return;_i++}$[_t]=256*$[_t]+I,++b!=2&&b!=4||_t++}if(b!=4)return;break}if(ga()==":"){if(_i++,!ga())return}else if(ga())return;$[_t++]=y}else{if(_r!==null)return;_i++,_r=++_t}}if(_r!==null)for(B=_t-_r,_t=7;_t!=0&&B>0;)q=$[_t],$[_t--]=$[_r+B-1],$[_r+--B]=q;else if(_t!=8)return;return $}(VO(e,1,-1))))return ET;this.host=l}else if(this.isSpecial()){if(e=bIt(e),ES(UIt,e)||(l=function(A){var y,g,b,I,k,B,q,$=DIt(A,".");if($.length&&$[$.length-1]==""&&$.length--,(y=$.length)>4)return A;for(g=[],b=0;b<y;b++){if((I=$[b])=="")return A;if(k=10,I.length>1&&nS(I,0)=="0"&&(k=ES(xIt,I)?16:8,I=VO(I,k==8?1:2)),I==="")B=0;else{if(!ES(k==10?MIt:k==8?BIt:mX,I))return A;B=LP(I,k)}R2(g,B)}for(b=0;b<y;b++)if(B=g[b],b==y-1){if(B>=fX(256,5-y))return null}else if(B>255)return null;for(q=NIt(g),b=0;b<g.length;b++)q+=g[b]*fX(256,3-b);return q}(e))===null)return ET;this.host=l}else{if(ES(jIt,e))return ET;for(l="",d=S2(e),p=0;p<d.length;p++)l+=TR(d[p],xP);this.host=l}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return f6(BP,this.scheme)},shortenPath:function(){var e=this.path,l=e.length;!l||this.scheme=="file"&&l==1&&HO(e[0],!0)||e.length--},serialize:function(){var e=this,l=e.scheme,d=e.username,p=e.password,A=e.host,y=e.port,g=e.path,b=e.query,I=e.fragment,k=l+":";return A!==null?(k+="//",e.includesCredentials()&&(k+=d+(p?":"+p:"")+"@"),k+=qO(A),y!==null&&(k+=":"+y)):l=="file"&&(k+="//"),k+=e.cannotBeABaseURL?g[0]:g.length?"/"+GO(g,"/"):"",b!==null&&(k+="?"+b),I!==null&&(k+="#"+I),k},setHref:function(e){var l=this.parse(e);if(l)throw g6(l);this.searchParams.update()},getOrigin:function(){var e=this.scheme,l=this.port;if(e=="blob")try{return new w2(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+qO(this.host)+(l!==null?":"+l:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(XS(e)+":",I6)},getUsername:function(){return this.username},setUsername:function(e){var l=S2(XS(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var d=0;d<l.length;d++)this.username+=TR(l[d],v6)}},getPassword:function(){return this.password},setPassword:function(e){var l=S2(XS(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var d=0;d<l.length;d++)this.password+=TR(l[d],v6)}},getHost:function(){var e=this.host,l=this.port;return e===null?"":l===null?qO(e):qO(e)+":"+l},setHost:function(e){this.cannotBeABaseURL||this.parse(e,b6)},getHostname:function(){var e=this.host;return e===null?"":qO(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,C6)},getPort:function(){var e=this.port;return e===null?"":XS(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=XS(e))==""?this.port=null:this.parse(e,S6))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+GO(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,T2))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=XS(e))==""?this.query=null:(nS(e,0)=="?"&&(e=VO(e,1)),this.query="",this.parse(e,mT)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=XS(e))!=""?(nS(e,0)=="#"&&(e=VO(e,1)),this.fragment="",this.parse(e,ZS)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var w2=function(e){var l=_It(this,jP),d=arguments.length>1?arguments[1]:void 0,p=SIt(l,new w6(e,!1,d));h6||(l.href=p.serialize(),l.origin=p.getOrigin(),l.protocol=p.getProtocol(),l.username=p.getUsername(),l.password=p.getPassword(),l.host=p.getHost(),l.hostname=p.getHostname(),l.port=p.getPort(),l.pathname=p.getPathname(),l.search=p.getSearch(),l.searchParams=p.getSearchParams(),l.hash=p.getHash())},jP=w2.prototype,rS=function(e,l){return{get:function(){return DP(this)[e]()},set:l&&function(d){return DP(this)[l](d)},configurable:!0,enumerable:!0}};if(h6&&IIt(jP,{href:rS("serialize","setHref"),origin:rS("getOrigin"),protocol:rS("getProtocol","setProtocol"),username:rS("getUsername","setUsername"),password:rS("getPassword","setPassword"),host:rS("getHost","setHost"),hostname:rS("getHostname","setHostname"),port:rS("getPort","setPort"),pathname:rS("getPathname","setPathname"),search:rS("getSearch","setSearch"),searchParams:rS("getSearchParams"),hash:rS("getHash","setHash")}),kP(jP,"toJSON",function(){return DP(this).serialize()},{enumerable:!0}),kP(jP,"toString",function(){return DP(this).serialize()},{enumerable:!0}),QO){var OX=QO.createObjectURL,NX=QO.revokeObjectURL;OX&&kP(w2,"createObjectURL",dX(OX,QO)),NX&&kP(w2,"revokeObjectURL",dX(NX,QO))}CIt(w2,"URL"),mIt({global:!0,forced:!vIt,sham:!h6},{URL:w2});var kX=xS.URL;const VIt={[c2.ACCESS_POINT]:{[k1.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[k1.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[k1.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[k1.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[k1.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[k1.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[k1.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[c2.UNILBS]:{[C_.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[C_.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[C_.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[C_.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[C_.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[C_.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[C_.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[C_.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[C_.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[C_.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[C_.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[C_.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[c2.STRING_UID_ALLOCATOR]:{[OO.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[OO.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[OO.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function KO(e){const l=VIt[Math.floor(e/1e4)];if(!l)return{desc:"unkonw error",retry:!1};const d=l[e%1e4];if(!d){if(Math.floor(e/1e4)===c2.ACCESS_POINT){const p=e%1e4;if(p.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(p.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return d}const qIt={[eI.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[eI.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[eI.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[eI.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[eI.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[eI.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[eI.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[eI.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[eI.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[eI.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[eI.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[eI.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[eI.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[eI.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[eI.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[eI.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[eI.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[eI.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[eI.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[eI.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[eI.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[eI.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[eI.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[eI.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[eI.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[eI.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[eI.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[eI.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[eI.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[eI.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[eI.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[eI.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[eI.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[eI.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[eI.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[eI.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[eI.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[eI.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[eI.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[eI.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[eI.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[eI.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[eI.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[eI.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[eI.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[eI.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[eI.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[eI.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[eI.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[eI.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[eI.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[eI.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[eI.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[eI.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[eI.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[eI.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[eI.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[eI.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"}};function O6(e){return qIt[e]||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}var DX={exports:{}};(function(e,l){e.exports=function(){var d={d:function(i0,_d){for(var Pv in _d)d.o(_d,Pv)&&!d.o(i0,Pv)&&Object.defineProperty(i0,Pv,{enumerable:!0,get:_d[Pv]})},o:function(i0,_d){return Object.prototype.hasOwnProperty.call(i0,_d)},r:function(i0){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i0,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i0,"__esModule",{value:!0})}},p={};d.r(p),d.d(p,{DataViewIndexOutOfBoundsError:function(){return p0},DecodeError:function(){return _A},Decoder:function(){return rI},EXT_TIMESTAMP:function(){return n0},Encoder:function(){return s0},ExtData:function(){return ah},ExtensionCodec:function(){return c0},decode:function(){return LI},decodeArrayStream:function(){return s1},decodeAsync:function(){return v_},decodeMulti:function(){return x1},decodeMultiStream:function(){return iR},decodeStream:function(){return h8},decodeTimestampExtension:function(){return D0},decodeTimestampToTimeSpec:function(){return V0},encode:function(){return Rv},encodeDateToTimeSpec:function(){return E0},encodeTimeSpecToTimestamp:function(){return f0},encodeTimestampExtension:function(){return m0}});var A=4294967295;function y(i0,_d,Pv){var d0=Math.floor(Pv/4294967296),o0=Pv;i0.setUint32(_d,d0),i0.setUint32(_d+4,o0)}function g(i0,_d){return 4294967296*i0.getInt32(_d)+i0.getUint32(_d+4)}var b=function(i0,_d){var Pv=typeof Symbol=="function"&&i0[Symbol.iterator];if(!Pv)return i0;var d0,o0,N0=Pv.call(i0),S0=[];try{for(;(_d===void 0||_d-- >0)&&!(d0=N0.next()).done;)S0.push(d0.value)}catch(q0){o0={error:q0}}finally{try{d0&&!d0.done&&(Pv=N0.return)&&Pv.call(N0)}finally{if(o0)throw o0.error}}return S0},I=function(i0,_d){for(var Pv=0,d0=_d.length,o0=i0.length;Pv<d0;Pv++,o0++)i0[o0]=_d[Pv];return i0},k=typeof TextEncoder!="undefined"&&typeof TextDecoder!="undefined";function B(i0){for(var _d=i0.length,Pv=0,d0=0;d0<_d;){var o0=i0.charCodeAt(d0++);if((4294967168&o0)!=0)if((4294965248&o0)==0)Pv+=2;else{if(o0>=55296&&o0<=56319&&d0<_d){var N0=i0.charCodeAt(d0);(64512&N0)==56320&&(++d0,o0=((1023&o0)<<10)+(1023&N0)+65536)}Pv+=(4294901760&o0)==0?3:4}else Pv++}return Pv}var q=k?new TextEncoder:void 0,$=k?typeof process!="undefined"?200:0:A,_t=q!=null&&q.encodeInto?function(i0,_d,Pv){q.encodeInto(i0,_d.subarray(Pv))}:function(i0,_d,Pv){_d.set(q.encode(i0),Pv)};function _r(i0,_d,Pv){for(var d0=_d,o0=d0+Pv,N0=[],S0="";d0<o0;){var q0=i0[d0++];if((128&q0)==0)N0.push(q0);else if((224&q0)==192){var aI=63&i0[d0++];N0.push((31&q0)<<6|aI)}else if((240&q0)==224){aI=63&i0[d0++];var lI=63&i0[d0++];N0.push((31&q0)<<12|aI<<6|lI)}else if((248&q0)==240){var x0=(7&q0)<<18|(aI=63&i0[d0++])<<12|(lI=63&i0[d0++])<<6|63&i0[d0++];x0>65535&&(x0-=65536,N0.push(x0>>>10&1023|55296),x0=56320|1023&x0),N0.push(x0)}else N0.push(q0);N0.length>=4096&&(S0+=String.fromCharCode.apply(String,I([],b(N0))),N0.length=0)}return N0.length>0&&(S0+=String.fromCharCode.apply(String,I([],b(N0)))),S0}var _i,ga=k?new TextDecoder:null,_u=k?typeof process!="undefined"?200:0:A,ah=function(i0,_d){this.type=i0,this.data=_d},_h=(_i=function(i0,_d){return(_i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Pv,d0){Pv.__proto__=d0}||function(Pv,d0){for(var o0 in d0)Object.prototype.hasOwnProperty.call(d0,o0)&&(Pv[o0]=d0[o0])})(i0,_d)},function(i0,_d){if(typeof _d!="function"&&_d!==null)throw new TypeError("Class extends value "+String(_d)+" is not a constructor or null");function Pv(){this.constructor=i0}_i(i0,_d),i0.prototype=_d===null?Object.create(_d):(Pv.prototype=_d.prototype,new Pv)}),_A=function(i0){function _d(Pv){var d0=i0.call(this,Pv)||this,o0=Object.create(_d.prototype);return Object.setPrototypeOf(d0,o0),Object.defineProperty(d0,"name",{configurable:!0,enumerable:!1,value:_d.name}),d0}return _h(_d,i0),_d}(Error),n0=-1;function f0(i0){var _d,Pv=i0.sec,d0=i0.nsec;if(Pv>=0&&d0>=0&&Pv<=17179869183){if(d0===0&&Pv<=4294967295){var o0=new Uint8Array(4);return(_d=new DataView(o0.buffer)).setUint32(0,Pv),o0}var N0=Pv/4294967296,S0=4294967295&Pv;return o0=new Uint8Array(8),(_d=new DataView(o0.buffer)).setUint32(0,d0<<2|3&N0),_d.setUint32(4,S0),o0}return o0=new Uint8Array(12),(_d=new DataView(o0.buffer)).setUint32(0,d0),y(_d,4,Pv),o0}function E0(i0){var _d=i0.getTime(),Pv=Math.floor(_d/1e3),d0=1e6*(_d-1e3*Pv),o0=Math.floor(d0/1e9);return{sec:Pv+o0,nsec:d0-1e9*o0}}function m0(i0){return i0 instanceof Date?f0(E0(i0)):null}function V0(i0){var _d=new DataView(i0.buffer,i0.byteOffset,i0.byteLength);switch(i0.byteLength){case 4:return{sec:_d.getUint32(0),nsec:0};case 8:var Pv=_d.getUint32(0);return{sec:4294967296*(3&Pv)+_d.getUint32(4),nsec:Pv>>>2};case 12:return{sec:g(_d,4),nsec:_d.getUint32(0)};default:throw new _A("Unrecognized data size for timestamp (expected 4, 8, or 12): "+i0.length)}}function D0(i0){var _d=V0(i0);return new Date(1e3*_d.sec+_d.nsec/1e6)}var j0={type:n0,encode:m0,decode:D0},c0=function(){function i0(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(j0)}return i0.prototype.register=function(_d){var Pv=_d.type,d0=_d.encode,o0=_d.decode;if(Pv>=0)this.encoders[Pv]=d0,this.decoders[Pv]=o0;else{var N0=1+Pv;this.builtInEncoders[N0]=d0,this.builtInDecoders[N0]=o0}},i0.prototype.tryToEncode=function(_d,Pv){for(var d0=0;d0<this.builtInEncoders.length;d0++)if((o0=this.builtInEncoders[d0])!=null&&(N0=o0(_d,Pv))!=null)return new ah(-1-d0,N0);for(d0=0;d0<this.encoders.length;d0++){var o0,N0;if((o0=this.encoders[d0])!=null&&(N0=o0(_d,Pv))!=null)return new ah(d0,N0)}return _d instanceof ah?_d:null},i0.prototype.decode=function(_d,Pv,d0){var o0=Pv<0?this.builtInDecoders[-1-Pv]:this.decoders[Pv];return o0?o0(_d,Pv,d0):new ah(Pv,_d)},i0.defaultCodec=new i0,i0}();function _m(i0){return i0 instanceof Uint8Array?i0:ArrayBuffer.isView(i0)?new Uint8Array(i0.buffer,i0.byteOffset,i0.byteLength):i0 instanceof ArrayBuffer?new Uint8Array(i0):Uint8Array.from(i0)}var t0=function(i0){var _d=typeof Symbol=="function"&&Symbol.iterator,Pv=_d&&i0[_d],d0=0;if(Pv)return Pv.call(i0);if(i0&&typeof i0.length=="number")return{next:function(){return i0&&d0>=i0.length&&(i0=void 0),{value:i0&&i0[d0++],done:!i0}}};throw new TypeError(_d?"Object is not iterable.":"Symbol.iterator is not defined.")},s0=function(){function i0(_d,Pv,d0,o0,N0,S0,q0,aI){_d===void 0&&(_d=c0.defaultCodec),Pv===void 0&&(Pv=void 0),d0===void 0&&(d0=100),o0===void 0&&(o0=2048),N0===void 0&&(N0=!1),S0===void 0&&(S0=!1),q0===void 0&&(q0=!1),aI===void 0&&(aI=!1),this.extensionCodec=_d,this.context=Pv,this.maxDepth=d0,this.initialBufferSize=o0,this.sortKeys=N0,this.forceFloat32=S0,this.ignoreUndefined=q0,this.forceIntegerToFloat=aI,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return i0.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},i0.prototype.reinitializeState=function(){this.pos=0},i0.prototype.encode=function(_d){return this.reinitializeState(),this.doEncode(_d,1),this.getUint8Array()},i0.prototype.doEncode=function(_d,Pv){if(Pv>this.maxDepth)throw new Error("Too deep objects in depth "+Pv);_d==null?this.encodeNil():typeof _d=="boolean"?this.encodeBoolean(_d):typeof _d=="number"?this.encodeNumber(_d):typeof _d=="string"?this.encodeString(_d):this.encodeObject(_d,Pv)},i0.prototype.ensureBufferSizeToWrite=function(_d){var Pv=this.pos+_d;this.view.byteLength<Pv&&this.resizeBuffer(2*Pv)},i0.prototype.resizeBuffer=function(_d){var Pv=new ArrayBuffer(_d),d0=new Uint8Array(Pv),o0=new DataView(Pv);d0.set(this.bytes),this.view=o0,this.bytes=d0},i0.prototype.encodeNil=function(){this.writeU8(192)},i0.prototype.encodeBoolean=function(_d){_d===!1?this.writeU8(194):this.writeU8(195)},i0.prototype.encodeNumber=function(_d){Number.isSafeInteger(_d)&&!this.forceIntegerToFloat?_d>=0?_d<128?this.writeU8(_d):_d<256?(this.writeU8(204),this.writeU8(_d)):_d<65536?(this.writeU8(205),this.writeU16(_d)):_d<4294967296?(this.writeU8(206),this.writeU32(_d)):(this.writeU8(207),this.writeU64(_d)):_d>=-32?this.writeU8(224|_d+32):_d>=-128?(this.writeU8(208),this.writeI8(_d)):_d>=-32768?(this.writeU8(209),this.writeI16(_d)):_d>=-2147483648?(this.writeU8(210),this.writeI32(_d)):(this.writeU8(211),this.writeI64(_d)):this.forceFloat32?(this.writeU8(202),this.writeF32(_d)):(this.writeU8(203),this.writeF64(_d))},i0.prototype.writeStringHeader=function(_d){if(_d<32)this.writeU8(160+_d);else if(_d<256)this.writeU8(217),this.writeU8(_d);else if(_d<65536)this.writeU8(218),this.writeU16(_d);else{if(!(_d<4294967296))throw new Error("Too long string: "+_d+" bytes in UTF-8");this.writeU8(219),this.writeU32(_d)}},i0.prototype.encodeString=function(_d){if(_d.length>$){var Pv=B(_d);this.ensureBufferSizeToWrite(5+Pv),this.writeStringHeader(Pv),_t(_d,this.bytes,this.pos),this.pos+=Pv}else Pv=B(_d),this.ensureBufferSizeToWrite(5+Pv),this.writeStringHeader(Pv),function(d0,o0,N0){for(var S0=d0.length,q0=N0,aI=0;aI<S0;){var lI=d0.charCodeAt(aI++);if((4294967168&lI)!=0){if((4294965248&lI)==0)o0[q0++]=lI>>6&31|192;else{if(lI>=55296&&lI<=56319&&aI<S0){var x0=d0.charCodeAt(aI);(64512&x0)==56320&&(++aI,lI=((1023&lI)<<10)+(1023&x0)+65536)}(4294901760&lI)==0?(o0[q0++]=lI>>12&15|224,o0[q0++]=lI>>6&63|128):(o0[q0++]=lI>>18&7|240,o0[q0++]=lI>>12&63|128,o0[q0++]=lI>>6&63|128)}o0[q0++]=63&lI|128}else o0[q0++]=lI}}(_d,this.bytes,this.pos),this.pos+=Pv},i0.prototype.encodeObject=function(_d,Pv){var d0=this.extensionCodec.tryToEncode(_d,this.context);if(d0!=null)this.encodeExtension(d0);else if(Array.isArray(_d))this.encodeArray(_d,Pv);else if(ArrayBuffer.isView(_d))this.encodeBinary(_d);else{if(typeof _d!="object")throw new Error("Unrecognized object: "+Object.prototype.toString.apply(_d));this.encodeMap(_d,Pv)}},i0.prototype.encodeBinary=function(_d){var Pv=_d.byteLength;if(Pv<256)this.writeU8(196),this.writeU8(Pv);else if(Pv<65536)this.writeU8(197),this.writeU16(Pv);else{if(!(Pv<4294967296))throw new Error("Too large binary: "+Pv);this.writeU8(198),this.writeU32(Pv)}var d0=_m(_d);this.writeU8a(d0)},i0.prototype.encodeArray=function(_d,Pv){var d0,o0,N0=_d.length;if(N0<16)this.writeU8(144+N0);else if(N0<65536)this.writeU8(220),this.writeU16(N0);else{if(!(N0<4294967296))throw new Error("Too large array: "+N0);this.writeU8(221),this.writeU32(N0)}try{for(var S0=t0(_d),q0=S0.next();!q0.done;q0=S0.next()){var aI=q0.value;this.doEncode(aI,Pv+1)}}catch(lI){d0={error:lI}}finally{try{q0&&!q0.done&&(o0=S0.return)&&o0.call(S0)}finally{if(d0)throw d0.error}}},i0.prototype.countWithoutUndefined=function(_d,Pv){var d0,o0,N0=0;try{for(var S0=t0(Pv),q0=S0.next();!q0.done;q0=S0.next())_d[q0.value]!==void 0&&N0++}catch(aI){d0={error:aI}}finally{try{q0&&!q0.done&&(o0=S0.return)&&o0.call(S0)}finally{if(d0)throw d0.error}}return N0},i0.prototype.encodeMap=function(_d,Pv){var d0,o0,N0=Object.keys(_d);this.sortKeys&&N0.sort();var S0=this.ignoreUndefined?this.countWithoutUndefined(_d,N0):N0.length;if(S0<16)this.writeU8(128+S0);else if(S0<65536)this.writeU8(222),this.writeU16(S0);else{if(!(S0<4294967296))throw new Error("Too large map object: "+S0);this.writeU8(223),this.writeU32(S0)}try{for(var q0=t0(N0),aI=q0.next();!aI.done;aI=q0.next()){var lI=aI.value,x0=_d[lI];this.ignoreUndefined&&x0===void 0||(this.encodeString(lI),this.doEncode(x0,Pv+1))}}catch(W0){d0={error:W0}}finally{try{aI&&!aI.done&&(o0=q0.return)&&o0.call(q0)}finally{if(d0)throw d0.error}}},i0.prototype.encodeExtension=function(_d){var Pv=_d.data.length;if(Pv===1)this.writeU8(212);else if(Pv===2)this.writeU8(213);else if(Pv===4)this.writeU8(214);else if(Pv===8)this.writeU8(215);else if(Pv===16)this.writeU8(216);else if(Pv<256)this.writeU8(199),this.writeU8(Pv);else if(Pv<65536)this.writeU8(200),this.writeU16(Pv);else{if(!(Pv<4294967296))throw new Error("Too large extension object: "+Pv);this.writeU8(201),this.writeU32(Pv)}this.writeI8(_d.type),this.writeU8a(_d.data)},i0.prototype.writeU8=function(_d){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,_d),this.pos++},i0.prototype.writeU8a=function(_d){var Pv=_d.length;this.ensureBufferSizeToWrite(Pv),this.bytes.set(_d,this.pos),this.pos+=Pv},i0.prototype.writeI8=function(_d){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,_d),this.pos++},i0.prototype.writeU16=function(_d){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,_d),this.pos+=2},i0.prototype.writeI16=function(_d){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,_d),this.pos+=2},i0.prototype.writeU32=function(_d){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,_d),this.pos+=4},i0.prototype.writeI32=function(_d){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,_d),this.pos+=4},i0.prototype.writeF32=function(_d){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,_d),this.pos+=4},i0.prototype.writeF64=function(_d){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,_d),this.pos+=8},i0.prototype.writeU64=function(_d){this.ensureBufferSizeToWrite(8),function(Pv,d0,o0){var N0=o0/4294967296,S0=o0;Pv.setUint32(d0,N0),Pv.setUint32(d0+4,S0)}(this.view,this.pos,_d),this.pos+=8},i0.prototype.writeI64=function(_d){this.ensureBufferSizeToWrite(8),y(this.view,this.pos,_d),this.pos+=8},i0}(),P0={};function Rv(i0,_d){return _d===void 0&&(_d=P0),new s0(_d.extensionCodec,_d.context,_d.maxDepth,_d.initialBufferSize,_d.sortKeys,_d.forceFloat32,_d.ignoreUndefined,_d.forceIntegerToFloat).encode(i0)}function e0(i0){return(i0<0?"-":"")+"0x"+Math.abs(i0).toString(16).padStart(2,"0")}var l0=function(){function i0(_d,Pv){_d===void 0&&(_d=16),Pv===void 0&&(Pv=16),this.maxKeyLength=_d,this.maxLengthPerKey=Pv,this.hit=0,this.miss=0,this.caches=[];for(var d0=0;d0<this.maxKeyLength;d0++)this.caches.push([])}return i0.prototype.canBeCached=function(_d){return _d>0&&_d<=this.maxKeyLength},i0.prototype.find=function(_d,Pv,d0){var o0,N0,S0=this.caches[d0-1];try{t:for(var q0=function(iI){var CI=typeof Symbol=="function"&&Symbol.iterator,zI=CI&&iI[CI],G1=0;if(zI)return zI.call(iI);if(iI&&typeof iI.length=="number")return{next:function(){return iI&&G1>=iI.length&&(iI=void 0),{value:iI&&iI[G1++],done:!iI}}};throw new TypeError(CI?"Object is not iterable.":"Symbol.iterator is not defined.")}(S0),aI=q0.next();!aI.done;aI=q0.next()){for(var lI=aI.value,x0=lI.bytes,W0=0;W0<d0;W0++)if(x0[W0]!==_d[Pv+W0])continue t;return lI.str}}catch(iI){o0={error:iI}}finally{try{aI&&!aI.done&&(N0=q0.return)&&N0.call(q0)}finally{if(o0)throw o0.error}}return null},i0.prototype.store=function(_d,Pv){var d0=this.caches[_d.length-1],o0={bytes:_d,str:Pv};d0.length>=this.maxLengthPerKey?d0[Math.random()*d0.length|0]=o0:d0.push(o0)},i0.prototype.decode=function(_d,Pv,d0){var o0=this.find(_d,Pv,d0);if(o0!=null)return this.hit++,o0;this.miss++;var N0=_r(_d,Pv,d0),S0=Uint8Array.prototype.slice.call(_d,Pv,Pv+d0);return this.store(S0,N0),N0},i0}(),w0=function(i0,_d){var Pv,d0,o0,N0,S0={label:0,sent:function(){if(1&o0[0])throw o0[1];return o0[1]},trys:[],ops:[]};return N0={next:q0(0),throw:q0(1),return:q0(2)},typeof Symbol=="function"&&(N0[Symbol.iterator]=function(){return this}),N0;function q0(aI){return function(lI){return function(x0){if(Pv)throw new TypeError("Generator is already executing.");for(;S0;)try{if(Pv=1,d0&&(o0=2&x0[0]?d0.return:x0[0]?d0.throw||((o0=d0.return)&&o0.call(d0),0):d0.next)&&!(o0=o0.call(d0,x0[1])).done)return o0;switch(d0=0,o0&&(x0=[2&x0[0],o0.value]),x0[0]){case 0:case 1:o0=x0;break;case 4:return S0.label++,{value:x0[1],done:!1};case 5:S0.label++,d0=x0[1],x0=[0];continue;case 7:x0=S0.ops.pop(),S0.trys.pop();continue;default:if(!((o0=(o0=S0.trys).length>0&&o0[o0.length-1])||x0[0]!==6&&x0[0]!==2)){S0=0;continue}if(x0[0]===3&&(!o0||x0[1]>o0[0]&&x0[1]<o0[3])){S0.label=x0[1];break}if(x0[0]===6&&S0.label<o0[1]){S0.label=o0[1],o0=x0;break}if(o0&&S0.label<o0[2]){S0.label=o0[2],S0.ops.push(x0);break}o0[2]&&S0.ops.pop(),S0.trys.pop();continue}x0=_d.call(i0,S0)}catch(W0){x0=[6,W0],d0=0}finally{Pv=o0=0}if(5&x0[0])throw x0[1];return{value:x0[0]?x0[1]:void 0,done:!0}}([aI,lI])}}},B0=function(i0){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _d,Pv=i0[Symbol.asyncIterator];return Pv?Pv.call(i0):(i0=typeof __values=="function"?__values(i0):i0[Symbol.iterator](),_d={},d0("next"),d0("throw"),d0("return"),_d[Symbol.asyncIterator]=function(){return this},_d);function d0(o0){_d[o0]=i0[o0]&&function(N0){return new Promise(function(S0,q0){(function(aI,lI,x0,W0){Promise.resolve(W0).then(function(iI){aI({value:iI,done:x0})},lI)})(S0,q0,(N0=i0[o0](N0)).done,N0.value)})}}},g0=function(i0){return this instanceof g0?(this.v=i0,this):new g0(i0)},_n=function(i0,_d,Pv){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d0,o0=Pv.apply(i0,_d||[]),N0=[];return d0={},S0("next"),S0("throw"),S0("return"),d0[Symbol.asyncIterator]=function(){return this},d0;function S0(W0){o0[W0]&&(d0[W0]=function(iI){return new Promise(function(CI,zI){N0.push([W0,iI,CI,zI])>1||q0(W0,iI)})})}function q0(W0,iI){try{(CI=o0[W0](iI)).value instanceof g0?Promise.resolve(CI.value.v).then(aI,lI):x0(N0[0][2],CI)}catch(zI){x0(N0[0][3],zI)}var CI}function aI(W0){q0("next",W0)}function lI(W0){q0("throw",W0)}function x0(W0,iI){W0(iI),N0.shift(),N0.length&&q0(N0[0][0],N0[0][1])}},_l=new DataView(new ArrayBuffer(0)),_p=new Uint8Array(_l.buffer),p0=function(){try{_l.getInt8(0)}catch(i0){return i0.constructor}throw new Error("never reached")}(),L0=new p0("Insufficient data"),oI=new l0,rI=function(){function i0(_d,Pv,d0,o0,N0,S0,q0,aI){_d===void 0&&(_d=c0.defaultCodec),Pv===void 0&&(Pv=void 0),d0===void 0&&(d0=A),o0===void 0&&(o0=A),N0===void 0&&(N0=A),S0===void 0&&(S0=A),q0===void 0&&(q0=A),aI===void 0&&(aI=oI),this.extensionCodec=_d,this.context=Pv,this.maxStrLength=d0,this.maxBinLength=o0,this.maxArrayLength=N0,this.maxMapLength=S0,this.maxExtLength=q0,this.keyDecoder=aI,this.totalPos=0,this.pos=0,this.view=_l,this.bytes=_p,this.headByte=-1,this.stack=[]}return i0.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},i0.prototype.setBuffer=function(_d){this.bytes=_m(_d),this.view=function(Pv){if(Pv instanceof ArrayBuffer)return new DataView(Pv);var d0=_m(Pv);return new DataView(d0.buffer,d0.byteOffset,d0.byteLength)}(this.bytes),this.pos=0},i0.prototype.appendBuffer=function(_d){if(this.headByte!==-1||this.hasRemaining(1)){var Pv=this.bytes.subarray(this.pos),d0=_m(_d),o0=new Uint8Array(Pv.length+d0.length);o0.set(Pv),o0.set(d0,Pv.length),this.setBuffer(o0)}else this.setBuffer(_d)},i0.prototype.hasRemaining=function(_d){return this.view.byteLength-this.pos>=_d},i0.prototype.createExtraByteError=function(_d){var Pv=this.view,d0=this.pos;return new RangeError("Extra "+(Pv.byteLength-d0)+" of "+Pv.byteLength+" byte(s) found at buffer["+_d+"]")},i0.prototype.decode=function(_d){this.reinitializeState(),this.setBuffer(_d);var Pv=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return Pv},i0.prototype.decodeMulti=function(_d){return w0(this,function(Pv){switch(Pv.label){case 0:this.reinitializeState(),this.setBuffer(_d),Pv.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return Pv.sent(),[3,1];case 3:return[2]}})},i0.prototype.decodeAsync=function(_d){var Pv,d0,o0,N0,S0,q0,aI,lI;return S0=this,q0=void 0,lI=function(){var x0,W0,iI,CI,zI,G1,F0,K0;return w0(this,function(uI){switch(uI.label){case 0:x0=!1,uI.label=1;case 1:uI.trys.push([1,6,7,12]),Pv=B0(_d),uI.label=2;case 2:return[4,Pv.next()];case 3:if((d0=uI.sent()).done)return[3,5];if(iI=d0.value,x0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(iI);try{W0=this.doDecodeSync(),x0=!0}catch(PI){if(!(PI instanceof p0))throw PI}this.totalPos+=this.pos,uI.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return CI=uI.sent(),o0={error:CI},[3,12];case 7:return uI.trys.push([7,,10,11]),d0&&!d0.done&&(N0=Pv.return)?[4,N0.call(Pv)]:[3,9];case 8:uI.sent(),uI.label=9;case 9:return[3,11];case 10:if(o0)throw o0.error;return[7];case 11:return[7];case 12:if(x0){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,W0]}throw G1=(zI=this).headByte,F0=zI.pos,K0=zI.totalPos,new RangeError("Insufficient data in parsing "+e0(G1)+" at "+K0+" ("+F0+" in the current buffer)")}})},new((aI=void 0)||(aI=Promise))(function(x0,W0){function iI(G1){try{zI(lI.next(G1))}catch(F0){W0(F0)}}function CI(G1){try{zI(lI.throw(G1))}catch(F0){W0(F0)}}function zI(G1){var F0;G1.done?x0(G1.value):(F0=G1.value,F0 instanceof aI?F0:new aI(function(K0){K0(F0)})).then(iI,CI)}zI((lI=lI.apply(S0,q0||[])).next())})},i0.prototype.decodeArrayStream=function(_d){return this.decodeMultiAsync(_d,!0)},i0.prototype.decodeStream=function(_d){return this.decodeMultiAsync(_d,!1)},i0.prototype.decodeMultiAsync=function(_d,Pv){return _n(this,arguments,function(){var d0,o0,N0,S0,q0,aI,lI,x0,W0;return w0(this,function(iI){switch(iI.label){case 0:d0=Pv,o0=-1,iI.label=1;case 1:iI.trys.push([1,13,14,19]),N0=B0(_d),iI.label=2;case 2:return[4,g0(N0.next())];case 3:if((S0=iI.sent()).done)return[3,12];if(q0=S0.value,Pv&&o0===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(q0),d0&&(o0=this.readArraySize(),d0=!1,this.complete()),iI.label=4;case 4:iI.trys.push([4,9,,10]),iI.label=5;case 5:return[4,g0(this.doDecodeSync())];case 6:return[4,iI.sent()];case 7:return iI.sent(),--o0==0?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((aI=iI.sent())instanceof p0))throw aI;return[3,10];case 10:this.totalPos+=this.pos,iI.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return lI=iI.sent(),x0={error:lI},[3,19];case 14:return iI.trys.push([14,,17,18]),S0&&!S0.done&&(W0=N0.return)?[4,g0(W0.call(N0))]:[3,16];case 15:iI.sent(),iI.label=16;case 16:return[3,18];case 17:if(x0)throw x0.error;return[7];case 18:return[7];case 19:return[2]}})})},i0.prototype.doDecodeSync=function(){t:for(;;){var _d=this.readHeadByte(),Pv=void 0;if(_d>=224)Pv=_d-256;else if(_d<192)if(_d<128)Pv=_d;else if(_d<144){if((o0=_d-128)!=0){this.pushMapState(o0),this.complete();continue t}Pv={}}else if(_d<160){if((o0=_d-144)!=0){this.pushArrayState(o0),this.complete();continue t}Pv=[]}else{var d0=_d-160;Pv=this.decodeUtf8String(d0,0)}else if(_d===192)Pv=null;else if(_d===194)Pv=!1;else if(_d===195)Pv=!0;else if(_d===202)Pv=this.readF32();else if(_d===203)Pv=this.readF64();else if(_d===204)Pv=this.readU8();else if(_d===205)Pv=this.readU16();else if(_d===206)Pv=this.readU32();else if(_d===207)Pv=this.readU64();else if(_d===208)Pv=this.readI8();else if(_d===209)Pv=this.readI16();else if(_d===210)Pv=this.readI32();else if(_d===211)Pv=this.readI64();else if(_d===217)d0=this.lookU8(),Pv=this.decodeUtf8String(d0,1);else if(_d===218)d0=this.lookU16(),Pv=this.decodeUtf8String(d0,2);else if(_d===219)d0=this.lookU32(),Pv=this.decodeUtf8String(d0,4);else if(_d===220){if((o0=this.readU16())!==0){this.pushArrayState(o0),this.complete();continue t}Pv=[]}else if(_d===221){if((o0=this.readU32())!==0){this.pushArrayState(o0),this.complete();continue t}Pv=[]}else if(_d===222){if((o0=this.readU16())!==0){this.pushMapState(o0),this.complete();continue t}Pv={}}else if(_d===223){if((o0=this.readU32())!==0){this.pushMapState(o0),this.complete();continue t}Pv={}}else if(_d===196){var o0=this.lookU8();Pv=this.decodeBinary(o0,1)}else if(_d===197)o0=this.lookU16(),Pv=this.decodeBinary(o0,2);else if(_d===198)o0=this.lookU32(),Pv=this.decodeBinary(o0,4);else if(_d===212)Pv=this.decodeExtension(1,0);else if(_d===213)Pv=this.decodeExtension(2,0);else if(_d===214)Pv=this.decodeExtension(4,0);else if(_d===215)Pv=this.decodeExtension(8,0);else if(_d===216)Pv=this.decodeExtension(16,0);else if(_d===199)o0=this.lookU8(),Pv=this.decodeExtension(o0,1);else if(_d===200)o0=this.lookU16(),Pv=this.decodeExtension(o0,2);else{if(_d!==201)throw new _A("Unrecognized type byte: "+e0(_d));o0=this.lookU32(),Pv=this.decodeExtension(o0,4)}this.complete();for(var N0=this.stack;N0.length>0;){var S0=N0[N0.length-1];if(S0.type===0){if(S0.array[S0.position]=Pv,S0.position++,S0.position!==S0.size)continue t;N0.pop(),Pv=S0.array}else{if(S0.type===1){if((q0=typeof Pv)!="string"&&q0!=="number")throw new _A("The type of key must be string or number but "+typeof Pv);if(Pv==="__proto__")throw new _A("The key __proto__ is not allowed");S0.key=Pv,S0.type=2;continue t}if(S0.map[S0.key]=Pv,S0.readCount++,S0.readCount!==S0.size){S0.key=null,S0.type=1;continue t}N0.pop(),Pv=S0.map}}return Pv}var q0},i0.prototype.readHeadByte=function(){return this.headByte===-1&&(this.headByte=this.readU8()),this.headByte},i0.prototype.complete=function(){this.headByte=-1},i0.prototype.readArraySize=function(){var _d=this.readHeadByte();switch(_d){case 220:return this.readU16();case 221:return this.readU32();default:if(_d<160)return _d-144;throw new _A("Unrecognized array type byte: "+e0(_d))}},i0.prototype.pushMapState=function(_d){if(_d>this.maxMapLength)throw new _A("Max length exceeded: map length ("+_d+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:_d,key:null,readCount:0,map:{}})},i0.prototype.pushArrayState=function(_d){if(_d>this.maxArrayLength)throw new _A("Max length exceeded: array length ("+_d+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:_d,array:new Array(_d),position:0})},i0.prototype.decodeUtf8String=function(_d,Pv){var d0;if(_d>this.maxStrLength)throw new _A("Max length exceeded: UTF-8 byte length ("+_d+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+Pv+_d)throw L0;var o0,N0=this.pos+Pv;return o0=this.stateIsMapKey()&&((d0=this.keyDecoder)===null||d0===void 0?void 0:d0.canBeCached(_d))?this.keyDecoder.decode(this.bytes,N0,_d):_d>_u?function(S0,q0,aI){var lI=S0.subarray(q0,q0+aI);return ga.decode(lI)}(this.bytes,N0,_d):_r(this.bytes,N0,_d),this.pos+=Pv+_d,o0},i0.prototype.stateIsMapKey=function(){return this.stack.length>0&&this.stack[this.stack.length-1].type===1},i0.prototype.decodeBinary=function(_d,Pv){if(_d>this.maxBinLength)throw new _A("Max length exceeded: bin length ("+_d+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(_d+Pv))throw L0;var d0=this.pos+Pv,o0=this.bytes.subarray(d0,d0+_d);return this.pos+=Pv+_d,o0},i0.prototype.decodeExtension=function(_d,Pv){if(_d>this.maxExtLength)throw new _A("Max length exceeded: ext length ("+_d+") > maxExtLength ("+this.maxExtLength+")");var d0=this.view.getInt8(this.pos+Pv),o0=this.decodeBinary(_d,Pv+1);return this.extensionCodec.decode(o0,d0,this.context)},i0.prototype.lookU8=function(){return this.view.getUint8(this.pos)},i0.prototype.lookU16=function(){return this.view.getUint16(this.pos)},i0.prototype.lookU32=function(){return this.view.getUint32(this.pos)},i0.prototype.readU8=function(){var _d=this.view.getUint8(this.pos);return this.pos++,_d},i0.prototype.readI8=function(){var _d=this.view.getInt8(this.pos);return this.pos++,_d},i0.prototype.readU16=function(){var _d=this.view.getUint16(this.pos);return this.pos+=2,_d},i0.prototype.readI16=function(){var _d=this.view.getInt16(this.pos);return this.pos+=2,_d},i0.prototype.readU32=function(){var _d=this.view.getUint32(this.pos);return this.pos+=4,_d},i0.prototype.readI32=function(){var _d=this.view.getInt32(this.pos);return this.pos+=4,_d},i0.prototype.readU64=function(){var _d,Pv,d0=(_d=this.view,Pv=this.pos,4294967296*_d.getUint32(Pv)+_d.getUint32(Pv+4));return this.pos+=8,d0},i0.prototype.readI64=function(){var _d=g(this.view,this.pos);return this.pos+=8,_d},i0.prototype.readF32=function(){var _d=this.view.getFloat32(this.pos);return this.pos+=4,_d},i0.prototype.readF64=function(){var _d=this.view.getFloat64(this.pos);return this.pos+=8,_d},i0}(),cI={};function LI(i0,_d){return _d===void 0&&(_d=cI),new rI(_d.extensionCodec,_d.context,_d.maxStrLength,_d.maxBinLength,_d.maxArrayLength,_d.maxMapLength,_d.maxExtLength).decode(i0)}function x1(i0,_d){return _d===void 0&&(_d=cI),new rI(_d.extensionCodec,_d.context,_d.maxStrLength,_d.maxBinLength,_d.maxArrayLength,_d.maxMapLength,_d.maxExtLength).decodeMulti(i0)}var g1=function(i0,_d){var Pv,d0,o0,N0,S0={label:0,sent:function(){if(1&o0[0])throw o0[1];return o0[1]},trys:[],ops:[]};return N0={next:q0(0),throw:q0(1),return:q0(2)},typeof Symbol=="function"&&(N0[Symbol.iterator]=function(){return this}),N0;function q0(aI){return function(lI){return function(x0){if(Pv)throw new TypeError("Generator is already executing.");for(;S0;)try{if(Pv=1,d0&&(o0=2&x0[0]?d0.return:x0[0]?d0.throw||((o0=d0.return)&&o0.call(d0),0):d0.next)&&!(o0=o0.call(d0,x0[1])).done)return o0;switch(d0=0,o0&&(x0=[2&x0[0],o0.value]),x0[0]){case 0:case 1:o0=x0;break;case 4:return S0.label++,{value:x0[1],done:!1};case 5:S0.label++,d0=x0[1],x0=[0];continue;case 7:x0=S0.ops.pop(),S0.trys.pop();continue;default:if(!((o0=(o0=S0.trys).length>0&&o0[o0.length-1])||x0[0]!==6&&x0[0]!==2)){S0=0;continue}if(x0[0]===3&&(!o0||x0[1]>o0[0]&&x0[1]<o0[3])){S0.label=x0[1];break}if(x0[0]===6&&S0.label<o0[1]){S0.label=o0[1],o0=x0;break}if(o0&&S0.label<o0[2]){S0.label=o0[2],S0.ops.push(x0);break}o0[2]&&S0.ops.pop(),S0.trys.pop();continue}x0=_d.call(i0,S0)}catch(W0){x0=[6,W0],d0=0}finally{Pv=o0=0}if(5&x0[0])throw x0[1];return{value:x0[0]?x0[1]:void 0,done:!0}}([aI,lI])}}},FI=function(i0){return this instanceof FI?(this.v=i0,this):new FI(i0)},BI=function(i0,_d,Pv){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d0,o0=Pv.apply(i0,_d||[]),N0=[];return d0={},S0("next"),S0("throw"),S0("return"),d0[Symbol.asyncIterator]=function(){return this},d0;function S0(W0){o0[W0]&&(d0[W0]=function(iI){return new Promise(function(CI,zI){N0.push([W0,iI,CI,zI])>1||q0(W0,iI)})})}function q0(W0,iI){try{(CI=o0[W0](iI)).value instanceof FI?Promise.resolve(CI.value.v).then(aI,lI):x0(N0[0][2],CI)}catch(zI){x0(N0[0][3],zI)}var CI}function aI(W0){q0("next",W0)}function lI(W0){q0("throw",W0)}function x0(W0,iI){W0(iI),N0.shift(),N0.length&&q0(N0[0][0],N0[0][1])}};function u1(i0){if(i0==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function n_(i0){return i0[Symbol.asyncIterator]!=null?i0:function(_d){return BI(this,arguments,function(){var Pv,d0,o0,N0;return g1(this,function(S0){switch(S0.label){case 0:Pv=_d.getReader(),S0.label=1;case 1:S0.trys.push([1,,9,10]),S0.label=2;case 2:return[4,FI(Pv.read())];case 3:return d0=S0.sent(),o0=d0.done,N0=d0.value,o0?[4,FI(void 0)]:[3,5];case 4:return[2,S0.sent()];case 5:return u1(N0),[4,FI(N0)];case 6:return[4,S0.sent()];case 7:return S0.sent(),[3,2];case 8:return[3,10];case 9:return Pv.releaseLock(),[7];case 10:return[2]}})})}(i0)}function v_(i0,_d){return _d===void 0&&(_d=cI),Pv=this,d0=void 0,N0=function(){var S0;return function(q0,aI){var lI,x0,W0,iI,CI={label:0,sent:function(){if(1&W0[0])throw W0[1];return W0[1]},trys:[],ops:[]};return iI={next:zI(0),throw:zI(1),return:zI(2)},typeof Symbol=="function"&&(iI[Symbol.iterator]=function(){return this}),iI;function zI(G1){return function(F0){return function(K0){if(lI)throw new TypeError("Generator is already executing.");for(;CI;)try{if(lI=1,x0&&(W0=2&K0[0]?x0.return:K0[0]?x0.throw||((W0=x0.return)&&W0.call(x0),0):x0.next)&&!(W0=W0.call(x0,K0[1])).done)return W0;switch(x0=0,W0&&(K0=[2&K0[0],W0.value]),K0[0]){case 0:case 1:W0=K0;break;case 4:return CI.label++,{value:K0[1],done:!1};case 5:CI.label++,x0=K0[1],K0=[0];continue;case 7:K0=CI.ops.pop(),CI.trys.pop();continue;default:if(!((W0=(W0=CI.trys).length>0&&W0[W0.length-1])||K0[0]!==6&&K0[0]!==2)){CI=0;continue}if(K0[0]===3&&(!W0||K0[1]>W0[0]&&K0[1]<W0[3])){CI.label=K0[1];break}if(K0[0]===6&&CI.label<W0[1]){CI.label=W0[1],W0=K0;break}if(W0&&CI.label<W0[2]){CI.label=W0[2],CI.ops.push(K0);break}W0[2]&&CI.ops.pop(),CI.trys.pop();continue}K0=aI.call(q0,CI)}catch(uI){K0=[6,uI],x0=0}finally{lI=W0=0}if(5&K0[0])throw K0[1];return{value:K0[0]?K0[1]:void 0,done:!0}}([G1,F0])}}}(this,function(q0){return S0=n_(i0),[2,new rI(_d.extensionCodec,_d.context,_d.maxStrLength,_d.maxBinLength,_d.maxArrayLength,_d.maxMapLength,_d.maxExtLength).decodeAsync(S0)]})},new((o0=void 0)||(o0=Promise))(function(S0,q0){function aI(W0){try{x0(N0.next(W0))}catch(iI){q0(iI)}}function lI(W0){try{x0(N0.throw(W0))}catch(iI){q0(iI)}}function x0(W0){var iI;W0.done?S0(W0.value):(iI=W0.value,iI instanceof o0?iI:new o0(function(CI){CI(iI)})).then(aI,lI)}x0((N0=N0.apply(Pv,d0||[])).next())});var Pv,d0,o0,N0}function s1(i0,_d){_d===void 0&&(_d=cI);var Pv=n_(i0);return new rI(_d.extensionCodec,_d.context,_d.maxStrLength,_d.maxBinLength,_d.maxArrayLength,_d.maxMapLength,_d.maxExtLength).decodeArrayStream(Pv)}function iR(i0,_d){_d===void 0&&(_d=cI);var Pv=n_(i0);return new rI(_d.extensionCodec,_d.context,_d.maxStrLength,_d.maxBinLength,_d.maxArrayLength,_d.maxMapLength,_d.maxExtLength).decodeStream(Pv)}function h8(i0,_d){return _d===void 0&&(_d=cI),iR(i0,_d)}return p}()})(DX),(0,RS.exports)("Int8",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Int16",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Int32",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Uint16",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Uint32",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Float32",function(e){return function(l,d,p){return e(this,l,d,p)}}),(0,RS.exports)("Float64",function(e){return function(l,d,p){return e(this,l,d,p)}});const HIt=()=>function(e){const l=window.atob(e).split("").map(d=>d.charCodeAt(0));return new Uint8Array(l,0,l.length/Uint8Array.BYTES_PER_ELEMENT)}("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==");let N6,$S;async function KIt(){if(N6)return N6;const e={};let l,d={};for(l in e)Object.prototype.hasOwnProperty.call(e,l)&&(d[l]=e[l]);let p=!1,A=!1;p=typeof window=="object",A=typeof importScripts=="function",typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;let y="";(p||A)&&(A?y=self.location.href:typeof document!="undefined"&&document.currentScript&&(y=document.currentScript.src),y=y.indexOf("blob:")!==0?y.substr(0,y.lastIndexOf("/")+1):""),e.print||console.log.bind(console);const g=e.printErr||console.warn.bind(console);for(l in d)Object.prototype.hasOwnProperty.call(d,l)&&(e[l]=d[l]);let b;d=null,e.arguments,e.thisProgram,e.quit,e.wasmBinary,e.noExitRuntime,typeof WebAssembly!="object"&&n0("no native wasm support detected");let I=!1;function k(Rv){const e0=e["_"+Rv];var l0;return l0="Cannot call unknown function "+Rv+", make sure it is exported",e0||n0("Assertion failed: "+l0),e0}function B(Rv,e0,l0,w0,B0){const g0={string:function(L0){let oI=0;if(L0!=null&&L0!==0){const rI=1+(L0.length<<2);oI=s0(rI),function(cI,LI,x1){(function(g1,FI,BI,u1){if(!(u1>0))return 0;const n_=BI+u1-1;for(let v_=0;v_<g1.length;++v_){let s1=g1.charCodeAt(v_);if(s1>=55296&&s1<=57343&&(s1=65536+((1023&s1)<<10)|1023&g1.charCodeAt(++v_)),s1<=127){if(BI>=n_)break;FI[BI++]=s1}else if(s1<=2047){if(BI+1>=n_)break;FI[BI++]=192|s1>>6,FI[BI++]=128|63&s1}else if(s1<=65535){if(BI+2>=n_)break;FI[BI++]=224|s1>>12,FI[BI++]=128|s1>>6&63,FI[BI++]=128|63&s1}else{if(BI+3>=n_)break;FI[BI++]=240|s1>>18,FI[BI++]=128|s1>>12&63,FI[BI++]=128|s1>>6&63,FI[BI++]=128|63&s1}}FI[BI]=0})(cI,_t,LI,x1)}(L0,oI,rI)}return oI},array:function(L0){const oI=s0(L0.length);var rI,cI;return rI=L0,cI=oI,$.set(rI,cI),oI}},_n=k(Rv),_l=[];let _p=0;if(w0)for(let L0=0;L0<w0.length;L0++){const oI=g0[l0[L0]];oI?(_p===0&&(_p=_m()),_l[L0]=oI(w0[L0])):_l[L0]=w0[L0]}let p0=_n.apply(null,_l);return p0=function(L0){return e0==="string"?(oI=L0)?function(cI,LI,x1){const g1=LI+x1;let FI=LI,BI="";for(;cI[FI]&&!(FI>=g1);)++FI;if(FI-LI>16&&cI.subarray&&q)return q.decode(cI.subarray(LI,FI));for(;LI<FI;){let u1=cI[LI++];if(!(128&u1)){BI+=String.fromCharCode(u1);continue}const n_=63&cI[LI++];if((224&u1)==192){BI+=String.fromCharCode((31&u1)<<6|n_);continue}const v_=63&cI[LI++];if(u1=(240&u1)==224?(15&u1)<<12|n_<<6|v_:(7&u1)<<18|n_<<12|v_<<6|63&cI[LI++],u1<65536)BI+=String.fromCharCode(u1);else{const s1=u1-65536;BI+=String.fromCharCode(55296|s1>>10,56320|1023&s1)}}return BI}(_t,oI,rI):"":e0==="boolean"?Boolean(L0):L0;var oI,rI}(p0),_p!==0&&t0(_p),p0}const q=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;let $,_t,_r;typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le"),e.INITIAL_MEMORY;const _i=[],ga=[],_u=[],ah=[];ga.push({func:function(){D0()}});let _h=0,_A=null;function n0(Rv){throw e.onAbort&&e.onAbort(Rv),g(Rv+=""),I=!0,Rv="abort("+Rv+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(Rv)}e.preloadedImages={},e.preloadedAudios={};let f0="deflate.wasm";var E0;function m0(Rv){for(;Rv.length>0;){const e0=Rv.shift();if(typeof e0=="function"){e0(e);continue}const l0=e0.func;typeof l0=="number"?e0.arg===void 0?_r.get(l0)():_r.get(l0)(e0.arg):l0(e0.arg===void 0?null:e0.arg)}}E0="data:application/octet-stream;base64,",f0.startsWith(E0)||(f0=function(Rv){return e.locateFile?e.locateFile(Rv,y):y+Rv}(f0));const V0={emscripten_memcpy_big:function(Rv,e0,l0){_t.copyWithin(Rv,e0,e0+l0)},emscripten_resize_heap:function(Rv){n0("OOM")}};await async function(){const Rv={env:V0,wasi_snapshot_preview1:V0};function e0(B0,g0){const _n=B0.exports;var _l;e.asm=_n,b=e.asm.memory,_l=b.buffer,e.HEAP8=$=new Int8Array(_l),e.HEAP16=new Int16Array(_l),e.HEAP32=new Int32Array(_l),e.HEAPU8=_t=new Uint8Array(_l),e.HEAPU16=new Uint16Array(_l),e.HEAPU32=new Uint32Array(_l),e.HEAPF32=new Float32Array(_l),e.HEAPF64=new Float64Array(_l),_r=e.asm.__indirect_function_table,function(_p){if(_h--,e.monitorRunDependencies&&e.monitorRunDependencies(_h),_h==0&&_A){const p0=_A;_A=null,p0()}}()}function l0(B0){e0(B0.instance)}function w0(B0){return new Y0((g0,_n)=>{g0(HIt().buffer)}).then(function(g0){return WebAssembly.instantiate(g0,Rv)}).then(B0,function(g0){g("failed to asynchronously prepare wasm: "+g0),n0(g0)})}if(_h++,e.monitorRunDependencies&&e.monitorRunDependencies(_h),e.instantiateWasm)try{return e.instantiateWasm(Rv,e0)}catch(B0){return g("Module.instantiateWasm callback failed with error: "+B0),!1}return await w0(l0),{}}();let D0=e.___wasm_call_ctors=function(){return(D0=e.___wasm_call_ctors=e.asm.__wasm_call_ctors).apply(null,arguments)},j0=e._malloc=function(){return(j0=e._malloc=e.asm.malloc).apply(null,arguments)};e._free=function(){return(e._free=e.asm.free).apply(null,arguments)},e.___errno_location=function(){return(e.___errno_location=e.asm.__errno_location).apply(null,arguments)},e._zlibCompress=function(){return(e._zlibCompress=e.asm.zlibCompress).apply(null,arguments)};let c0,_m=e.stackSave=function(){return(_m=e.stackSave=e.asm.stackSave).apply(null,arguments)},t0=e.stackRestore=function(){return(t0=e.stackRestore=e.asm.stackRestore).apply(null,arguments)},s0=e.stackAlloc=function(){return(s0=e.stackAlloc=e.asm.stackAlloc).apply(null,arguments)};function P0(Rv){function e0(){c0||(c0=!0,e.calledRun=!0,I||(m0(ga),m0(_u),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)l0=e.postRun.shift(),ah.unshift(l0);var l0;m0(ah)}()))}_h>0||(function(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)l0=e.preRun.shift(),_i.unshift(l0);var l0;m0(_i)}(),_h>0||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),e0()},1)):e0()))}if(e.ccall=B,e.cwrap=function(Rv,e0,l0,w0){const B0=(l0=l0||[]).every(function(g0){return g0==="number"});return e0!=="string"&&B0&&!w0?k(Rv):function(){return B(Rv,e0,l0,arguments)}},e.allocate=function(Rv,e0){let l0;return l0=e0==1?s0(Rv.length):j0(Rv.length),Rv.subarray||Rv.slice?_t.set(Rv,l0):_t.set(new Uint8Array(Rv),l0),l0},_A=function Rv(){c0||P0(),c0||(_A=Rv)},e.run=P0,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return P0(),N6=e,e}const LX=Uint8Array.BYTES_PER_ELEMENT,YIt={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},WIt={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},JIt={_message:"m",_type:"t",_id:"id"},zIt={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let k6;class XIt{constructor(){_s(this,"zlibCompress",void 0)}async init(){k6||(k6=(await(async()=>($S||($S=await KIt()),{zlibCompress:d=>{const p=new Uint8Array(d),A=LX*p.byteLength,y=$S._malloc(A),g=$S._malloc(3*A);for(let k=0;k<A;k++)$S.HEAP8[y/LX+k]=p[k];const b=$S._zlibCompress(y,A,g),I=new Uint8Array($S.HEAP8.slice(g,g+b));return $S._free(y),$S._free(g),I}}))()).zlibCompress),this.zlibCompress=k6}msgPackCompress(l){return DX.exports.encode(l)}compress(l){const d=Date.now(),p=this.compressKeyAndValue(JSON.parse(JSON.stringify(l))),A=this.msgPackCompress(p),y=this.zlibCompress(A),g=new Uint8Array([49,49,49,50,...Array.from(y)]);return{origin:Object.assign({},l),originLength:JSON.stringify(l).length,shortKeyAndValue:p,msgpackSer:A,compressed:g,compressedLength:g.length,time:Date.now()-d}}compressKeyAndValue(l){return this._ObjectKeyCompress(this._typeCompress(l))}_typeCompress(l){const d=l._type;if(!d)return l;const p=zIt[d];return l._type=p||d,l}_ObjectKeyCompress(l){const d=l._message;if(d){const p=d.stats;p&&(d.stats=this._statsCompress(p)),l._message=this._messageCompress(d)}return this._reportCompress(l)}_statsCompress(l){return this._keyCompress(l,YIt)}_messageCompress(l){return this._keyCompress(l,WIt)}_reportCompress(l){return this._keyCompress(l,JIt)}_keyCompress(l,d){const p={},A=Object.keys(l);return VR(A).call(A,(y,g)=>{const b=l[g];return d[g]?p[d[g]]=b:p[g]=b,p},p),p}}class ZIt extends e1{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(l){super(),_s(this,"lowPriorityQueue",[]),_s(this,"highPriorityQueue",[]),_s(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=l}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(l){arguments.length>1&&arguments[1]!==void 0&&arguments[1]?this.highPriorityQueue.push(l):this.lowPriorityQueue.push(l),this.sendMessage()}sendMessage(){const l=this.queue.length;let d=0;d=l<5?15*l:60+3*(l-4),setTimeout(()=>{this._sendMessage()},d)}_sendMessage(){if(!this.queue.length)return;const l=this.AgoraWebSocketManager.getConnection();if(!l||l.readyState!==1)return;const d=this.queue.shift();return this.lowPriorityQueue.includes(d)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),l.send(d.compressed),d}}var PX;function xX(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}let FP=U1("AgoraWebSocketManager","connectionID")(PX=class extends e1{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){["tryNext","recover"].includes(e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._state==="reconnecting"?this.emit(SI.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(SI.CONNECTED):this._state==="closed"?this.emit(SI.CLOSED):this._state==="failed"&&this.emit(SI.FAILED))}resetReconnectCount(e){_a.debug("websocket reset reconnect count, reason: "+e),b0("debug",this,"resetReconnectCount",e,"websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,l){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2],p=arguments.length>3&&arguments[3]!==void 0&&arguments[3],A=arguments.length>4?arguments[4]:void 0;super(),_s(this,"connectionID",0),_s(this,"currentURLIndex",0),_s(this,"urls",void 0),_s(this,"_reconnectMode","tryNext"),_s(this,"reconnectReason",void 0),_s(this,"_initMutex",new g_("websocket")),_s(this,"name",void 0),_s(this,"_state","closed"),_s(this,"reconnectInterrupter",void 0),_s(this,"websocket",void 0),_s(this,"retryConfig",void 0),_s(this,"reconnectCount",0),_s(this,"onlineReconnectListener",void 0),_s(this,"compressor",new XIt),_s(this,"compressorInitStatus","initializing"),_s(this,"compress",void 0),_s(this,"messageSender",void 0),_s(this,"useCompress",void 0),_s(this,"tryDoubleDomain",!1),_s(this,"wsInflateLength",0),_s(this,"wsDeflateLength",0),_s(this,"closeEstablishingWs",()=>{}),_s(this,"store",void 0),_s(this,"joinChannelServiceRecordIndex",void 0),this.store=A,this.name=e,this.retryConfig=function(B){for(var q=1;q<arguments.length;q++){var $=arguments[q]!=null?arguments[q]:{};q%2?xX(Object($),!0).forEach(function(_t){_s(B,_t,$[_t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors($)):xX(Object($)).forEach(function(_t){Object.defineProperty(B,_t,Object.getOwnPropertyDescriptor($,_t))})}return B}({},l),this.useCompress=d,this.tryDoubleDomain=p;const{timeout:y,timeoutFactor:g}=l,b=Math.max(300,Math.floor(3*y/5)),I=Math.max(1.2,Math.floor(8*g)/10);f_.ONLINE&&(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=I),S1.on(nT.NETWORK_STATE_CHANGE,(B,q)=>{B!==q&&(this.resetReconnectCount("network state change: ".concat(q," -> ").concat(B)),B===f_.ONLINE?(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=I):(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=g))});const k=Date.now();this.compressor.init().then(()=>{this.compressorInitStatus="initialized";const B=Date.now()-k;_a.debug("websocket compressor initialized successfully in ".concat(B,"ms")),b0("debug",this.compressor,"init",void 0,"websocket compressor initialized successfully in ".concat(B,"ms")),_0.wsCompressorInit({status:!0,ec:null,eventElapse:B}),this.compress=this.compressor.compress.bind(this.compressor)}).catch(B=>{this.compressorInitStatus="failed";const q=B?B.message||B.toString():"Empty Error";_a.debug("websocket compressor failed to initialize because of ".concat(q)),b0("debug",this.compressor,"init",void 0,"websocket compressor failed to initialize because of ".concat(q)),_0.wsCompressorInit({status:!1,ec:q,eventElapse:1})})}getConnection(){return this.websocket||void 0}init(e){const l=(d,p)=>{this.urls=e;const A=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new ZIt(this),this.createWebSocketConnection(A).then(d).catch(p),this.once(SI.CLOSED,()=>p(new _E(_f.WS_DISCONNECT))),this.once(SI.CONNECTED,()=>d())};return this._initMutex.lock().then(d=>new Y0((p,A)=>{l(p,A)}).then(()=>{d()}).catch(()=>{d()}))}close(e,l){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const d=this.websocket;l?setTimeout(()=>d.close(),500):d.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,l){if(!this.websocket)return _a.warning("[".concat(this.name,"] can not reconnect, no websocket")),void b0("warning",this,"reconnect","can not reconnect, no websocket");var d;e!==void 0&&(this.reconnectMode=e),_a.debug("[".concat(this.name,"] reconnect is triggered initiative")),b0("debug",this,"reconnect"),typeof this.joinChannelServiceRecordIndex=="number"&&((d=this.store)===null||d===void 0||d.recordJoinChannelService({status:"error",errors:[new Error(l)]},this.joinChannelServiceRecordIndex));const p=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),p&&p.bind(this.websocket)({code:9999,reason:l})}sendMessageWithJSON(e){const l=JSON.stringify(e);return{compressed:l,compressedLength:l.length,origin:e}}sendMessage(e){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new _E(_f.WS_ABORT,"websocket is not ready");try{let d=null;if(this.compressorInitStatus==="initialized"&&this.useCompress&&y0("WEBSOCKET_COMPRESS"))try{d=this.compress(e),this.setWsInflateData(d)}catch{d=this.sendMessageWithJSON(e)}else d=this.sendMessageWithJSON(e);l?this.websocket.send(d.compressed):this.messageSender.pushMessage(d)}catch(d){throw new _E(_f.WS_ERR,"send websocket message error"+d.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,l=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:l}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e,l){return this.connectionID+=1,this.connectionID,this.joinChannelServiceRecordIndex=void 0,new Y0((d,p)=>{var A;const y=()=>{_a.debug("[".concat(this.name,"] websocket opened:"),e),qS("debug",["WebSocket",this.connectionID],"open",e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),d()},g=async k=>{if(_a.debug("[".concat(this.name,"] websocket close ").concat(this.websocket&&this.websocket.url,", code: ").concat(k.code,", reason: ").concat(k.reason,", current mode: ").concat(this.reconnectMode)),qS("debug",["WebSocket",this.connectionID],"close",{code:k.code,reason:k.reason,url:this.websocket&&this.websocket.url,reconnectMode:this.reconnectMode}),this.reconnectCount<this.retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=k.reason,this.state="reconnecting");const B=pT(this,SI.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,q=await this.reconnectWithAction(B);if(this.state==="closed")return _a.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect")),void H0("debug",this,"ws is closed, no need to reconnect");if(!q)return p(new _E(_f.WS_DISCONNECT,"websocket reconnect failed: ".concat(k.code))),void this.close(!0);d()}else p(new _E(_f.WS_DISCONNECT,"websocket close: ".concat(k.code))),this.close()},b=k=>{this.emit(SI.ON_MESSAGE,k)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),y0("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=y0("GATEWAY_WSS_ADDRESS")),_a.debug("[".concat(this.name,"] start connect, url: ").concat(e)),H0("debug",this,"start connect, url: ".concat(e));const I=(A=this.store)===null||A===void 0?void 0:A.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});this.chooseBestWebsocketConnection(e,!!l,I).then(k=>{var B;this.websocket=k,y&&y(),k.onclose=g,k.onmessage=b,(B=this.store)===null||B===void 0||B.recordJoinChannelService({endTs:Date.now(),status:"success"},I),this.joinChannelServiceRecordIndex=I}).catch(k=>{var B;if((B=this.store)===null||B===void 0||B.recordJoinChannelService({endTs:Date.now(),status:k instanceof _E&&k.code===_f.WS_ABORT?"aborted":"error",errors:[k]},I),this.state!=="closed"){if(k instanceof _E&&k.code===_f.WS_ERR){const q=new _E(_f.WS_ERR,"init websocket failed! Error: ".concat(k.toString()));return _a.error("[".concat(this.name,"]").concat(q)),b0("error",this,"chooseBestWebsocketConnection",void 0,k.toString()),void p(q)}g&&g(k)}else p(new _E(_f.WS_DISCONNECT,"websocket is closed: ".concat(k.toString())))})})}async reconnectWithAction(e){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||!this.urls||this.state==="closed")return!1;this.onlineReconnectListener||S1.networkState!==f_.OFFLINE||(this.onlineReconnectListener=S1.onlineWaiter&&S1.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let d=!0;if(this.reconnectInterrupter=()=>{d=!1},l){const A=O4(this.reconnectCount,this.retryConfig);_a.debug("[".concat(this.name,"] wait ").concat(A,"ms to reconnect websocket, mode: ").concat(e)),b0("debug",this,"reconnectWithAction",{timeout:A,action:e}),await Y0.race([Q1(A),this.onlineReconnectListener||new Y0(()=>{})])}if(this.state==="closed"||!d)return!1;this.reconnectCount+=1;const p=async(A,y)=>{this.emit(SI.RECONNECT_CREATE_CONNECTION,y),await this.createWebSocketConnection(A)};try{if(e==="retry"){const A=this.urls[this.currentURLIndex];this.emit(SI.RECONNECT_WAITTING_FINISH,e),await p(A,e)}else if(e==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover",!1);_a.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),H0("debug",this,"websocket url length: ".concat(this.urls.length," current index: ").concat(this.currentURLIndex));const A=this.urls[this.currentURLIndex];this.emit(SI.RECONNECT_WAITTING_FINISH,e),await p(A,e)}else if(e==="recover"){_a.debug("[".concat(this.name,"] request new urls")),H0("debug",this,"request new urls"),this.resetReconnectCount("recover mode"),this.emit(SI.RECONNECT_WAITTING_FINISH,e),this.urls=await O_(this,SI.REQUEST_NEW_URLS),this.currentURLIndex=0;const A=this.urls[this.currentURLIndex];await p(A,e)}return!0}catch(A){return _a.error("[".concat(this.name,"] reconnect failed"),A.toString()),b0("error",this,"reconnectWithAction",void 0,A.toString()),await this.reconnectWithAction(e,l)}}async chooseBestWebsocketConnection(e,l,d){return new Y0((p,A)=>{let y=!1;const g=[];this.closeEstablishingWs=()=>{_a.debug("[choose-best-ws] close establishing websockets"),g.forEach(_r=>{_r.onclose=null,_r.onopen=null,_r.onmessage=null,_r.close()}),A(new _E(_f.WS_ABORT,"choose best websocket aborted"))};const b=y0("GATEWAY_DOMAINS");let I;const k=e.indexOf("?h="),B=b.find(_r=>k!==-1?e.includes(_r,k):e.includes(_r));_a.debug("[choose-best-ws] currentDomain: ",B,", domains: ",b),b0("debug",this,"chooseBestWebsocketConnection",{currentDomain:B,domains:b});let q=!this.tryDoubleDomain||l||!B;if(!q&&B){var $;const _r=Date.now();try{b.forEach(_i=>{const ga=k===-1?e.replace(B,_i):e.substr(0,k)+e.substr(k).replace(B,_i),_u=new WebSocket(ga);_u.binaryType="arraybuffer",g.push(_u),_a.debug("[choose-best-ws] ws is connecting:",_u.url),H0("debug",this,"ws is connecting: ".concat(_u.url))})}catch{for(_a.debug("[choose-best-ws] ws create failed, fallback to single url"),H0("debug",this,"ws create failed, fallback to single url"),g.forEach(ga=>ga.close());g.length;)g.pop();q=!0}($=this.store)===null||$===void 0||$.recordJoinChannelService({urls:g.map(_i=>_i.url),service:"gateway"},d),g.forEach(_i=>{_i.onopen=()=>{if(y)return;const ga=Date.now()-_r;_a.debug("[choose-best-ws] ws open cost ".concat(ga,"ms")),g.filter(_u=>_u!==_i).forEach(_u=>{_a.debug("[choose-best-ws]close backup websocket: ".concat(_u.url)),H0("debug",this,"close backup websocket: ".concat(_u.url)),_u.close()}),y=!0,p(_i)},_i.onclose=ga=>{I=ga,!y&&(g.find(_u=>!(_u.readyState===WebSocket.CLOSED||_u.readyState===WebSocket.CLOSING))||(_a.debug("[choose-best-ws] all websocket is closed"),H0("debug",this,"all websocket is closed"),y=!0,A(I)))},_i.onmessage=ga=>{_a.debug("[choose-best-ws]".concat(_i.url," onmessage: ").concat(ga.data)),H0("debug",this,"".concat(_i.url," onmessage: ").concat(ga.data))}}),Q1(5e3).then(()=>{g.forEach(_i=>{_i.readyState!==WebSocket.OPEN&&_i.close()})})}if(q){var _t;let _r;_a.debug("[choose-best-ws] use single url: ",e),H0("debug",this,"use single url: ".concat(e)),(_t=this.store)===null||_t===void 0||_t.recordJoinChannelService({urls:[e],service:"gateway"},d);try{_r=new WebSocket(e),g.push(_r),_r.binaryType="arraybuffer"}catch(_i){const ga=new _E(_f.WS_ERR,"init websocket failed! Error: ".concat(_i.toString()));return _a.error("[".concat(this.name,"]").concat(ga)),b0("error",this,"chooseBestWebsocketConnection",void 0,_i.toString()),void A(ga)}_r.onopen=()=>{p(_r)},_r.onclose=_i=>{A(_i)},_r.onmessage=_i=>{_a.debug("[choose-best-ws]".concat(_r.url," onmessage: ").concat(_i.data)),H0("debug",this,"".concat(_r.url," onmessage: ").concat(_i.data))},Q1(5e3).then(()=>{_r&&_r.readyState!==WebSocket.OPEN&&_r.close()})}}).then(p=>(this.closeEstablishingWs=void 0,p)).catch(p=>{throw this.closeEstablishingWs=void 0,p})}})||PX;class $It{constructor(l){_s(this,"input",[]),_s(this,"size",void 0),this.size=l}add(l){this.input.push(l),this.input.length>this.size&&this.input.splice(0,1)}mean(){var l;return this.input.length===0?0:VR(l=this.input).call(l,(d,p)=>d+p)/this.input.length}}var BX;let t1t=U1("AgoraRTCSignal","websocket.connectionID")(BX=class extends e1{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===_1.CONNECTED?this.emit(fI.WS_CONNECTED):e===_1.RECONNECTING?this.emit(fI.WS_RECONNECTING,this._websocketReconnectReason):e===_1.CLOSED&&this.emit(fI.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(e,l){super(),_s(this,"_disconnectedReason",void 0),_s(this,"_websocketReconnectReason",void 0),_s(this,"_connectionState",_1.CLOSED),_s(this,"reconnectToken",void 0),_s(this,"websocket",void 0),_s(this,"openConnectionTime",void 0),_s(this,"clientId",void 0),_s(this,"lastMsgTime",Date.now()),_s(this,"uploadCache",[]),_s(this,"uploadCacheInterval",void 0),_s(this,"rttRolling",new $It(5)),_s(this,"pingpongTimer",void 0),_s(this,"wsInflateDataTimer",void 0),_s(this,"pingpongTimeoutCount",0),_s(this,"joinResponse",void 0),_s(this,"multiIpOption",void 0),_s(this,"initError",void 0),_s(this,"spec",void 0),_s(this,"store",void 0),_s(this,"onWebsocketMessage",d=>{if(d.data instanceof ArrayBuffer)return void this.emit(fI.ON_BINARY_DATA,d.data);const p=JSON.parse(d.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(p,"_id")){const A="res-@".concat(p._id);this.emit(A,p._result,p._message)}else if(Object.prototype.hasOwnProperty.call(p,"_type")&&(this.emit(p._type,p._message),p._type===xI.ON_NOTIFICATION&&this.handleNotification(p._message),p._type===xI.ON_USER_BANNED))switch(p._message.error_code){case 14:this.close(I1.UID_BANNED);break;case 15:this.close(I1.IP_BANNED);break;case 16:this.close(I1.CHANNEL_BANNED)}}),this.clientId=e.clientId,this.spec=e,this.store=l,this.websocket=new FP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,l),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===_1.CONNECTED&&this.reconnect("retry",X1.OFFLINE)})}async request(e,l,d,p){const A=i1(6,""),y={_id:A,_type:e,_message:l},g=this.websocket.connectionID,b=()=>new Y0((_t,_r)=>{if(this.connectionState===_1.CONNECTED)return _t();const _i=()=>{this.off(fI.WS_CLOSED,ga),_t()},ga=()=>{this.off(fI.WS_CONNECTED,_i),_r(new _E(_f.WS_ABORT))};this.once(fI.WS_CONNECTED,_i),this.once(fI.WS_CLOSED,ga),e!==vI.PUBLISH&&e!==vI.SUBSCRIBE&&e!==vI.UNSUBSCRIBE&&e!==vI.UNPUBLISH&&e!==vI.CONTROL||this.once(fI.DISCONNECT_P2P,()=>{_r(new _E(_f.DISCONNECT_P2P))}),e===vI.PUBLISH&&this.once(fI.ABORT_P2P_EXECUTION,()=>{_r(new _E(_f.DISCONNECT_P2P))})});if(this.connectionState!==_1.CONNECTING&&this.connectionState!==_1.RECONNECTING||e===vI.JOIN||e===vI.REJOIN||await b(),this.websocket.sendMessage(y,!0),p)return;const I=new Y0((_t,_r)=>{let _i=!1;const ga=(ah,_h)=>{_i=!0,_t({isSuccess:ah==="success",message:_h||{}}),this.off(fI.WS_CLOSED,_u),this.off(fI.WS_RECONNECTING,_u),this.emit(fI.REQUEST_SUCCESS,e,l)};this.once("res-@".concat(A),ga);const _u=()=>{_r(new _E(_f.WS_ABORT,"type: ".concat(e))),this.off(fI.WS_CLOSED,_u),this.off(fI.WS_RECONNECTING,_u),this.off("res-@".concat(A),ga)};this.once(fI.WS_CLOSED,_u),this.once(fI.WS_RECONNECTING,_u),Q1(y0("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==g||_i||(_a.warning("ws request timeout, type: ".concat(e)),H0("warning",this,"ws request timeout, type: ".concat(e)),this.emit(fI.REQUEST_TIMEOUT,e,l))})});let k=null;try{k=await I}catch(_t){if(this.connectionState===_1.CLOSED||e===vI.LEAVE)throw new _E(_f.WS_ABORT);return!this.spec.forceWaitGatewayResponse||d?_t.throw():e===vI.JOIN||e===vI.REJOIN?null:(await b(),await this.request(e,l))}if(k.isSuccess)return k.message;const B=Number(k.message.error_code||k.message.code),q=O6(B),$=new _E(_f.UNEXPECTED_RESPONSE,"".concat(q.desc,": ").concat(k.message.error_str),{code:B,data:k.message});return q.action==="success"?k.message:(_a.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(B,", message: ").concat(q.desc,", action: ").concat(q.action)),H0("warning",this,"unexpected response from type ".concat(e,", error_code: ").concat(B,", message: ").concat(q.desc,", action: ").concat(q.action)),B===eI.ERR_TOO_MANY_BROADCASTERS?((e===vI.JOIN||e===vI.REJOIN)&&(this.initError=$,this.close()),$.throw()):q.action==="failed"?$.throw():q.action==="quit"?(this.initError=$,this.close(),$.throw()):(B===eI.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=k.message.option,_a.warning("[".concat(this.clientId,"] detect multi ip, recover")),H0("warning",this,"detect multi ip, recover"),this.reconnect("recover",X1.MULTI_IP)):this.reconnect(q.action,X1.SERVER_ERROR),e===vI.JOIN||e===vI.REJOIN?null:await this.request(e,l)))}waitMessage(e,l){return new Y0(d=>{const p=A=>{(!l||l(A))&&(this.off(e,p),d(A))};this.on(e,p)})}upload(e,l){const d={_type:e,_message:l};try{this.websocket.sendMessage(d)}catch{const A=y0("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(d),this.uploadCache.length>A&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==_1.CONNECTED)return;const y=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(y._type,y._message)},y0("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,l){const d={_type:e,_message:l};this.websocket.sendMessage(d)}init(e,l){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Y0((d,p)=>{this.once(fI.WS_CONNECTED,()=>d(this.joinResponse)),this.once(fI.WS_CLOSED,()=>p(this.initError||new _E(_f.WS_ABORT))),this.connectionState=_1.CONNECTING,this.websocket.init(e).catch(p),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{l&&this.openConnectionTime===void 0&&(_a.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),p(new _E(_f.INIT_WEBSOCKET_TIMEOUT)))},y0("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||I1.LEAVE,this.connectionState=_1.CLOSED,_a.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===I1.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new FP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(fI.ABORT_P2P_EXECUTION);const e=await O_(this,fI.REQUEST_JOIN_INFO),l=await this.request(vI.JOIN,e);if(!l)return this.emit(fI.REPORT_JOIN_GATEWAY,_f.TIMEOUT,this.url||""),!1;this.joinResponse=l,this.emit(fI.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=_1.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new _E(_f.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=CP(this,fI.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const l=await this.request(vI.REJOIN,e);return!!l&&(this.connectionState=_1.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),l.peers&&l.peers.forEach(d=>{this.emit(xI.ON_USER_ONLINE,{uid:d.uid}),d.audio_mute?this.emit(xI.MUTE_AUDIO,{uid:d.uid}):this.emit(xI.UNMUTE_AUDIO,{uid:d.uid}),d.video_mute?this.emit(xI.MUTE_VIDEO,{uid:d.uid}):this.emit(xI.UNMUTE_VIDEO,{uid:d.uid}),d.audio_enable_local?this.emit(xI.ENABLE_LOCAL_AUDIO,{uid:d.uid}):this.emit(xI.DISABLE_LOCAL_AUDIO,{uid:d.uid}),d.video_enable_local?this.emit(xI.ENABLE_LOCAL_VIDEO,{uid:d.uid}):this.emit(xI.DISABLE_LOCAL_VIDEO,{uid:d.uid}),d.audio||d.video||this.emit(xI.ON_REMOVE_STREAM,{uid:d.uid,uint_id:d.uint_id}),d.audio&&this.emit(xI.ON_ADD_AUDIO_STREAM,{uid:d.uid,uint_id:d.uint_id,audio:!0,ssrcId:d.audio_ssrc}),d.video&&this.emit(xI.ON_ADD_VIDEO_STREAM,{uid:d.uid,uint_id:d.uint_id,video:!0,ssrcId:d.video_ssrc})}),!0)}reconnect(e,l){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,l)}handleNotification(e){_a.debug("[".concat(this.clientId,"] receive notification: "),e),b0("debug",this,"handleNotification",e);const l=O6(e.code);if(l.action!=="success")return l.action==="failed"?(_a.error("[".concat(this.clientId,"] ignore error: "),l.desc),void H0("error",this,"ignore error: ".concat(l.desc))):l.action==="quit"?(l.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(I1.UID_BANNED),void this.close()):void this.reconnect(l.action,X1.SERVER_ERROR)}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=y0("PING_PONG_TIME_OUT"),l=Date.now();this.pingpongTimeoutCount>=e&&(_a.warning("PINGPONG Timeout. Last Socket Message: ".concat(l-this.lastMsgTime,"ms")),H0("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(l-this.lastMsgTime,"ms")),l-this.lastMsgTime>y0("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",X1.TIMEOUT):this.request(vI.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const d=Date.now()-l;this.rttRolling.add(d),y0("REPORT_STATS")&&this.send(vI.PING_BACK,{pingpongElapse:d})}).catch(d=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:l}=this.websocket.getWsInflateData();e!==0&&l!==0&&this.upload(c_.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:l,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(SI.RECONNECT_WAITTING_FINISH,e=>{this.emit(fI.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(SI.RECONNECT_CREATE_CONNECTION,e=>{this.emit(fI.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(SI.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(SI.CLOSED,()=>{this.connectionState=_1.CLOSED}),this.websocket.on(SI.FAILED,()=>{this._disconnectedReason=I1.NETWORK_ERROR,this.connectionState=_1.CLOSED}),this.websocket.on(SI.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===_1.CONNECTED?this.connectionState=_1.RECONNECTING:this.connectionState=_1.CONNECTING}),this.websocket.on(SI.WILL_RECONNECT,(e,l)=>{if(CP(this,fI.IS_P2P_DISCONNECTED)&&e==="retry")return _a.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),H0("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(fI.NEED_RENEW_SESSION),this.emit(fI.DISCONNECT_P2P),l("tryNext");e!=="retry"&&(_a.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),H0("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(fI.NEED_RENEW_SESSION),this.emit(fI.DISCONNECT_P2P)),l(e)}),this.websocket.on(SI.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{_a.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),b0("warning",this,"rejoin",void 0,e.toString()),this.reconnect("tryNext",X1.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(fI.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof _E&&e.code===_f.UNEXPECTED_RESPONSE&&e.data.code===eI.ERR_NO_AUTHORIZED)return _a.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),H0("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",X1.SERVER_ERROR);_a.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),b0("error",this,"join",void 0,e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",X1.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(SI.REQUEST_NEW_URLS,(e,l)=>{O_(this,fI.REQUEST_RECOVER,this.multiIpOption).then(e).catch(l)})}})||BX;var MX;function UX(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function O2(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?UX(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):UX(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}const D6=new Map;let e1t=U1("AgoraRTCGateway","store.clientId")(MX=class extends e1{get state(){return this._state}set state(e){if(e===this._state)return;const l=this._state;this._state=e,e==="DISCONNECTED"&&this._disconnectedReason?this.emit(c1.CONNECTION_STATE_CHANGE,e,l,this._disconnectedReason):this.emit(c1.CONNECTION_STATE_CHANGE,e,l)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){_a.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),b0("debug",this,"joinGatewayStartTime",e,"[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,l){super(),_s(this,"store",void 0),_s(this,"joinInfo",void 0),_s(this,"key",void 0),_s(this,"signal",void 0),_s(this,"role",void 0),_s(this,"inChannelInfo",{joinAt:null,duration:0}),_s(this,"spec",void 0),_s(this,"_state","DISCONNECTED"),_s(this,"_statsCollector",void 0),_s(this,"_disconnectedReason",void 0),_s(this,"isSignalRecover",!1),_s(this,"hasChangeBGPAddress",!1),_s(this,"trafficStatsInterval",void 0),_s(this,"networkQualityInterval",void 0),_s(this,"_joinGatewayStartTime",0),_s(this,"_signalTimeout",!1),_s(this,"_clientRoleOptions",void 0),_s(this,"_isProactiveJoin",!1),this.store=e,this.spec=l,this.signal=new t1t(O2(O2({},l),{},{retryConfig:l.websocketRetryConfig}),e),this._statsCollector=l.statsCollector,this.role=l.role||"audience",this._clientRoleOptions=l.clientRoleOptions,this.handleSignalEvents()}async join(e,l,d){this.store.joinGatewayStart(),e.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const p=Date.now();let A=D6.get(e.cname);if(A||(A=new Map,D6.set(e.cname,A)),this._isProactiveJoin=!0,A.has(e.uid)){const I=new _E(_f.UID_CONFLICT);throw _0.joinGateway(e.sid,{lts:p,succ:!1,ec:I.message,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer}),this._isProactiveJoin=!1,I}A.set(e.uid,!0),this.joinInfo=e,this.key=l;const y=e.proxyServer,g=y?e.gatewayAddrs.map(I=>{const k=I.address.split(":");return"wss://".concat(y,"/ws/?h=").concat(k[0],"&p=").concat(k[1])}):e.gatewayAddrs.map(I=>"wss://".concat(I.address));let b=0;this.joinGatewayStartTime=p;try{b=(await this.signal.init(g,d)).uid}catch(I){throw I&&I.code===_f.INIT_WEBSOCKET_TIMEOUT?(_a.warning("[".concat(this.store.clientId,"] User join failed"),I.toString()),I):(_a.error("[".concat(this.store.clientId,"] User join failed"),I.toString()),b0("error",this,"join",void 0,I.toString()),_0.joinGateway(e.sid,{lts:p,succ:!1,ec:I.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!y}),this._isProactiveJoin=!1,A.delete(e.uid),this.signal.close(),I)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),_a.debug("[".concat(this.store.clientId,"] Connected to gateway server")),b0("debug",this,"join",void 0,"success"),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(I=>{_a.warning("[".concat(this.store.clientId,"] get traffic stats error"),I.toString()),b0("warning",this,"trafficStatsInterval",void 0,I.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(c1.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(c1.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(c1.NETWORK_QUALITY,{uplinkNetworkQuality:wJ(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:wJ(this._statsCollector.trafficStats.B_dnq)}):this.emit(c1.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),b}async leave(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],l=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){l!==I1.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==_1.CONNECTED||await function(d,p){return p===1/0?d:Y0.race([d,f0t(p)])}(this.signal.request(vI.LEAVE,void 0,!0),3e3)}catch(d){_a.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),d),H0("warning",this,"leave request failed, ignore, ".concat(d.toString()))}this.signal.close(l),l!==I1.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,l,d){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const p={state:"offer",p2p_id:this.store.p2pId,ortc:l,mode:this.spec.mode,extend:y0("PUB_EXTEND")};try{return(await this.signal.request(vI.PUBLISH,p,!0))._message}catch(A){if(d&&A.data&&A.data.code===eI.ERR_PUBLISH_REQUEST_INVALID)return _a.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),A.toString()),H0("warning",this,"receive publish error code, retry, ".concat(A.toString())),await this.tryUnpubBeforeRepub(e,l),this.publish(e,l,!1);throw A}}async unpublish(e,l){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(vI.UNPUBLISH,{stream_id:l,ortc:e},!0)}catch(d){_a.warning("unpublish warning: ",d),b0("warning",this,"unpublish",void 0,d.toString())}}async subscribe(e,l,d){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const p={stream_id:e,stream_type:l.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,tcc:!!y0("SUBSCRIBE_TCC"),extend:y0("SUB_EXTEND"),ssrcId:l.ssrcId};try{return(await this.signal.request(vI.SUBSCRIBE,p,!0))._message}catch(A){if(d&&A.data&&A.data.code===eI.ERR_SUBSCRIBE_REQUEST_INVALID)return _a.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),A.toString()),H0("warning",this,"receiver subscribe error code, retry"),await this.tryUnsubBeforeResub(e,l),await this.subscribe(e,l,!1);throw A}}async subscribeAll(e,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const d={p2p_id:this.store.p2pId,users:e,dtx:!1};try{return await this.signal.request(vI.SUBSCRIBE_STREAMS,d,!0)}catch(p){if(l&&p.data&&p.data.code===eI.ERR_SUBSCRIBE_REQUEST_INVALID)return _a.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),p.toString()),H0("warning",this,"receiver massSubscribe error code, retry"),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw p}}async setVideoProfile(e){const l=function(d){if(!(d.bitrateMax&&d.bitrateMin&&d.frameRate&&d.height&&d.width))return;let p=d.frameRate,A=d.width,y=d.height,g=!0;return typeof p!="number"&&(p=p.exact||p.ideal||p.max||p.min||0,p||(g=!1)),typeof A!="number"&&(A=A.exact||A.ideal||A.max||A.min||0,A||(g=!1)),typeof y!="number"&&(y=y.exact||y.ideal||y.max||y.min||0,p||(g=!1)),g?{stream_type:0,width:A,height:y,fps:p,start_bps:1e3*d.bitrateMax,min_bps:1e3*d.bitrateMin,target_bps:1e3*d.bitrateMax}:void 0}(e);return l?this.signal.request(vI.SET_VIDEO_PROFILE,l):(_a.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway")),void H0("debug",this,"encoder config is not complete, do not report to gateway"))}async unsubscribe(e,l){try{await this.signal.request(vI.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:l},!0)}catch(d){_a.warning("unsubscribe warning: ",d),b0("warning",this,"unsubscribe",void 0,d.toString())}}async massUnsubscribe(e){try{await this.signal.request(vI.UNSUBSCRIBE_STREAMS,e,!0)}catch(l){_a.warning("unsubscribeAll warning: ",l),b0("warning",this,"unsubscribeAll",void 0,l.toString())}}async reconnectPC(e){const{iceParameters:l,dtlsParameters:d,rtpCapabilities:p}=e,A=await this.signal.request(vI.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:l,dtlsParameters:d,rtpCapabilities:p}},!0),y=this.getGatewayIpPort();return{gatewayEstablishParams:A,gatewayIP:y==null?void 0:y.ip,gatewayPort:y==null?void 0:y.port}}getGatewayInfo(){return this.signal.request(vI.GATEWAY_INFO)}renewToken(e){return this.signal.request(vI.RENEW_TOKEN,e)}async setClientRole(e,l){if(l&&(this._clientRoleOptions=Object.assign({},l)),this.state!=="CONNECTED")return void(this.role=e);let d;d=e==="audience"?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(vI.SET_CLIENT_ROLE,{role:e,level:d}),this.role=e}async setRemoteVideoStreamType(e,l){await this.signal.request(vI.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:l})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(vI.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,l){await this.signal.request(vI.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:l})}async pickSVCLayer(e,l){await this.signal.request(vI.PICK_SVC_LAYER,{stream_id:e,spatial_layer:l.spatialLayer,temporal_layer:l.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),O2({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(vI.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=D6.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(l){const d=l.match(/(wss\:\/\/)?([^:]+):(\d+)/);return d?{username:p1.username,password:p1.password,turnServerURL:d[2],tcpport:parseInt(d[3])+30,udpport:parseInt(d[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(O2(O2({},p1),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const e=await this.signal.request(vI.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),e.peer_delay.forEach(l=>{const d=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(p=>p.peer_uid===l.peer_uid);d&&d.B_st!==l.B_st&&Y_(()=>{this.emit(c1.STREAM_TYPE_CHANGE,l.peer_uid,l.B_st)})}),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new _E(_f.UNEXPECTED_ERROR,"can not generate join message, no join info");const l=Object.assign({},this.joinInfo.apResponse);let d=y0("REPORT_APP_SCENARIO");if(typeof d!="string")try{d=JSON.stringify(d)}catch{d=void 0}d&&d.length>128&&(d=void 0);const p=O2({p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:s_,browser:navigator.userAgent,process_id:y0("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:l,extend:y0("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:d,attributes:{userAttributes:{enablePublishedUserList:y0("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:y0("MAX_SUBSCRIPTION")}}},e);return this.joinInfo.stringUid&&(p.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(p.aes_mode=this.joinInfo.aesmode,y0("ENCRYPT_AES")?(p.aes_secret=this.joinInfo.aespassword,p.aes_encrypt=!0):p.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(p.aes_salt=this.joinInfo.aessalt)),l.addresses[this.signal.websocket.currentURLIndex]&&(p.ap_response.ticket=l.addresses[this.signal.websocket.currentURLIndex].ticket,delete l.addresses),this.joinInfo.defaultVideoStream!==void 0&&(p.default_video_stream=this.joinInfo.defaultVideoStream),p}getRejoinMessage(){if(!this.joinInfo)throw new _E(_f.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(fI.WS_RECONNECT_WAITTING_FINISH,e=>{["tryNext","recover"].includes(e)&&this.joinInfo&&_0.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(fI.WS_RECONNECT_CREATE_CONNECTION,e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(fI.WS_RECONNECTING,e=>{this.joinInfo&&_0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||X1.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",_0.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(fI.WS_CLOSED,e=>{let l;switch(e){case I1.LEAVE:l=X1.LEAVE;break;case I1.UID_BANNED:case I1.IP_BANNED:case I1.CHANNEL_BANNED:case I1.SERVER_ERROR:l=X1.SERVER_ERROR;break;case I1.FALLBACK:l=X1.FALLBACK;break;default:l=X1.NETWORK_ERROR}_a.debug("[signal] websocket closed, reason: ".concat(l||"undefined -> "+X1.NETWORK_ERROR)),VI("debug",this,"ws_closed","reason: ".concat(e)),this.joinInfo&&_0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===I1.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:l}),this._disconnectedReason=e,e!==I1.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(fI.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&this._clientRoleOptions.level&&(_a.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),H0("debug",this,"patch to send set client role, role: ".concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),_0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return _a.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e)),void H0("error",this,"set local access point after joined failed: ".concat(e));H1("EVENT_REPORT_DOMAIN",e[1]),H1("EVENT_REPORT_BACKUP_DOMAIN",e[1]),H1("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(xI.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(fI.REQUEST_RECOVER,(e,l,d)=>{if(!this.joinInfo)return d(new _E(_f.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,O_(this,c1.REQUEST_NEW_GATEWAY_LIST).then(l).catch(d)}),this.signal.on(fI.REQUEST_JOIN_INFO,async e=>{var l;this.updateTurnConfigFromSignal();const{iceParameters:d,dtlsParameters:p,rtpCapabilities:A}=await O_(this,c1.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(l=this.joinInfo)===null||l===void 0?void 0:l.turnServer});e(this.getJoinMessage({ortc:{iceParameters:d,dtlsParameters:p,rtpCapabilities:A,version:"2"}}))}),this.signal.on(fI.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(fI.REPORT_JOIN_GATEWAY,(e,l)=>{this.joinInfo&&(_0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:l,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1)}),this.signal.on(fI.IS_P2P_DISCONNECTED,e=>{e(CP(this,c1.IS_P2P_DISCONNECTED))}),this.signal.on(fI.DISCONNECT_P2P,()=>{this.emit(c1.DISCONNECT_P2P)}),this.signal.on(fI.NEED_RENEW_SESSION,()=>{this.emit(c1.NEED_RENEW_SESSION)}),this.signal.on(fI.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(fI.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(fI.JOIN_RESPONSE,e=>{const l=this.getGatewayIpPort();l?this.emit(c1.JOIN_RESPONSE,e,l.ip,l.port):this.emit(c1.JOIN_RESPONSE,e)})}async tryUnsubBeforeResub(e,l){try{await this.signal.request(vI.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[l]},!0)}catch(d){throw _a.warning("unsubscribe warning",d),b0("warning",this,"tryUnsubBeforeResub",e,d.toString()),d}}async tryUnpubBeforeRepub(e,l){try{await this.signal.request(vI.UNPUBLISH,{stream_id:e,ortc:l},!0)}catch(d){throw _a.warning("unpublish warning: ",d),b0("warning",this,"tryUnpubBeforeRepub",e,d.toString()),d}}async tryMassUnsubBeforeResub(e){const l={users:e.map(d=>({stream_id:d.stream_id,stream_type:d.stream_type}))};try{await this.signal.request(vI.UNSUBSCRIBE_STREAMS,l,!0)}catch(d){throw _a.warning("massUnsubscribe warning",d),b0("warning",this,"tryUnsubAllBeforeResub",e.map(p=>p.stream_id),d.toString()),d}}async muteLocal(e,l){const d={action:e.find(p=>p.stream_type===r1.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:l};try{await this.signal.request(vI.CONTROL,d,!0,!0)}catch(p){throw _a.warning("gateway unmuteLocal warning: ",p),b0("warning",this,"muteLocal",l,p.toString()),p}}async unmuteLocal(e,l){const d={action:e.find(p=>p.stream_type===r1.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:l};try{await this.signal.request(vI.CONTROL,d,!0,!0)}catch(p){throw _a.warning("gateway muteLocal warning: ",p),b0("warning",this,"unmuteLocal",l,p.toString()),p}}uploadStats(e,l){this.signal.upload(e,l)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const l={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{const d=await this.signal.request(vI.RESTART_ICE,l,!0),p=this.getGatewayIpPort();return{restartICEResponse:d,gatewayIP:p==null?void 0:p.ip,gatewayPort:p==null?void 0:p.port}}catch(d){throw _a.warning("P2PChannel.restartICE warning: ",d),b0("warning",this,"restartICE",void 0,d.toString()),d}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,X1.P2P_FAILED)}getGatewayIpPort(){var e;if(!y0("GATEWAY_WSS_ADDRESS")&&(e=this.joinInfo)!==null&&e!==void 0&&e.gatewayAddrs){const l=this.joinInfo.gatewayAddrs[this.signal.currentURLIndex];return(l.ip||l.ip6)&&l.port?l.ip6?{ip:l.ip6,port:l.port}:{ip:l.ip,port:l.port}:void 0}}})||MX;/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */function jX(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function FX(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?jX(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):jX(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}(function(){var e;function l(Rv){var e0=0;return function(){return e0<Rv.length?{done:!1,value:Rv[e0++]}:{done:!0}}}var d=typeof Object.defineProperties=="function"?Object.defineProperty:function(Rv,e0,l0){return Rv==Array.prototype||Rv==Object.prototype||(Rv[e0]=l0.value),Rv},p,A=function(Rv){Rv=[typeof globalThis=="object"&&globalThis,Rv,typeof window=="object"&&window,typeof self=="object"&&self,typeof s=="object"&&s];for(var e0=0;e0<Rv.length;++e0){var l0=Rv[e0];if(l0&&l0.Math==Math)return l0}throw Error("Cannot find global object")}(this);function y(Rv,e0){if(e0)t:{var l0=A;Rv=Rv.split(".");for(var w0=0;w0<Rv.length-1;w0++){var B0=Rv[w0];if(!(B0 in l0))break t;l0=l0[B0]}(e0=e0(w0=l0[Rv=Rv[Rv.length-1]]))!=w0&&e0!=null&&d(l0,Rv,{configurable:!0,writable:!0,value:e0})}}function g(Rv){return(Rv={next:Rv})[Symbol.iterator]=function(){return this},Rv}function b(Rv){var e0=typeof Symbol!="undefined"&&Symbol.iterator&&Rv[Symbol.iterator];return e0?e0.call(Rv):{next:l(Rv)}}if(y("Symbol",function(Rv){function e0(B0,g0){this.A=B0,d(this,"description",{configurable:!0,writable:!0,value:g0})}if(Rv)return Rv;e0.prototype.toString=function(){return this.A};var l0="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",w0=0;return function B0(g0){if(this instanceof B0)throw new TypeError("Symbol is not a constructor");return new e0(l0+(g0||"")+"_"+w0++,g0)}}),y("Symbol.iterator",function(Rv){if(Rv)return Rv;Rv=Symbol("Symbol.iterator");for(var e0="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),l0=0;l0<e0.length;l0++){var w0=A[e0[l0]];typeof w0=="function"&&typeof w0.prototype[Rv]!="function"&&d(w0.prototype,Rv,{configurable:!0,writable:!0,value:function(){return g(l(this))}})}return Rv}),typeof Object.setPrototypeOf=="function")p=Object.setPrototypeOf;else{var I;t:{var k={};try{k.__proto__={a:!0},I=k.a;break t}catch{}I=!1}p=I?function(Rv,e0){if(Rv.__proto__=e0,Rv.__proto__!==e0)throw new TypeError(Rv+" is not extensible");return Rv}:null}var B=p;function q(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function $(Rv){if(Rv.m)throw new TypeError("Generator is already running");Rv.m=!0}function _t(Rv,e0){return Rv.h=3,{value:e0}}function _r(Rv){this.g=new q,this.G=Rv}function _i(Rv,e0,l0,w0){try{var B0=e0.call(Rv.g.j,l0);if(!(B0 instanceof Object))throw new TypeError("Iterator result "+B0+" is not an object");if(!B0.done)return Rv.g.m=!1,B0;var g0=B0.value}catch(_n){return Rv.g.j=null,Rv.g.s(_n),ga(Rv)}return Rv.g.j=null,w0.call(Rv.g,g0),ga(Rv)}function ga(Rv){for(;Rv.g.h;)try{var e0=Rv.G(Rv.g);if(e0)return Rv.g.m=!1,{value:e0.value,done:!1}}catch(l0){Rv.g.v=void 0,Rv.g.s(l0)}if(Rv.g.m=!1,Rv.g.l){if(e0=Rv.g.l,Rv.g.l=null,e0.F)throw e0.D;return{value:e0.return,done:!0}}return{value:void 0,done:!0}}function _u(Rv){this.next=function(e0){return Rv.o(e0)},this.throw=function(e0){return Rv.s(e0)},this.return=function(e0){return function(l0,w0){$(l0.g);var B0=l0.g.j;return B0?_i(l0,"return"in B0?B0.return:function(g0){return{value:g0,done:!0}},w0,l0.g.return):(l0.g.return(w0),ga(l0))}(Rv,e0)},this[Symbol.iterator]=function(){return this}}function ah(Rv,e0){return e0=new _u(new _r(e0)),B&&Rv.prototype&&B(e0,Rv.prototype),e0}if(q.prototype.o=function(Rv){this.v=Rv},q.prototype.s=function(Rv){this.l={D:Rv,F:!0},this.h=this.C||this.u},q.prototype.return=function(Rv){this.l={return:Rv},this.h=this.u},_r.prototype.o=function(Rv){return $(this.g),this.g.j?_i(this,this.g.j.next,Rv,this.g.o):(this.g.o(Rv),ga(this))},_r.prototype.s=function(Rv){return $(this.g),this.g.j?_i(this,this.g.j.throw,Rv,this.g.o):(this.g.s(Rv),ga(this))},y("Array.prototype.entries",function(Rv){return Rv||function(){return function(e0,l0){e0 instanceof String&&(e0+="");var w0=0,B0=!1,g0={next:function(){if(!B0&&w0<e0.length){var _n=w0++;return{value:l0(_n,e0[_n]),done:!1}}return B0=!0,{done:!0,value:void 0}}};return g0[Symbol.iterator]=function(){return g0},g0}(this,function(e0,l0){return[e0,l0]})}}),typeof Blob!="undefined"&&(typeof FormData=="undefined"||!FormData.prototype.keys)){var _h=function(Rv,e0){for(var l0=0;l0<Rv.length;l0++)e0(Rv[l0])},_A=function(Rv){return Rv.replace(/\r?\n|\r/g,`\r
`)},n0=function(Rv,e0,l0){return e0 instanceof Blob?(l0=l0!==void 0?String(l0+""):typeof e0.name=="string"?e0.name:"blob",e0.name===l0&&Object.prototype.toString.call(e0)!=="[object Blob]"||(e0=new File([e0],l0)),[String(Rv),e0]):[String(Rv),String(e0)]},f0=function(Rv,e0){if(Rv.length<e0)throw new TypeError(e0+" argument required, but only "+Rv.length+" present.")},E0=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,m0=E0.FormData,V0=E0.XMLHttpRequest&&E0.XMLHttpRequest.prototype.send,D0=E0.Request&&E0.fetch,j0=E0.navigator&&E0.navigator.sendBeacon,c0=E0.Element&&E0.Element.prototype,_m=E0.Symbol&&Symbol.toStringTag;_m&&(Blob.prototype[_m]||(Blob.prototype[_m]="Blob"),"File"in E0&&!File.prototype[_m]&&(File.prototype[_m]="File"));try{new File([],"")}catch{E0.File=function(e0,l0,w0){return e0=new Blob(e0,w0||{}),Object.defineProperties(e0,{name:{value:l0},lastModified:{value:+(w0&&w0.lastModified!==void 0?new Date(w0.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),_m&&Object.defineProperty(e0,_m,{value:"File"}),e0}}var t0=function(Rv){return Rv.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},s0=function(Rv){this.i=[];var e0=this;Rv&&_h(Rv.elements,function(l0){if(l0.name&&!l0.disabled&&l0.type!=="submit"&&l0.type!=="button"&&!l0.matches("form fieldset[disabled] *"))if(l0.type==="file"){var w0=l0.files&&l0.files.length?l0.files:[new File([],"",{type:"application/octet-stream"})];_h(w0,function(B0){e0.append(l0.name,B0)})}else l0.type==="select-multiple"||l0.type==="select-one"?_h(l0.options,function(B0){!B0.disabled&&B0.selected&&e0.append(l0.name,B0.value)}):l0.type==="checkbox"||l0.type==="radio"?l0.checked&&e0.append(l0.name,l0.value):(w0=l0.type==="textarea"?_A(l0.value):l0.value,e0.append(l0.name,w0))})};if((e=s0.prototype).append=function(Rv,e0,l0){f0(arguments,2),this.i.push(n0(Rv,e0,l0))},e.delete=function(Rv){f0(arguments,1);var e0=[];Rv=String(Rv),_h(this.i,function(l0){l0[0]!==Rv&&e0.push(l0)}),this.i=e0},e.entries=function Rv(){var e0,l0=this;return ah(Rv,function(w0){if(w0.h==1&&(e0=0),w0.h!=3)return e0<l0.i.length?w0=_t(w0,l0.i[e0]):(w0.h=0,w0=void 0),w0;e0++,w0.h=2})},e.forEach=function(Rv,e0){f0(arguments,1);for(var l0=b(this),w0=l0.next();!w0.done;w0=l0.next()){var B0=b(w0.value);w0=B0.next().value,B0=B0.next().value,Rv.call(e0,B0,w0,this)}},e.get=function(Rv){f0(arguments,1);var e0=this.i;Rv=String(Rv);for(var l0=0;l0<e0.length;l0++)if(e0[l0][0]===Rv)return e0[l0][1];return null},e.getAll=function(Rv){f0(arguments,1);var e0=[];return Rv=String(Rv),_h(this.i,function(l0){l0[0]===Rv&&e0.push(l0[1])}),e0},e.has=function(Rv){f0(arguments,1),Rv=String(Rv);for(var e0=0;e0<this.i.length;e0++)if(this.i[e0][0]===Rv)return!0;return!1},e.keys=function Rv(){var e0,l0,w0,B0,g0=this;return ah(Rv,function(_n){if(_n.h==1&&(e0=b(g0),l0=e0.next()),_n.h!=3)return l0.done?void(_n.h=0):(w0=l0.value,B0=b(w0),_t(_n,B0.next().value));l0=e0.next(),_n.h=2})},e.set=function(Rv,e0,l0){f0(arguments,2),Rv=String(Rv);var w0=[],B0=n0(Rv,e0,l0),g0=!0;_h(this.i,function(_n){_n[0]===Rv?g0&&(g0=!w0.push(B0)):w0.push(_n)}),g0&&w0.push(B0),this.i=w0},e.values=function Rv(){var e0,l0,w0,B0,g0=this;return ah(Rv,function(_n){if(_n.h==1&&(e0=b(g0),l0=e0.next()),_n.h!=3)return l0.done?void(_n.h=0):(w0=l0.value,(B0=b(w0)).next(),_t(_n,B0.next().value));l0=e0.next(),_n.h=2})},s0.prototype._asNative=function(){for(var Rv=new m0,e0=b(this),l0=e0.next();!l0.done;l0=e0.next()){var w0=b(l0.value);l0=w0.next().value,w0=w0.next().value,Rv.append(l0,w0)}return Rv},s0.prototype._blob=function(){var Rv="----formdata-polyfill-"+Math.random(),e0=[],l0="--"+Rv+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(w0,B0){return typeof w0=="string"?e0.push(l0+t0(_A(B0))+`"\r
\r
`+_A(w0)+`\r
`):e0.push(l0+t0(_A(B0))+'"; filename="'+t0(w0.name)+`"\r
Content-Type: `+(w0.type||"application/octet-stream")+`\r
\r
`,w0,`\r
`)}),e0.push("--"+Rv+"--"),new Blob(e0,{type:"multipart/form-data; boundary="+Rv})},s0.prototype[Symbol.iterator]=function(){return this.entries()},s0.prototype.toString=function(){return"[object FormData]"},c0&&!c0.matches&&(c0.matches=c0.matchesSelector||c0.mozMatchesSelector||c0.msMatchesSelector||c0.oMatchesSelector||c0.webkitMatchesSelector||function(Rv){for(var e0=(Rv=(this.document||this.ownerDocument).querySelectorAll(Rv)).length;0<=--e0&&Rv.item(e0)!==this;);return-1<e0}),_m&&(s0.prototype[_m]="FormData"),V0){var P0=E0.XMLHttpRequest.prototype.setRequestHeader;E0.XMLHttpRequest.prototype.setRequestHeader=function(Rv,e0){P0.call(this,Rv,e0),Rv.toLowerCase()==="content-type"&&(this.B=!0)},E0.XMLHttpRequest.prototype.send=function(Rv){Rv instanceof s0?(Rv=Rv._blob(),this.B||this.setRequestHeader("Content-Type",Rv.type),V0.call(this,Rv)):V0.call(this,Rv)}}D0&&(E0.fetch=function(Rv,e0){return e0&&e0.body&&e0.body instanceof s0&&(e0.body=e0.body._blob()),D0.call(this,Rv,e0)}),j0&&(E0.navigator.sendBeacon=function(Rv,e0){return e0 instanceof s0&&(e0=e0._asNative()),j0.call(this,Rv,e0)}),E0.FormData=s0}})();let L6=1;function n1t(e,l,d,p,A){L6+=1;const y={sid:d.sid,command:"convergeAllocateEdge",uid:"666",appId:d.appId,ts:Math.floor(Date.now()/1e3),seq:L6,requestId:L6,version:s_,cname:d.cname},g={service_name:l,json_body:JSON.stringify(y)};let b,I,k=e[0];return Q_(async()=>{b=Date.now();const B=await Pb(k,{data:g,cancelToken:p,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(I=Date.now()-b,B.code!==0){const _t=new _E(_f.UNEXPECTED_RESPONSE,"live streaming ap error, code"+B.code,{retry:!0,responseTime:I});throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_t.toString()),_t}const q=JSON.parse(B.json_body);if(q.code!==200){const _t=new _E(_f.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(q.code,", reason: ").concat(q.reason),{code:q.code,responseTime:I});throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_t.toString()),_t}if(!q.servers||q.servers.length===0){const _t=new _E(_f.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:q.code,responseTime:I});throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_t.toString()),_t}const $=function(_t,_r){return{addressList:_t.servers.map(_i=>"wss://".concat(_i.address.replace(/\./g,"-"),".").concat(y0("WORKER_DOMAIN"),":").concat(_i.wss,"?serviceName=").concat(encodeURIComponent(_r))),workerToken:_t.workerToken,vid:_t.vid}}(q,l);return y0("LIVE_STREAMING_ADDRESS")&&($.addressList=y0("LIVE_STREAMING_ADDRESS")instanceof Array?y0("LIVE_STREAMING_ADDRESS"):[y0("LIVE_STREAMING_ADDRESS")]),FX(FX({},$),{},{responseTime:I})},(B,q)=>(_0.apworkerEvent(d.sid,{success:!0,sc:200,serviceName:l,responseDetail:JSON.stringify(B.addressList),firstSuccess:q===0,responseTime:I,serverIp:e[q%e.length]}),!1),(B,q)=>(_0.apworkerEvent(d.sid,{success:!1,sc:B.data&&B.data.code||200,serviceName:l,responseTime:I,serverIp:e[q%e.length]}),!!(B.code!==_f.OPERATION_ABORTED&&B.code!==_f.UNEXPECTED_RESPONSE||B.data&&B.data.retry)&&(k=e[(q+1)%e.length],!0)),A)}let P6=1;function QX(e,l,d,p){let{url:A,areaCode:y}=e;b0("debug",["AjaxAPI",l.clientId],"requestChooseServer",{url:A,areaCode:y});const g=Date.now(),[b,I]=HX(l,y,[l1.CHOOSE_SERVER]);let k=S1.networkState;return Q_(async()=>{k&&S1.networkState===f_.OFFLINE&&S1.onlineWaiter&&await Y0.race([S1.onlineWaiter,Q1(p&&p.maxRetryTimeout||a1.maxRetryTimeout)]),k=S1.networkState;const B=await Pb(A,{data:b,cancelToken:d,headers:{"Content-Type":"multipart/form-data;"}},!0);_0.reportResourceTiming(A,l.sid),VX(B,A,l,g,[l1.CHOOSE_SERVER]);const q=X5(B,l1.CHOOSE_SERVER);return qX(q),SJ(q,A)},B=>(B&&_0.joinChooseServer(l.sid,{lts:g,succ:!0,csAddr:A,opid:I,serverList:B.gatewayAddrs.map(q=>q.address),ec:null,cid:B.cid.toString(),uid:B.uid.toString(),csIp:B.csIp,unilbsServerIds:[l1.CHOOSE_SERVER].toString()}),!1),B=>B.code!==_f.OPERATION_ABORTED&&(B.code===_f.CAN_NOT_GET_GATEWAY_SERVER?B.data.retry:(_0.joinChooseServer(l.sid,{lts:g,succ:!1,csAddr:A,serverList:null,opid:I,ec:B.code,csIp:B.data&&B.data.csIp,unilbsServerIds:[l1.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:k})}),_a.warning("[".concat(l.clientId,"] Choose server network error, retry"),B),H0("warning",["AjaxAPI",l.clientId],"Choose server network error, retry, ".concat(B)),!0)),p)}function GX(e,l,d,p){let{url:A,areaCode:y,serviceIds:g}=e;b0("debug",["AjaxAPI",l.clientId],"requestMultiUnilbs",{url:A,areaCode:y,serviceIds:g});const b=Date.now(),[I,k]=HX(l,y,g);let B;return Q_(async()=>{B&&S1.networkState===f_.OFFLINE&&S1.onlineWaiter&&await Y0.race([S1.onlineWaiter,Q1(p&&p.maxRetryTimeout||a1.maxRetryTimeout)]),B=S1.networkState;const q=await Pb(A,{data:I,cancelToken:d,headers:{"Content-Type":"multipart/form-data;"}},!0);_0.reportResourceTiming(A,l.sid),VX(q,A,l,b,g);const $=X5(q,l1.CHOOSE_SERVER),_t=X5(q,l.cloudProxyServer==="proxy5"?l1.CLOUD_PROXY_5:l.cloudProxyServer==="proxy3"||l.cloudProxyServer==="proxy4"?l1.CLOUD_PROXY:l1.CLOUD_PROXY_FALLBACK);return qX($),{gatewayInfo:SJ($,A),proxyInfo:_t,url:A}},q=>(q.gatewayInfo&&_0.joinChooseServer(l.sid,{lts:b,succ:!0,csAddr:A,serverList:q.gatewayInfo.gatewayAddrs.map($=>$.address),ec:null,opid:k,cid:q.gatewayInfo.cid.toString(),uid:q.gatewayInfo.uid.toString(),csIp:q.gatewayInfo.csIp,unilbsServerIds:g.toString()}),q.proxyInfo&&_0.joinWebProxyAP(l.sid,{lts:b,sucess:1,apServerAddr:A,turnServerAddrList:q.proxyInfo.addresses.map($=>$.ip).join(","),errorCode:null,eventType:l.cloudProxyServer,unilbsServerIds:g.toString()}),!1),q=>q.code!==_f.OPERATION_ABORTED&&(q.code===_f.CAN_NOT_GET_GATEWAY_SERVER?q.data.retry:(_0.joinWebProxyAP(l.sid,{lts:b,sucess:0,apServerAddr:A,turnServerAddrList:null,errorCode:q.code,eventType:l.cloudProxyServer,unilbsServerIds:g.toString(),extend:JSON.stringify({networkState:B})}),_a.warning("[".concat(l.clientId,"] multi unilbs network error, retry"),q),H0("warning",["AjaxAPI",l.clientId],"multi unilbs network error, retry, ".concat(q)),!0)),p)}const VX=(e,l,d,p,A)=>{const y=[],g=b=>{b.flag===4096?_0.joinChooseServer(d.sid,{lts:p,succ:!1,csAddr:l,opid:e.opid,serverList:null,ec:b.error.message,csIp:b.error.data&&b.error.data.csIp,unilbsServerIds:A.toString()}):b.flag!==1048576&&b.flag!==4194304&&b.flag!==4194310||_0.joinWebProxyAP(d.sid,{lts:p,sucess:0,apServerAddr:l,turnServerAddrList:null,errorCode:b.error.code,eventType:d.cloudProxyServer,unilbsServerIds:A.toString()})};if(e.response_body.forEach(b=>{const I=b.buffer.code;if(b.uri===23&&I===0&&!b.buffer.edges_services)if(b.buffer.flag===4194310)_a.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),b.buffer.edges_services=[];else{const k={error:new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:b.buffer.flag};y.push(k),g(k)}if(I!==0){const k=KO(I),B={error:new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,k.desc,{retry:k.retry,csIp:e.detail[502]}),flag:b.buffer.flag};b.buffer.flag===4194310?_a.warning(B.error.toString()):y.push(B),g(B)}}),y.length)throw _a.warning("[".concat(d.clientId,"] multi unilbs ").concat(l," failed, ").concat(y.map(b=>"flag: ".concat(b.flag,", message: ").concat(b.error.message,", retry: ").concat(b.error.data.retry)).join(" | "))),b0("warning",["AjaxAPI",d.clientId],"checkMultiUnilbsResponseValid",{url:l},y.map(b=>({flag:b.flag,message:b.error.message,retry:b.error.data.retry}))),new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,y.map(b=>"flag: ".concat(b.flag,", message: ").concat(b.error.message)).join(" | "),{retry:!!y.find(b=>b.error.data.retry),csIp:e.detail[502]})},qX=e=>{if(e.addresses&&e.addresses.length===0&&e.code===0)throw new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(y0("GATEWAY_ADDRESS")&&y0("GATEWAY_ADDRESS").length>0){_a.debug("assign gateway address to",y0("GATEWAY_ADDRESS")),H0("debug",["AjaxAPI"],"assign gateway address to ".concat(JSON.stringify(y0("GATEWAY_ADDRESS"))));const l=y0("GATEWAY_ADDRESS").map(d=>({ip:d.ip,port:d.port,ticket:e.addresses[0]&&e.addresses[0].ticket}));e.addresses=l}},r1t=(e,l)=>{if(e.response_body&&e.response_body.length){const d=e.response_body[0];if(d.buffer.code!==0){const p=KO(d.buffer.code);throw new _E(_f.UPDATE_TICKET_FAILED,"[".concat(d.buffer.code,"]: ").concat(p.desc),{retry:p.retry})}return d.buffer.ticket}throw _a.debug("update ticket request received ap response without response body:",l),H0("debug",["AjaxAPI"],"update ticket request received ap response without response body: ".concat(l)),new _E(_f.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},HX=(e,l,d)=>{const p=Math.floor(Math.random()*1e12),A={appid:e.appId,client_ts:Date.now(),opid:p,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:{6:e.stringUid,11:l,12:y0("USE_NEW_TOKEN")?"1":void 0},key:e.token,service_ids:d,uid:e.uid||0}}]};A.request_bodies.forEach(g=>{e.multiIP&&e.multiIP.gateway_ip&&(g.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const y=new FormData;return y.append("request",JSON.stringify(A)),[y,p]},i1t=(e,l)=>{const d=Math.floor(Math.random()*1e12),p={appid:e.appId,client_ts:Date.now(),opid:d,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:l,uid:e.uid||0,edges_services:e.apResponse.addresses.map(y=>({ip:y.ip,port:y.port}))}}]},A=new FormData;return A.append("request",JSON.stringify(p)),[A,d]},YO=()=>{const e=y0("AREAS");return e.length===0&&e.push(RI.GLOBAL),VR(e).call(e,(l,d,p)=>{const A=o1t(d);return A?p===0?A:"".concat(l,",").concat(A):l},"")},o1t=e=>e===RI.OVERSEA?"".concat(f1.ASIA,",").concat(f1.EUROPE,",").concat(f1.AFRICA,",").concat(f1.NORTH_AMERICA,",").concat(f1.SOUTH_AMERICA,",").concat(f1.OCEANIA):f1[e],QP={GLOBAL:{ASIA:[RI.CHINA,RI.JAPAN,RI.INDIA,RI.KOREA,RI.HKMC],EUROPE:[],NORTH_AMERICA:[RI.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},x6=Object.keys(QP[RI.GLOBAL]),KX=[RI.CHINA,RI.NORTH_AMERICA,RI.EUROPE,RI.ASIA,RI.JAPAN,RI.INDIA,RI.OCEANIA,RI.SOUTH_AMERICA,RI.AFRICA,RI.KOREA,RI.HKMC,RI.US],s1t=function(e,l){let d=[];if(e.includes(RI.GLOBAL)){const y=[RI.GLOBAL,RI.OVERSEA],g=Object.keys(n5);if(l===RI.GLOBAL)throw new _E(_f.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(l===RI.CHINA)d=[RI.OVERSEA];else if(A=l,x6.includes(A)){const b=(p=l,QP[RI.GLOBAL][p]||[]),I=[...y,l,...b];d=g.filter(k=>!I.includes(k))}else if(function(b){let I=!1;return x6.forEach(k=>{QP[RI.GLOBAL][k].includes(b)&&(I=!0)}),I}(l)){const b=function(k){let B;return x6.forEach(q=>{QP[RI.GLOBAL][q].includes(k)&&(B=q)}),B}(l),I=[...y,b,l];d=g.filter(k=>!I.includes(k))}else d=e;d=function(b){const I=[];return KX.forEach(k=>{b.includes(k)&&I.push(k)}),I.concat(b.filter(k=>!KX.includes(k)))}(d)}else d=e;var p,A;return d};async function N2(e,l,d,p){return{gatewayInfo:await async function(y,g,b,I){let k=null;const B=[],q=async()=>{const _t=y0("WEBCS_DOMAIN").slice(0,y0("AJAX_REQUEST_CONCURRENT")).map(ga=>({url:y.proxyServer?"https://".concat(y.proxyServer,"/ap/?url=").concat(ga+"/api/v2/transpond/webrtc?v=2"):"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"),areaCode:YO()})),_r=I.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_t.map(ga=>ga.url)}),_i=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:_t,asyncMapHandler:ga=>(_a.debug("[".concat(y.clientId,"] Connect to choose_server:"),ga.url),QX(ga,y,g,b)),allFailedhandler:ga=>{throw I.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_r),ga[0]},promisesCollector:B});return I.recordJoinChannelService({endTs:Date.now(),status:"success"},_r),_i},$=async()=>{if(await Q1(1e3),k!==null)return k;const _t=y0("WEBCS_DOMAIN_BACKUP_LIST").map(ga=>({url:y.proxyServer?"https://".concat(y.proxyServer,"/ap/?url=").concat(ga+"/api/v2/transpond/webrtc?v=2"):"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"),areaCode:YO()})),_r=I.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:_t.map(ga=>ga.url)}),_i=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:_t,asyncMapHandler:ga=>(_a.debug("[".concat(y.clientId,"] Connect to backup choose_server:"),ga.url),QX(ga,y,g,b)),allFailedhandler:ga=>{throw I.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_r),ga[0]},promisesCollector:B});return I.recordJoinChannelService({endTs:Date.now(),status:"success"},_r),_i};try{return k=await hT([q(),$()]),B.length&&B.forEach(_t=>_t.cancel&&typeof _t.cancel=="function"&&_t.cancel()),k}catch(_t){throw _t[0]}}(e,l,d,p)}}async function B6(e,l,d,p,A){const y=e.cloudProxyServer;if(y==="disabled"){if(!p)return;if(e.useLocalAccessPoint)return await N2(e,l,d,A);if(y0("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:b,proxyInfo:I}=await YX(e,l,d,A);return e.turnServer&&e.turnServer.mode!=="auto"?(H0("debug",["Server",e.clientId],"do not set fallback turn because of already having turnserver"),{gatewayInfo:b}):(e.turnServer={mode:"manual",servers:I.map(k=>({turnServerURL:k.address,tcpport:k.tcpport||p1.tcpport,udpport:k.udpport||p1.udpport,username:k.username||p1.username,password:k.password||p1.password,forceturn:y0("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0}))},{gatewayInfo:b})}return await N2(e,l,d,A)}let g;if(["443only","normal"].includes(y)){let b;p?y!=="normal"?[b,g]=await Y0.all([GP(e,l,d),N2(e,l,d,A)]):(b=await GP(e,l,d),e.proxyServer=b.addresses[0],_0.setProxyServer(e.proxyServer),_a.setProxyServer(e.proxyServer),tT(e.proxyServer),g=await N2(e,l,d,A)):(g=void 0,y!=="normal"?b=await GP(e,l,d):(b=await GP(e,l,d),e.proxyServer=b.addresses[0],_0.setProxyServer(e.proxyServer),_a.setProxyServer(e.proxyServer),tT(e.proxyServer))),e.turnServer={mode:"manual",servers:b.addresses.map(I=>({turnServerURL:I,tcpport:b.serverResponse.tcpport?b.serverResponse.tcpport:p1.tcpport,udpport:b.serverResponse.udpport?b.serverResponse.udpport:p1.udpport,username:b.serverResponse.username||p1.username,password:b.serverResponse.password||p1.password,forceturn:!0,security:!1}))}}else{const{proxyInfo:b,gatewayInfo:I}=await YX(e,l,d,A);g={gatewayInfo:I},e.turnServer={mode:"manual",servers:b.map(k=>({turnServerURL:k.address,tcpport:y==="proxy3"?void 0:k.tcpport?k.tcpport:p1.tcpport,udpport:y==="proxy4"?void 0:k.udpport?k.udpport:p1.udpport,username:k.username||p1.username,password:k.password||p1.password,forceturn:y!=="proxy4",security:y==="proxy5"}))}}return _a.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(y)),b0("debug",["Server",e.clientId],"setCloudProxyServerAndGetServerInfo",{proxyServer:e.proxyServer,mode:e.cloudProxyServer}),g}async function M6(e,l,d,p,A){const y=y0("ACCOUNT_REGISTER").slice(0,y0("AJAX_REQUEST_CONCURRENT"));let g=[];g=l.proxyServer?y.map(I=>"https://".concat(l.proxyServer,"/ap/?url=").concat(I+"/api/v1")):y.map(I=>"https://".concat(I,"/api/v1"));const b=A==null?void 0:A.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:g});try{const I=await async function(k,B,q,$,_t){const _r=Date.now(),_i={sid:q.sid,opid:10,appid:q.appId,string_uid:B};let ga=k[0];const _u=await Q_(()=>Pb(ga+"".concat(ga.indexOf("?")===-1?"?":"&","action=stringuid"),{data:_i,cancelToken:$,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(ah,_h)=>{if(ah.code===0){if(ah.uid<=0||ah.uid>=Math.pow(2,32))throw _a.error("Invalid Uint Uid ".concat(B," => ").concat(ah.uid),ah),b0("error",["AjaxAPI"],"requestUserAccount","Invalid Uint Uid ".concat(B," => ").concat(ah.uid,", ").concat(ah)),_0.reqUserAccount(_i.sid,{lts:_r,success:!1,serverAddr:ga,stringUid:_i.string_uid,uid:ah.uid,errorCode:_f.INVALID_UINT_UID_FROM_STRING_UID,extend:_i}),new _E(_f.INVALID_UINT_UID_FROM_STRING_UID);return _0.reqUserAccount(_i.sid,{lts:_r,success:!0,serverAddr:ga,stringUid:_i.string_uid,uid:ah.uid,errorCode:null,extend:_i}),!1}const _A=KO(ah.code);return _A.retry&&(ga=k[(_h+1)%k.length]),_0.reqUserAccount(_i.sid,{lts:_r,success:!1,serverAddr:ga,stringUid:_i.string_uid,uid:ah.uid,errorCode:_A.desc,extend:_i}),_A.retry},(ah,_h)=>ah.code!==_f.OPERATION_ABORTED&&(_0.reqUserAccount(_i.sid,{lts:_r,success:!1,serverAddr:ga,stringUid:_i.string_uid,uid:null,errorCode:ah.code,extend:_i}),ga=k[(_h+1)%k.length],!0),_t);if(_u.code!==0){const ah=KO(_u.code);throw new _E(_f.UNEXPECTED_RESPONSE,ah.desc)}return _u}(g,e,l,d,p);return A==null||A.recordJoinChannelService({status:"success",endTs:Date.now()},b),I.uid}catch(I){throw A==null||A.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[I]},b),I}}async function GP(e,l,d){let p=Date.now();const A=e.cloudProxyServer,y=y0(A==="normal"?"PROXY_CS":"WEBCS_DOMAIN").map(B=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(B+"/api/v1"):"https://".concat(B,"/api/v1"));if(["proxy3","proxy4","proxy5"].includes(A)){const B=y.map(_t=>({url:_t,areaCode:YO()}));let q=null;q=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:B,asyncMapHandler:_t=>function(_r,_i,ga,_u){let{url:ah,areaCode:_h}=_r;const _A=Date.now(),n0={opid:133,flag:_i.cloudProxyServer==="proxy5"?4194304:1048576,ts:+new Date,key:_i.token,cname:_i.cname,sid:_i.sid,detail:{6:_i.stringUid,11:_h},uid:_i.uid||0};return Q_(async()=>await Pb(ah,{data:n0,cancelToken:ga,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}}),f0=>{if(f0.code===0)return _0.joinWebProxyAP(_i.sid,{lts:_A,sucess:1,apServerAddr:ah,turnServerAddrList:f0.addresses.map(m0=>m0.ip).join(","),errorCode:null,eventType:_i.cloudProxyServer}),!1;const E0=KO(f0.code);throw new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,E0.desc,{retry:E0.retry})},f0=>f0.code!==_f.OPERATION_ABORTED&&(f0.code===_f.CAN_NOT_GET_GATEWAY_SERVER?(_0.joinWebProxyAP(n0.sid,{lts:_A,sucess:0,apServerAddr:ah,turnServerAddrList:null,errorCode:f0.code,eventType:_i.cloudProxyServer}),_a.warning("[".concat(_i.clientId,"] proxy ap server ").concat(ah," failed, message: ").concat(f0.message,", retry: ").concat(f0.data.retry)),H0("warning",["AjaxAPI",_i.clientId],"proxy ap server ".concat(ah," failed, message: ").concat(f0.message,", retry: ").concat(f0.data.retry)),f0.data.retry):(_0.joinWebProxyAP(n0.sid,{lts:_A,sucess:0,apServerAddr:ah,turnServerAddrList:null,errorCode:f0.code,eventType:_i.cloudProxyServer}),!0)),_u)}(_t,e,l,d),allFailedhandler:()=>{throw _a.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}});const $=q.addresses;if(!$||$.length===0)throw _a.error("[".concat(e.clientId,"] can not get proxy server, empty proxy server list")),new _E(_f.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:$.map(_t=>_t.ip).map(z5),serverResponse:{tcpport:$[0].port||443,udpport:$[0].port||p1.udpport,username:p1.username,password:p1.password}}}let g=null;g=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:y,asyncMapHandler:B=>function(q,$,_t,_r){const _i=Date.now(),ga={command:"convergeAllocateEdge",sid:$.sid,appId:$.appId,token:$.token,uid:$.uid,cname:$.cname,ts:Math.floor(Date.now()/1e3),version:s_,seq:0,requestId:1};return Q_(async()=>({res:await Pb(q,{data:{service_name:"webrtc_proxy",json_body:JSON.stringify(ga)},cancelToken:_t,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:q}),_u=>{if(!_u.res.json_body)throw _a.debug("[".concat($.clientId,"] Get proxy server failed: no json_body")),b0("error",["AjaxAPI",$.clientId],"requestProxyServerList","Get proxy server failed: no json_body"),new _E(_f.UNEXPECTED_RESPONSE,JSON.stringify(_u.res));const ah=JSON.parse(_u.res.json_body);if(ah.code!==200)throw _a.debug("[".concat($.clientId,"] Get proxy server failed: response code [").concat(ah.code,"], reason [").concat(ah.reason,"]")),b0("error",["AjaxAPI",$.clientId],"requestProxyServerList","Get proxy server failed: response code [".concat(ah.code,"], reason [").concat(ah.reason,"]")),new _E(_f.UNEXPECTED_RESPONSE,JSON.stringify(_u.res));return _a.debug("[".concat($.clientId,"] App return server length"),ah.servers.length),b0("debug",["AjaxAPI",$.clientId],"requestProxyServerList","",{length:ah.servers.length}),!1},_u=>_u.code!==_f.OPERATION_ABORTED&&(_0.requestProxyAppCenter(ga.sid,{lts:_i,succ:!1,APAddr:q,workerManagerList:null,ec:_u.code,response:_u.message}),!0),_r)}(B,e,l,d),allFailedhandler:()=>{throw _a.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}});const b=JSON.parse(g.res.json_body).servers.map(d0t);if(e.cloudProxyServer==="443only")return{addresses:b,serverResponse:{tcpport:443,udpport:p1.udpport,username:p1.username,password:p1.password}};_0.requestProxyAppCenter(e.sid,{lts:p,succ:!0,APAddr:g.url,workerManagerList:JSON.stringify(b),ec:null,response:JSON.stringify(g.res)}),p=Date.now();const I=b.map(B=>function(q,$,_t,_r){const _i=Date.now();let ga=q;q.startsWith("http")||(ga="https://".concat(q,":4000/v2/machine"));const _u={command:"request",gatewayType:"http",appId:$.appId,cname:$.cname,uid:($.uid||"").toString(),sdkVersion:"2.3.1",sid:$.sid,seq:1,ts:Date.now(),requestId:3,clientRequest:{appId:$.appId,cname:$.cname,uid:($.uid||"").toString(),sid:$.sid}};return Q_(async()=>({res:await Pb(ga,{data:_u,cancelToken:_t}),url:q}),ah=>{if(!ah.res.serverResponse)throw new _E(_f.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1},ah=>ah.code!==_f.OPERATION_ABORTED&&(_0.requestProxyWorkerManager(_u.sid,{lts:_i,succ:!1,workerManagerAddr:q,ec:ah.code,response:ah.message}),!0),_r)}(B,e,l,d));let k=null;try{k=await hT(I)}catch{throw _a.error("[".concat(e.clientId,"] can not get worker manager after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}return I.forEach(B=>B.cancel()),_0.requestProxyWorkerManager(e.sid,{lts:p,succ:!0,workerManagerAddr:k.url,ec:null,response:JSON.stringify(k.res)}),{addresses:[k.url],serverResponse:k.res.serverResponse}}async function a1t(e,l,d){const p=y0("CDS_AP").slice(0,y0("AJAX_REQUEST_CONCURRENT")).map(b=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(b+"/api/v1"):"https://".concat(b,"/api/v1?action=config")).map(b=>function(I,k,B,q){const $=MI(),_t={flag:64,cipher_method:0,features:{device:$.name,system:$.os,system_general:navigator.userAgent,vendor:k.appId,version:s_,cname:k.cname,sid:k.sid,session_id:k.sid,detail:"",proxyServer:k.proxyServer}};return Q_(()=>Pb(I,{data:_t,timeout:1e3,cancelToken:B,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,_r=>_r.code!==_f.OPERATION_ABORTED,q)}(b,e,l,d));let A=null,y=null,g={};try{A=await hT(p)}catch(b){if(b.code===_f.OPERATION_ABORTED)throw b;y=b}if(p.forEach(b=>b.cancel()),_0.reportApiInvoke(e.sid,{name:$0.REQUEST_CONFIG_DISTRIBUTE,options:{error:y,res:A}}).onSuccess(),A&&A.test_tags)try{g=function(b){if(!b.test_tags)return{};const I=b.test_tags,k=Object.keys(I),B={};return k.forEach(q=>{var $;const _t=ZR($=q.slice(4)).call($),_r=JSON.parse(I[q])[1];B[_t]=_r}),B}(A)}catch{}return g}async function YX(e,l,d,p){const A=y0("PROXY_SERVER_TYPE3"),y=(_t,_r)=>{let _i=A;return Array.isArray(_i)&&(_i=_r%2==0?A[1]:A[0]),"https://".concat(_i,"/ap/?url=").concat(_t)};let g=null;const b=[],I=async()=>{const _t=y0("WEBCS_DOMAIN").slice(0,y0("AJAX_REQUEST_CONCURRENT")).map((ga,_u)=>({url:e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"):y("".concat(ga,"/api/v2/transpond/webrtc?v=2"),_u),areaCode:YO(),serviceIds:[l1.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?l1.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?l1.CLOUD_PROXY:l1.CLOUD_PROXY_FALLBACK]})),_r=p.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_t.map(ga=>ga.url)}),_i=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:_t,asyncMapHandler:ga=>(_a.debug("[".concat(e.clientId,"] Connect to choose_server:"),ga.url),GX(ga,e,l,d)),allFailedhandler:ga=>{throw p.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_r),ga[0]},promisesCollector:b});return p.recordJoinChannelService({endTs:Date.now(),status:"success"},_r),_i},k=async()=>{if(await Q1(1e3),g!==null)return g;const _t=y0("WEBCS_DOMAIN_BACKUP_LIST").map((ga,_u)=>({url:e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"):y("".concat(ga,"/api/v2/transpond/webrtc?v=2"),_u),areaCode:YO(),serviceIds:[l1.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?l1.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?l1.CLOUD_PROXY:l1.CLOUD_PROXY_FALLBACK]})),_r=p.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_t.map(ga=>ga.url)}),_i=await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:_t,asyncMapHandler:ga=>(_a.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),ga.url),GX(ga,e,l,d)),allFailedhandler:ga=>{throw p.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_r),ga[0]},promisesCollector:b});return p.recordJoinChannelService({endTs:Date.now(),status:"success"},_r),_i};let B,q,$;try{({gatewayInfo:B,proxyInfo:q,url:$}=await hT([I(),k()]))}catch(_t){throw _t[0]}if(b.length&&b.forEach(_t=>_t.cancel&&typeof _t.cancel=="function"&&_t.cancel()),!B||!q)throw new _E(_f.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=$,e.cloudProxyServer!=="disabled"&&Array.isArray(A)&&$){const _t=new kX($).host;A.includes(_t)&&(e.proxyServer=_t,_a.setProxyServer(_t),_0.setProxyServer(_t),tT(_t))}return g={gatewayInfo:B,proxyInfo:await h0t(q,B.uid)},g}async function WX(e,l,d,p){const A=y0("UAP_AP").slice(0,y0("AJAX_REQUEST_CONCURRENT")).map(y=>l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(y+"/api/v1?action=uap"):"https://".concat(y,"/api/v1?action=uap"));return await n1t(A,e,l,d,p)}async function c1t(e,l,d){const p=y0("UAP_AP").slice(0,y0("AJAX_REQUEST_CONCURRENT")).map(A=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(A+"/api/v1?action=uap"):"https://".concat(A,"/api/v1?action=uap")).map(A=>function(y,g,b,I){const k={command:"convergeAllocateEdge",sid:g.sid,appId:g.appId,token:g.token,ts:Date.now(),version:s_,cname:g.cname,uid:g.uid.toString(),requestId:P6,seq:P6};P6+=1;const B={service_name:"tele_channel",json_body:JSON.stringify(k)};return Q_(async()=>{const q=await Pb(y,{data:B,cancelToken:b,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(q.code!==0){const _t=new _E(_f.UNEXPECTED_RESPONSE,"cross channel ap error, code"+q.code,{retry:!0});throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_t.toString()),_t}const $=JSON.parse(q.json_body);if($.code!==200){const _t=new _E(_f.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat($.code,", reason: ").concat($.reason));throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_t.toString()),_t}if(!$.servers||$.servers.length===0){const _t=new _E(_f.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw _a.error(_t.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_t.toString()),_t}return{vid:$.vid,workerToken:$.workerToken,addressList:$.servers.map(_t=>"wss://".concat(_t.address.replace(/\./g,"-"),".").concat(y0("WORKER_DOMAIN"),":").concat(_t.wss))}},void 0,q=>!!(q.code!==_f.OPERATION_ABORTED&&q.code!==_f.UNEXPECTED_RESPONSE||q.data&&q.data.retry),I)}(A,e,l,d));try{const A=await hT(p);return p.forEach(y=>y.cancel()),A}catch(A){throw A[0]}}async function u1t(e,l,d){let p=null;const A=[],y=async g=>{const b=y0(g?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(I=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(I+"/api/v2/transpond/webrtc?v=2"):"https://".concat(I,"/api/v2/transpond/webrtc?v=2"));return g&&(await Q1(1e3),p!==null)?p:await fT({fragementLength:y0("FRAGEMENT_LENGTH"),referenceList:b,asyncMapHandler:I=>(_a.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(g?"backup":""," choose_server:"),I),function(k,B,q,$){const[_t]=i1t(B,[l1.CHOOSE_SERVER]);let _r=S1.networkState;return Q_(async()=>{_r&&S1.networkState===f_.OFFLINE&&S1.onlineWaiter&&await Y0.race([S1.onlineWaiter,Q1($&&$.maxRetryTimeout||a1.maxRetryTimeout)]),_r=S1.networkState;const _i=await Pb(k,{data:_t,cancelToken:q,headers:{"Content-Type":"multipart/form-data;"}},!0);return r1t(_i,k)},()=>!1,_i=>_i.code!==_f.OPERATION_ABORTED&&(_i.code===_f.UPDATE_TICKET_FAILED?_i.data.retry:(_a.warning("[".concat(B.clientId,"] update ticket network error, retry"),_i),H0("warning",["AjaxAPI",B.clientId],"update ticket network error, retry, ".concat(_i)),!0)),$)}(I,e,l,d)),allFailedhandler:I=>{throw I[0]},promisesCollector:A})};try{return p=await hT([y(!1),y(!0)]),A.length&&A.forEach(g=>g.cancel&&typeof g.cancel=="function"&&g.cancel()),p}catch(g){throw g[0]}}var JX;function zX(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function XX(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?zX(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):zX(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let l1t=U1("ConfigDistributeManager")(JX=class extends e1{constructor(){super(),_s(this,"configs",void 0),_s(this,"joinInfo",void 0),_s(this,"cancelToken",void 0),_s(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),_s(this,"interval",void 0),_s(this,"mutex",new g_("config-distribute")),_s(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,l){this.joinInfo=e,this.cancelToken=l,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},y0("CONFIG_DISTRIBUTE_INTERVAL"))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){!this.mutex.isLocked||(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,_0.reportApiInvoke(null,{options:void 0,name:$0.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:z0.TRACER}).onSuccess(JSON.stringify(U4))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return _a.debug("[config-distribute] get config distribute interrupted have no joininfo"),void b0("debug",this,"updateConfigDistribute",void 0,"get config distribute interrupted have no joininfo");let e;const l=await this.mutex.lock();try{e=await a1t(this.joinInfo,this.cancelToken,this.retryConfig),_a.debug("[config-distribute] get config distribute",JSON.stringify(e)),b0("debug",this,"updateConfigDistribute",e),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(d){const p=new _E(_f.NETWORK_RESPONSE_ERROR,d);_a.warning("[config-distribute] ".concat(p.toString())),b0("warning",this,"updateConfigDistribute",void 0,d.toString())}finally{l()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var l;(l=e)&&l.uplink&&l.id&&l.uplink.max_bitrate!==void 0&&l.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(NO.UPDATE_BITRATE_LIMIT,e):this.emit(NO.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&XX({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var l;const d=q4(l=Object.keys(e).filter(A=>/^webrtc_ng_global_parameter/.test(A))).call(l);for(let A=0;A<d.length;A++)for(let y=d.length-1;y>A;y--){const g=d[y];if(typeof e[g].__priority=="number"){const b=e[g].__priority,I=d[y-1];if(typeof e[I].__priority=="number"){if(!(b>e[I].__priority))continue;{const k=g;d[y]=d[y-1],d[y-1]=k}}else{const k=g;d[y]=d[y-1],d[y-1]=k}}}const p={};d.forEach(A=>{const y=e[A],g=y.__expires;Object.keys(y).forEach(b=>{b==="__priority"||b==="__expires"||Object.prototype.hasOwnProperty.call(p,b)||(p[b]=XX({value:y[b]},g&&{expires:g}))})});try{const A=JSON.stringify(p),y=window.btoa(A);window.localStorage.setItem("websdk_ng_global_parameter",y),_a.debug("Caching global parameters ".concat(A)),b0("debug",this,"cacheGlobalParameterConfig",A)}catch(A){_a.error("Error caching global parameters:",A.message),b0("error",this,"cacheGlobalParameterConfig",void 0,A.message)}}})||JX;function ZX(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function WO(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?ZX(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):ZX(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}class d1t extends e1{constructor(l,d,p,A){super(),_s(this,"spec",void 0),_s(this,"token",void 0),_s(this,"websocket",void 0),_s(this,"pingpongTimer",void 0),_s(this,"reconnectMode","retry"),_s(this,"serviceMode",void 0),_s(this,"reqId",0),_s(this,"commandReqId",0),_s(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),_s(this,"handleWebSocketMessage",y=>{if(!y.data)return;const g=JSON.parse(y.data);g.requestId?this.emit("@".concat(g.requestId,"-").concat(g.sid),g):this.serviceMode===n1.INJECT?this.emit(_b.INJECT_STREAM_STATUS,g):(_0.workerEvent(this.spec.sid,{actionType:"status",serverCode:g.code,workerType:this.serviceMode===n1.TRANSCODE?1:2}),this.emit(_b.PUBLISH_STREAM_STATUS,g))}),this.spec=d,this.token=l,this.serviceMode=A,this.websocket=new FP("live-streaming",p),this.websocket.on(SI.CONNECTED,this.handleWebSocketOpen),this.websocket.on(SI.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(SI.REQUEST_NEW_URLS,(y,g)=>{O_(this,_b.REQUEST_NEW_ADDRESS).then(y).catch(g)}),this.websocket.on(SI.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(l){return this.websocket.init(l)}async request(l,d,p,A){this.reqId+=1,l==="request"&&(this.commandReqId+=1);const y=this.commandReqId,g=this.reqId;if(!g||!this.websocket)throw new _E(_f.UNEXPECTED_ERROR);const b=WO({command:l,sdkVersion:s_==="4.11.1"?"0.0.1":s_,seq:g,requestId:g,allocate:p,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},d);if(this.websocket.state==="closed")throw new _E(_f.WS_DISCONNECT);const I=()=>new Y0(($,_t)=>{this.websocket.once(SI.CLOSED,()=>_t(new _E(_f.WS_ABORT))),this.websocket.once(SI.CONNECTED,$)});this.websocket.state!=="connected"&&await I(),b.clientRequest&&(b.clientRequest.workerToken=this.token);const k=new Y0(($,_t)=>{const _r=()=>{_t(new _E(_f.WS_ABORT))};this.websocket.once(SI.RECONNECTING,_r),this.websocket.once(SI.CLOSED,_r),this.once("@".concat(g,"-").concat(this.spec.sid),_i=>{$(_i)})});A&&_0.workerEvent(this.spec.sid,WO(WO({},A),{},{requestId:y,actionType:"request",payload:JSON.stringify(d.clientRequest),serverCode:0,code:0}));const B=Date.now();this.websocket.sendMessage(b);let q=null;try{q=await k}catch($){if(this.websocket.state==="closed")throw $;return await I(),await this.request(l,d,p)}return A&&_0.workerEvent(this.spec.sid,WO(WO({},A),{},{requestId:y,actionType:"response",payload:JSON.stringify(q.serverResponse),serverCode:q.code,success:q.code===200,responseTime:Date.now()-B})),q.code!==200&&this.handleResponseError(q),q}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const l=s_==="4.11.1"?"0.0.1":s_;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:l,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(l){switch(l.code){case JI.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void _a.warning("live stream response already exists stream");case JI.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case JI.LIVE_STREAM_RESPONSE_BAD_STREAM:case JI.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new _E(_f.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:l.code}).throw();case JI.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(l.serverResponse.command==="UnpublishStream"||l.serverResponse.command==="UninjectStream")return;throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case JI.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new _E(_f.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:l.code}).throw();case JI.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const d=new _E(_f.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(_b.WARNING,d,l.serverResponse.url)}case JI.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const d=new _E(_f.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(_b.WARNING,d,l.serverResponse.url)}case JI.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case JI.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new _E(_f.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:l.code}).throw();case JI.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const d=new _E(_f.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(_b.WARNING,d,l.serverResponse.url)}case JI.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:l.code}).throw();case JI.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case JI.LIVE_STREAM_RESPONSE_WORKER_LOST:case JI.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(l.serverResponse.command==="UnpublishStream"||l.serverResponse.command==="UninjectStream")return;throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case JI.ERROR_FAIL_SEND_MESSAGE:if(l.serverResponse.command==="UnpublishStream"||l.serverResponse.command==="UninjectStream")return;if(l.serverResponse.command==="UpdateTranscoding"||l.serverResponse.command==="ControlStream")return new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:l.code}).throw();throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case JI.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new _E(_f.LIVE_STREAMING_CDN_ERROR,"",{code:l.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(bP)},6e3)}}function $X(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function e_(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?$X(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):$X(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}class h1t extends e1{constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a1,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a1;super(),_s(this,"onLiveStreamWarning",void 0),_s(this,"onLiveStreamError",void 0),_s(this,"onInjectStatusChange",void 0),_s(this,"spec",void 0),_s(this,"retryTimeout",1e4),_s(this,"connection",void 0),_s(this,"httpRetryConfig",void 0),_s(this,"wsRetryConfig",void 0),_s(this,"streamingTasks",new Map),_s(this,"isStartingStreamingTask",!1),_s(this,"taskMutex",new g_("live-streaming")),_s(this,"cancelToken",lS.CancelToken.source()),_s(this,"transcodingConfig",void 0),_s(this,"injectConfig",e_({},Tgt)),_s(this,"injectLoopTimes",0),_s(this,"uapResponse",void 0),_s(this,"lastTaskId",1),_s(this,"statusError",new Map),this.spec=l,this.httpRetryConfig=p,this.wsRetryConfig=d}async setTranscodingConfig(l){const d=e_(e_({},Rgt),l);d.videoCodecProfile!==66&&d.videoCodecProfile!==77&&d.videoCodecProfile!==100&&(_a.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(d.videoCodecProfile," -> 100")),d.videoCodecProfile=100),d.transcodingUsers||(d.transcodingUsers=d.userConfigs),d.transcodingUsers&&(d.transcodingUsers=d.transcodingUsers.map(g=>e_(e_(e_({},Sgt),g),{},{zOrder:g.zOrder?g.zOrder+1:1}))),function(g){GI(g.width)||jI(g.width,"config.width",0,1e4),GI(g.height)||jI(g.height,"config.height",0,1e4),GI(g.videoBitrate)||jI(g.videoBitrate,"config.videoBitrate",1,1e6),GI(g.videoFrameRate)||jI(g.videoFrameRate,"config.videoFrameRate"),GI(g.lowLatency)||rP(g.lowLatency,"config.lowLatency"),GI(g.audioSampleRate)||O1(g.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),GI(g.audioBitrate)||jI(g.audioBitrate,"config.audioBitrate",1,128),GI(g.audioChannels)||O1(g.audioChannels,"config.audioChannels",[1,2,3,4,5]),GI(g.videoGop)||jI(g.videoGop,"config.videoGop"),GI(g.videoCodecProfile)||O1(g.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),GI(g.userCount)||jI(g.userCount,"config.userCount",0,17),GI(g.backgroundColor)||jI(g.backgroundColor,"config.backgroundColor",0,16777215),GI(g.userConfigExtraInfo)||K1(g.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),g.transcodingUsers&&!GI(g.transcodingUsers)&&(wO(g.transcodingUsers,"config.transcodingUsers"),g.transcodingUsers.forEach((b,I)=>{K4(b.uid),GI(b.x)||jI(b.x,"transcodingUser[".concat(I,"].x"),0,1e4),GI(b.y)||jI(b.y,"transcodingUser[".concat(I,"].y"),0,1e4),GI(b.width)||jI(b.width,"transcodingUser[".concat(I,"].width"),0,1e4),GI(b.height)||jI(b.height,"transcodingUser[".concat(I,"].height"),0,1e4),GI(b.zOrder)||jI(b.zOrder-1,"transcodingUser[".concat(I,"].zOrder"),0,100),GI(b.alpha)||jI(b.alpha,"transcodingUser[".concat(I,"].alpha"),0,1,!1)})),GI(g.watermark)||$4(g.watermark,"watermark"),GI(g.backgroundImage)||$4(g.backgroundImage,"backgroundImage"),g.images&&!GI(g.images)&&(wO(g.images,"config.images"),g.images.forEach((b,I)=>{$4(b,"images[".concat(I,"]"))}))}(d);const p=[];d.images&&p.push(...d.images.map(g=>e_(e_(e_({},Z4),g),{},{zOrder:255}))),d.backgroundImage&&(p.push(e_(e_(e_({},Z4),d.backgroundImage),{},{zOrder:0})),delete d.backgroundImage),d.watermark&&(p.push(e_(e_(e_({},Z4),d.watermark),{},{zOrder:255})),delete d.watermark),d.images=p,d.transcodingUsers&&(d.userConfigs=d.transcodingUsers.map(g=>e_({},g)),d.userCount=d.transcodingUsers.length,delete d.transcodingUsers);const A=(d.userConfigs||[]).map(g=>typeof g.uid=="number"?Y0.resolve(g.uid):M6(g.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await Y0.all(A)).forEach((g,b)=>{d.userConfigs&&d.userConfigs[b]&&(d.userConfigs[b].uid=g)}),this.transcodingConfig=d,this.connection)try{var y;const g=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(zS(y=this.streamingTasks).call(y)).map(b=>b.taskId).join("#")});_a.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(g.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(g){if(!g.data||!g.data.retry)throw g;g.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(b=>{_a.warning("[".concat(this.spec.clientId,"] live streaming receive error"),g.toString(),"try to republish",b.url),this.startLiveStreamingTask(b.url,b.mode,g).then(()=>{_a.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(b.url," success"))}).catch(I=>{_a.error("[".concat(this.spec.clientId,"] live streaming republish failed"),b.url,I.toString()),this.onLiveStreamError&&this.onLiveStreamError(b.url,I)})})}}setInjectStreamConfig(l,d){this.injectConfig=Object.assign({},this.injectConfig,l),this.injectLoopTimes=d}async startLiveStreamingTask(l,d,p){var A;if(Array.from(zS(A=this.streamingTasks).call(A)).find(I=>I.mode===n1.INJECT)&&d===n1.INJECT)return new _E(_f.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&d===n1.TRANSCODE)throw new _E(_f.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let y={command:"PublishStream",ts:Date.now(),url:l,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};_a.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(l,", mode: ").concat(d));const g=await this.taskMutex.lock();if(!this.connection&&p)return void g();if(this.streamingTasks.get(l)&&!p)return g(),new _E(_f.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(d))}catch(I){throw g(),I}switch(d){case n1.TRANSCODE:y.transcodingConfig=e_({},this.transcodingConfig);break;case n1.RAW:break;case n1.INJECT:y={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:l,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(y.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const b=this.lastTaskId++;try{const I=new Y0((B,q)=>{Q1(this.retryTimeout).then(()=>{if(p)return q(p);const $=this.statusError.get(l);return $?(this.statusError.delete(l),q($)):void 0})}),k=await Y0.race([this.connection.request("request",{clientRequest:y},!0,{url:l,command:"PublishStream",workerType:d===n1.TRANSCODE?1:2,requestByUser:!p,tid:b.toString()}),I]);this.isStartingStreamingTask=!1,_a.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(k.code)),this.streamingTasks.set(l,{clientRequest:y,mode:d,url:l,taskId:b}),g()}catch(I){if(g(),this.isStartingStreamingTask=!1,!I.data||!I.data.retry||p)throw I;return I.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(l,d,I)):await this.startLiveStreamingTask(l,d,I)}}stopLiveStreamingTask(l){return new Y0((d,p)=>{const A=this.streamingTasks.get(l);if(!A||!this.connection)return new _E(_f.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const y=A.mode;A.abortTask=()=>{_a.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(l),d()},this.connection.request("request",{clientRequest:{command:y===n1.INJECT?"UninjectStream":"UnpublishStream",url:A.url}},!1,{url:l,command:"UnPublishStream",workerType:y===n1.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(g=>{_a.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(g.code)),this.streamingTasks.delete(l),this.streamingTasks.size===0&&y!==n1.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),d(),y===n1.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,l)}).catch(p)})}async controlInjectStream(l,d,p,A){const y=this.streamingTasks.get(l);if(!y||!this.connection||y.mode!==n1.INJECT)throw new _E(_f.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:l,control:d,audioVolume:p,position:A}})).serverResponse}resetAllTask(){var l;const d=Array.from(zS(l=this.streamingTasks).call(l));this.terminate();for(const p of d)this.startLiveStreamingTask(p.url,p.mode).catch(A=>{this.onLiveStreamError&&this.onLiveStreamError(p.url,A)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=lS.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(l){if(this.connection)throw new _E(_f.UNEXPECTED_ERROR,"live streaming connection has already connected");const d=await O_(this,u2.REQUEST_WORKER_MANAGER_LIST,l);return this.uapResponse=d,this.connection=new d1t(d.workerToken,this.spec,this.wsRetryConfig,l),this.connection.on(_b.WARNING,(p,A)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(A,p)),this.connection.on(_b.PUBLISH_STREAM_STATUS,p=>this.handlePublishStreamServer(p)),this.connection.on(_b.INJECT_STREAM_STATUS,p=>this.handleInjectStreamServerStatus(p)),this.connection.on(_b.REQUEST_NEW_ADDRESS,(p,A)=>{if(!this.connection)return A(new _E(_f.UNEXPECTED_ERROR,"can not get new live streaming address list"));O_(this,u2.REQUEST_WORKER_MANAGER_LIST,l).then(y=>{this.uapResponse=y,p(y.addressList)}).catch(A)}),await this.connection.init(d.addressList),this.connection}handlePublishStreamServer(l){const d=l.serverStatus&&l.serverStatus.url||"empty_url",p=this.streamingTasks.get(d),A=l.reason;switch(l.code){case JI.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case JI.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const g=new _E(_f.LIVE_STREAMING_CDN_ERROR,"",{code:l.code});if(p)return _a.error(g.toString()),this.onLiveStreamError&&this.onLiveStreamError(d,g);if(!this.isStartingStreamingTask)return;this.statusError.set(d,g)}case JI.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const g=new _E(_f.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,A);return this.onLiveStreamWarning&&this.onLiveStreamWarning(d,g)}case JI.LIVE_STREAM_RESPONSE_WORKER_LOST:case JI.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var y;if(!this.connection)return;this.connection.tryNextAddress();const g=Array.from(zS(y=this.streamingTasks).call(y));for(const b of g)b.abortTask?b.abortTask():(_a.warning("[".concat(this.spec.clientId,"] publish stream status code"),l.code,"try to republish",b.url),this.startLiveStreamingTask(b.url,b.mode,new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:l.code})).then(()=>{_a.debug("[".concat(this.spec.clientId,"] republish live stream success"),b.url)}).catch(I=>{_a.error(I.toString()),this.onLiveStreamError&&this.onLiveStreamError(b.url,I)}));return}}}handleInjectStreamServerStatus(l){const d=Number(l.uid),p=l.serverStatus&&l.serverStatus.url;switch(l.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_START_SUCCESS,d,p));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,d,p),void this.streamingTasks.delete(p);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_START_UNAUTHORIZED,d,p),void this.streamingTasks.delete(p);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_BROKEN,d,p),void this.streamingTasks.delete(p);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(gR.INJECT_STREAM_STATUS_START_TIMEOUT,d,p),void this.streamingTasks.delete(p);default:return void _a.debug("inject stream server status",l)}}hasUrl(l){return this.streamingTasks.has(l)}}class tZ{constructor(){_s(this,"destChannelMediaInfos",new Map),_s(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(l){ZK(l),this.srcChannelMediaInfo=l}addDestChannelInfo(l){ZK(l),this.destChannelMediaInfos.set(l.channelName,l)}removeDestChannelInfo(l){H4(l),this.destChannelMediaInfos.delete(l)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function eZ(e){if(!(e instanceof tZ))return new _E(_f.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const l=e.getSrcChannelMediaInfo(),d=e.getDestChannelMediaInfo();if(!l)return new _E(_f.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(d.size===0)return new _E(_f.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class p1t extends e1{constructor(l,d,p){super(),_s(this,"ws",void 0),_s(this,"requestId",1),_s(this,"heartBeatTimer",void 0),_s(this,"joinInfo",void 0),_s(this,"clientId",void 0),_s(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),_s(this,"onClose",A=>{this.emit("close"),this.dispose()}),_s(this,"onMessage",A=>{const y=JSON.parse(A.data);if(!y||y.command!=="serverResponse"||!y.requestId)return y&&y.command==="serverStatus"&&y.serverStatus&&y.serverStatus.command?(this.emit("status",y.serverStatus),void this.emit(y.serverStatus.command,y.serverStatus)):void 0;this.emit("req_".concat(y.requestId),y)}),this.joinInfo=l,this.clientId=d,this.ws=new FP("cross-channel-".concat(this.clientId),p),this.ws.on(SI.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(SI.CONNECTED,this.onOpen),this.ws.on(SI.ON_MESSAGE,this.onMessage),this.ws.on(SI.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(l){const d=this.requestId++;return l.requestId=d,l.seq=d,this.ws.sendMessage(l),d}waitStatus(l){return new Y0((d,p)=>{const A=window.setTimeout(()=>{p(new _E(_f.TIMEOUT,"wait status timeout, status: ".concat(l)))},5e3);this.once(l,y=>{window.clearTimeout(A),y.state&&y.state!==0?p(new _E(_f.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(l))):d(void 0)}),this.once("dispose",()=>{window.clearTimeout(A),p(new _E(_f.WS_ABORT))})})}async request(l){if(this.ws.state==="closed")throw new _E(_f.WS_DISCONNECT);const d=()=>new Y0((g,b)=>{this.ws.once(SI.CLOSED,()=>b(new _E(_f.WS_ABORT))),this.ws.once(SI.CONNECTED,g)});this.ws.state!=="connected"&&await d();const p=this.sendMessage(l),A=new Y0((g,b)=>{const I=()=>{b(new _E(_f.WS_ABORT))};this.ws.once(SI.RECONNECTING,I),this.ws.once(SI.CLOSED,I),this.once("req_".concat(p),g),Q1(3e3).then(()=>{this.removeAllListeners("req_".concat(p)),this.ws.off(SI.RECONNECTING,I),this.ws.off(SI.CLOSED,I),b(new _E(_f.TIMEOUT,"cross channel ws request timeout"))})}),y=await A;if(!y||y.code!==200)throw new _E(_f.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(y)));return y}async connect(l){this.ws.removeAllListeners(SI.REQUEST_NEW_URLS),this.ws.on(SI.REQUEST_NEW_URLS,d=>{d(l)}),await this.ws.init(l)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(l){const d=this.requestId++;return l.requestId=d,this.ws.sendMessage(l),d}startHeartBeatCheck(){this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class f1t extends e1{set state(l){l!==this._state&&(l!==Z1.RELAY_STATE_FAILURE&&(this.errorCode=ER.RELAY_OK),this.emit("state",l,this.errorCode),this._state=l)}get state(){return this._state}constructor(l,d,p,A){super(),_s(this,"joinInfo",void 0),_s(this,"clientId",void 0),_s(this,"cancelToken",lS.CancelToken.source()),_s(this,"workerToken",void 0),_s(this,"requestId",0),_s(this,"signal",void 0),_s(this,"prevChannelMediaConfig",void 0),_s(this,"httpRetryConfig",void 0),_s(this,"_state",Z1.RELAY_STATE_IDLE),_s(this,"errorCode",ER.RELAY_OK),_s(this,"onStatus",y=>{_a.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(y))),y&&y.command&&(y.command==="onAudioPacketReceived"&&this.emit("event",dS.PACKET_RECEIVED_AUDIO_FROM_SRC),y.command==="onVideoPacketReceived"&&this.emit("event",dS.PACKET_RECEIVED_VIDEO_FROM_SRC),y.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=ER.SRC_TOKEN_EXPIRED,this.state=Z1.RELAY_STATE_FAILURE),y.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=ER.DEST_TOKEN_EXPIRED,this.state=Z1.RELAY_STATE_FAILURE))}),_s(this,"onReconnect",async()=>{_a.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",dS.NETWORK_DISCONNECTED),this.state=Z1.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(y=>{this.state!==Z1.RELAY_STATE_IDLE&&(_a.error("auto restart channel media relay failed",y.toString()),this.errorCode=ER.SERVER_CONNECTION_LOST,this.state=Z1.RELAY_STATE_FAILURE)})}),this.joinInfo=l,this.clientId=d,this.signal=new p1t(this.joinInfo,this.clientId,p),this.httpRetryConfig=A}async startChannelMediaRelay(l){if(this.state!==Z1.RELAY_STATE_IDLE)throw new _E(_f.INVALID_OPERATION);this.state=Z1.RELAY_STATE_CONNECTING,await this.connect(),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(l)}catch(d){throw d.data&&d.data.serverResponse&&d.data.serverResponse.command==="SetSourceChannel"?new _E(_f.CROSS_CHANNEL_FAILED_JOIN_SRC):d.data&&d.data.serverResponse&&d.serverResponse.command==="SetDestChannelStatus"?new _E(_f.CROSS_CHANNEL_FAILED_JOIN_DEST):d.data&&d.data.serverResponse&&d.serverResponse.command==="StartPacketTransfer"?new _E(_f.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):d}this.prevChannelMediaConfig=l}async updateChannelMediaRelay(l){if(this.state!==Z1.RELAY_STATE_RUNNING)throw new _E(_f.INVALID_OPERATION);await this.sendUpdateMessage(l),this.prevChannelMediaConfig=l}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),_a.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Z1.RELAY_STATE_IDLE,this.dispose()}dispose(){_a.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=lS.CancelToken.source(),this.state=Z1.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const l=await c1t(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=l.workerToken,await this.signal.connect(l.addressList),this.emit("event",dS.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(l){const d=this.genMessage(Y1.StopPacketTransfer);await this.signal.request(d),await this.signal.waitStatus("Normal Quit"),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const p=this.genMessage(Y1.SetSdkProfile,l);await this.signal.request(p),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const A=this.genMessage(Y1.SetSourceChannel,l);await this.signal.request(A),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",dS.PACKET_JOINED_SRC_CHANNEL),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const y=this.genMessage(Y1.SetSourceUserId,l);await this.signal.request(y),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const g=this.genMessage(Y1.SetDestChannel,l);await this.signal.request(g),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",dS.PACKET_JOINED_DEST_CHANNEL),_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const b=this.genMessage(Y1.StartPacketTransfer,l);await this.signal.request(b),this.emit("event",dS.PACKET_SENT_TO_DEST_CHANNEL),this.state=Z1.RELAY_STATE_RUNNING,_a.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))}async sendUpdateMessage(l){const d=this.genMessage(Y1.UpdateDestChannel,l);await this.signal.request(d),this.emit("event",dS.PACKET_UPDATE_DEST_CHANNEL),_a.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const l=this.genMessage(Y1.StopPacketTransfer);await this.signal.request(l),_a.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(l,d){const p=[],A=[],y=[];this.requestId+=1;const g={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:s_,sid:this.joinInfo.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};g.sdkVersion==="4.11.1"&&(g.sdkVersion="0.0.1");let b=null,I=null;switch(l){case Y1.SetSdkProfile:return g.clientRequest={command:"SetSdkProfile",type:"multi_channel"},g;case Y1.SetSourceChannel:if(I=d&&d.getSrcChannelMediaInfo(),!I)throw new _E(_f.UNEXPECTED_ERROR,"can not find source config");return g.clientRequest={command:"SetSourceChannel",uid:"0",channelName:I.channelName,token:I.token||this.joinInfo.appId},g;case Y1.SetSourceUserId:if(I=d&&d.getSrcChannelMediaInfo(),!I)throw new _E(_f.UNEXPECTED_ERROR,"can not find source config");return g.clientRequest={command:"SetSourceUserId",uid:I.uid+""},g;case Y1.SetDestChannel:if(b=d&&d.getDestChannelMediaInfo(),!b)throw new _E(_f.UNEXPECTED_ERROR,"can not find dest config");return b.forEach(k=>{p.push(k.channelName),A.push(k.uid+""),y.push(k.token||this.joinInfo.appId)}),g.clientRequest={command:"SetDestChannel",channelName:p,uid:A,token:y},g;case Y1.StartPacketTransfer:return g.clientRequest={command:"StartPacketTransfer"},g;case Y1.Reconnect:return g.clientRequest={command:"Reconnect"},g;case Y1.StopPacketTransfer:return g.clientRequest={command:"StopPacketTransfer"},g;case Y1.UpdateDestChannel:if(b=d&&d.getDestChannelMediaInfo(),!b)throw new _E(_f.UNEXPECTED_ERROR,"can not find dest config");return b.forEach(k=>{p.push(k.channelName),A.push(k.uid+""),y.push(k.token||this.joinInfo.appId)}),g.clientRequest={command:"UpdateDestChannel",channelName:p,uid:A,token:y},g}return g}}var nZ;let rZ=U1("AgoraRTCPlayer","trackId")(nZ=class{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(_a.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),qS("debug",["HTMLVideoElement",this.trackId],"statusChange","".concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}constructor(e){_s(this,"trackId",void 0),_s(this,"config",void 0),_s(this,"onFirstVideoFrameDecoded",void 0),_s(this,"freezeTimeCounterList",[]),_s(this,"timeUpdatedCount",0),_s(this,"freezeTime",0),_s(this,"playbackTime",0),_s(this,"lastTimeUpdatedTime",0),_s(this,"videoTrack",void 0),_s(this,"container",void 0),_s(this,"videoElement",void 0),_s(this,"videoElementCheckInterval",void 0),_s(this,"_videoElementStatus",j1.NONE),_s(this,"slot",void 0),_s(this,"isGettingVideoDimensions",!1),_s(this,"handleVideoEvents",l=>{switch(l.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=j1.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=j1.CANPLAY;break;case"stalled":this.videoElementStatus=j1.STALLED;break;case"suspend":this.videoElementStatus=j1.SUSPEND;break;case"pause":this.videoElementStatus=j1.PAUSED,!h_()&&!VS()&&this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),H0("debug",this,"video element paused, auto resume"),this.videoElement.play());break;case"waiting":this.videoElementStatus=j1.WAITING;break;case"abort":this.videoElementStatus=j1.ABORT;break;case"ended":this.videoElementStatus=j1.ENDED;break;case"emptied":this.videoElementStatus=j1.EMPTIED;break;case"timeupdate":{const d=Date.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=d);const p=d-this.lastTimeUpdatedTime;for(this.lastTimeUpdatedTime=d,p>500&&(this.freezeTime+=p),this.playbackTime+=p;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}}),_s(this,"startGetVideoDimensions",()=>{const l=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return _a.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),b0("debug",this,"startGetVideoDimensions",{videoWidth:this.videoElement.videoWidth,videoHeight:this.videoElement.videoHeight}),void(this.isGettingVideoDimensions=!1);setTimeout(l,500)};!this.isGettingVideoDimensions&&l()}),_s(this,"autoResumeAfterInterruption",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&bI.curState==="running"&&(_4()?(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):ZH()?(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):XH()&&(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),_s(this,"autoResumeAfterInterruptionOnIOS15",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&(_4()?(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):ZH()?(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):XH()&&(_a.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),this.slot=e.element,this.trackId=e.trackId,this.updateConfig(e),bI.on(d1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.on(d1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(e){this.config=e,this.trackId=e.trackId;const l=e.element;l!==this.slot&&(this.destroy(),this.slot=l),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){if(this.videoElement){const l=this.videoElement.play();l&&l.catch&&l.catch(p=>{e&&_0.autoplayFailed(e,"video",p.message,this.trackId),b0("warning",this,"play",p.toString(),"error"),p.name==="NotAllowedError"?(_a.warning("detected video element autoplay failed",p),this.handleAutoPlayFailed()):_a.warning("[".concat(this.trackId,"] play warning: "),p)});const d=MI();if((d.name==="Safari"&&Number(d.version)===15||t2())&&l&&l.then&&l.catch){const p=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};l.then(p).catch(p)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const l=e.getContext("2d");if(!l)return _a.error("create canvas context failed!"),b0("error",this,"getCurrentFrame","create canvas context failed!","error"),new ImageData(2,2);l.drawImage(this.videoElement,0,0,e.width,e.height);const d=l.getImageData(0,0,e.width,e.height);return e.remove(),d}destroy(){if(bI.off(d1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.off(d1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=j1.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=j1.ERROR,this.container&&this.container.appendChild(this.videoElement),iZ.forEach(d=>{this.videoElement&&this.videoElement.addEventListener(d,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=j1.DESTROYED)},1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0";const e=MI();e.name==="Safari"&&Number(e.version)===15||t2()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,d_()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,d_()&&this.videoElement.load());const l=this.videoElement.play();l!==void 0&&l.catch(d=>{_a.debug("[".concat(this.trackId,"] playback interrupted"),d.toString()),H0("debug",this,"play back interrupted: ".concat(d.toString()))})}removeVideoElement(){if(this.videoElement){iZ.forEach(e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=void 0,this.videoElementStatus=j1.NONE}}handleAutoPlayFailed(){const e=MI();if(this.videoElement){const l=d=>{d.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{_a.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed.")),H0("debug",this,"video element autoplay resumed")}).catch(p=>{_a.error(p)}),e.os!=="Android"||e.name!=="Chrome"&&e.name!==DI.WECHAT?(document.body.removeEventListener("touchstart",l,!0),document.body.removeEventListener("mousedown",l,!0)):document.body.removeEventListener("click",l,!0))};e.os!=="Android"||e.name!=="Chrome"&&e.name!==DI.WECHAT?(document.body.addEventListener("touchstart",l,!0),document.body.addEventListener("mousedown",l,!0)):document.body.addEventListener("click",l,!0),xW()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}})||nZ;const iZ=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];var oZ={exports:{}};function A1t(e,l,d){const p=e.createShader(d);if(!p)return new _E(_f.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(e.shaderSource(p,l),e.compileShader(p),!e.getShaderParameter(p,e.COMPILE_STATUS)){const A=e.getShaderInfoLog(p);return e.deleteShader(p),new _E(_f.WEBGL_INTERNAL_ERROR,"error compiling shader:"+A).throw()}return p}function g1t(e,l,d,p){const A=[];for(let y=0;y<l.length;++y){const g=y===0?e.VERTEX_SHADER:e.FRAGMENT_SHADER;A.push(A1t(e,l[y],g))}return function(y,g,b,I){const k=y.createProgram();if(!k)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(g.forEach(B=>{y.attachShader(k,B)}),b&&b.forEach((B,q)=>{y.bindAttribLocation(k,I?I[q]:q,B)}),y.linkProgram(k),!y.getProgramParameter(k,y.LINK_STATUS)){const B=y.getProgramInfoLog(k);throw y.deleteProgram(k),new _E(_f.WEBGL_INTERNAL_ERROR,"error in program linking:"+B)}return k}(e,A,d,p)}(function(e,l){e.exports=(()=>{var d={3476:(g,b,I)=>{g.exports=I(7460)},4341:(g,b,I)=>{g.exports=I(3685)},3536:(g,b,I)=>{var k=I(1910);g.exports=k},8171:(g,b,I)=>{I(6450);var k=I(4058).Object,B=g.exports=function(q,$,_t){return k.defineProperty(q,$,_t)};k.defineProperty.sham&&(B.sham=!0)},2956:(g,b,I)=>{I(7627),I(6274),I(5967),I(8881),I(4560),I(7206),I(4349),I(7971);var k=I(4058);g.exports=k.Promise},3685:(g,b,I)=>{var k=I(3536);g.exports=k},4883:(g,b,I)=>{var k=I(1899),B=I(7475),q=I(9826),$=k.TypeError;g.exports=function(_t){if(B(_t))return _t;throw $(q(_t)+" is not a function")}},174:(g,b,I)=>{var k=I(1899),B=I(4284),q=I(9826),$=k.TypeError;g.exports=function(_t){if(B(_t))return _t;throw $(q(_t)+" is not a constructor")}},1851:(g,b,I)=>{var k=I(1899),B=I(7475),q=k.String,$=k.TypeError;g.exports=function(_t){if(typeof _t=="object"||B(_t))return _t;throw $("Can't set "+q(_t)+" as a prototype")}},8479:g=>{g.exports=function(){}},5743:(g,b,I)=>{var k=I(1899),B=I(7046),q=k.TypeError;g.exports=function($,_t){if(B(_t,$))return $;throw q("Incorrect invocation")}},6059:(g,b,I)=>{var k=I(1899),B=I(941),q=k.String,$=k.TypeError;g.exports=function(_t){if(B(_t))return _t;throw $(q(_t)+" is not an object")}},1692:(g,b,I)=>{var k=I(4529),B=I(9413),q=I(623),$=function(_t){return function(_r,_i,ga){var _u,ah=k(_r),_h=q(ah),_A=B(ga,_h);if(_t&&_i!=_i){for(;_h>_A;)if((_u=ah[_A++])!=_u)return!0}else for(;_h>_A;_A++)if((_t||_A in ah)&&ah[_A]===_i)return _t||_A||0;return!_t&&-1}};g.exports={includes:$(!0),indexOf:$(!1)}},3765:(g,b,I)=>{var k=I(5329);g.exports=k([].slice)},1385:(g,b,I)=>{var k=I(9813)("iterator"),B=!1;try{var q=0,$={next:function(){return{done:!!q++}},return:function(){B=!0}};$[k]=function(){return this},Array.from($,function(){throw 2})}catch{}g.exports=function(_t,_r){if(!_r&&!B)return!1;var _i=!1;try{var ga={};ga[k]=function(){return{next:function(){return{done:_i=!0}}}},_t(ga)}catch{}return _i}},2532:(g,b,I)=>{var k=I(5329),B=k({}.toString),q=k("".slice);g.exports=function($){return q(B($),8,-1)}},9697:(g,b,I)=>{var k=I(1899),B=I(2885),q=I(7475),$=I(2532),_t=I(9813)("toStringTag"),_r=k.Object,_i=$(function(){return arguments}())=="Arguments";g.exports=B?$:function(ga){var _u,ah,_h;return ga===void 0?"Undefined":ga===null?"Null":typeof(ah=function(_A,n0){try{return _A[n0]}catch{}}(_u=_r(ga),_t))=="string"?ah:_i?$(_u):(_h=$(_u))=="Object"&&q(_u.callee)?"Arguments":_h}},8694:(g,b,I)=>{var k=I(5329)("".replace),B=String(Error("zxcasd").stack),q=/\n\s*at [^:]*:[^\n]*/,$=q.test(B);g.exports=function(_t,_r){if($&&typeof _t=="string")for(;_r--;)_t=k(_t,q,"");return _t}},3489:(g,b,I)=>{var k=I(953),B=I(1136),q=I(9677),$=I(5988);g.exports=function(_t,_r,_i){for(var ga=B(_r),_u=$.f,ah=q.f,_h=0;_h<ga.length;_h++){var _A=ga[_h];k(_t,_A)||_i&&k(_i,_A)||_u(_t,_A,ah(_r,_A))}}},4160:(g,b,I)=>{var k=I(5981);g.exports=!k(function(){function B(){}return B.prototype.constructor=null,Object.getPrototypeOf(new B)!==B.prototype})},1046:(g,b,I)=>{var k=I(5143).IteratorPrototype,B=I(9290),q=I(1887),$=I(904),_t=I(2077),_r=function(){return this};g.exports=function(_i,ga,_u,ah){var _h=ga+" Iterator";return _i.prototype=B(k,{next:q(+!ah,_u)}),$(_i,_h,!1,!0),_t[_h]=_r,_i}},2029:(g,b,I)=>{var k=I(5746),B=I(5988),q=I(1887);g.exports=k?function($,_t,_r){return B.f($,_t,q(1,_r))}:function($,_t,_r){return $[_t]=_r,$}},1887:g=>{g.exports=function(b,I){return{enumerable:!(1&b),configurable:!(2&b),writable:!(4&b),value:I}}},7771:(g,b,I)=>{var k=I(6887),B=I(8834),q=I(2529),$=I(9417),_t=I(7475),_r=I(1046),_i=I(249),ga=I(8929),_u=I(904),ah=I(2029),_h=I(9754),_A=I(9813),n0=I(2077),f0=I(5143),E0=$.PROPER,m0=$.CONFIGURABLE,V0=f0.IteratorPrototype,D0=f0.BUGGY_SAFARI_ITERATORS,j0=_A("iterator"),c0="keys",_m="values",t0="entries",s0=function(){return this};g.exports=function(P0,Rv,e0,l0,w0,B0,g0){_r(e0,Rv,l0);var _n,_l,_p,p0=function(g1){if(g1===w0&&LI)return LI;if(!D0&&g1 in rI)return rI[g1];switch(g1){case c0:case _m:case t0:return function(){return new e0(this,g1)}}return function(){return new e0(this)}},L0=Rv+" Iterator",oI=!1,rI=P0.prototype,cI=rI[j0]||rI["@@iterator"]||w0&&rI[w0],LI=!D0&&cI||p0(w0),x1=Rv=="Array"&&rI.entries||cI;if(x1&&(_n=_i(x1.call(new P0)))!==Object.prototype&&_n.next&&(q||_i(_n)===V0||(ga?ga(_n,V0):_t(_n[j0])||_h(_n,j0,s0)),_u(_n,L0,!0,!0),q&&(n0[L0]=s0)),E0&&w0==_m&&cI&&cI.name!==_m&&(!q&&m0?ah(rI,"name",_m):(oI=!0,LI=function(){return B(cI,this)})),w0)if(_l={values:p0(_m),keys:B0?LI:p0(c0),entries:p0(t0)},g0)for(_p in _l)(D0||oI||!(_p in rI))&&_h(rI,_p,_l[_p]);else k({target:Rv,proto:!0,forced:D0||oI},_l);return q&&!g0||rI[j0]===LI||_h(rI,j0,LI,{name:w0}),n0[Rv]=LI,_l}},5746:(g,b,I)=>{var k=I(5981);g.exports=!k(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},1333:(g,b,I)=>{var k=I(1899),B=I(941),q=k.document,$=B(q)&&B(q.createElement);g.exports=function(_t){return $?q.createElement(_t):{}}},3281:g=>{g.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:g=>{g.exports=typeof window=="object"},4470:(g,b,I)=>{var k=I(2861),B=I(1899);g.exports=/ipad|iphone|ipod/i.test(k)&&B.Pebble!==void 0},2749:(g,b,I)=>{var k=I(2861);g.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(k)},6049:(g,b,I)=>{var k=I(2532),B=I(1899);g.exports=k(B.process)=="process"},8045:(g,b,I)=>{var k=I(2861);g.exports=/web0s(?!.*chrome)/i.test(k)},2861:(g,b,I)=>{var k=I(626);g.exports=k("navigator","userAgent")||""},3385:(g,b,I)=>{var k,B,q=I(1899),$=I(2861),_t=q.process,_r=q.Deno,_i=_t&&_t.versions||_r&&_r.version,ga=_i&&_i.v8;ga&&(B=(k=ga.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!B&&$&&(!(k=$.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=$.match(/Chrome\/(\d+)/))&&(B=+k[1]),g.exports=B},6759:g=>{g.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8780:(g,b,I)=>{var k=I(5981),B=I(1887);g.exports=!k(function(){var q=Error("a");return!("stack"in q)||(Object.defineProperty(q,"stack",B(1,7)),q.stack!==7)})},6887:(g,b,I)=>{var k=I(1899),B=I(9730),q=I(5329),$=I(7475),_t=I(9677).f,_r=I(7252),_i=I(4058),ga=I(6843),_u=I(2029),ah=I(953),_h=function(_A){var n0=function(f0,E0,m0){if(this instanceof n0){switch(arguments.length){case 0:return new _A;case 1:return new _A(f0);case 2:return new _A(f0,E0)}return new _A(f0,E0,m0)}return B(_A,this,arguments)};return n0.prototype=_A.prototype,n0};g.exports=function(_A,n0){var f0,E0,m0,V0,D0,j0,c0,_m,t0=_A.target,s0=_A.global,P0=_A.stat,Rv=_A.proto,e0=s0?k:P0?k[t0]:(k[t0]||{}).prototype,l0=s0?_i:_i[t0]||_u(_i,t0,{})[t0],w0=l0.prototype;for(m0 in n0)f0=!_r(s0?m0:t0+(P0?".":"#")+m0,_A.forced)&&e0&&ah(e0,m0),D0=l0[m0],f0&&(j0=_A.noTargetGet?(_m=_t(e0,m0))&&_m.value:e0[m0]),V0=f0&&j0?j0:n0[m0],f0&&typeof D0==typeof V0||(c0=_A.bind&&f0?ga(V0,k):_A.wrap&&f0?_h(V0):Rv&&$(V0)?q(V0):V0,(_A.sham||V0&&V0.sham||D0&&D0.sham)&&_u(c0,"sham",!0),_u(l0,m0,c0),Rv&&(ah(_i,E0=t0+"Prototype")||_u(_i,E0,{}),_u(_i[E0],m0,V0),_A.real&&w0&&!w0[m0]&&_u(w0,m0,V0)))}},5981:g=>{g.exports=function(b){try{return!!b()}catch{return!0}}},9730:(g,b,I)=>{var k=I(8285),B=Function.prototype,q=B.apply,$=B.call;g.exports=typeof Reflect=="object"&&Reflect.apply||(k?$.bind(q):function(){return $.apply(q,arguments)})},6843:(g,b,I)=>{var k=I(5329),B=I(4883),q=I(8285),$=k(k.bind);g.exports=function(_t,_r){return B(_t),_r===void 0?_t:q?$(_t,_r):function(){return _t.apply(_r,arguments)}}},8285:(g,b,I)=>{var k=I(5981);g.exports=!k(function(){var B=function(){}.bind();return typeof B!="function"||B.hasOwnProperty("prototype")})},8834:(g,b,I)=>{var k=I(8285),B=Function.prototype.call;g.exports=k?B.bind(B):function(){return B.apply(B,arguments)}},9417:(g,b,I)=>{var k=I(5746),B=I(953),q=Function.prototype,$=k&&Object.getOwnPropertyDescriptor,_t=B(q,"name"),_r=_t&&function(){}.name==="something",_i=_t&&(!k||k&&$(q,"name").configurable);g.exports={EXISTS:_t,PROPER:_r,CONFIGURABLE:_i}},5329:(g,b,I)=>{var k=I(8285),B=Function.prototype,q=B.bind,$=B.call,_t=k&&q.bind($,$);g.exports=k?function(_r){return _r&&_t(_r)}:function(_r){return _r&&function(){return $.apply(_r,arguments)}}},626:(g,b,I)=>{var k=I(4058),B=I(1899),q=I(7475),$=function(_t){return q(_t)?_t:void 0};g.exports=function(_t,_r){return arguments.length<2?$(k[_t])||$(B[_t]):k[_t]&&k[_t][_r]||B[_t]&&B[_t][_r]}},2902:(g,b,I)=>{var k=I(9697),B=I(4229),q=I(2077),$=I(9813)("iterator");g.exports=function(_t){if(_t!=null)return B(_t,$)||B(_t,"@@iterator")||q[k(_t)]}},429:(g,b,I)=>{var k=I(1899),B=I(8834),q=I(4883),$=I(6059),_t=I(9826),_r=I(2902),_i=k.TypeError;g.exports=function(ga,_u){var ah=arguments.length<2?_r(ga):_u;if(q(ah))return $(B(ah,ga));throw _i(_t(ga)+" is not iterable")}},4229:(g,b,I)=>{var k=I(4883);g.exports=function(B,q){var $=B[q];return $==null?void 0:k($)}},1899:(g,b,I)=>{var k=function(B){return B&&B.Math==Math&&B};g.exports=k(typeof globalThis=="object"&&globalThis)||k(typeof window=="object"&&window)||k(typeof self=="object"&&self)||k(typeof I.g=="object"&&I.g)||function(){return this}()||Function("return this")()},953:(g,b,I)=>{var k=I(5329),B=I(9678),q=k({}.hasOwnProperty);g.exports=Object.hasOwn||function($,_t){return q(B($),_t)}},7748:g=>{g.exports={}},4845:(g,b,I)=>{var k=I(1899);g.exports=function(B,q){var $=k.console;$&&$.error&&(arguments.length==1?$.error(B):$.error(B,q))}},5463:(g,b,I)=>{var k=I(626);g.exports=k("document","documentElement")},2840:(g,b,I)=>{var k=I(5746),B=I(5981),q=I(1333);g.exports=!k&&!B(function(){return Object.defineProperty(q("div"),"a",{get:function(){return 7}}).a!=7})},7026:(g,b,I)=>{var k=I(1899),B=I(5329),q=I(5981),$=I(2532),_t=k.Object,_r=B("".split);g.exports=q(function(){return!_t("z").propertyIsEnumerable(0)})?function(_i){return $(_i)=="String"?_r(_i,""):_t(_i)}:_t},1302:(g,b,I)=>{var k=I(5329),B=I(7475),q=I(3030),$=k(Function.toString);B(q.inspectSource)||(q.inspectSource=function(_t){return $(_t)}),g.exports=q.inspectSource},3794:(g,b,I)=>{var k=I(941),B=I(2029);g.exports=function(q,$){k($)&&"cause"in $&&B(q,"cause",$.cause)}},5402:(g,b,I)=>{var k,B,q,$=I(8019),_t=I(1899),_r=I(5329),_i=I(941),ga=I(2029),_u=I(953),ah=I(3030),_h=I(4262),_A=I(7748),n0="Object already initialized",f0=_t.TypeError,E0=_t.WeakMap;if($||ah.state){var m0=ah.state||(ah.state=new E0),V0=_r(m0.get),D0=_r(m0.has),j0=_r(m0.set);k=function(_m,t0){if(D0(m0,_m))throw new f0(n0);return t0.facade=_m,j0(m0,_m,t0),t0},B=function(_m){return V0(m0,_m)||{}},q=function(_m){return D0(m0,_m)}}else{var c0=_h("state");_A[c0]=!0,k=function(_m,t0){if(_u(_m,c0))throw new f0(n0);return t0.facade=_m,ga(_m,c0,t0),t0},B=function(_m){return _u(_m,c0)?_m[c0]:{}},q=function(_m){return _u(_m,c0)}}g.exports={set:k,get:B,has:q,enforce:function(_m){return q(_m)?B(_m):k(_m,{})},getterFor:function(_m){return function(t0){var s0;if(!_i(t0)||(s0=B(t0)).type!==_m)throw f0("Incompatible receiver, "+_m+" required");return s0}}}},6782:(g,b,I)=>{var k=I(9813),B=I(2077),q=k("iterator"),$=Array.prototype;g.exports=function(_t){return _t!==void 0&&(B.Array===_t||$[q]===_t)}},7475:g=>{g.exports=function(b){return typeof b=="function"}},4284:(g,b,I)=>{var k=I(5329),B=I(5981),q=I(7475),$=I(9697),_t=I(626),_r=I(1302),_i=function(){},ga=[],_u=_t("Reflect","construct"),ah=/^\s*(?:class|function)\b/,_h=k(ah.exec),_A=!ah.exec(_i),n0=function(E0){if(!q(E0))return!1;try{return _u(_i,ga,E0),!0}catch{return!1}},f0=function(E0){if(!q(E0))return!1;switch($(E0)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _A||!!_h(ah,_r(E0))}catch{return!0}};f0.sham=!0,g.exports=!_u||B(function(){var E0;return n0(n0.call)||!n0(Object)||!n0(function(){E0=!0})||E0})?f0:n0},7252:(g,b,I)=>{var k=I(5981),B=I(7475),q=/#|\.prototype\./,$=function(_u,ah){var _h=_r[_t(_u)];return _h==ga||_h!=_i&&(B(ah)?k(ah):!!ah)},_t=$.normalize=function(_u){return String(_u).replace(q,".").toLowerCase()},_r=$.data={},_i=$.NATIVE="N",ga=$.POLYFILL="P";g.exports=$},941:(g,b,I)=>{var k=I(7475);g.exports=function(B){return typeof B=="object"?B!==null:k(B)}},2529:g=>{g.exports=!0},6664:(g,b,I)=>{var k=I(1899),B=I(626),q=I(7475),$=I(7046),_t=I(2302),_r=k.Object;g.exports=_t?function(_i){return typeof _i=="symbol"}:function(_i){var ga=B("Symbol");return q(ga)&&$(ga.prototype,_r(_i))}},3091:(g,b,I)=>{var k=I(1899),B=I(6843),q=I(8834),$=I(6059),_t=I(9826),_r=I(6782),_i=I(623),ga=I(7046),_u=I(429),ah=I(2902),_h=I(7609),_A=k.TypeError,n0=function(E0,m0){this.stopped=E0,this.result=m0},f0=n0.prototype;g.exports=function(E0,m0,V0){var D0,j0,c0,_m,t0,s0,P0,Rv=V0&&V0.that,e0=!(!V0||!V0.AS_ENTRIES),l0=!(!V0||!V0.IS_ITERATOR),w0=!(!V0||!V0.INTERRUPTED),B0=B(m0,Rv),g0=function(_l){return D0&&_h(D0,"normal",_l),new n0(!0,_l)},_n=function(_l){return e0?($(_l),w0?B0(_l[0],_l[1],g0):B0(_l[0],_l[1])):w0?B0(_l,g0):B0(_l)};if(l0)D0=E0;else{if(!(j0=ah(E0)))throw _A(_t(E0)+" is not iterable");if(_r(j0)){for(c0=0,_m=_i(E0);_m>c0;c0++)if((t0=_n(E0[c0]))&&ga(f0,t0))return t0;return new n0(!1)}D0=_u(E0,j0)}for(s0=D0.next;!(P0=q(s0,D0)).done;){try{t0=_n(P0.value)}catch(_l){_h(D0,"throw",_l)}if(typeof t0=="object"&&t0&&ga(f0,t0))return t0}return new n0(!1)}},7609:(g,b,I)=>{var k=I(8834),B=I(6059),q=I(4229);g.exports=function($,_t,_r){var _i,ga;B($);try{if(!(_i=q($,"return"))){if(_t==="throw")throw _r;return _r}_i=k(_i,$)}catch(_u){ga=!0,_i=_u}if(_t==="throw")throw _r;if(ga)throw _i;return B(_i),_r}},5143:(g,b,I)=>{var k,B,q,$=I(5981),_t=I(7475),_r=I(9290),_i=I(249),ga=I(9754),_u=I(9813),ah=I(2529),_h=_u("iterator"),_A=!1;[].keys&&("next"in(q=[].keys())?(B=_i(_i(q)))!==Object.prototype&&(k=B):_A=!0),k==null||$(function(){var n0={};return k[_h].call(n0)!==n0})?k={}:ah&&(k=_r(k)),_t(k[_h])||ga(k,_h,function(){return this}),g.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:_A}},2077:g=>{g.exports={}},623:(g,b,I)=>{var k=I(3057);g.exports=function(B){return k(B.length)}},6132:(g,b,I)=>{var k,B,q,$,_t,_r,_i,ga,_u=I(1899),ah=I(6843),_h=I(9677).f,_A=I(2941).set,n0=I(2749),f0=I(4470),E0=I(8045),m0=I(6049),V0=_u.MutationObserver||_u.WebKitMutationObserver,D0=_u.document,j0=_u.process,c0=_u.Promise,_m=_h(_u,"queueMicrotask"),t0=_m&&_m.value;t0||(k=function(){var s0,P0;for(m0&&(s0=j0.domain)&&s0.exit();B;){P0=B.fn,B=B.next;try{P0()}catch(Rv){throw B?$():q=void 0,Rv}}q=void 0,s0&&s0.enter()},n0||m0||E0||!V0||!D0?!f0&&c0&&c0.resolve?((_i=c0.resolve(void 0)).constructor=c0,ga=ah(_i.then,_i),$=function(){ga(k)}):m0?$=function(){j0.nextTick(k)}:(_A=ah(_A,_u),$=function(){_A(k)}):(_t=!0,_r=D0.createTextNode(""),new V0(k).observe(_r,{characterData:!0}),$=function(){_r.data=_t=!_t})),g.exports=t0||function(s0){var P0={fn:s0,next:void 0};q&&(q.next=P0),B||(B=P0,$()),q=P0}},9297:(g,b,I)=>{var k=I(1899);g.exports=k.Promise},2497:(g,b,I)=>{var k=I(3385),B=I(5981);g.exports=!!Object.getOwnPropertySymbols&&!B(function(){var q=Symbol();return!String(q)||!(Object(q)instanceof Symbol)||!Symbol.sham&&k&&k<41})},8019:(g,b,I)=>{var k=I(1899),B=I(7475),q=I(1302),$=k.WeakMap;g.exports=B($)&&/native code/.test(q($))},9520:(g,b,I)=>{var k=I(4883),B=function(q){var $,_t;this.promise=new q(function(_r,_i){if($!==void 0||_t!==void 0)throw TypeError("Bad Promise constructor");$=_r,_t=_i}),this.resolve=k($),this.reject=k(_t)};g.exports.f=function(q){return new B(q)}},4649:(g,b,I)=>{var k=I(5803);g.exports=function(B,q){return B===void 0?arguments.length<2?"":q:k(B)}},9290:(g,b,I)=>{var k,B=I(6059),q=I(9938),$=I(6759),_t=I(7748),_r=I(5463),_i=I(1333),ga=I(4262)("IE_PROTO"),_u=function(){},ah=function(n0){return"<script>"+n0+"<\/script>"},_h=function(n0){n0.write(ah("")),n0.close();var f0=n0.parentWindow.Object;return n0=null,f0},_A=function(){try{k=new ActiveXObject("htmlfile")}catch{}var n0,f0;_A=typeof document!="undefined"?document.domain&&k?_h(k):((f0=_i("iframe")).style.display="none",_r.appendChild(f0),f0.src=String("javascript:"),(n0=f0.contentWindow.document).open(),n0.write(ah("document.F=Object")),n0.close(),n0.F):_h(k);for(var E0=$.length;E0--;)delete _A.prototype[$[E0]];return _A()};_t[ga]=!0,g.exports=Object.create||function(n0,f0){var E0;return n0!==null?(_u.prototype=B(n0),E0=new _u,_u.prototype=null,E0[ga]=n0):E0=_A(),f0===void 0?E0:q.f(E0,f0)}},9938:(g,b,I)=>{var k=I(5746),B=I(3937),q=I(5988),$=I(6059),_t=I(4529),_r=I(4771);b.f=k&&!B?Object.defineProperties:function(_i,ga){$(_i);for(var _u,ah=_t(ga),_h=_r(ga),_A=_h.length,n0=0;_A>n0;)q.f(_i,_u=_h[n0++],ah[_u]);return _i}},5988:(g,b,I)=>{var k=I(1899),B=I(5746),q=I(2840),$=I(3937),_t=I(6059),_r=I(3894),_i=k.TypeError,ga=Object.defineProperty,_u=Object.getOwnPropertyDescriptor;b.f=B?$?function(ah,_h,_A){if(_t(ah),_h=_r(_h),_t(_A),typeof ah=="function"&&_h==="prototype"&&"value"in _A&&"writable"in _A&&!_A.writable){var n0=_u(ah,_h);n0&&n0.writable&&(ah[_h]=_A.value,_A={configurable:"configurable"in _A?_A.configurable:n0.configurable,enumerable:"enumerable"in _A?_A.enumerable:n0.enumerable,writable:!1})}return ga(ah,_h,_A)}:ga:function(ah,_h,_A){if(_t(ah),_h=_r(_h),_t(_A),q)try{return ga(ah,_h,_A)}catch{}if("get"in _A||"set"in _A)throw _i("Accessors not supported");return"value"in _A&&(ah[_h]=_A.value),ah}},9677:(g,b,I)=>{var k=I(5746),B=I(8834),q=I(6760),$=I(1887),_t=I(4529),_r=I(3894),_i=I(953),ga=I(2840),_u=Object.getOwnPropertyDescriptor;b.f=k?_u:function(ah,_h){if(ah=_t(ah),_h=_r(_h),ga)try{return _u(ah,_h)}catch{}if(_i(ah,_h))return $(!B(q.f,ah,_h),ah[_h])}},946:(g,b,I)=>{var k=I(5629),B=I(6759).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(q){return k(q,B)}},7857:(g,b)=>{b.f=Object.getOwnPropertySymbols},249:(g,b,I)=>{var k=I(1899),B=I(953),q=I(7475),$=I(9678),_t=I(4262),_r=I(4160),_i=_t("IE_PROTO"),ga=k.Object,_u=ga.prototype;g.exports=_r?ga.getPrototypeOf:function(ah){var _h=$(ah);if(B(_h,_i))return _h[_i];var _A=_h.constructor;return q(_A)&&_h instanceof _A?_A.prototype:_h instanceof ga?_u:null}},7046:(g,b,I)=>{var k=I(5329);g.exports=k({}.isPrototypeOf)},5629:(g,b,I)=>{var k=I(5329),B=I(953),q=I(4529),$=I(1692).indexOf,_t=I(7748),_r=k([].push);g.exports=function(_i,ga){var _u,ah=q(_i),_h=0,_A=[];for(_u in ah)!B(_t,_u)&&B(ah,_u)&&_r(_A,_u);for(;ga.length>_h;)B(ah,_u=ga[_h++])&&(~$(_A,_u)||_r(_A,_u));return _A}},4771:(g,b,I)=>{var k=I(5629),B=I(6759);g.exports=Object.keys||function(q){return k(q,B)}},6760:(g,b)=>{var I={}.propertyIsEnumerable,k=Object.getOwnPropertyDescriptor,B=k&&!I.call({1:2},1);b.f=B?function(q){var $=k(this,q);return!!$&&$.enumerable}:I},8929:(g,b,I)=>{var k=I(5329),B=I(6059),q=I(1851);g.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var $,_t=!1,_r={};try{($=k(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(_r,[]),_t=_r instanceof Array}catch{}return function(_i,ga){return B(_i),q(ga),_t?$(_i,ga):_i.__proto__=ga,_i}}():void 0)},5623:(g,b,I)=>{var k=I(2885),B=I(9697);g.exports=k?{}.toString:function(){return"[object "+B(this)+"]"}},9811:(g,b,I)=>{var k=I(1899),B=I(8834),q=I(7475),$=I(941),_t=k.TypeError;g.exports=function(_r,_i){var ga,_u;if(_i==="string"&&q(ga=_r.toString)&&!$(_u=B(ga,_r))||q(ga=_r.valueOf)&&!$(_u=B(ga,_r))||_i!=="string"&&q(ga=_r.toString)&&!$(_u=B(ga,_r)))return _u;throw _t("Can't convert object to primitive value")}},1136:(g,b,I)=>{var k=I(626),B=I(5329),q=I(946),$=I(7857),_t=I(6059),_r=B([].concat);g.exports=k("Reflect","ownKeys")||function(_i){var ga=q.f(_t(_i)),_u=$.f;return _u?_r(ga,_u(_i)):ga}},4058:g=>{g.exports={}},2:g=>{g.exports=function(b){try{return{error:!1,value:b()}}catch(I){return{error:!0,value:I}}}},6584:(g,b,I)=>{var k=I(6059),B=I(941),q=I(9520);g.exports=function($,_t){if(k($),B(_t)&&_t.constructor===$)return _t;var _r=q.f($);return(0,_r.resolve)(_t),_r.promise}},8397:g=>{var b=function(){this.head=null,this.tail=null};b.prototype={add:function(I){var k={item:I,next:null};this.head?this.tail.next=k:this.head=k,this.tail=k},get:function(){var I=this.head;if(I)return this.head=I.next,this.tail===I&&(this.tail=null),I.item}},g.exports=b},7524:(g,b,I)=>{var k=I(9754);g.exports=function(B,q,$){for(var _t in q)$&&$.unsafe&&B[_t]?B[_t]=q[_t]:k(B,_t,q[_t],$);return B}},9754:(g,b,I)=>{var k=I(2029);g.exports=function(B,q,$,_t){_t&&_t.enumerable?B[q]=$:k(B,q,$)}},8219:(g,b,I)=>{var k=I(1899).TypeError;g.exports=function(B){if(B==null)throw k("Can't call method on "+B);return B}},4911:(g,b,I)=>{var k=I(1899),B=Object.defineProperty;g.exports=function(q,$){try{B(k,q,{value:$,configurable:!0,writable:!0})}catch{k[q]=$}return $}},4431:(g,b,I)=>{var k=I(626),B=I(5988),q=I(9813),$=I(5746),_t=q("species");g.exports=function(_r){var _i=k(_r),ga=B.f;$&&_i&&!_i[_t]&&ga(_i,_t,{configurable:!0,get:function(){return this}})}},904:(g,b,I)=>{var k=I(2885),B=I(5988).f,q=I(2029),$=I(953),_t=I(5623),_r=I(9813)("toStringTag");g.exports=function(_i,ga,_u,ah){if(_i){var _h=_u?_i:_i.prototype;$(_h,_r)||B(_h,_r,{configurable:!0,value:ga}),ah&&!k&&q(_h,"toString",_t)}}},4262:(g,b,I)=>{var k=I(8726),B=I(9418),q=k("keys");g.exports=function($){return q[$]||(q[$]=B($))}},3030:(g,b,I)=>{var k=I(1899),B=I(4911),q="__core-js_shared__",$=k[q]||B(q,{});g.exports=$},8726:(g,b,I)=>{var k=I(2529),B=I(3030);(g.exports=function(q,$){return B[q]||(B[q]=$!==void 0?$:{})})("versions",[]).push({version:"3.20.3",mode:k?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(g,b,I)=>{var k=I(6059),B=I(174),q=I(9813)("species");g.exports=function($,_t){var _r,_i=k($).constructor;return _i===void 0||(_r=k(_i)[q])==null?_t:B(_r)}},4620:(g,b,I)=>{var k=I(5329),B=I(2435),q=I(5803),$=I(8219),_t=k("".charAt),_r=k("".charCodeAt),_i=k("".slice),ga=function(_u){return function(ah,_h){var _A,n0,f0=q($(ah)),E0=B(_h),m0=f0.length;return E0<0||E0>=m0?_u?"":void 0:(_A=_r(f0,E0))<55296||_A>56319||E0+1===m0||(n0=_r(f0,E0+1))<56320||n0>57343?_u?_t(f0,E0):_A:_u?_i(f0,E0,E0+2):n0-56320+(_A-55296<<10)+65536}};g.exports={codeAt:ga(!1),charAt:ga(!0)}},2941:(g,b,I)=>{var k,B,q,$,_t=I(1899),_r=I(9730),_i=I(6843),ga=I(7475),_u=I(953),ah=I(5981),_h=I(5463),_A=I(3765),n0=I(1333),f0=I(2749),E0=I(6049),m0=_t.setImmediate,V0=_t.clearImmediate,D0=_t.process,j0=_t.Dispatch,c0=_t.Function,_m=_t.MessageChannel,t0=_t.String,s0=0,P0={};try{k=_t.location}catch{}var Rv=function(B0){if(_u(P0,B0)){var g0=P0[B0];delete P0[B0],g0()}},e0=function(B0){return function(){Rv(B0)}},l0=function(B0){Rv(B0.data)},w0=function(B0){_t.postMessage(t0(B0),k.protocol+"//"+k.host)};m0&&V0||(m0=function(B0){var g0=_A(arguments,1);return P0[++s0]=function(){_r(ga(B0)?B0:c0(B0),void 0,g0)},B(s0),s0},V0=function(B0){delete P0[B0]},E0?B=function(B0){D0.nextTick(e0(B0))}:j0&&j0.now?B=function(B0){j0.now(e0(B0))}:_m&&!f0?($=(q=new _m).port2,q.port1.onmessage=l0,B=_i($.postMessage,$)):_t.addEventListener&&ga(_t.postMessage)&&!_t.importScripts&&k&&k.protocol!=="file:"&&!ah(w0)?(B=w0,_t.addEventListener("message",l0,!1)):B="onreadystatechange"in n0("script")?function(B0){_h.appendChild(n0("script")).onreadystatechange=function(){_h.removeChild(this),Rv(B0)}}:function(B0){setTimeout(e0(B0),0)}),g.exports={set:m0,clear:V0}},9413:(g,b,I)=>{var k=I(2435),B=Math.max,q=Math.min;g.exports=function($,_t){var _r=k($);return _r<0?B(_r+_t,0):q(_r,_t)}},4529:(g,b,I)=>{var k=I(7026),B=I(8219);g.exports=function(q){return k(B(q))}},2435:g=>{var b=Math.ceil,I=Math.floor;g.exports=function(k){var B=+k;return B!=B||B===0?0:(B>0?I:b)(B)}},3057:(g,b,I)=>{var k=I(2435),B=Math.min;g.exports=function(q){return q>0?B(k(q),9007199254740991):0}},9678:(g,b,I)=>{var k=I(1899),B=I(8219),q=k.Object;g.exports=function($){return q(B($))}},6935:(g,b,I)=>{var k=I(1899),B=I(8834),q=I(941),$=I(6664),_t=I(4229),_r=I(9811),_i=I(9813),ga=k.TypeError,_u=_i("toPrimitive");g.exports=function(ah,_h){if(!q(ah)||$(ah))return ah;var _A,n0=_t(ah,_u);if(n0){if(_h===void 0&&(_h="default"),_A=B(n0,ah,_h),!q(_A)||$(_A))return _A;throw ga("Can't convert object to primitive value")}return _h===void 0&&(_h="number"),_r(ah,_h)}},3894:(g,b,I)=>{var k=I(6935),B=I(6664);g.exports=function(q){var $=k(q,"string");return B($)?$:$+""}},2885:(g,b,I)=>{var k={};k[I(9813)("toStringTag")]="z",g.exports=String(k)==="[object z]"},5803:(g,b,I)=>{var k=I(1899),B=I(9697),q=k.String;g.exports=function($){if(B($)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return q($)}},9826:(g,b,I)=>{var k=I(1899).String;g.exports=function(B){try{return k(B)}catch{return"Object"}}},9418:(g,b,I)=>{var k=I(5329),B=0,q=Math.random(),$=k(1 .toString);g.exports=function(_t){return"Symbol("+(_t===void 0?"":_t)+")_"+$(++B+q,36)}},2302:(g,b,I)=>{var k=I(2497);g.exports=k&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3937:(g,b,I)=>{var k=I(5746),B=I(5981);g.exports=k&&B(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},9813:(g,b,I)=>{var k=I(1899),B=I(8726),q=I(953),$=I(9418),_t=I(2497),_r=I(2302),_i=B("wks"),ga=k.Symbol,_u=ga&&ga.for,ah=_r?ga:ga&&ga.withoutSetter||$;g.exports=function(_h){if(!q(_i,_h)||!_t&&typeof _i[_h]!="string"){var _A="Symbol."+_h;_t&&q(ga,_h)?_i[_h]=ga[_h]:_i[_h]=_r&&_u?_u(_A):ah(_A)}return _i[_h]}},7627:(g,b,I)=>{var k=I(6887),B=I(1899),q=I(7046),$=I(249),_t=I(8929),_r=I(3489),_i=I(9290),ga=I(2029),_u=I(1887),ah=I(8694),_h=I(3794),_A=I(3091),n0=I(4649),f0=I(9813),E0=I(8780),m0=f0("toStringTag"),V0=B.Error,D0=[].push,j0=function(_m,t0){var s0,P0=arguments.length>2?arguments[2]:void 0,Rv=q(c0,this);_t?s0=_t(new V0,Rv?$(this):c0):(s0=Rv?this:_i(c0),ga(s0,m0,"Error")),t0!==void 0&&ga(s0,"message",n0(t0)),E0&&ga(s0,"stack",ah(s0.stack,1)),_h(s0,P0);var e0=[];return _A(_m,D0,{that:e0}),ga(s0,"errors",e0),s0};_t?_t(j0,V0):_r(j0,V0,{name:!0});var c0=j0.prototype=_i(V0.prototype,{constructor:_u(1,j0),message:_u(1,""),name:_u(1,"AggregateError")});k({global:!0},{AggregateError:j0})},6274:(g,b,I)=>{var k=I(4529),B=I(8479),q=I(2077),$=I(5402),_t=I(5988).f,_r=I(7771),_i=I(2529),ga=I(5746),_u="Array Iterator",ah=$.set,_h=$.getterFor(_u);g.exports=_r(Array,"Array",function(n0,f0){ah(this,{type:_u,target:k(n0),index:0,kind:f0})},function(){var n0=_h(this),f0=n0.target,E0=n0.kind,m0=n0.index++;return!f0||m0>=f0.length?(n0.target=void 0,{value:void 0,done:!0}):E0=="keys"?{value:m0,done:!1}:E0=="values"?{value:f0[m0],done:!1}:{value:[m0,f0[m0]],done:!1}},"values");var _A=q.Arguments=q.Array;if(B("keys"),B("values"),B("entries"),!_i&&ga&&_A.name!=="values")try{_t(_A,"name",{value:"values"})}catch{}},6450:(g,b,I)=>{var k=I(6887),B=I(5746),q=I(5988).f;k({target:"Object",stat:!0,forced:Object.defineProperty!==q,sham:!B},{defineProperty:q})},5967:()=>{},4560:(g,b,I)=>{var k=I(6887),B=I(8834),q=I(4883),$=I(9520),_t=I(2),_r=I(3091);k({target:"Promise",stat:!0},{allSettled:function(_i){var ga=this,_u=$.f(ga),ah=_u.resolve,_h=_u.reject,_A=_t(function(){var n0=q(ga.resolve),f0=[],E0=0,m0=1;_r(_i,function(V0){var D0=E0++,j0=!1;m0++,B(n0,ga,V0).then(function(c0){j0||(j0=!0,f0[D0]={status:"fulfilled",value:c0},--m0||ah(f0))},function(c0){j0||(j0=!0,f0[D0]={status:"rejected",reason:c0},--m0||ah(f0))})}),--m0||ah(f0)});return _A.error&&_h(_A.value),_u.promise}})},7206:(g,b,I)=>{var k=I(6887),B=I(4883),q=I(626),$=I(8834),_t=I(9520),_r=I(2),_i=I(3091),ga="No one promise resolved";k({target:"Promise",stat:!0},{any:function(_u){var ah=this,_h=q("AggregateError"),_A=_t.f(ah),n0=_A.resolve,f0=_A.reject,E0=_r(function(){var m0=B(ah.resolve),V0=[],D0=0,j0=1,c0=!1;_i(_u,function(_m){var t0=D0++,s0=!1;j0++,$(m0,ah,_m).then(function(P0){s0||c0||(c0=!0,n0(P0))},function(P0){s0||c0||(s0=!0,V0[t0]=P0,--j0||f0(new _h(V0,ga)))})}),--j0||f0(new _h(V0,ga))});return E0.error&&f0(E0.value),_A.promise}})},4349:(g,b,I)=>{var k=I(6887),B=I(2529),q=I(9297),$=I(5981),_t=I(626),_r=I(7475),_i=I(487),ga=I(6584),_u=I(9754);if(k({target:"Promise",proto:!0,real:!0,forced:!!q&&$(function(){q.prototype.finally.call({then:function(){}},function(){})})},{finally:function(_h){var _A=_i(this,_t("Promise")),n0=_r(_h);return this.then(n0?function(f0){return ga(_A,_h()).then(function(){return f0})}:_h,n0?function(f0){return ga(_A,_h()).then(function(){throw f0})}:_h)}}),!B&&_r(q)){var ah=_t("Promise").prototype.finally;q.prototype.finally!==ah&&_u(q.prototype,"finally",ah,{unsafe:!0})}},8881:(g,b,I)=>{var k,B,q,$,_t=I(6887),_r=I(2529),_i=I(1899),ga=I(626),_u=I(8834),ah=I(9297),_h=I(9754),_A=I(7524),n0=I(8929),f0=I(904),E0=I(4431),m0=I(4883),V0=I(7475),D0=I(941),j0=I(5743),c0=I(1302),_m=I(3091),t0=I(1385),s0=I(487),P0=I(2941).set,Rv=I(6132),e0=I(6584),l0=I(4845),w0=I(9520),B0=I(2),g0=I(8397),_n=I(5402),_l=I(7252),_p=I(9813),p0=I(3321),L0=I(6049),oI=I(3385),rI=_p("species"),cI="Promise",LI=_n.getterFor(cI),x1=_n.set,g1=_n.getterFor(cI),FI=ah&&ah.prototype,BI=ah,u1=FI,n_=_i.TypeError,v_=_i.document,s1=_i.process,iR=w0.f,h8=iR,i0=!!(v_&&v_.createEvent&&_i.dispatchEvent),_d=V0(_i.PromiseRejectionEvent),Pv="unhandledrejection",d0=!1,o0=_l(cI,function(){var F0=c0(BI),K0=F0!==String(BI);if(!K0&&oI===66||_r&&!u1.finally)return!0;if(oI>=51&&/native code/.test(F0))return!1;var uI=new BI(function(E1){E1(1)}),PI=function(E1){E1(function(){},function(){})};return(uI.constructor={})[rI]=PI,!(d0=uI.then(function(){})instanceof PI)||!K0&&p0&&!_d}),N0=o0||!t0(function(F0){BI.all(F0).catch(function(){})}),S0=function(F0){var K0;return!(!D0(F0)||!V0(K0=F0.then))&&K0},q0=function(F0,K0){var uI,PI,E1,kS=K0.value,B2=K0.state==1,bT=B2?F0.ok:F0.fail,i3=F0.resolve,kR=F0.reject,DR=F0.domain;try{bT?(B2||(K0.rejection===2&&iI(K0),K0.rejection=1),bT===!0?uI=kS:(DR&&DR.enter(),uI=bT(kS),DR&&(DR.exit(),E1=!0)),uI===F0.promise?kR(n_("Promise-chain cycle")):(PI=S0(uI))?_u(PI,uI,i3,kR):i3(uI)):kR(kS)}catch(p8){DR&&!E1&&DR.exit(),kR(p8)}},aI=function(F0,K0){F0.notified||(F0.notified=!0,Rv(function(){for(var uI,PI=F0.reactions;uI=PI.get();)q0(uI,F0);F0.notified=!1,K0&&!F0.rejection&&x0(F0)}))},lI=function(F0,K0,uI){var PI,E1;i0?((PI=v_.createEvent("Event")).promise=K0,PI.reason=uI,PI.initEvent(F0,!1,!0),_i.dispatchEvent(PI)):PI={promise:K0,reason:uI},!_d&&(E1=_i["on"+F0])?E1(PI):F0===Pv&&l0("Unhandled promise rejection",uI)},x0=function(F0){_u(P0,_i,function(){var K0,uI=F0.facade,PI=F0.value;if(W0(F0)&&(K0=B0(function(){L0?s1.emit("unhandledRejection",PI,uI):lI(Pv,uI,PI)}),F0.rejection=L0||W0(F0)?2:1,K0.error))throw K0.value})},W0=function(F0){return F0.rejection!==1&&!F0.parent},iI=function(F0){_u(P0,_i,function(){var K0=F0.facade;L0?s1.emit("rejectionHandled",K0):lI("rejectionhandled",K0,F0.value)})},CI=function(F0,K0,uI){return function(PI){F0(K0,PI,uI)}},zI=function(F0,K0,uI){F0.done||(F0.done=!0,uI&&(F0=uI),F0.value=K0,F0.state=2,aI(F0,!0))},G1=function(F0,K0,uI){if(!F0.done){F0.done=!0,uI&&(F0=uI);try{if(F0.facade===K0)throw n_("Promise can't be resolved itself");var PI=S0(K0);PI?Rv(function(){var E1={done:!1};try{_u(PI,K0,CI(G1,E1,F0),CI(zI,E1,F0))}catch(kS){zI(E1,kS,F0)}}):(F0.value=K0,F0.state=1,aI(F0,!1))}catch(E1){zI({done:!1},E1,F0)}}};if(o0&&(u1=(BI=function(F0){j0(this,u1),m0(F0),_u(k,this);var K0=LI(this);try{F0(CI(G1,K0),CI(zI,K0))}catch(uI){zI(K0,uI)}}).prototype,(k=function(F0){x1(this,{type:cI,done:!1,notified:!1,parent:!1,reactions:new g0,rejection:!1,state:0,value:void 0})}).prototype=_A(u1,{then:function(F0,K0){var uI=g1(this),PI=iR(s0(this,BI));return uI.parent=!0,PI.ok=!V0(F0)||F0,PI.fail=V0(K0)&&K0,PI.domain=L0?s1.domain:void 0,uI.state==0?uI.reactions.add(PI):Rv(function(){q0(PI,uI)}),PI.promise},catch:function(F0){return this.then(void 0,F0)}}),B=function(){var F0=new k,K0=LI(F0);this.promise=F0,this.resolve=CI(G1,K0),this.reject=CI(zI,K0)},w0.f=iR=function(F0){return F0===BI||F0===q?new B(F0):h8(F0)},!_r&&V0(ah)&&FI!==Object.prototype)){$=FI.then,d0||(_h(FI,"then",function(F0,K0){var uI=this;return new BI(function(PI,E1){_u($,uI,PI,E1)}).then(F0,K0)},{unsafe:!0}),_h(FI,"catch",u1.catch,{unsafe:!0}));try{delete FI.constructor}catch{}n0&&n0(FI,u1)}_t({global:!0,wrap:!0,forced:o0},{Promise:BI}),f0(BI,cI,!1,!0),E0(cI),q=ga(cI),_t({target:cI,stat:!0,forced:o0},{reject:function(F0){var K0=iR(this);return _u(K0.reject,void 0,F0),K0.promise}}),_t({target:cI,stat:!0,forced:_r||o0},{resolve:function(F0){return e0(_r&&this===q?BI:this,F0)}}),_t({target:cI,stat:!0,forced:N0},{all:function(F0){var K0=this,uI=iR(K0),PI=uI.resolve,E1=uI.reject,kS=B0(function(){var B2=m0(K0.resolve),bT=[],i3=0,kR=1;_m(F0,function(DR){var p8=i3++,ltt=!1;kR++,_u(B2,K0,DR).then(function(uyt){ltt||(ltt=!0,bT[p8]=uyt,--kR||PI(bT))},E1)}),--kR||PI(bT)});return kS.error&&E1(kS.value),uI.promise},race:function(F0){var K0=this,uI=iR(K0),PI=uI.reject,E1=B0(function(){var kS=m0(K0.resolve);_m(F0,function(B2){_u(kS,K0,B2).then(uI.resolve,PI)})});return E1.error&&PI(E1.value),uI.promise}})},7971:(g,b,I)=>{var k=I(4620).charAt,B=I(5803),q=I(5402),$=I(7771),_t="String Iterator",_r=q.set,_i=q.getterFor(_t);$(String,"String",function(ga){_r(this,{type:_t,string:B(ga),index:0})},function(){var ga,_u=_i(this),ah=_u.string,_h=_u.index;return _h>=ah.length?{value:void 0,done:!0}:(ga=k(ah,_h),_u.index+=ga.length,{value:ga,done:!1})})},7634:(g,b,I)=>{I(6274);var k=I(3281),B=I(1899),q=I(9697),$=I(2029),_t=I(2077),_r=I(9813)("toStringTag");for(var _i in k){var ga=B[_i],_u=ga&&ga.prototype;_u&&q(_u)!==_r&&$(_u,_r,_i),_t[_i]=_t.Array}},1910:(g,b,I)=>{var k=I(8171);g.exports=k},7460:(g,b,I)=>{var k=I(2956);I(7634),g.exports=k},9662:(g,b,I)=>{var k=I(7854),B=I(614),q=I(6330),$=k.TypeError;g.exports=function(_t){if(B(_t))return _t;throw $(q(_t)+" is not a function")}},6077:(g,b,I)=>{var k=I(7854),B=I(614),q=k.String,$=k.TypeError;g.exports=function(_t){if(typeof _t=="object"||B(_t))return _t;throw $("Can't set "+q(_t)+" as a prototype")}},1223:(g,b,I)=>{var k=I(5112),B=I(30),q=I(3070),$=k("unscopables"),_t=Array.prototype;_t[$]==null&&q.f(_t,$,{configurable:!0,value:B(null)}),g.exports=function(_r){_t[$][_r]=!0}},9670:(g,b,I)=>{var k=I(7854),B=I(111),q=k.String,$=k.TypeError;g.exports=function(_t){if(B(_t))return _t;throw $(q(_t)+" is not an object")}},1318:(g,b,I)=>{var k=I(5656),B=I(1400),q=I(6244),$=function(_t){return function(_r,_i,ga){var _u,ah=k(_r),_h=q(ah),_A=B(ga,_h);if(_t&&_i!=_i){for(;_h>_A;)if((_u=ah[_A++])!=_u)return!0}else for(;_h>_A;_A++)if((_t||_A in ah)&&ah[_A]===_i)return _t||_A||0;return!_t&&-1}};g.exports={includes:$(!0),indexOf:$(!1)}},4326:(g,b,I)=>{var k=I(1702),B=k({}.toString),q=k("".slice);g.exports=function($){return q(B($),8,-1)}},648:(g,b,I)=>{var k=I(7854),B=I(1694),q=I(614),$=I(4326),_t=I(5112)("toStringTag"),_r=k.Object,_i=$(function(){return arguments}())=="Arguments";g.exports=B?$:function(ga){var _u,ah,_h;return ga===void 0?"Undefined":ga===null?"Null":typeof(ah=function(_A,n0){try{return _A[n0]}catch{}}(_u=_r(ga),_t))=="string"?ah:_i?$(_u):(_h=$(_u))=="Object"&&q(_u.callee)?"Arguments":_h}},7741:(g,b,I)=>{var k=I(1702)("".replace),B=String(Error("zxcasd").stack),q=/\n\s*at [^:]*:[^\n]*/,$=q.test(B);g.exports=function(_t,_r){if($&&typeof _t=="string")for(;_r--;)_t=k(_t,q,"");return _t}},9920:(g,b,I)=>{var k=I(2597),B=I(3887),q=I(1236),$=I(3070);g.exports=function(_t,_r,_i){for(var ga=B(_r),_u=$.f,ah=q.f,_h=0;_h<ga.length;_h++){var _A=ga[_h];k(_t,_A)||_i&&k(_i,_A)||_u(_t,_A,ah(_r,_A))}}},8544:(g,b,I)=>{var k=I(7293);g.exports=!k(function(){function B(){}return B.prototype.constructor=null,Object.getPrototypeOf(new B)!==B.prototype})},4994:(g,b,I)=>{var k=I(3383).IteratorPrototype,B=I(30),q=I(9114),$=I(8003),_t=I(7497),_r=function(){return this};g.exports=function(_i,ga,_u,ah){var _h=ga+" Iterator";return _i.prototype=B(k,{next:q(+!ah,_u)}),$(_i,_h,!1,!0),_t[_h]=_r,_i}},8880:(g,b,I)=>{var k=I(9781),B=I(3070),q=I(9114);g.exports=k?function($,_t,_r){return B.f($,_t,q(1,_r))}:function($,_t,_r){return $[_t]=_r,$}},9114:g=>{g.exports=function(b,I){return{enumerable:!(1&b),configurable:!(2&b),writable:!(4&b),value:I}}},654:(g,b,I)=>{var k=I(2109),B=I(6916),q=I(1913),$=I(6530),_t=I(614),_r=I(4994),_i=I(9518),ga=I(7674),_u=I(8003),ah=I(8880),_h=I(1320),_A=I(5112),n0=I(7497),f0=I(3383),E0=$.PROPER,m0=$.CONFIGURABLE,V0=f0.IteratorPrototype,D0=f0.BUGGY_SAFARI_ITERATORS,j0=_A("iterator"),c0="keys",_m="values",t0="entries",s0=function(){return this};g.exports=function(P0,Rv,e0,l0,w0,B0,g0){_r(e0,Rv,l0);var _n,_l,_p,p0=function(g1){if(g1===w0&&LI)return LI;if(!D0&&g1 in rI)return rI[g1];switch(g1){case c0:case _m:case t0:return function(){return new e0(this,g1)}}return function(){return new e0(this)}},L0=Rv+" Iterator",oI=!1,rI=P0.prototype,cI=rI[j0]||rI["@@iterator"]||w0&&rI[w0],LI=!D0&&cI||p0(w0),x1=Rv=="Array"&&rI.entries||cI;if(x1&&(_n=_i(x1.call(new P0)))!==Object.prototype&&_n.next&&(q||_i(_n)===V0||(ga?ga(_n,V0):_t(_n[j0])||_h(_n,j0,s0)),_u(_n,L0,!0,!0),q&&(n0[L0]=s0)),E0&&w0==_m&&cI&&cI.name!==_m&&(!q&&m0?ah(rI,"name",_m):(oI=!0,LI=function(){return B(cI,this)})),w0)if(_l={values:p0(_m),keys:B0?LI:p0(c0),entries:p0(t0)},g0)for(_p in _l)(D0||oI||!(_p in rI))&&_h(rI,_p,_l[_p]);else k({target:Rv,proto:!0,forced:D0||oI},_l);return q&&!g0||rI[j0]===LI||_h(rI,j0,LI,{name:w0}),n0[Rv]=LI,_l}},9781:(g,b,I)=>{var k=I(7293);g.exports=!k(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(g,b,I)=>{var k=I(7854),B=I(111),q=k.document,$=B(q)&&B(q.createElement);g.exports=function(_t){return $?q.createElement(_t):{}}},8324:g=>{g.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(g,b,I)=>{var k=I(317)("span").classList,B=k&&k.constructor&&k.constructor.prototype;g.exports=B===Object.prototype?void 0:B},8113:(g,b,I)=>{var k=I(5005);g.exports=k("navigator","userAgent")||""},7392:(g,b,I)=>{var k,B,q=I(7854),$=I(8113),_t=q.process,_r=q.Deno,_i=_t&&_t.versions||_r&&_r.version,ga=_i&&_i.v8;ga&&(B=(k=ga.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!B&&$&&(!(k=$.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=$.match(/Chrome\/(\d+)/))&&(B=+k[1]),g.exports=B},748:g=>{g.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:(g,b,I)=>{var k=I(7293),B=I(9114);g.exports=!k(function(){var q=Error("a");return!("stack"in q)||(Object.defineProperty(q,"stack",B(1,7)),q.stack!==7)})},2109:(g,b,I)=>{var k=I(7854),B=I(1236).f,q=I(8880),$=I(1320),_t=I(3505),_r=I(9920),_i=I(4705);g.exports=function(ga,_u){var ah,_h,_A,n0,f0,E0=ga.target,m0=ga.global,V0=ga.stat;if(ah=m0?k:V0?k[E0]||_t(E0,{}):(k[E0]||{}).prototype)for(_h in _u){if(n0=_u[_h],_A=ga.noTargetGet?(f0=B(ah,_h))&&f0.value:ah[_h],!_i(m0?_h:E0+(V0?".":"#")+_h,ga.forced)&&_A!==void 0){if(typeof n0==typeof _A)continue;_r(n0,_A)}(ga.sham||_A&&_A.sham)&&q(n0,"sham",!0),$(ah,_h,n0,ga)}}},7293:g=>{g.exports=function(b){try{return!!b()}catch{return!0}}},2104:(g,b,I)=>{var k=I(4374),B=Function.prototype,q=B.apply,$=B.call;g.exports=typeof Reflect=="object"&&Reflect.apply||(k?$.bind(q):function(){return $.apply(q,arguments)})},4374:(g,b,I)=>{var k=I(7293);g.exports=!k(function(){var B=function(){}.bind();return typeof B!="function"||B.hasOwnProperty("prototype")})},6916:(g,b,I)=>{var k=I(4374),B=Function.prototype.call;g.exports=k?B.bind(B):function(){return B.apply(B,arguments)}},6530:(g,b,I)=>{var k=I(9781),B=I(2597),q=Function.prototype,$=k&&Object.getOwnPropertyDescriptor,_t=B(q,"name"),_r=_t&&function(){}.name==="something",_i=_t&&(!k||k&&$(q,"name").configurable);g.exports={EXISTS:_t,PROPER:_r,CONFIGURABLE:_i}},1702:(g,b,I)=>{var k=I(4374),B=Function.prototype,q=B.bind,$=B.call,_t=k&&q.bind($,$);g.exports=k?function(_r){return _r&&_t(_r)}:function(_r){return _r&&function(){return $.apply(_r,arguments)}}},5005:(g,b,I)=>{var k=I(7854),B=I(614),q=function($){return B($)?$:void 0};g.exports=function($,_t){return arguments.length<2?q(k[$]):k[$]&&k[$][_t]}},8173:(g,b,I)=>{var k=I(9662);g.exports=function(B,q){var $=B[q];return $==null?void 0:k($)}},7854:(g,b,I)=>{var k=function(B){return B&&B.Math==Math&&B};g.exports=k(typeof globalThis=="object"&&globalThis)||k(typeof window=="object"&&window)||k(typeof self=="object"&&self)||k(typeof I.g=="object"&&I.g)||function(){return this}()||Function("return this")()},2597:(g,b,I)=>{var k=I(1702),B=I(7908),q=k({}.hasOwnProperty);g.exports=Object.hasOwn||function($,_t){return q(B($),_t)}},3501:g=>{g.exports={}},490:(g,b,I)=>{var k=I(5005);g.exports=k("document","documentElement")},4664:(g,b,I)=>{var k=I(9781),B=I(7293),q=I(317);g.exports=!k&&!B(function(){return Object.defineProperty(q("div"),"a",{get:function(){return 7}}).a!=7})},8361:(g,b,I)=>{var k=I(7854),B=I(1702),q=I(7293),$=I(4326),_t=k.Object,_r=B("".split);g.exports=q(function(){return!_t("z").propertyIsEnumerable(0)})?function(_i){return $(_i)=="String"?_r(_i,""):_t(_i)}:_t},9587:(g,b,I)=>{var k=I(614),B=I(111),q=I(7674);g.exports=function($,_t,_r){var _i,ga;return q&&k(_i=_t.constructor)&&_i!==_r&&B(ga=_i.prototype)&&ga!==_r.prototype&&q($,ga),$}},2788:(g,b,I)=>{var k=I(1702),B=I(614),q=I(5465),$=k(Function.toString);B(q.inspectSource)||(q.inspectSource=function(_t){return $(_t)}),g.exports=q.inspectSource},8340:(g,b,I)=>{var k=I(111),B=I(8880);g.exports=function(q,$){k($)&&"cause"in $&&B(q,"cause",$.cause)}},9909:(g,b,I)=>{var k,B,q,$=I(8536),_t=I(7854),_r=I(1702),_i=I(111),ga=I(8880),_u=I(2597),ah=I(5465),_h=I(6200),_A=I(3501),n0="Object already initialized",f0=_t.TypeError,E0=_t.WeakMap;if($||ah.state){var m0=ah.state||(ah.state=new E0),V0=_r(m0.get),D0=_r(m0.has),j0=_r(m0.set);k=function(_m,t0){if(D0(m0,_m))throw new f0(n0);return t0.facade=_m,j0(m0,_m,t0),t0},B=function(_m){return V0(m0,_m)||{}},q=function(_m){return D0(m0,_m)}}else{var c0=_h("state");_A[c0]=!0,k=function(_m,t0){if(_u(_m,c0))throw new f0(n0);return t0.facade=_m,ga(_m,c0,t0),t0},B=function(_m){return _u(_m,c0)?_m[c0]:{}},q=function(_m){return _u(_m,c0)}}g.exports={set:k,get:B,has:q,enforce:function(_m){return q(_m)?B(_m):k(_m,{})},getterFor:function(_m){return function(t0){var s0;if(!_i(t0)||(s0=B(t0)).type!==_m)throw f0("Incompatible receiver, "+_m+" required");return s0}}}},614:g=>{g.exports=function(b){return typeof b=="function"}},4705:(g,b,I)=>{var k=I(7293),B=I(614),q=/#|\.prototype\./,$=function(_u,ah){var _h=_r[_t(_u)];return _h==ga||_h!=_i&&(B(ah)?k(ah):!!ah)},_t=$.normalize=function(_u){return String(_u).replace(q,".").toLowerCase()},_r=$.data={},_i=$.NATIVE="N",ga=$.POLYFILL="P";g.exports=$},111:(g,b,I)=>{var k=I(614);g.exports=function(B){return typeof B=="object"?B!==null:k(B)}},1913:g=>{g.exports=!1},2190:(g,b,I)=>{var k=I(7854),B=I(5005),q=I(614),$=I(7976),_t=I(3307),_r=k.Object;g.exports=_t?function(_i){return typeof _i=="symbol"}:function(_i){var ga=B("Symbol");return q(ga)&&$(ga.prototype,_r(_i))}},3383:(g,b,I)=>{var k,B,q,$=I(7293),_t=I(614),_r=I(30),_i=I(9518),ga=I(1320),_u=I(5112),ah=I(1913),_h=_u("iterator"),_A=!1;[].keys&&("next"in(q=[].keys())?(B=_i(_i(q)))!==Object.prototype&&(k=B):_A=!0),k==null||$(function(){var n0={};return k[_h].call(n0)!==n0})?k={}:ah&&(k=_r(k)),_t(k[_h])||ga(k,_h,function(){return this}),g.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:_A}},7497:g=>{g.exports={}},6244:(g,b,I)=>{var k=I(7466);g.exports=function(B){return k(B.length)}},133:(g,b,I)=>{var k=I(7392),B=I(7293);g.exports=!!Object.getOwnPropertySymbols&&!B(function(){var q=Symbol();return!String(q)||!(Object(q)instanceof Symbol)||!Symbol.sham&&k&&k<41})},8536:(g,b,I)=>{var k=I(7854),B=I(614),q=I(2788),$=k.WeakMap;g.exports=B($)&&/native code/.test(q($))},6277:(g,b,I)=>{var k=I(1340);g.exports=function(B,q){return B===void 0?arguments.length<2?"":q:k(B)}},30:(g,b,I)=>{var k,B=I(9670),q=I(6048),$=I(748),_t=I(3501),_r=I(490),_i=I(317),ga=I(6200)("IE_PROTO"),_u=function(){},ah=function(n0){return"<script>"+n0+"<\/script>"},_h=function(n0){n0.write(ah("")),n0.close();var f0=n0.parentWindow.Object;return n0=null,f0},_A=function(){try{k=new ActiveXObject("htmlfile")}catch{}var n0,f0;_A=typeof document!="undefined"?document.domain&&k?_h(k):((f0=_i("iframe")).style.display="none",_r.appendChild(f0),f0.src=String("javascript:"),(n0=f0.contentWindow.document).open(),n0.write(ah("document.F=Object")),n0.close(),n0.F):_h(k);for(var E0=$.length;E0--;)delete _A.prototype[$[E0]];return _A()};_t[ga]=!0,g.exports=Object.create||function(n0,f0){var E0;return n0!==null?(_u.prototype=B(n0),E0=new _u,_u.prototype=null,E0[ga]=n0):E0=_A(),f0===void 0?E0:q.f(E0,f0)}},6048:(g,b,I)=>{var k=I(9781),B=I(3353),q=I(3070),$=I(9670),_t=I(5656),_r=I(1956);b.f=k&&!B?Object.defineProperties:function(_i,ga){$(_i);for(var _u,ah=_t(ga),_h=_r(ga),_A=_h.length,n0=0;_A>n0;)q.f(_i,_u=_h[n0++],ah[_u]);return _i}},3070:(g,b,I)=>{var k=I(7854),B=I(9781),q=I(4664),$=I(3353),_t=I(9670),_r=I(4948),_i=k.TypeError,ga=Object.defineProperty,_u=Object.getOwnPropertyDescriptor;b.f=B?$?function(ah,_h,_A){if(_t(ah),_h=_r(_h),_t(_A),typeof ah=="function"&&_h==="prototype"&&"value"in _A&&"writable"in _A&&!_A.writable){var n0=_u(ah,_h);n0&&n0.writable&&(ah[_h]=_A.value,_A={configurable:"configurable"in _A?_A.configurable:n0.configurable,enumerable:"enumerable"in _A?_A.enumerable:n0.enumerable,writable:!1})}return ga(ah,_h,_A)}:ga:function(ah,_h,_A){if(_t(ah),_h=_r(_h),_t(_A),q)try{return ga(ah,_h,_A)}catch{}if("get"in _A||"set"in _A)throw _i("Accessors not supported");return"value"in _A&&(ah[_h]=_A.value),ah}},1236:(g,b,I)=>{var k=I(9781),B=I(6916),q=I(5296),$=I(9114),_t=I(5656),_r=I(4948),_i=I(2597),ga=I(4664),_u=Object.getOwnPropertyDescriptor;b.f=k?_u:function(ah,_h){if(ah=_t(ah),_h=_r(_h),ga)try{return _u(ah,_h)}catch{}if(_i(ah,_h))return $(!B(q.f,ah,_h),ah[_h])}},8006:(g,b,I)=>{var k=I(6324),B=I(748).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(q){return k(q,B)}},5181:(g,b)=>{b.f=Object.getOwnPropertySymbols},9518:(g,b,I)=>{var k=I(7854),B=I(2597),q=I(614),$=I(7908),_t=I(6200),_r=I(8544),_i=_t("IE_PROTO"),ga=k.Object,_u=ga.prototype;g.exports=_r?ga.getPrototypeOf:function(ah){var _h=$(ah);if(B(_h,_i))return _h[_i];var _A=_h.constructor;return q(_A)&&_h instanceof _A?_A.prototype:_h instanceof ga?_u:null}},7976:(g,b,I)=>{var k=I(1702);g.exports=k({}.isPrototypeOf)},6324:(g,b,I)=>{var k=I(1702),B=I(2597),q=I(5656),$=I(1318).indexOf,_t=I(3501),_r=k([].push);g.exports=function(_i,ga){var _u,ah=q(_i),_h=0,_A=[];for(_u in ah)!B(_t,_u)&&B(ah,_u)&&_r(_A,_u);for(;ga.length>_h;)B(ah,_u=ga[_h++])&&(~$(_A,_u)||_r(_A,_u));return _A}},1956:(g,b,I)=>{var k=I(6324),B=I(748);g.exports=Object.keys||function(q){return k(q,B)}},5296:(g,b)=>{var I={}.propertyIsEnumerable,k=Object.getOwnPropertyDescriptor,B=k&&!I.call({1:2},1);b.f=B?function(q){var $=k(this,q);return!!$&&$.enumerable}:I},7674:(g,b,I)=>{var k=I(1702),B=I(9670),q=I(6077);g.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var $,_t=!1,_r={};try{($=k(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(_r,[]),_t=_r instanceof Array}catch{}return function(_i,ga){return B(_i),q(ga),_t?$(_i,ga):_i.__proto__=ga,_i}}():void 0)},2140:(g,b,I)=>{var k=I(7854),B=I(6916),q=I(614),$=I(111),_t=k.TypeError;g.exports=function(_r,_i){var ga,_u;if(_i==="string"&&q(ga=_r.toString)&&!$(_u=B(ga,_r))||q(ga=_r.valueOf)&&!$(_u=B(ga,_r))||_i!=="string"&&q(ga=_r.toString)&&!$(_u=B(ga,_r)))return _u;throw _t("Can't convert object to primitive value")}},3887:(g,b,I)=>{var k=I(5005),B=I(1702),q=I(8006),$=I(5181),_t=I(9670),_r=B([].concat);g.exports=k("Reflect","ownKeys")||function(_i){var ga=q.f(_t(_i)),_u=$.f;return _u?_r(ga,_u(_i)):ga}},1320:(g,b,I)=>{var k=I(7854),B=I(614),q=I(2597),$=I(8880),_t=I(3505),_r=I(2788),_i=I(9909),ga=I(6530).CONFIGURABLE,_u=_i.get,ah=_i.enforce,_h=String(String).split("String");(g.exports=function(_A,n0,f0,E0){var m0,V0=!!E0&&!!E0.unsafe,D0=!!E0&&!!E0.enumerable,j0=!!E0&&!!E0.noTargetGet,c0=E0&&E0.name!==void 0?E0.name:n0;B(f0)&&(String(c0).slice(0,7)==="Symbol("&&(c0="["+String(c0).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!q(f0,"name")||ga&&f0.name!==c0)&&$(f0,"name",c0),(m0=ah(f0)).source||(m0.source=_h.join(typeof c0=="string"?c0:""))),_A!==k?(V0?!j0&&_A[n0]&&(D0=!0):delete _A[n0],D0?_A[n0]=f0:$(_A,n0,f0)):D0?_A[n0]=f0:_t(n0,f0)})(Function.prototype,"toString",function(){return B(this)&&_u(this).source||_r(this)})},2261:(g,b,I)=>{var k,B,q=I(6916),$=I(1702),_t=I(1340),_r=I(7066),_i=I(2999),ga=I(2309),_u=I(30),ah=I(9909).get,_h=I(9441),_A=I(7168),n0=ga("native-string-replace",String.prototype.replace),f0=RegExp.prototype.exec,E0=f0,m0=$("".charAt),V0=$("".indexOf),D0=$("".replace),j0=$("".slice),c0=(B=/b*/g,q(f0,k=/a/,"a"),q(f0,B,"a"),k.lastIndex!==0||B.lastIndex!==0),_m=_i.BROKEN_CARET,t0=/()??/.exec("")[1]!==void 0;(c0||t0||_m||_h||_A)&&(E0=function(s0){var P0,Rv,e0,l0,w0,B0,g0,_n=this,_l=ah(_n),_p=_t(s0),p0=_l.raw;if(p0)return p0.lastIndex=_n.lastIndex,P0=q(E0,p0,_p),_n.lastIndex=p0.lastIndex,P0;var L0=_l.groups,oI=_m&&_n.sticky,rI=q(_r,_n),cI=_n.source,LI=0,x1=_p;if(oI&&(rI=D0(rI,"y",""),V0(rI,"g")===-1&&(rI+="g"),x1=j0(_p,_n.lastIndex),_n.lastIndex>0&&(!_n.multiline||_n.multiline&&m0(_p,_n.lastIndex-1)!==`
`)&&(cI="(?: "+cI+")",x1=" "+x1,LI++),Rv=new RegExp("^(?:"+cI+")",rI)),t0&&(Rv=new RegExp("^"+cI+"$(?!\\s)",rI)),c0&&(e0=_n.lastIndex),l0=q(f0,oI?Rv:_n,x1),oI?l0?(l0.input=j0(l0.input,LI),l0[0]=j0(l0[0],LI),l0.index=_n.lastIndex,_n.lastIndex+=l0[0].length):_n.lastIndex=0:c0&&l0&&(_n.lastIndex=_n.global?l0.index+l0[0].length:e0),t0&&l0&&l0.length>1&&q(n0,l0[0],Rv,function(){for(w0=1;w0<arguments.length-2;w0++)arguments[w0]===void 0&&(l0[w0]=void 0)}),l0&&L0)for(l0.groups=B0=_u(null),w0=0;w0<L0.length;w0++)B0[(g0=L0[w0])[0]]=l0[g0[1]];return l0}),g.exports=E0},7066:(g,b,I)=>{var k=I(9670);g.exports=function(){var B=k(this),q="";return B.global&&(q+="g"),B.ignoreCase&&(q+="i"),B.multiline&&(q+="m"),B.dotAll&&(q+="s"),B.unicode&&(q+="u"),B.sticky&&(q+="y"),q}},2999:(g,b,I)=>{var k=I(7293),B=I(7854).RegExp,q=k(function(){var _r=B("a","y");return _r.lastIndex=2,_r.exec("abcd")!=null}),$=q||k(function(){return!B("a","y").sticky}),_t=q||k(function(){var _r=B("^r","gy");return _r.lastIndex=2,_r.exec("str")!=null});g.exports={BROKEN_CARET:_t,MISSED_STICKY:$,UNSUPPORTED_Y:q}},9441:(g,b,I)=>{var k=I(7293),B=I(7854).RegExp;g.exports=k(function(){var q=B(".","s");return!(q.dotAll&&q.exec(`
`)&&q.flags==="s")})},7168:(g,b,I)=>{var k=I(7293),B=I(7854).RegExp;g.exports=k(function(){var q=B("(?<a>b)","g");return q.exec("b").groups.a!=="b"||"b".replace(q,"$<a>c")!=="bc"})},4488:(g,b,I)=>{var k=I(7854).TypeError;g.exports=function(B){if(B==null)throw k("Can't call method on "+B);return B}},3505:(g,b,I)=>{var k=I(7854),B=Object.defineProperty;g.exports=function(q,$){try{B(k,q,{value:$,configurable:!0,writable:!0})}catch{k[q]=$}return $}},8003:(g,b,I)=>{var k=I(3070).f,B=I(2597),q=I(5112)("toStringTag");g.exports=function($,_t,_r){$&&!_r&&($=$.prototype),$&&!B($,q)&&k($,q,{configurable:!0,value:_t})}},6200:(g,b,I)=>{var k=I(2309),B=I(9711),q=k("keys");g.exports=function($){return q[$]||(q[$]=B($))}},5465:(g,b,I)=>{var k=I(7854),B=I(3505),q="__core-js_shared__",$=k[q]||B(q,{});g.exports=$},2309:(g,b,I)=>{var k=I(1913),B=I(5465);(g.exports=function(q,$){return B[q]||(B[q]=$!==void 0?$:{})})("versions",[]).push({version:"3.20.3",mode:k?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},1400:(g,b,I)=>{var k=I(9303),B=Math.max,q=Math.min;g.exports=function($,_t){var _r=k($);return _r<0?B(_r+_t,0):q(_r,_t)}},5656:(g,b,I)=>{var k=I(8361),B=I(4488);g.exports=function(q){return k(B(q))}},9303:g=>{var b=Math.ceil,I=Math.floor;g.exports=function(k){var B=+k;return B!=B||B===0?0:(B>0?I:b)(B)}},7466:(g,b,I)=>{var k=I(9303),B=Math.min;g.exports=function(q){return q>0?B(k(q),9007199254740991):0}},7908:(g,b,I)=>{var k=I(7854),B=I(4488),q=k.Object;g.exports=function($){return q(B($))}},7593:(g,b,I)=>{var k=I(7854),B=I(6916),q=I(111),$=I(2190),_t=I(8173),_r=I(2140),_i=I(5112),ga=k.TypeError,_u=_i("toPrimitive");g.exports=function(ah,_h){if(!q(ah)||$(ah))return ah;var _A,n0=_t(ah,_u);if(n0){if(_h===void 0&&(_h="default"),_A=B(n0,ah,_h),!q(_A)||$(_A))return _A;throw ga("Can't convert object to primitive value")}return _h===void 0&&(_h="number"),_r(ah,_h)}},4948:(g,b,I)=>{var k=I(7593),B=I(2190);g.exports=function(q){var $=k(q,"string");return B($)?$:$+""}},1694:(g,b,I)=>{var k={};k[I(5112)("toStringTag")]="z",g.exports=String(k)==="[object z]"},1340:(g,b,I)=>{var k=I(7854),B=I(648),q=k.String;g.exports=function($){if(B($)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return q($)}},6330:(g,b,I)=>{var k=I(7854).String;g.exports=function(B){try{return k(B)}catch{return"Object"}}},9711:(g,b,I)=>{var k=I(1702),B=0,q=Math.random(),$=k(1 .toString);g.exports=function(_t){return"Symbol("+(_t===void 0?"":_t)+")_"+$(++B+q,36)}},3307:(g,b,I)=>{var k=I(133);g.exports=k&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(g,b,I)=>{var k=I(9781),B=I(7293);g.exports=k&&B(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},5112:(g,b,I)=>{var k=I(7854),B=I(2309),q=I(2597),$=I(9711),_t=I(133),_r=I(3307),_i=B("wks"),ga=k.Symbol,_u=ga&&ga.for,ah=_r?ga:ga&&ga.withoutSetter||$;g.exports=function(_h){if(!q(_i,_h)||!_t&&typeof _i[_h]!="string"){var _A="Symbol."+_h;_t&&q(ga,_h)?_i[_h]=ga[_h]:_i[_h]=_r&&_u?_u(_A):ah(_A)}return _i[_h]}},9191:(g,b,I)=>{var k=I(5005),B=I(2597),q=I(8880),$=I(7976),_t=I(7674),_r=I(9920),_i=I(9587),ga=I(6277),_u=I(8340),ah=I(7741),_h=I(2914),_A=I(1913);g.exports=function(n0,f0,E0,m0){var V0=m0?2:1,D0=n0.split("."),j0=D0[D0.length-1],c0=k.apply(null,D0);if(c0){var _m=c0.prototype;if(!_A&&B(_m,"cause")&&delete _m.cause,!E0)return c0;var t0=k("Error"),s0=f0(function(P0,Rv){var e0=ga(m0?Rv:P0,void 0),l0=m0?new c0(P0):new c0;return e0!==void 0&&q(l0,"message",e0),_h&&q(l0,"stack",ah(l0.stack,2)),this&&$(_m,this)&&_i(l0,this,s0),arguments.length>V0&&_u(l0,arguments[V0]),l0});if(s0.prototype=_m,j0!=="Error"&&(_t?_t(s0,t0):_r(s0,t0,{name:!0})),_r(s0,c0),!_A)try{_m.name!==j0&&q(_m,"name",j0),_m.constructor=s0}catch{}return s0}}},6992:(g,b,I)=>{var k=I(5656),B=I(1223),q=I(7497),$=I(9909),_t=I(3070).f,_r=I(654),_i=I(1913),ga=I(9781),_u="Array Iterator",ah=$.set,_h=$.getterFor(_u);g.exports=_r(Array,"Array",function(n0,f0){ah(this,{type:_u,target:k(n0),index:0,kind:f0})},function(){var n0=_h(this),f0=n0.target,E0=n0.kind,m0=n0.index++;return!f0||m0>=f0.length?(n0.target=void 0,{value:void 0,done:!0}):E0=="keys"?{value:m0,done:!1}:E0=="values"?{value:f0[m0],done:!1}:{value:[m0,f0[m0]],done:!1}},"values");var _A=q.Arguments=q.Array;if(B("keys"),B("values"),B("entries"),!_i&&ga&&_A.name!=="values")try{_t(_A,"name",{value:"values"})}catch{}},1703:(g,b,I)=>{var k=I(2109),B=I(7854),q=I(2104),$=I(9191),_t=B.WebAssembly,_r=Error("e",{cause:7}).cause!==7,_i=function(_u,ah){var _h={};_h[_u]=$(_u,ah,_r),k({global:!0,forced:_r},_h)},ga=function(_u,ah){if(_t&&_t[_u]){var _h={};_h[_u]=$("WebAssembly."+_u,ah,_r),k({target:"WebAssembly",stat:!0,forced:_r},_h)}};_i("Error",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("EvalError",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("RangeError",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("ReferenceError",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("SyntaxError",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("TypeError",function(_u){return function(ah){return q(_u,this,arguments)}}),_i("URIError",function(_u){return function(ah){return q(_u,this,arguments)}}),ga("CompileError",function(_u){return function(ah){return q(_u,this,arguments)}}),ga("LinkError",function(_u){return function(ah){return q(_u,this,arguments)}}),ga("RuntimeError",function(_u){return function(ah){return q(_u,this,arguments)}})},4916:(g,b,I)=>{var k=I(2109),B=I(2261);k({target:"RegExp",proto:!0,forced:/./.exec!==B},{exec:B})},3948:(g,b,I)=>{var k=I(7854),B=I(8324),q=I(8509),$=I(6992),_t=I(8880),_r=I(5112),_i=_r("iterator"),ga=_r("toStringTag"),_u=$.values,ah=function(_A,n0){if(_A){if(_A[_i]!==_u)try{_t(_A,_i,_u)}catch{_A[_i]=_u}if(_A[ga]||_t(_A,ga,n0),B[n0]){for(var f0 in $)if(_A[f0]!==$[f0])try{_t(_A,f0,$[f0])}catch{_A[f0]=$[f0]}}}};for(var _h in B)ah(k[_h]&&k[_h].prototype,_h);ah(q,"DOMTokenList")}},p={};function A(g){var b=p[g];if(b!==void 0)return b.exports;var I=p[g]={exports:{}};return d[g](I,I.exports,A),I.exports}A.n=g=>{var b=g&&g.__esModule?()=>g.default:()=>g;return A.d(b,{a:b}),b},A.d=(g,b)=>{for(var I in b)A.o(b,I)&&!A.o(g,I)&&Object.defineProperty(g,I,{enumerable:!0,get:b[I]})},A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),A.o=(g,b)=>Object.prototype.hasOwnProperty.call(g,b),A.r=g=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})};var y={};return(()=>{A.r(y),A.d(y,{AudioExtension:()=>V0,AudioProcessor:()=>E0,Extension:()=>m0,Ticker:()=>j0,VideoProcessor:()=>f0,logger:()=>_i,reporter:()=>ah});var g=A(4341);function b(c0,_m,t0){return _m in c0?g(c0,_m,{value:t0,enumerable:!0,configurable:!0,writable:!0}):c0[_m]=t0,c0}A(1703),A(6992),A(3948);var I=A(3476),k=A.n(I);function B(){let c0=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,_m=arguments.length>1?arguments[1]:void 0;const t0=Math.random().toString(16).substr(2,c0).toLowerCase();return t0.length===c0?"".concat(_m).concat(t0):"".concat(_m).concat(t0)+B(c0-t0.length,"")}A(4916);const q=Date.now(),$={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function _t(){const c0=new Date;return c0.toTimeString().split(" ")[0]+":"+c0.getMilliseconds()}const _r=c0=>{for(const _m in $)if(Object.prototype.hasOwnProperty.call($,_m)&&$[_m]===c0)return _m;return"DEFAULT"},_i=new class{constructor(){b(this,"logLevel",$.DEBUG),b(this,"hookLog",void 0)}debug(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[$.DEBUG].concat(_m);this.log.apply(this,s0)}info(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[$.INFO].concat(_m);this.log.apply(this,s0)}warning(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[$.WARNING].concat(_m);this.log.apply(this,s0)}error(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[$.ERROR].concat(_m);this.log.apply(this,s0)}log(){for(var c0,_m=arguments.length,t0=new Array(_m),s0=0;s0<_m;s0++)t0[s0]=arguments[s0];if(Date.now()-q<100)return void setTimeout(()=>{this.log(...t0)},Date.now()-q);const P0=Math.max(0,Math.min(4,t0[0]));if(t0[0]=_t()+" Agora-Extension [".concat(_r(P0),"]:"),P0<this.logLevel)return;const Rv=_t()+" %cAgora-Extension [".concat(_r(P0),"]:");let e0=[];switch(P0){case $.DEBUG:e0=[Rv,"color: #64B5F6;"].concat(t0.slice(1)),console.log.apply(console,e0);break;case $.INFO:e0=[Rv,"color: #1E88E5; font-weight: bold;"].concat(t0.slice(1)),console.log.apply(console,e0);break;case $.WARNING:e0=[Rv,"color: #FB8C00; font-weight: bold;"].concat(t0.slice(1)),console.warn.apply(console,e0);break;case $.ERROR:e0=[Rv,"color: #B00020; font-weight: bold;"].concat(t0.slice(1)),console.error.apply(console,e0)}(c0=this.hookLog)===null||c0===void 0||c0.call(this,P0,e0)}};function ga(c0,_m){var t0=Object.keys(c0);if(Object.getOwnPropertySymbols){var s0=Object.getOwnPropertySymbols(c0);_m&&(s0=s0.filter(function(P0){return Object.getOwnPropertyDescriptor(c0,P0).enumerable})),t0.push.apply(t0,s0)}return t0}function _u(c0){for(var _m=1;_m<arguments.length;_m++){var t0=arguments[_m]!=null?arguments[_m]:{};_m%2?ga(Object(t0),!0).forEach(function(s0){b(c0,s0,t0[s0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c0,Object.getOwnPropertyDescriptors(t0)):ga(Object(t0)).forEach(function(s0){Object.defineProperty(c0,s0,Object.getOwnPropertyDescriptor(t0,s0))})}return c0}const ah=new class{constructor(){b(this,"apiInvokeMsgQueue",[]),b(this,"hookApiInvoke",void 0)}reportApiInvoke(c0){c0.timeout=c0.timeout||6e4,c0.reportResult=c0.reportResult===void 0||c0.reportResult;const _m=Date.now(),t0=()=>({name:c0.name,apiInvokeTime:_m,options:c0.options});let s0=!1;var P0;(P0=c0.timeout,new(k())(e0=>{window.setTimeout(e0,P0)})).then(()=>{s0||(this.sendApiInvoke(_u(_u({},t0()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),_i.debug("".concat(c0.name," timeout")))});const Rv=new Error("".concat(c0.name,": this api invoke is end"));return{onSuccess:e0=>{if(s0)throw Rv;s0=!0,this.sendApiInvoke(_u(_u({},t0()),{},{success:!0},c0.reportResult&&{result:e0}))},onError:e0=>{if(s0)throw e0;s0=!0,this.sendApiInvoke(_u(_u({},t0()),{},{success:!1,error:e0.toString()}))}}}sendApiInvoke(c0){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,c0]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(c0)}};function _h(c0,_m){var t0=Object.keys(c0);if(Object.getOwnPropertySymbols){var s0=Object.getOwnPropertySymbols(c0);_m&&(s0=s0.filter(function(P0){return Object.getOwnPropertyDescriptor(c0,P0).enumerable})),t0.push.apply(t0,s0)}return t0}function _A(c0){for(var _m=1;_m<arguments.length;_m++){var t0=arguments[_m]!=null?arguments[_m]:{};_m%2?_h(Object(t0),!0).forEach(function(s0){b(c0,s0,t0[s0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c0,Object.getOwnPropertyDescriptors(t0)):_h(Object(t0)).forEach(function(s0){Object.defineProperty(c0,s0,Object.getOwnPropertyDescriptor(t0,s0))})}return c0}class n0 extends class{constructor(){b(this,"_events",{}),b(this,"addListener",this.on)}getListeners(_m){return this._events[_m]?this._events[_m].map(t0=>t0.listener):[]}on(_m,t0){this._events[_m]||(this._events[_m]=[]);const s0=this._events[_m];this._indexOfListener(s0,t0)===-1&&s0.push({listener:t0,once:!1})}once(_m,t0){this._events[_m]||(this._events[_m]=[]);const s0=this._events[_m];this._indexOfListener(s0,t0)===-1&&s0.push({listener:t0,once:!0})}off(_m,t0){if(!this._events[_m])return;const s0=this._events[_m],P0=this._indexOfListener(s0,t0);P0!==-1&&s0.splice(P0,1),this._events[_m].length===0&&delete this._events[_m]}removeAllListeners(_m){_m?delete this._events[_m]:this._events={}}emit(_m){this._events[_m]||(this._events[_m]=[]);const t0=this._events[_m].map(e0=>e0);for(var s0=arguments.length,P0=new Array(s0>1?s0-1:0),Rv=1;Rv<s0;Rv++)P0[Rv-1]=arguments[Rv];for(let e0=0;e0<t0.length;e0+=1){const l0=t0[e0];l0.once&&this.off(_m,l0.listener),l0.listener.apply(this,P0||[])}}_indexOfListener(_m,t0){let s0=_m.length;for(;s0--;)if(_m[s0].listener===t0)return s0;return-1}emitAsPromise(_m){for(var t0=arguments.length,s0=new Array(t0>1?t0-1:0),P0=1;P0<t0;P0++)s0[P0-1]=arguments[P0];return this.getListeners(_m).length===0?k().reject(new Error("No promise event handler.")):new(k())((Rv,e0)=>{this.emit(_m,...s0,Rv,e0)})}emitAsPromiseNoResponse(_m){for(var t0=arguments.length,s0=new Array(t0>1?t0-1:0),P0=1;P0<t0;P0++)s0[P0-1]=arguments[P0];return this.getListeners(_m).length===0?k().resolve():new(k())((Rv,e0)=>{this.emit(_m,...s0,Rv,e0)})}}{get enabled(){return this._enabled}output(_m,t0){if(this.outputTrack===_m)return;const s0=ah.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:_m==null?void 0:_m.toString()}});this.outputTrack=_m,this.destination&&this.destination.updateInput({track:_m,context:t0}),s0.onSuccess()}constructor(){super(),b(this,"inputTrack",void 0),b(this,"outputTrack",void 0),b(this,"_enabled",!0),b(this,"_source",void 0),b(this,"ID",B(6,"")),b(this,"destination",void 0),b(this,"context",void 0),b(this,"name",void 0)}enable(){if(this._enabled)return;const _m=ah.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!0});_i.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var t0;const s0=(t0=this.onEnableChange)===null||t0===void 0?void 0:t0.call(this,this._enabled);if(s0 instanceof k())return s0.then(()=>{_m.onSuccess()}).catch(P0=>{throw _m.onError(P0),P0});_m.onSuccess()}catch(s0){throw _m.onError(s0),s0}}disable(){if(!this._enabled)return;const _m=ah.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!1});_i.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var t0;const s0=(t0=this.onEnableChange)===null||t0===void 0?void 0:t0.call(this,this._enabled);if(s0 instanceof k())return s0.then(()=>{_m.onSuccess()}).catch(P0=>{throw _m.onError(P0),P0});_m.onSuccess()}catch(s0){throw _m.onError(s0),s0}}}class f0 extends n0{get kind(){return"video"}pipe(_m){const t0=ah.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:_m.name}});if(this.destination===_m)return t0.onSuccess(),_m;if(_m._source){const s0=new Error("Processor ".concat(_m.name," already piped, please call unpipe beforehand."));throw t0.onError(s0),s0}return this.destination&&this.unpipe(),this.destination=_m,_m._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),t0.onSuccess(),_m}unpipe(){if(!this.destination)return;const _m=ah.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});_i.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const t0=this.destination;this.destination._source=void 0,this.destination=void 0,t0.reset()}finally{_m.onSuccess()}}updateInput(_m){var t0,s0;_m.context!==this.context&&(this.context=_m.context,(t0=this.onPiped)===null||t0===void 0||t0.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:_m.context})),_m.track&&this.inputTrack!==_m.track&&(this.inputTrack=_m.track,(s0=this.onTrack)===null||s0===void 0||s0.call(this,_m.track,this.context))}reset(){var _m;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,(_m=this.onUnpiped)===null||_m===void 0||_m.call(this),this.destination&&this.destination.reset()}}class E0 extends n0{constructor(){super(...arguments),b(this,"inputNode",void 0),b(this,"outputNode",void 0),b(this,"destination",void 0),b(this,"context",void 0)}get kind(){return"audio"}pipe(_m){const t0=ah.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:_m.name}});if(this.destination===_m)return t0.onSuccess(),_m;if(_m._source){const s0=new Error("Processor ".concat(_m.name," already piped, please call unpipe beforehand."));throw t0.onError(s0),s0}return this.destination&&this.unpipe(),this.destination=_m,_m._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),t0.onSuccess(),_m}unpipe(){if(!this.destination)return;_i.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const _m=ah.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var t0;let s0=this.destination;(t0=this.outputNode)===null||t0===void 0||t0.disconnect(),this.destination._source=void 0,this.destination=void 0,s0.reset()}finally{_m.onSuccess()}}output(_m,t0){if(_m instanceof MediaStreamTrack)super.output(_m,t0);else if(_m instanceof AudioNode){if(this.outputNode===_m)return;const s0=ah.reportApiInvoke({name:"".concat(this.name,".output"),options:_A(_A({},_m instanceof MediaStreamTrack&&{track:_m.toString()}),_m instanceof AudioNode&&{audioNode:_m.toString()})});this.outputNode=_m,this.destination&&this.destination.updateInput({node:_m,context:t0}),s0.onSuccess()}}updateInput(_m){var t0,s0,P0;_m.context!==this.context&&(this.context=_m.context,(t0=this.onPiped)===null||t0===void 0||t0.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:_m.context})),_m.track&&this.inputTrack!==_m.track&&(this.inputTrack=_m.track,(s0=this.onTrack)===null||s0===void 0||s0.call(this,_m.track,this.context)),_m.node&&this.inputNode!==_m.node&&(this.inputNode=_m.node,(P0=this.onNode)===null||P0===void 0||P0.call(this,_m.node,this.context))}reset(){var _m;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,this.context=void 0,(_m=this.onUnpiped)===null||_m===void 0||_m.call(this),this.destination&&this.destination.reset()}}class m0{constructor(){b(this,"__registered__",!1),b(this,"logger",_i),b(this,"reporter",ah),b(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class V0 extends m0{}let D0;class j0{get running(){return this._running}constructor(_m,t0){if(b(this,"type",void 0),b(this,"interval",void 0),b(this,"fn",void 0),b(this,"_running",!1),b(this,"_osc",void 0),!_m)throw new Error;if(t0<=0)throw new Error;this.type=_m,this.interval=t0}add(_m){this.fn=_m}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const _m=()=>{setTimeout(()=>{this.fn&&this.fn(),this._running&&_m()},this.interval)};_m();break}case"RAF":{const _m=t0=>{requestAnimationFrame(s0=>{s0-t0<this.interval?this._running&&_m(t0):(this.fn&&this.fn(),this._running&&_m(s0))})};_m(performance.now());break}case"Oscillator":{D0||(D0=new AudioContext);const _m=D0.createGain();let t0;_m.gain.value=0,_m.connect(D0.destination);const s0=()=>{this.fn&&this.fn(),t0&&t0.disconnect(),t0=D0.createOscillator(),this._osc=t0,t0.connect(_m),this._running&&(t0.onended=s0,t0.start(0),t0.stop(D0.currentTime+this.interval/1e3))};s0();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}})(),y})()})(oZ);var sZ;!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(sZ=HTMLCanvasElement.prototype.getContext,function(){let e=arguments;return e[0]==="webgl"&&(e=[].slice.call(arguments),e[0]="experimental-webgl"),sZ.apply(null,e)}));const E1t=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function aZ(e){const l=new Uint8Array([99,114,121,112,116,105,105]),d=l.length,p=e,A=p.length,y=new Uint8Array(A),g=new Uint8Array(256);for(let q=0;q<256;q++)g[q]=q;let b=0;for(let q=0;q<256;q++)b=(b+g[q]+l[q%d])%256,[g[q],g[b]]=[g[b],g[q]];let I,k=0;b=0;for(let q=0;q<0+A;q++)k=(k+1)%256,b=(b+g[k])%256,[g[k],g[b]]=[g[b],g[k]],I=g[(g[k]+g[b])%256],q>=0&&(y[q-0]=p[q-0]^I);const B=String.fromCharCode.apply(null,Array.from(y));return Function("var winSize = 5; return `"+B+"`")()}const m1t=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class cZ{constructor(l,d){_s(this,"program",void 0),_s(this,"gl",void 0),_s(this,"kernel",void 0),this.gl=l,this.kernel=d||m1t,this.program=function(p,A){const y=aZ(A),g=g1t(p,[aZ(E1t),y]);{const b=p.getAttribLocation(g,"a_position"),I=p.createBuffer();p.bindBuffer(p.ARRAY_BUFFER,I),p.bufferData(p.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),p.STATIC_DRAW),p.enableVertexAttribArray(b);const k=2,B=p.FLOAT,q=!1,$=0,_t=0;p.vertexAttribPointer(b,k,B,q,$,_t)}{const b=p.getAttribLocation(g,"a_texCoord"),I=p.createBuffer();p.bindBuffer(p.ARRAY_BUFFER,I),p.bufferData(p.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),p.STATIC_DRAW),p.enableVertexAttribArray(b);const k=2,B=p.FLOAT,q=!1,$=0,_t=0;p.vertexAttribPointer(b,k,B,q,$,_t)}return g}(this.gl,this.kernel)}setUniforms(){const l=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(l,1)}}class tR extends cZ{constructor(l,d,p,A){super(l,d),_s(this,"xOffset",void 0),_s(this,"yOffset",void 0),_s(this,"denoiseLevel",5),this.xOffset=1/p,this.yOffset=1/A}setUniforms(){const l=this.gl.getUniformLocation(this.program,"u_flipY"),d=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),p=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(d,this.xOffset,this.yOffset),this.gl.uniform1f(p,this.denoiseLevel),this.gl.uniform1f(l,1)}setParameters(l){l.denoiseLevel!==void 0&&(this.denoiseLevel=l.denoiseLevel)}setSize(l,d){this.xOffset=1/l,this.yOffset=1/d}}const v1t=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class I1t extends tR{constructor(l,d,p){super(l,v1t,d,p)}}const _1t=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class y1t extends tR{constructor(l,d,p){super(l,_1t,d,p)}}const b1t=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class C1t extends tR{constructor(l,d,p){super(l,b1t,d,p)}}const S1t=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],R1t=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],uZ=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],T1t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class w1t extends tR{constructor(l,d,p,A){super(l,S1t,p,A),_s(this,"inputTexture",void 0),_s(this,"lightLevel",.1),_s(this,"rednessLevel",.5),_s(this,"mskin_he_max",175/180*3.141593),_s(this,"mskin_he_min",115/180*3.141593),_s(this,"mskin_hc_max",173/180*3.141593),_s(this,"mskin_hc_min",116/180*3.141593),_s(this,"mskin_hc_axis",2.04203545),_s(this,"mfacts_rotate_c",0),_s(this,"mfacts_rotate_le",0),_s(this,"mfacts_rotate_ge",0),_s(this,"tab_addr",null),_s(this,"lutTextures",[]),this.inputTexture=d,this.init()}setUniforms(){const l=this.gl.getUniformLocation(this.program,"u_flipY"),d=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(d,this.denoiseLevel),this.gl.uniform1f(l,1);const p=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(p,this.lightLevel);const A=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(A,this.rednessLevel);const y=this.gl.getUniformLocation(this.program,"skin_he_max"),g=this.gl.getUniformLocation(this.program,"skin_he_min"),b=this.gl.getUniformLocation(this.program,"skin_hc_max"),I=this.gl.getUniformLocation(this.program,"skin_hc_min"),k=this.gl.getUniformLocation(this.program,"skin_hc_axis"),B=this.gl.getUniformLocation(this.program,"facts_rotate_c"),q=this.gl.getUniformLocation(this.program,"facts_rotate_le"),$=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(y,this.mskin_he_max),this.gl.uniform1f(g,this.mskin_he_min),this.gl.uniform1f(b,this.mskin_hc_max),this.gl.uniform1f(I,this.mskin_hc_min),this.gl.uniform1f(k,this.mskin_hc_axis),this.gl.uniform1f(B,this.mfacts_rotate_c),this.gl.uniform1f(q,this.mfacts_rotate_le),this.gl.uniform1f($,this.mfacts_rotate_ge);const _t=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(_t,2);const _r=["lighten_lut"],_i=[this.gl.TEXTURE3];for(let ga=0;ga<_r.length;ga++){const _u=this.gl.getUniformLocation(this.program,_r[ga]);this.gl.activeTexture(_i[ga]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[ga]),this.gl.uniform1i(_u,ga+3)}}setParameters(l){l.denoiseLevel!==void 0&&(this.denoiseLevel=l.denoiseLevel),l.lightLevel!==void 0&&(this.lightLevel=l.lightLevel),l.rednessLevel!==void 0&&(this.rednessLevel=l.rednessLevel,this.updateRedness(this.rednessLevel)),l.lighteningContrastLevel&&this.updateLut(l.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(uZ);const l=[this.tab_addr],d=[256],p=[1];for(let A=0;A<l.length;A++){const y=this.gl.createTexture();if(!y)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,y),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,d[A],p[A],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,l[A]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(y)}}updateRedness(l){let p,A,y=l,g=y;y>1&&(y=1),y<0&&(y=0),g>1&&(g=1),g<0&&(g=0),this.mfacts_rotate_c=.8*y,g<.8&&(g=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*g)/180*3.141593,this.mskin_hc_min=(116-4*g)/180*3.141593,this.mskin_hc_axis=(117-4*g)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<3.141593/2&&(this.mskin_hc_min=3.141593/2),this.mskin_hc_axis<3.141593/2&&(this.mskin_hc_axis=3.141593/2),this.mskin_he_min<3.141593/2&&(this.mskin_he_min=3.141593/2),this.mskin_hc_max>3.141593&&(this.mskin_hc_max=3.141593),this.mskin_hc_axis>3.141593&&(this.mskin_hc_axis=3.141593),this.mskin_he_max>3.141593&&(this.mskin_he_max=3.141593),p=this.mskin_he_max-this.mskin_hc_max,A=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=p>.01?this.mfacts_rotate_c*A/p:this.mfacts_rotate_c,p=this.mskin_hc_min-this.mskin_he_min,A=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=p>.01?this.mfacts_rotate_c*A/p:this.mfacts_rotate_c}updateLut(l){let d=null;if(l===0&&(d=uZ),l===1&&(d=T1t),l===2&&(d=R1t),!d)throw new _E(_f.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+l);this.tab_addr=new Uint8Array(d);const p=[this.tab_addr],A=[256],y=[1];for(let g=0;g<p.length;g++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[g]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,A[g],y[g],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,p[g])}}class O1t{constructor(){_s(this,"gl",null),_s(this,"canvas",null),_s(this,"programs",[]),_s(this,"commonProgram",null),_s(this,"inputTexture",null),_s(this,"outputTextures",[]),_s(this,"fbos",[]),_s(this,"originalFrameWidth",0),_s(this,"originalFrameHeight",0),_s(this,"enableBeauty",!1),_s(this,"denoiseLevel",5),_s(this,"lightLevel",.35),_s(this,"rednessLevel",.5),_s(this,"lighteningContrastLevel",1)}setEnableBeauty(l){this.enableBeauty=!!l}init(l,d,p){if(!t_().supportWebGL)throw new _E(_f.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=p.getContext("webgl"),!this.gl)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(l,d),!this.inputTexture)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=p,this.programs.push(new cZ(this.gl)),this.programs.push(new I1t(this.gl,l,d)),this.programs.push(new y1t(this.gl,l,d)),this.programs.push(new C1t(this.gl,l,d)),this.programs.push(new w1t(this.gl,this.inputTexture,l,d)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(l){if(!this.gl||!this.commonProgram||!this.canvas)return void _a.warning("video effect manager is not init!");let d=0;if(this.originalFrameHeight===l.videoWidth&&this.originalFrameWidth===l.videoHeight)d=2;else if(this.originalFrameHeight!==l.videoHeight||this.originalFrameWidth!==l.videoWidth){if(_a.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(l.videoWidth,"x").concat(l.videoHeight)),l.videoHeight===0||l.videoWidth===0)return void _a.debug("beauty effect: skip 0 resolution frame");this.canvas.width=l.videoWidth,this.canvas.height=l.videoHeight,l.setAttribute("width",l.videoWidth.toString()),l.setAttribute("height",l.videoHeight.toString()),this.release(),this.init(l.videoWidth,l.videoHeight,this.canvas)}this.gl.viewport(0,0,l.videoWidth,l.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,l);const p=this.enableBeauty?this.programs.length-1:0;for(let y=0;y<=p;y++){const g=this.programs[y].program;this.gl.useProgram(g);const b=this.gl.getUniformLocation(g,"u_image");this.programs[y].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[d+y%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[d+y%2]),this.gl.uniform1i(b,0)}this.gl.useProgram(this.commonProgram);const A=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(A,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(l){this.programs.forEach(d=>{d instanceof tR&&d.setParameters({denoiseLevel:l})}),this.denoiseLevel=l}setLightLevel(l){this.programs.forEach(d=>{d instanceof tR&&d.setParameters({lightLevel:l})}),this.lightLevel=l}setRednessLevel(l){this.programs.forEach(d=>{d instanceof tR&&d.setParameters({rednessLevel:l})}),this.rednessLevel=l}setContrastLevel(l){this.programs.forEach(d=>{d instanceof tR&&d.setParameters({lighteningContrastLevel:l})}),this.lighteningContrastLevel=l}setSize(l,d){this.programs.forEach(p=>{p instanceof tR&&p.setSize(l,d)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(l,d){if(!this.gl)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let p=0;p<4;p++){const A=this.gl.createTexture();if(!A)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,A),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),p<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,l,d,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,d,l,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const y=this.gl.createFramebuffer();if(!y)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,y),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,A,0),this.outputTextures.push(A),this.fbos.push(y)}this.gl.viewport(0,0,l,d),this.originalFrameWidth=l,this.originalFrameHeight=d}}class N1t{constructor(){_s(this,"targetFrameRate",0),_s(this,"recordedFrameCount",0),_s(this,"recordingTime",2),_s(this,"recordID",void 0)}async startRecordBeautyEffectOutput(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;if(this.recordID)throw new _E(_f.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const p=i1(6,"");return this.recordID=p,this.targetFrameRate=l,this.recordedFrameCount=0,this.recordingTime=d,await Q1(1e3*this.recordingTime),this.recordID!==p?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(_a.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(_a.debug("beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class k1t extends oZ.exports.VideoProcessor{constructor(){super(),_s(this,"name","BeautyProcessor"),_s(this,"fps",15),_s(this,"canvas",void 0),_s(this,"video",void 0),_s(this,"manager",void 0),_s(this,"overloadDetector",new N1t),_s(this,"stopChromeBackgroundLoop",null),_s(this,"onOverload",void 0),_s(this,"stopLoop",void 0),_s(this,"lastRenderTime",0),this.fps=30,this.manager=new O1t,this._enabled=!1}async onEnableChange(l){this.manager.setEnableBeauty(l),this.context&&this.inputTrack&&(l?await this.startEffect(this.inputTrack,this.context):await this.stopEffect(this.inputTrack,this.context))}async setBeautyEffectOptions(l){if(function(d){d.smoothnessLevel!==void 0&&jI(d.smoothnessLevel,"options.smoothnessLevel",0,1,!1),d.lighteningLevel!==void 0&&jI(d.lighteningLevel,"options.lighteningLevel",0,1,!1),d.rednessLevel!==void 0&&jI(d.rednessLevel,"options.rednessLevel",0,1,!1),d.lighteningContrastLevel!==void 0&&O1(d.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2])}(l),l.smoothnessLevel!==void 0){const d=Math.max(.1,10*l.smoothnessLevel);this.manager.setDenoiseLevel(d)}if(l.lighteningLevel!==void 0){const d=Math.max(.1,l.lighteningLevel/2);this.manager.setLightLevel(d)}if(l.rednessLevel!==void 0){const d=Math.max(.01,l.rednessLevel);this.manager.setRednessLevel(d)}if(l.lighteningContrastLevel!==void 0){const d=l.lighteningContrastLevel;this.manager.setContrastLevel(d)}}async onTrack(l,d){var p;this.video&&this.enabled&&((p=this.stopLoop)===null||p===void 0||p.call(this),await this.stopEffect(l,d)),await this.startEffect(l,d)}async startEffect(l,d){if(!this.enabled)return;const p=MI(),A=await this.renderWithWebGL(l);this.output(A,d),_a.info("start video effect, output:",this.outputTrack),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then(b=>{b||this.onOverload&&this.onOverload()});let y=!1;this.stopLoop=()=>{y=!0};const g=()=>{this.enabled&&!y&&requestAnimationFrame(g);const b=Date.now(),I=1e3/this.fps,k=this.lastRenderTime?b-this.lastRenderTime:I;k<I||(this.lastRenderTime=b-(k-I),this.video&&this.video.paused&&this.video.play(),this.enabled&&this.video&&(this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()))};requestAnimationFrame(g),p.name===DI.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?this.stopChromeBackgroundLoop=Y5(()=>{this.enabled&&this.video&&this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()},this.fps):this.stopChromeBackgroundLoop&&(this.stopChromeBackgroundLoop(),this.stopChromeBackgroundLoop=null)},!1)}async renderWithWebGL(l){this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([l]);const d=new Y0(b=>{const I=()=>{this.video&&this.video.removeEventListener("playing",I),b(void 0)};this.video&&this.video.addEventListener("playing",I)});this.video.play(),await d;const p=l.getSettings(),A=p.width||this.video.videoWidth,y=p.height||this.video.videoHeight;if(p.frameRate&&this.fps!==p.frameRate&&(this.fps=p.frameRate,_a.debug("beauty video processor: set fps to",this.fps)),_a.debug("beauty video processor: width ".concat(A," height ").concat(y)),!A||!y)throw new _E(_f.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");this.canvas.width=A,this.canvas.height=y,this.video.setAttribute("width",A.toString()),this.video.setAttribute("height",y.toString()),this.manager.init(A,y,this.canvas);const g=t_();return this.canvas.captureStream(g.supportRequestFrame?0:this.fps).getVideoTracks()[0]}async stopEffect(l,d){_a.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.canvas=void 0,this.video=void 0,this.output(l,d)}}function U6(e){const l={};if(e.facingMode&&(l.facingMode=e.facingMode),e.cameraId&&(l.deviceId={exact:e.cameraId}),!e.encoderConfig)return l;const d=o2(e.encoderConfig);return l.width=d.width,l.height=d.height,!tK()&&d.frameRate&&(l.frameRate=d.frameRate),MI().name===DI.EDGE&&typeof l.frameRate=="object"&&(l.frameRate.max=60),d_()&&(l.frameRate={ideal:30,max:30}),l}function D1t(e){const l={};e.screenSourceType&&(l.mediaSource=e.screenSourceType),e.extensionId&&I4()&&(l.extensionId=e.extensionId),e.electronScreenSourceId&&(l.sourceId=e.electronScreenSourceId);const d=e.encoderConfig?M4(e.encoderConfig):null;return l.mandatory={chromeMediaSource:"desktop",maxWidth:d?d.width:void 0,maxHeight:d?d.height:void 0},d&&d.frameRate&&(typeof d.frameRate=="number"?(l.mandatory.maxFrameRate=d.frameRate,l.mandatory.minFrameRate=d.frameRate):(l.mandatory.maxFrameRate=d.frameRate.max||d.frameRate.ideal||d.frameRate.exact||void 0,l.mandatory.minFrameRate=d.frameRate.min||d.frameRate.ideal||d.frameRate.exact||void 0),l.frameRate=d.frameRate),d&&d.width&&(l.width=d.width),d&&d.height&&(l.height=d.height),l}function lZ(e){const l={};if(tK()||(e.AGC!==void 0&&(l.autoGainControl=e.AGC),e.AEC!==void 0&&(l.echoCancellation=e.AEC),e.ANS!==void 0&&(l.noiseSuppression=e.ANS,I4()&&e.ANS&&(l.googHighpassFilter=e.ANS))),e.encoderConfig){const d=eP(e.encoderConfig);l.channelCount=d.stereo?2:1,l.sampleRate=d.sampleRate,l.sampleSize=d.sampleSize}return e.microphoneId&&(l.deviceId={exact:e.microphoneId}),eK()&&(l.sampleRate=void 0),l}var k2,VP;(function(e){e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE"})(k2||(k2={})),function(e){e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(VP||(VP={}));var dZ,hZ,pZ,fZ,AZ,gZ,EZ,mZ,vZ,IZ,_Z,yZ,bZ,CZ,SZ,HI,RZ,TZ,wZ,OZ,NZ,kZ,NS,DZ=new class{constructor(){_s(this,"_clientSize",null),_s(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),_s(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),_s(this,"getStyle",e=>window.getComputedStyle(e,null)),_s(this,"checkCssVisibleProperty",e=>{let l=!0;const d=this.getStyle(e),{display:p,visibility:A,opacity:y,filter:g}=d;return(p==="none"||["hidden","collapse"].includes(A)||Number(y)<.1)&&(l=!1),l?(g&&g.split(" ").filter(b=>{const I=b.split("(")[0];return["brightness","blur","opacity"].includes(I)}).map(b=>{const[I,k]=b.split(/\(|\)/);return[I,Number(k.match(/^[0-9\.]+/))]}).forEach(b=>{const[I,k]=b;switch(I){case"brightness":(k<.1||k>3)&&(l=!1);break;case"blur":k>3&&(l=!1);break;case"opacity":k<.1&&(l=!1)}}),l):!1}),_s(this,"checkPropertyUpToAllParentNodes",(e,l)=>{let d=!0,p=!0;const A=g=>l(g);let y=e;for(;y&&p;)A(y)||(d=!1,p=!1),y=y.parentElement,y||(p=!1);return d}),_s(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),_s(this,"getSizeAboutClient",e=>{const{width:l,height:d,left:p,right:A,top:y,bottom:g}=e.getBoundingClientRect(),b=this.getClientWidth(),I=this.getClientHeight();return{width:l,height:d,left:p,right:A,top:y,bottom:g,clientWidth:b,clientHeight:I,clientMin:Math.min(b,I)}}),_s(this,"checkActualSize",()=>{const{width:e,height:l,clientMin:d}=this._clientSize;return this.checkSizeIsVisible(e,l,d)}),_s(this,"elementFromPoint",(e,l)=>document.elementFromPoint?document.elementFromPoint(e,l):null),_s(this,"checkCoverForAPoint",(e,l,d)=>{const p=this.elementFromPoint(e,l);return p!==null&&p!==d}),_s(this,"getPointPositionList",()=>{const{width:e,height:l,left:d,top:p}=this._clientSize,A=e/6,y=l/6,g=[],b=10**6;for(let I=0;I<5;I++)for(let k=0;k<5;k++){const B=(d*b+(I===0?.1:I===4?(A*I*b-1e5)/b:A*I)*b)/b,q=(p*b+(k===0?.1:k===4?(y*k*b-1e5)/b:y*k)*b)/b;g.push({x:B,y:q})}return[...g]}),_s(this,"checkElementCover",e=>this.getPointPositionList().map(l=>this.checkCoverForAPoint(l.x,l.y,e)).filter(l=>!!l).length>6),_s(this,"checkSizeIsVisible",(e,l,d)=>(e>50||d/e<=10)&&(l>50||d/l<=10)),_s(this,"checkSizeOfPartInClient",()=>{const{left:e,right:l,top:d,bottom:p,clientHeight:A,clientWidth:y,clientMin:g}=this._clientSize;let b,I,k,B;if(e<0)b=0;else{if(!(e<y))return!1;b=e}if(l<0)return!1;if(I=l<y?l:y,d<0)k=0;else{if(!(d<A))return!1;k=d}if(p<0)return!1;B=p<A?p:A;const q=I-b,$=B-k;return this.checkSizeIsVisible(q,$,g)}),_s(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),_s(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(k2.COVERED);{const l=this.checkActualSize(),d=this.checkSizeOfPartInClient();return l&&!d?this.returnHiddenResult(k2.POSITION):l?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(k2.SIZE)}}return this.returnHiddenResult(k2.STYLE)}return this.returnHiddenResult(VP.UNMOUNTED)}return this.returnHiddenResult(VP.INVALID_HTML_ELEMENT)}),_s(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,l=>l.nodeName.toUpperCase()!=="HTML"?l.parentElement!==null:!!document.documentElement))}};function LZ(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function D2(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?LZ(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):LZ(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let A1=(dZ=U1("LocalVideoTrack","getTrackId"),hZ=$I(),pZ=m2("LocalVideoTrack","_enabledMutex"),fZ=$I(),AZ=m2("LocalVideoTrack","_enabledMutex"),gZ=$I(),EZ=mP({report:_0}),mZ=$I(),vZ=$I(),IZ=$I(),_Z=$I(),yZ=$I(),bZ=$I(),CZ=$I(),dZ((X0((HI=class ftt extends q5{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==j1.PLAYING)}constructor(l,d,p,A,y,g){super(l,y),_s(this,"trackMediaType","video"),_s(this,"_player",void 0),_s(this,"_videoBeautyProcessor",void 0),_s(this,"_videoVisibleTimer",null),_s(this,"_previousVideoVisibleStatus",void 0),_s(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_s(this,"_encoderConfig",void 0),_s(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),_s(this,"_optimizationMode",void 0),_s(this,"_videoHeight",void 0),_s(this,"_videoWidth",void 0),_s(this,"_forceBitrateLimit",void 0),_s(this,"_enabled",!0),_s(this,"processorDestination",void 0),_s(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=d,this._scalabiltyMode=p,this._optimizationMode=A,this._hints=g||[],this._hints.indexOf(F1.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile(),this.processorContext=new P1t(this.getTrackId()),this.processorDestination=new L1t(this.processorContext),this.bindProcessorDestinationEvents()}play(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),typeof l=="string"?l:"HTMLElement",d]});if(typeof l=="string"){const y=document.getElementById(l);y?l=y:(_a.warning("[".concat(this.getTrackId(),'] can not find "#').concat(l,'" element, use document.body')),H0("warning",this,'can not find "#'.concat(l,'" element, use document.body')),l=document.body)}_a.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(d)),b0("debug",this,"play",d);const A=D2(D2(D2({},this._getDefaultPlayerConfig()),d),{},{trackId:this.getTrackId(),element:l});this._player?this._player.updateConfig(A):(this._player=new rZ(A),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const y=this.getVideoElementVisibleStatus();this.emit(mR.VIDEO_ELEMENT_VISIBLE_STATUS,y)}catch{}},y0("CHECK_VIDEO_VISIBLE_INTERVAL")),p.onSuccess()}stop(){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return l.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_a.debug("[".concat(this.getTrackId(),"] stop video playback")),b0("debug",this,"stop"),l.onSuccess()}async setEnabled(l,d){if(!d){if(l===this._enabled)return;this.stateCheck("enabled",l)}if(_a.info("[".concat(this.getTrackId(),"] start setEnabled"),l),b0("info",this,"setEnabled",l),!l){this._originMediaStreamTrack.enabled=!1;try{await YI(this,tI.NEED_DISABLE_TRACK,this)}catch(p){throw _a.error("[".concat(this.getTrackId(),"] setEnabled to false error"),p.toString()),b0("error",this,"setEnabled",l,p.toString()),p}return d||(this._enabled=!1),_a.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void b0("info",this,"setEnabled",l,"success")}this._originMediaStreamTrack.enabled=!0;try{await YI(this,tI.NEED_ENABLE_TRACK,this)}catch(p){throw _a.error("[".concat(this.getTrackId(),"] setEnabled to true error"),p.toString()),b0("error",this,"setEnabled",l,p.toString()),p}_a.info("[".concat(this.getTrackId(),"] setEnabled to true success")),b0("info",this,"setEnabled",l,"success"),d||(this._enabled=!0)}async setMuted(l){l!==this._muted&&(this.stateCheck("muted",l),this._muted=l,this._mediaStreamTrack.enabled=!l,_a.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(l)),b0("debug",this,"setMuted",l),l?await YI(this,tI.NEED_MUTE_TRACK,this):await YI(this,tI.NEED_UNMUTE_TRACK,this))}getStats(){return UO(()=>{_a.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead"),H0("warning",this,"[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),pT(this,tI.GET_STATS)||D2({},X4)}async setBeautyEffect(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),l,d]});if(l||this._videoBeautyProcessor){if(JH()===C1.IOS||JH()===C1.ANDROID){const A=new _E(_f.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw p.onError(A),A}if(!this._enabled&&l){const A=new _E(_f.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw p.onError(A),A}if(_a.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),l,JSON.stringify(d)),b0("info",this,"setBeautyEffect",[l,d]),this._videoBeautyProcessor||l){try{if(!this._videoBeautyProcessor)if(this._videoBeautyProcessor=new k1t,this.processor){const A=this.processor;this.pipe(this._videoBeautyProcessor).pipe(A)}else this.pipe(this._videoBeautyProcessor).pipe(this.processorDestination);await this._videoBeautyProcessor.setBeautyEffectOptions(d),l?await this._videoBeautyProcessor.enable():await this._videoBeautyProcessor.disable()}catch(A){throw _a.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),A.toString()),b0("info",this,"setBeautyEffect",[l,d]),p.onError(A),A}_a.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),b0("info",this,"setBeautyEffect",[l,d],"success"),p.onSuccess()}else p.onSuccess()}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}clone(l,d,p,A){const y=this._mediaStreamTrack.clone();return new ftt(y,l,d,p,A)}async setBitrateLimit(l){if(_a.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(l))),b0("debug",this,"setBitrateLimit",l),l){this._forceBitrateLimit=l,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<l.max_bitrate?this._encoderConfig.bitrateMax:l.max_bitrate:this._encoderConfig.bitrateMax=l.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=l.min_bitrate);try{await YI(this,tI.NEED_UPDATE_VIDEO_ENCODER,this)}catch(d){return d.throw()}}}async setOptimizationMode(l){if(l!=="motion"&&l!=="detail"&&l!=="balanced")return _a.error(_f.INVALID_PARAMS,"optimization mode must be motion, detail or balanced"),void b0("error",this,"setOptimizationMode",l,_f.INVALID_PARAMS);const d=this._optimizationMode;try{this._optimizationMode=l,await YI(this,tI.SET_OPTIMIZATION_MODE,this)}catch(p){throw this._optimizationMode=d,_a.error("[".concat(this.getTrackId(),"] set optimization mode failed"),p.toString()),b0("error",this,"setOptimizationMode",l,p.toString()),p}_a.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(l,")")),b0("info",this,"setOptimizationMode",l,"success")}setScalabiltyMode(l){if(l.numSpatialLayers===1&&l.numTemporalLayers!==1)return _a.error(_f.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),b0("error",this,"setScalabiltyMode",l,_f.INVALID_PARAMS),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=l,_a.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(l,")")),b0("info",this,"setScalabiltyMode",l,"success")}updateMediaStreamTrackResolution(){kJ(this._originMediaStreamTrack).then(l=>{let[d,p]=l;this._videoHeight=p,this._videoWidth=d}).catch(bP)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:l,height:d,frameRate:p}=this.getMediaStreamTrackSettings();if(!l||!d||!p)return;const[A,y]=function(g,b,I){const k=y0("BITRATE_ADAPTER_TYPE");let B;const q=200*Math.pow(I/15,.6)*Math.pow(g*b/640/360,.75),$=q;if(k==="STANDARD_BITRATE")B=4*q;else{if(k!=="COMPATIABLE_BITRATE")return;B=2*q}return[Math.floor(B),Math.floor($)]}(l,d,p)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=y,this._encoderConfig.bitrateMax=A,_a.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(l,", h: ").concat(d,", fps: ").concat(p,"] => [brMax: ").concat(A,", brMin: ").concat(y,"]")),b0("debug",this,"updateBitrateFromProfile",void 0,"[w: ".concat(l,", h: ").concat(d,", fps: ").concat(p,"] => [brMax: ").concat(A,", brMin: ").concat(y,"]")))}getVideoElementVisibleStatus(){try{var l,d;const p=this==null||(l=this._player)===null||l===void 0?void 0:l.getContainerElement(),A={track:this,element:this==null||(d=this._player)===null||d===void 0?void 0:d.getVideoElement(),slot:p==null?void 0:p.parentElement},{element:y,slot:g}=A;if(this.isPlaying&&y instanceof HTMLVideoElement&&g instanceof HTMLElement){const b=DZ.checkOneElementVisible(y),I=Object.assign({},b);if(I.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=I.visible;const k=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});I.visible?k.onSuccess("Video is visible"):k.onSuccess("Invisible because of ".concat(I.reason))}return I}return}catch(p){throw new _E(_f.GET_VIDEO_ELEMENT_VISIBLE_ERROR,p.message)}}async renewMediaStreamTrack(l){}pipe(l){if(this._videoBeautyProcessor&&l!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(l);if(this.processor===l)return l;if(l._source)throw new _E(_f.INVALID_OPERATION,"Processor ".concat(l.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=l,this.processor._source=this,l.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),l}unpipe(){if(!this.processor)return;const l=this.processor;this.processor._source=void 0,this.processor=void 0,l.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){this.processorDestination.on(R_.ON_TRACK,async l=>{l?l!==this._mediaStreamTrack&&(this._mediaStreamTrack=l,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await YI(this,tI.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(R_.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(u_.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(u_.REQUEST_CONSTRAINTS)}}).prototype,"play",[hZ],Object.getOwnPropertyDescriptor(HI.prototype,"play"),HI.prototype),X0(HI.prototype,"setEnabled",[pZ,fZ],Object.getOwnPropertyDescriptor(HI.prototype,"setEnabled"),HI.prototype),X0(HI.prototype,"setMuted",[AZ,gZ,EZ],Object.getOwnPropertyDescriptor(HI.prototype,"setMuted"),HI.prototype),X0(HI.prototype,"getStats",[mZ],Object.getOwnPropertyDescriptor(HI.prototype,"getStats"),HI.prototype),X0(HI.prototype,"setBeautyEffect",[vZ],Object.getOwnPropertyDescriptor(HI.prototype,"setBeautyEffect"),HI.prototype),X0(HI.prototype,"getCurrentFrameData",[IZ],Object.getOwnPropertyDescriptor(HI.prototype,"getCurrentFrameData"),HI.prototype),X0(HI.prototype,"setBitrateLimit",[_Z],Object.getOwnPropertyDescriptor(HI.prototype,"setBitrateLimit"),HI.prototype),X0(HI.prototype,"setOptimizationMode",[yZ],Object.getOwnPropertyDescriptor(HI.prototype,"setOptimizationMode"),HI.prototype),X0(HI.prototype,"setScalabiltyMode",[bZ],Object.getOwnPropertyDescriptor(HI.prototype,"setScalabiltyMode"),HI.prototype),X0(HI.prototype,"updateMediaStreamTrackResolution",[CZ],Object.getOwnPropertyDescriptor(HI.prototype,"updateMediaStreamTrackResolution"),HI.prototype),SZ=HI))||SZ),PZ=(RZ=U1("CameraVideoTrack","getTrackId"),TZ=$I(),wZ=m2("CameraVideoTrack","_enabledMutex"),OZ=$I(),NZ=$I(),RZ((X0((NS=class extends A1{constructor(e,l,d,p,A,y){super(e,l.encoderConfig?o2(l.encoderConfig):{},p,A,y),_s(this,"_config",void 0),_s(this,"_originalConstraints",void 0),_s(this,"_constraints",void 0),_s(this,"_enabled",!0),_s(this,"_deviceName","default"),_s(this,"tryResumeVideoForIOS15WeChat",async()=>{t2()&&!_4()&&$H()&&this._enabled&&!this._isClosed&&(_a.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),Z0("info",this,"constructor",{trackId:y,deviceId:e.label,constraints:d,config:l}),this._config=l,this._originalConstraints=d,this._constraints=d,this._deviceName=e.label,this._config.encoderConfig&&(this._encoderConfig=o2(this._config.encoderConfig)),bI.on(d1.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),bI.on(d1.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}async setDevice(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(_a.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),b0("info",this,"setDevice",e),this._enabled)try{const d=await E_.getDeviceById(e),p={};p.video=D2({},this._constraints),p.video.deviceId={exact:e},p.video.facingMode=void 0,this._originMediaStreamTrack.stop();let A=null;try{A=await _C(p,this.getTrackId())}catch(y){throw _a.error("[".concat(this.getTrackId(),"] setDevice failed"),y.toString()),b0("error",this,"setDevice",e,y.toString()),A=await _C({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),y}await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=d.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(d){throw l.onError(d),_a.error("[".concat(this.getTrackId(),"] setDevice error"),d.toString()),b0("error",this,"setDevice",e,d.toString()),d}else try{const d=await E_.getDeviceById(e);this._deviceName=d.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(d){throw l.onError(d),_a.error("[".concat(this.getTrackId(),"] setDevice error"),d.toString()),b0("error",this,"setDevice",e,d.toString()),d}_a.info("[".concat(this.getTrackId(),"] setDevice success")),b0("info",this,"setDevice",e,"success"),l.onSuccess()}async setEnabled(e,l){if(!l){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_a.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),l||(this._enabled=!1);try{await YI(this,tI.NEED_DISABLE_TRACK,this)}catch(A){throw _a.error("[".concat(this.getTrackId(),"] setEnabled to false error"),A.toString()),b0("error",this,"setEnabled",e,A.toString()),A}return _a.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void b0("info",this,"setEnabled",e,"success")}const d=D2({},this._constraints),p=E_.searchDeviceIdByName(this._deviceName);p&&!d.deviceId&&(d.deviceId={exact:p});try{const A=await _C({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),await YI(this,tI.NEED_ENABLE_TRACK,this)}catch(A){throw _a.error("[".concat(this.getTrackId(),"] setEnabled true error"),A.toString()),b0("error",this,"setEnabled",e,A.toString()),A}this.updateMediaStreamTrackResolution(),_a.info("[".concat(this.getTrackId(),"] setEnabled to true success")),b0("info",this,"setEnabled",e,"success"),l||(this._enabled=!0)}async setEncoderConfiguration(e,l){const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),e]});if(!this._enabled){const y=new _E(_f.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw d.onError(y),y}e=o2(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const p=L1(this._config);p.encoderConfig=e;const A=U6(p);(y_()||h_()||VS())&&(A.deviceId=void 0),_a.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(A)),b0("debug",this,"setEncoderConfiguration",e);try{await this._originMediaStreamTrack.applyConstraints(A),this.updateMediaStreamTrackResolution()}catch(y){const g=new _E(_f.UNEXPECTED_ERROR,y.toString());throw _a.error("[".concat(this.getTrackId(),"] applyConstraints error"),g.toString()),b0("error",this,"setEncoderConfiguration",y.toString()),d.onError(g),g}this._config=p,this._constraints=A,this._originalConstraints=A,this._encoderConfig=e,this._hints.indexOf(F1.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await YI(this,tI.NEED_UPDATE_VIDEO_ENCODER,this)}catch(y){return d.onError(y),y.throw()}d.onSuccess()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((h_()||VS())&&this._enabled&&!this._isClosed&&bI.duringInterruption){const e=async()=>{bI.off(d1.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(_a.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),H0("debug",this,"try capture camera media device for interrupted iOS device."),await this.setEnabled(!1),await this.setEnabled(!0))};bI.on(d1.IOS_INTERRUPTION_END,e)}else _a.debug("[".concat(this.getTrackId(),"] track ended")),qS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(mR.TRACK_ENDED)}async renewMediaStreamTrack(e){const l=e||this._constraints,d=E_.searchDeviceIdByName(this._deviceName);d&&!l.deviceId&&(l.deviceId={exact:d});const p=await _C({video:l},this.getTrackId());this._constraints=l,await this._updateOriginMediaStreamTrack(p.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}close(){super.close(),bI.off(d1.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),bI.off(d1.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){this.processorContext.on(u_.REQUEST_UPDATE_CONSTRAINTS,async(e,l,d)=>{try{const p=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(p),l()}catch(p){d(p)}}),this.processorContext.on(u_.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[TZ],Object.getOwnPropertyDescriptor(NS.prototype,"setDevice"),NS.prototype),X0(NS.prototype,"setEnabled",[wZ,OZ],Object.getOwnPropertyDescriptor(NS.prototype,"setEnabled"),NS.prototype),X0(NS.prototype,"setEncoderConfiguration",[NZ],Object.getOwnPropertyDescriptor(NS.prototype,"setEncoderConfiguration"),NS.prototype),kZ=NS))||kZ);class L1t extends e1{constructor(l){super(),_s(this,"name","VideoProcessorDestination"),_s(this,"ID","0"),_s(this,"_source",void 0),_s(this,"videoContext",void 0),_s(this,"inputTrack",void 0),this.videoContext=l}get kind(){return"video"}get enabled(){return!0}pipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(l){if(l.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);l.track&&l.track!==this.inputTrack&&(this.inputTrack=l.track,this.emit(R_.ON_TRACK,l.track))}reset(){this.inputTrack=void 0,this.emit(R_.ON_TRACK,void 0)}}class P1t extends e1{constructor(l){super(),_s(this,"constraintsMap",new Map),_s(this,"statsRegistry",[]),_s(this,"trackId",void 0),this.trackId=l}async getConstraints(){return await O_(this,u_.REQUEST_CONSTRAINTS)}async requestApplyConstraints(l,d){var p;return _a.info("processor ".concat(d.name," requestApplyConstraints for ").concat(this.trackId)),l&&this.constraintsMap.set(d,l),YI(this,u_.REQUEST_UPDATE_CONSTRAINTS,Array.from(zS(p=this.constraintsMap).call(p)))}async requestRevertConstraints(l){var d;if(this.constraintsMap.has(l))return _a.info("processor ".concat(l.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(l),YI(this,u_.REQUEST_UPDATE_CONSTRAINTS,Array.from(zS(d=this.constraintsMap).call(d)))}registerStats(l,d,p){this.statsRegistry.find(A=>A.processorID===l.ID&&A.processorName===l.name&&A.type===d)||this.statsRegistry.push({processorName:l.name,processorID:l.ID,type:d,cb:p})}unregisterStats(l,d){}gatherStats(){return this.statsRegistry.map(l=>{let{processorID:d,processorName:p,type:A,cb:y}=l;return{processorID:d,processorName:p,type:A,stats:y()}})}}class j6{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(l,d){_s(this,"uid",void 0),_s(this,"_uintid",void 0),_s(this,"_trust_in_room_",!0),_s(this,"_trust_audio_enabled_state_",!0),_s(this,"_trust_video_enabled_state_",!0),_s(this,"_trust_audio_mute_state_",!0),_s(this,"_trust_video_mute_state_",!0),_s(this,"_trust_stream_added_state_",!0),_s(this,"_audio_muted_",!1),_s(this,"_video_muted_",!1),_s(this,"_audio_enabled_",!0),_s(this,"_video_enabled_",!0),_s(this,"_audio_added_",!1),_s(this,"_video_added_",!1),_s(this,"_audioTrack",void 0),_s(this,"_videoTrack",void 0),_s(this,"_audioSSRC",void 0),_s(this,"_videoSSRC",void 0),_s(this,"_audioOrtc",void 0),_s(this,"_videoOrtc",void 0),_s(this,"_cname",void 0),_s(this,"_rtxSsrcId",void 0),this.uid=l,this._uintid=d}}var x1t=AV,B1t=KT,M1t=AL;M1({target:"Promise",stat:!0},{try:function(e){var l=B1t.f(this),d=M1t(e);return(d.error?l.reject:l.resolve)(d.value),l.promise}});var F6=x1t,U1t=M1,j1t=II,F1t=m1,Q1t=PO,G1t=M_,V1t=_S,q1t=MS,xZ=nP,H1t=CW,K1t=NW,Y1t=LT,BZ=v1("isConcatSpreadable"),MZ=9007199254740991,UZ="Maximum allowed index exceeded",jZ=j1t.TypeError,W1t=Y1t>=51||!F1t(function(){var e=[];return e[BZ]=!1,e.concat()[0]!==e}),J1t=K1t("concat"),z1t=function(e){if(!G1t(e))return!1;var l=e[BZ];return l!==void 0?!!l:Q1t(e)};U1t({target:"Array",proto:!0,forced:!W1t||!J1t},{concat:function(e){var l,d,p,A,y,g=V1t(this),b=H1t(g,0),I=0;for(l=-1,p=arguments.length;l<p;l++)if(z1t(y=l===-1?g:arguments[l])){if(I+(A=q1t(y))>MZ)throw jZ(UZ);for(d=0;d<A;d++,I++)d in y&&xZ(b,I,y[d])}else{if(I>=MZ)throw jZ(UZ);xZ(b,I++,y)}return b.length=I,b}});var FZ={},X1t=iO,Z1t=uR,QZ=XN.f,$1t=F4,GZ=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];FZ.f=function(e){return GZ&&X1t(e)=="Window"?function(l){try{return QZ(l)}catch{return $1t(GZ)}}(e):QZ(Z1t(e))};var JO={},t_t=v1;JO.f=t_t;var VZ=xS,e_t=z1,n_t=JO,r_t=uS.f,R1=function(e){var l=VZ.Symbol||(VZ.Symbol={});e_t(l,e)||r_t(l,e,{value:n_t.f(e)})},L2=M1,Q6=II,i_t=cS,o_t=oM,zO=__,s_t=t1,P2=$_,vT=lM,G6=m1,P1=z1,a_t=PO,c_t=B1,u_t=M_,l_t=B_,V6=dM,q6=U_,d_t=_S,qP=uR,H6=xN,qZ=hR,K6=cR,XO=dO,HZ=_D,h_t=XN,KZ=FZ,Y6=$N,YZ=rO,WZ=uS,p_t=_k,JZ=ON,f_t=vU,W6=VT,ZO=PN.exports,zZ=ZN,XZ=EM,ZZ=v1,A_t=JO,g_t=R1,E_t=WR,$Z=GT,HP=RW.forEach,N_=zN("hidden"),KP="Symbol",t$=ZZ("toPrimitive"),m_t=$Z.set,e$=$Z.getterFor(KP),mS=Object.prototype,wR=Q6.Symbol,IT=wR&&wR.prototype,n$=Q6.TypeError,J6=Q6.QObject,$O=i_t("JSON","stringify"),r$=YZ.f,OR=WZ.f,i$=KZ.f,v_t=JZ.f,o$=s_t([].push),eR=ZO("symbols"),tN=ZO("op-symbols"),z6=ZO("string-to-symbol-registry"),X6=ZO("symbol-to-string-registry"),I_t=ZO("wks"),Z6=!J6||!J6.prototype||!J6.prototype.findChild,$6=P2&&G6(function(){return XO(OR({},"a",{get:function(){return OR(this,"a",{value:7}).a}})).a!=7})?function(e,l,d){var p=r$(mS,l);p&&delete mS[l],OR(e,l,d),p&&e!==mS&&OR(mS,l,p)}:OR,t8=function(e,l){var d=eR[e]=XO(IT);return m_t(d,{type:KP,tag:e,description:l}),P2||(d.description=l),d},YP=function(e,l,d){e===mS&&YP(tN,l,d),q6(e);var p=H6(l);return q6(d),P1(eR,p)?(d.enumerable?(P1(e,N_)&&e[N_][p]&&(e[N_][p]=!1),d=XO(d,{enumerable:K6(0,!1)})):(P1(e,N_)||OR(e,N_,K6(1,{})),e[N_][p]=!0),$6(e,p,d)):OR(e,p,d)},e8=function(e,l){q6(e);var d=qP(l),p=HZ(d).concat(n8(d));return HP(p,function(A){P2&&!zO(s$,d,A)||YP(e,A,d[A])}),e},s$=function(e){var l=H6(e),d=zO(v_t,this,l);return!(this===mS&&P1(eR,l)&&!P1(tN,l))&&(!(d||!P1(this,l)||!P1(eR,l)||P1(this,N_)&&this[N_][l])||d)},a$=function(e,l){var d=qP(e),p=H6(l);if(d!==mS||!P1(eR,p)||P1(tN,p)){var A=r$(d,p);return!A||!P1(eR,p)||P1(d,N_)&&d[N_][p]||(A.enumerable=!0),A}},c$=function(e){var l=i$(qP(e)),d=[];return HP(l,function(p){P1(eR,p)||P1(zZ,p)||o$(d,p)}),d},n8=function(e){var l=e===mS,d=i$(l?tN:qP(e)),p=[];return HP(d,function(A){!P1(eR,A)||l&&!P1(mS,A)||o$(p,eR[A])}),p};if(vT||(W6(IT=(wR=function(){if(l_t(IT,this))throw n$("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?qZ(arguments[0]):void 0,l=XZ(e),d=function(p){this===mS&&zO(d,tN,p),P1(this,N_)&&P1(this[N_],l)&&(this[N_][l]=!1),$6(this,l,K6(1,p))};return P2&&Z6&&$6(mS,l,{configurable:!0,set:d}),t8(l,e)}).prototype,"toString",function(){return e$(this).tag}),W6(wR,"withoutSetter",function(e){return t8(XZ(e),e)}),JZ.f=s$,WZ.f=YP,p_t.f=e8,YZ.f=a$,h_t.f=KZ.f=c$,Y6.f=n8,A_t.f=function(e){return t8(ZZ(e),e)},P2&&OR(IT,"description",{configurable:!0,get:function(){return e$(this).description}})),L2({global:!0,wrap:!0,forced:!vT,sham:!vT},{Symbol:wR}),HP(HZ(I_t),function(e){g_t(e)}),L2({target:KP,stat:!0,forced:!vT},{for:function(e){var l=qZ(e);if(P1(z6,l))return z6[l];var d=wR(l);return z6[l]=d,X6[d]=l,d},keyFor:function(e){if(!V6(e))throw n$(e+" is not a symbol");if(P1(X6,e))return X6[e]},useSetter:function(){Z6=!0},useSimple:function(){Z6=!1}}),L2({target:"Object",stat:!0,forced:!vT,sham:!P2},{create:function(e,l){return l===void 0?XO(e):e8(XO(e),l)},defineProperty:YP,defineProperties:e8,getOwnPropertyDescriptor:a$}),L2({target:"Object",stat:!0,forced:!vT},{getOwnPropertyNames:c$,getOwnPropertySymbols:n8}),L2({target:"Object",stat:!0,forced:G6(function(){Y6.f(1)})},{getOwnPropertySymbols:function(e){return Y6.f(d_t(e))}}),$O&&L2({target:"JSON",stat:!0,forced:!vT||G6(function(){var e=wR();return $O([e])!="[null]"||$O({a:e})!="{}"||$O(Object(e))!="{}"})},{stringify:function(e,l,d){var p=f_t(arguments),A=l;if((u_t(l)||e!==void 0)&&!V6(e))return a_t(l)||(l=function(y,g){if(c_t(A)&&(g=zO(A,this,y,g)),!V6(g))return g}),p[1]=l,o_t($O,null,p)}}),!IT[t$]){var __t=IT.valueOf;W6(IT,t$,function(e){return zO(__t,this)})}E_t(wR,KP),zZ[N_]=!0,R1("asyncIterator"),R1("hasInstance"),R1("isConcatSpreadable"),R1("iterator"),R1("match"),R1("matchAll"),R1("replace"),R1("search"),R1("species"),R1("split"),R1("toPrimitive"),R1("toStringTag"),R1("unscopables"),WR(II.JSON,"JSON",!0);var y_t=xS.Symbol;R1("asyncDispose"),R1("dispose"),R1("matcher"),R1("metadata"),R1("observable"),R1("patternMatch"),R1("replaceAll");var u$=y_t,l$=JO.f("asyncIterator"),b_t=l$;function d$(e){this.wrapped=e}function eN(e){var l,d;function p(y,g){try{var b=e[y](g),I=b.value,k=I instanceof d$;F6.resolve(k?I.wrapped:I).then(function(B){k?p(y==="return"?"return":"next",B):A(b.done?"return":"normal",B)},function(B){p("throw",B)})}catch(B){A("throw",B)}}function A(y,g){switch(y){case"return":l.resolve({value:g,done:!0});break;case"throw":l.reject(g);break;default:l.resolve({value:g,done:!1})}(l=l.next)?p(l.key,l.arg):d=null}this._invoke=function(y,g){return new F6(function(b,I){var k={key:y,arg:g,resolve:b,reject:I,next:null};d?d=d.next=k:(l=d=k,p(y,g))})},typeof e.return!="function"&&(this.return=void 0)}function nN(e){return function(){return new eN(e.apply(this,arguments))}}function o1(e){return new d$(e)}eN.prototype[typeof u$=="function"&&b_t||"@@asyncIterator"]=function(){return this},eN.prototype.next=function(e){return this._invoke("next",e)},eN.prototype.throw=function(e){return this._invoke("throw",e)},eN.prototype.return=function(e){return this._invoke("return",e)};var C_t=JO.f("iterator");function h$(e,l){var d={},p=!1;function A(y,g){return p=!0,g=new F6(function(b){b(e[y](g))}),{done:!1,value:l(g)}}return d[u$!==void 0&&C_t||"@@iterator"]=function(){return this},d.next=function(y){return p?(p=!1,y):A("next",y)},typeof e.throw=="function"&&(d.throw=function(y){if(p)throw p=!1,y;return A("throw",y)}),typeof e.return=="function"&&(d.return=function(y){return p?(p=!1,y):A("return",y)}),d}var S_t=l$,R_t=P_,T_t=j,w_t=f,WP=G0,O_t=W1,N_t=qI,k_t=I_,D_t=BT,L_t=J1.f,P_t=k3,nR=w_t.Symbol,_T=nR&&nR.prototype;if(T_t&&N_t(nR)&&(!("description"in _T)||nR().description!==void 0)){var p$={},JP=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:D_t(arguments[0]),l=k_t(_T,this)?new nR(e):e===void 0?nR():nR(e);return e===""&&(p$[l]=!0),l};P_t(JP,nR),JP.prototype=_T,_T.constructor=JP;var x_t=String(nR("test"))=="Symbol(test)",B_t=WP(_T.toString),M_t=WP(_T.valueOf),U_t=/^Symbol\((.*)\)[^)]+$/,j_t=WP("".replace),F_t=WP("".slice);L_t(_T,"description",{configurable:!0,get:function(){var e=M_t(this),l=B_t(e);if(O_t(p$,e))return"";var d=x_t?F_t(l,7,-1):j_t(l,U_t,"$1");return d===""?void 0:d}}),R_t({global:!0,forced:!0},{Symbol:JP})}var J_={exports:{}};function f$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function A$(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?f$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):f$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function r8(e,l,d,p,A,y){let g=[],b=[],I=[],k=[],B=!1,q=!1;if(J_.exports.parse(e).mediaDescriptions.forEach($=>{y&&y!==$.attributes.direction||($.media.mediaType!=="video"||B||(b=$.attributes.payloads,k=$.attributes.extmaps,B=!0),$.media.mediaType!=="audio"||q||(g=$.attributes.payloads,I=$.attributes.extmaps,q=!0))}),!k||b.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!I||g.length===0)throw new Error("Cannot get audio capabilities from SDP.");return b.forEach($=>{var _t;(_t=$.rtpMap)!==null&&_t!==void 0&&_t.clockRate&&($.rtpMap.clockRate=parseInt($.rtpMap.clockRate))}),g.forEach($=>{var _t;(_t=$.rtpMap)!==null&&_t!==void 0&&_t.clockRate&&($.rtpMap.clockRate=parseInt($.rtpMap.clockRate))}),l&&(g=g.filter($=>{var _t;return((_t=$.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())!=="rtx"}),b=b.filter($=>{var _t;return((_t=$.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())!=="rtx"})),d&&(b=b.filter($=>{var _t;return!/(red)|(ulpfec)|(flexfec)/i.test(((_t=$.rtpMap)===null||_t===void 0?void 0:_t.encodingName)||"")})),p&&(p==null?void 0:p.length)>0&&(g=g.filter($=>{var _t;return p.includes(((_t=$.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())||"")})),A&&(A==null?void 0:A.length)>0&&(b=b.filter($=>{var _t;return A.includes(((_t=$.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())||"")})),{audioCodecs:g,videoCodecs:b,audioExtensions:I,videoExtensions:k}}function zP(e){const l=J_.exports.parse(e);let d,p;for(const A of l.mediaDescriptions){if(!d){const y=A.attributes.iceUfrag,g=A.attributes.icePwd;if(!y||!g)throw new Error("Cannot get iceUfrag or icePwd from SDP.");d={iceUfrag:y,icePwd:g}}if(!p){const y=A.attributes.fingerprints;y.length>0&&(p={fingerprints:y})}}if(!p&&l.attributes.fingerprints.length>0&&(p={fingerprints:l.attributes.fingerprints}),!p||!d)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:d,dtlsParameters:p}}function g$(e,l,d){const{cname:p}=e;let A;l!==void 0&&d!==void 0?(A=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:l,port:d.toString(),type:"host",extension:{}}],_a.debug("Using remote candidate from AP ".concat(l,":").concat(d)),H0("debug",[],"Using remote candidate from AP ".concat(l,":").concat(d))):A=e.iceParameters.candidates.map(I=>({foundation:I.foundation,componentId:"1",transport:I.protocol,priority:I.priority.toString(),connectionAddress:I.ip,port:I.port.toString(),type:I.type,extension:{}}));const y={fingerprints:e.dtlsParameters.fingerprints.map(I=>({hashFunction:I.algorithm,fingerprint:I.fingerprint}))},g={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let b;switch(e.dtlsParameters.role){case"server":b="passive";break;case"client":b="active";break;case"auto":b="actpass"}return{dtlsParameters:y,iceParameters:g,candidates:A,rtpCapabilities:I$(e.rtpCapabilities),setup:b,cname:p}}function x2(e,l,d){const p=[],A=[];return e.forEach(y=>{let{ssrcId:g,rtx:b}=y;const I=i1(8,"track-"),k={ssrcId:g,attributes:A$({label:I,mslabel:d=d||i1(10,""),msid:"".concat(d," ").concat(I)},l&&{cname:l})};if(p.push(k),b!==void 0){const B={ssrcId:b,attributes:A$({label:I,mslabel:d,msid:"".concat(d," ").concat(I)},l&&{cname:l})};p.push(B),A.push({semantic:"FID",ssrcIds:[g,b]})}}),e.length>1&&A.push({semantic:"SIM",ssrcIds:e.map(y=>{let{ssrcId:g}=y;return g})}),{ssrcs:p,ssrcGroups:A}}function XP(e,l){l instanceof D1&&e.attributes.payloads.forEach(d=>{var p;const A=(p=d.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase();if(!A||["opus","pcmu","pcma","g722"].indexOf(A)===-1)return;d.fmtp||(d.fmtp={parameters:{}}),d.fmtp.parameters.minptime="10",d.fmtp.parameters.useinbandfec="1";const y=l._encoderConfig;y&&(A!=="pcmu"&&A!=="pcma"&&A!=="g722"&&(y.bitrate&&!d_()&&(d.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*y.bitrate))),y.sampleRate&&(d.fmtp.parameters.maxplaybackrate="".concat(y.sampleRate),d.fmtp.parameters["sprop-maxcapturerate"]="".concat(y.sampleRate))),y.stereo&&(d.fmtp.parameters.stereo="1",d.fmtp.parameters["sprop-stereo"]="1"))})}function E$(e){const l=e.attributes.unrecognized.findIndex(d=>d.attField==="x-google-flag"&&d.attValue==="conference");l!==-1&&e.attributes.unrecognized.splice(l,1)}function m$(e,l){if(!(l instanceof A1&&l._encoderConfig&&l._hints.indexOf(F1.SCREEN_TRACK)===-1))return;const d=l._encoderConfig;t_().supportMinBitrate&&d.bitrateMin&&e.attributes.payloads.forEach(p=>{var A;["h264","vp8","vp9","av1"].includes(((A=p.rtpMap)===null||A===void 0?void 0:A.encodingName.toLowerCase())||"")&&(p.fmtp||(p.fmtp={parameters:{}}),p.fmtp.parameters["x-google-min-bitrate"]="".concat(d.bitrateMin))}),t_().supportMinBitrate&&!l._hints.includes(F1.LOW_STREAM)&&d.bitrateMax&&e.attributes.payloads.forEach(p=>{var A;["h264","vp8","vp9","av1"].includes(((A=p.rtpMap)===null||A===void 0?void 0:A.encodingName.toLowerCase())||"")&&(p.fmtp||(p.fmtp={parameters:{}}),p.fmtp.parameters["x-google-start-bitrate"]="".concat(Math.floor(d.bitrateMax)))})}function v$(e,l,d){if(!l)return;let p,A;if(e.media.mediaType==="video"?(p=d.videoExtensions,A=d.videoCodecs):(p=d.audioExtensions,A=d.audioCodecs),l.tcc===!0){const y=p.find(g=>g.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");y&&(e.attributes.extmaps.find(g=>g.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||e.attributes.extmaps.push({entry:y.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(g,b){return b.filter(I=>!!g.find(k=>k.payloadType===I.payloadType&&!!k.rtcpFeedbacks.find(B=>B.type==="transport-cc")))}(A,e.attributes.payloads).forEach(g=>{g.rtcpFeedbacks.find(b=>b.type==="transport-cc")||g.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(l.tcc===!1){const y=e.attributes.extmaps.findIndex(g=>g.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");y!==-1&&e.attributes.extmaps.splice(y,1),e.attributes.payloads.forEach(g=>{const b=g.rtcpFeedbacks.findIndex(I=>I.type==="transport-cc");b!==-1&&g.rtcpFeedbacks.splice(b,1)})}if(l.remb===!0){const y=p.find(g=>g.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");y&&(e.attributes.extmaps.find(g=>g.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||e.attributes.extmaps.push({entry:y.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(g,b){return b.filter(I=>!!g.find(k=>k.payloadType===I.payloadType&&!!k.rtcpFeedbacks.find(B=>B.type==="goog-remb")))}(A,e.attributes.payloads).forEach(g=>{g.rtcpFeedbacks.find(b=>b.type==="goog-remb")||g.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(l.remb===!1){const y=e.attributes.extmaps.findIndex(g=>g.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");y!==-1&&e.attributes.extmaps.splice(y,1),e.attributes.payloads.forEach(g=>{const b=g.rtcpFeedbacks.findIndex(I=>I.type==="goog-remb");b!==-1&&g.rtcpFeedbacks.splice(b,1)})}}function ZP(e,l,d,p,A,y){if(d==="videoExtensions"||d==="audioExtensions"){const g=[];return e[d].forEach(b=>{l[d].some((I,k)=>{if(b.entry===I.entry&&b.extensionName===I.extensionName)return g.push(k),!0})?y[d].push(b):p[d].push(b)}),void l[d].forEach((b,I)=>{g.indexOf(I)===-1&&A[d].push(b)})}if(d==="videoCodecs"||d==="audioCodecs"){const g=[];return e[d].forEach(b=>{l[d].some((I,k)=>{if(b.payloadType===I.payloadType&&JSON.stringify(b)===JSON.stringify(I))return g.push(k),!0})?y[d].push(b):p[d].push(b)}),void l[d].forEach((b,I)=>{g.indexOf(I)===-1&&A[d].push(b)})}}function I$(e){const{send:l,recv:d,sendrecv:p}=e;if(!p){if(!l||!d)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:l,recv:d}}let A,y;return l?(A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},A.audioCodecs=[...l.audioCodecs,...p.audioCodecs],A.videoCodecs=[...l.videoCodecs,...p.videoCodecs],A.audioExtensions=[...l.audioExtensions,...p.audioExtensions],A.videoExtensions=[...l.videoExtensions,...p.videoExtensions]):A=p,d?(y={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},y.audioCodecs=[...d.audioCodecs,...p.audioCodecs],y.videoCodecs=[...d.videoCodecs,...p.videoCodecs],y.audioExtensions=[...d.audioExtensions,...p.audioExtensions],y.videoExtensions=[...d.videoExtensions,...p.videoExtensions]):y=p,{send:A,recv:y}}(function(e,l){e.exports=(()=>{var d={8:(y,g,b)=>{b.r(g),b.d(g,{Parser:()=>j0,Printer:()=>P0,parse:()=>w0,print:()=>B0});const I=`
`,k="".concat("\r").concat(I),B=" ";let q;function $(g0){return g0>="0"&&g0<="9"}function _t(g0){return g0>="!"&&g0<="~"}function _r(g0){return _t(g0)||g0>="\x80"&&g0<="\xFF"}function _i(g0){return g0==="!"||g0>="#"&&g0<="'"||g0>="*"&&g0<="+"||g0>="-"&&g0<="."||g0>="0"&&g0<="9"||g0>="A"&&g0<="Z"||g0>="^"&&g0<="~"}function ga(g0){return g0>="1"&&g0<="9"}function _u(g0){return g0>="A"&&g0<="Z"||g0>="a"&&g0<="z"}function ah(g0){return g0==="d"||g0==="h"||g0==="m"||g0==="s"}function _h(g0){return g0>""&&g0<"	"||g0>"\v"&&g0<"\f"||g0>""&&g0<"\xFF"}function _A(g0){return _u(g0)||$(g0)||g0==="+"||g0==="/"}function n0(g0){return $(g0)||_u(g0)||g0==="+"||g0==="/"||g0==="-"||g0==="_"}function f0(g0){return _u(g0)||$(g0)||g0==="+"||g0==="/"}function E0(g0,_n){var _l=Object.keys(g0);if(Object.getOwnPropertySymbols){var _p=Object.getOwnPropertySymbols(g0);_n&&(_p=_p.filter(function(p0){return Object.getOwnPropertyDescriptor(g0,p0).enumerable})),_l.push.apply(_l,_p)}return _l}function m0(g0){for(var _n=1;_n<arguments.length;_n++){var _l=arguments[_n]!=null?arguments[_n]:{};_n%2?E0(Object(_l),!0).forEach(function(_p){V0(g0,_p,_l[_p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g0,Object.getOwnPropertyDescriptors(_l)):E0(Object(_l)).forEach(function(_p){Object.defineProperty(g0,_p,Object.getOwnPropertyDescriptor(_l,_p))})}return g0}function V0(g0,_n,_l){return _n in g0?Object.defineProperty(g0,_n,{value:_l,enumerable:!0,configurable:!0,writable:!0}):g0[_n]=_l,g0}(function(g0){g0.VERSION="v",g0.ORIGIN="o",g0.SESSION_NAME="s",g0.INFORMATION="i",g0.URI="u",g0.EMAIL="e",g0.PHONE="p",g0.CONNECTION="c",g0.BANDWIDTH="b",g0.TIME="t",g0.REPEAT="r",g0.ZONE_ADJUSTMENTS="z",g0.KEY="k",g0.ATTRIBUTE="a",g0.MEDIA="m"})(q||(q={}));class D0{consumeText(_n,_l){let _p=_l;for(;_p<_n.length;){const p0=_n[_p];if(p0==="\0"||p0==="\r"||p0===I)break;_p+=1}if(_p-_l==0)throw new Error("Invalid text, at ".concat(_n));return _p}consumeUnicastAddress(_n,_l,_p){return this.consumeTill(_n,_l,B)}consumeOneOrMore(_n,_l,_p){let p0=_l;for(;_p(_n[p0]);)p0++;if(p0-_l==0)throw new Error("Invalid rule at ".concat(_l,"."));return p0}consumeSpace(_n,_l){if(_n[_l]===B)return _l+1;throw new Error("Invalid space at ".concat(_l,"."))}consumeIP4Address(_n,_l){let _p=_l;for(let p0=0;p0<4;p0++)if(_p=this.consumeDecimalUChar(_n,_p),p0!==3){if(_n[_p]!==".")throw new Error("Invalid IP4 address.");_p++}return _p}consumeDecimalUChar(_n,_l){let _p=_l;for(let L0=0;L0<3&&$(_n[_p]);L0++,_p++);if(_p-_l==0)throw new Error("Invalid decimal uchar.");const p0=parseInt(_n.slice(_l,_p));if(p0>=0&&p0<=255)return _p;throw new Error("Invalid decimal uchar")}consumeIP6Address(_n,_l){let _p=this.consumeHexpart(_n,_l);return _n[_p]===":"&&(_p+=1,_p=this.consumeIP4Address(_n,_p)),_p}consumeHexpart(_n,_l){let _p=_l;if(_n[_p]===":"&&_n[_p+1]===":"){_p+=2;try{_p=this.consumeHexseq(_n,_p)}catch{}return _p}if(_p=this.consumeHexseq(_n,_p),_n[_p]===":"&&_n[_p+1]===":"){_p+=2;try{_p=this.consumeHexseq(_n,_p)}catch{}return _p}return _p}consumeHexseq(_n,_l){let _p=_l;for(;_p=this.consumeHex4(_n,_p),_n[_p]===":"&&_n[_p+1]!==":";)_p+=1;return _p}consumeHex4(_n,_l){let _p=0;for(;_p<4;_p++)if(!((p0=_n[_l+_p])>="0"&&p0<="9"||p0>="a"&&p0<="f"||p0>="A"&&p0<="F")){if(_p===0)throw new Error("Invalid hex 4");break}var p0;return _l+_p}consumeFQDN(_n,_l){let _p=_l;for(;$(_n[_p])||_u(_n[_p])||_n[_p]==="-"||_n[_p]===".";)_p+=1;if(_p-_l<4)throw new Error("Invalid FQDN");return _p}consumeExtnAddr(_n,_l){return this.consumeOneOrMore(_n,_l,_r)}consumeMulticastAddress(_n,_l,_p){switch(_p){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(_n,_l);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(_n,_l);default:try{return this.consumeFQDN(_n,_l)}catch{return this.consumeExtnAddr(_n,_l)}}}consumeIP6MulticastAddress(_n,_l){const _p=this.consumeHexpart(_n,_l);return _n[_p]==="/"?this.consumeInteger(_n,_p+1):_p}consumeIP4MulticastAddress(_n,_l){let _p=_l+3;const p0=_n.slice(_l,_p),L0=parseInt(p0);if(L0<224||L0>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let oI=0;oI<3;oI++){if(_n[_p]!==".")throw new Error("Invalid IP4 multicast address.");_p+=1,_p=this.consumeDecimalUChar(_n,_p)}return _n[_p]==="/"&&(_p+=1),_p=this.consumeTTL(_n,_p),_n[_p]==="/"&&(_p=this.consumeInteger(_n,_p)),_p}consumeInteger(_n,_l){if(!ga(_n[_l]))throw new Error("Invalid integer.");for(_l+=1;$(_n[_l]);)_l+=1;return _l}consumeTTL(_n,_l){if(_n[_l]==="0")return _l+1;if(!ga(_n[_l]))throw new Error("Invalid TTL.");_l+=1;for(let _p=0;_p<2&&$(_n[_l]);_p++)_l+=1;return _l}consumeToken(_n,_l){return this.consumeOneOrMore(_n,_l,_i)}consumeTime(_n,_l){let _p=_l;if(_n[_p]==="0")return _p+1;for(ga(_n[_p])&&(_p+=1);$(_n[_p]);)_p++;if(_p-_l<10)throw new Error("Invalid time");return _p}consumeAddress(_n,_l){return this.consumeTill(_n,_l,B)}consumeTypedTime(_n,_l){let _p=_l;return _p=this.consumeOneOrMore(_n,_p,$),ah(_n[_p])?_p+1:_p}consumeRepeatInterval(_n,_l){if(!ga(_n[_l]))throw new Error("Invalid repeat interval");for(_l+=1;$(_n[_l]);)_l+=1;return ah(_n[_l])&&(_l+=1),_l}consumePort(_n,_l){return this.consumeOneOrMore(_n,_l,$)}consume(_n,_l,_p){for(let p0=0;p0<_p.length;p0++){if(_l+p0>=_n.length)throw new Error("consume exceeding value length");if(_n[_l+p0]!==_p[p0])throw new Error("consume ".concat(_p," failed at ").concat(p0))}return _l+_p.length}consumeTill(_n,_l,_p){let p0=_l;for(;p0<_n.length&&(typeof _p!="string"||_n[p0]!==_p)&&(typeof _p!="function"||!_p(_n[p0]));)p0++;return p0}}class j0 extends D0{constructor(){super(),V0(this,"records",[]),V0(this,"currentLine",0)}parse(_n){const _l=this.probeEOL(_n);this.records=_n.split(_l).filter(v_=>!!v_.trim()).map(this.parseLine),this.currentLine=0;const _p=this.parseVersion(),p0=this.parseOrigin(),L0=this.parseSessionName(),oI=this.parseInformation(),rI=this.parseUri(),cI=this.parseEmail(),LI=this.parsePhone(),x1=this.parseConnection(),g1=this.parseBandWidth(),FI=this.parseTimeFields(),BI=this.parseKey(),u1=this.parseSessionAttribute(),n_=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:_p,origin:p0,sessionName:L0,information:oI,uri:rI,emails:cI,phones:LI,connection:x1,bandwidths:g1,timeFields:FI,key:BI,attributes:u1,mediaDescriptions:n_}}getCurrentRecord(){const _n=this.records[this.currentLine];if(!_n)throw new Error("Record doesn't exit.");return _n}probeEOL(_n){for(let _l=0;_l<_n.length;_l++)if(_n[_l]===I)return _n[_l-1]==="\r"?k:I;throw new Error("Invalid newline character.")}parseLine(_n,_l){if(_n.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const _p=_n[0];if(_n[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:_p,value:_n.slice(2),line:_l,cur:0}}parseSessionAttribute(){const _n=new _m;for(;this.currentLine<this.records.length;){const _l=this.getCurrentRecord();if(_l.type!==q.ATTRIBUTE)break;const _p={attField:this.extractOneOrMore(_l,p0=>_i(p0)&&p0!==":"),_cur:0};_l.value[_l.cur]===":"&&(_l.cur+=1,_p.attValue=this.extractOneOrMore(_l,_h)),_n.parse(_p),this.currentLine++}return _n.digest()}parseMediaAttributes(_n){const _l=new t0(_n);for(;this.currentLine<this.records.length;){const _p=this.getCurrentRecord();if(_p.type!==q.ATTRIBUTE)break;const p0={attField:this.extractOneOrMore(_p,L0=>_i(L0)&&L0!==":"),_cur:0};_p.value[_p.cur]===":"&&(_p.cur+=1,p0.attValue=this.extractOneOrMore(_p,_h)),_l.parse(p0),this.currentLine++}return _l.digest()}parseKey(){const _n=this.getCurrentRecord();if(_n.type===q.KEY){if(_n.value==="prompt"||_n.value==="clear:"||_n.value==="base64:"||_n.value==="uri:")return _n.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const _n=this.getCurrentRecord();if(_n.type===q.ZONE_ADJUSTMENTS){const _l=[];for(;;)try{const _p=this.extract(_n,this.consumeTime);this.consumeSpaceForRecord(_n);let p0=!1;_n.value[_n.cur]==="-"&&(p0=!0,_n.cur+=1);const L0=this.extract(_n,this.consumeTypedTime);_l.push({time:_p,typedTime:L0,back:p0})}catch{break}if(_l.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,_l}return[]}parseRepeat(){const _n=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.REPEAT)break;{const _p=this.extract(_l,this.consumeRepeatInterval),p0=this.parseTypedTime(_l);_n.push({repeatInterval:_p,typedTimes:p0}),this.currentLine++}}return _n}parseTypedTime(_n){const _l=[];for(;;)try{this.consumeSpaceForRecord(_n),_l.push(this.extract(_n,this.consumeTypedTime))}catch{break}if(_l.length===0)throw new Error("Invalid typed time.");return _l}parseTime(){const _n=this.getCurrentRecord(),_l=this.extract(_n,this.consumeTime);this.consumeSpaceForRecord(_n);const _p=this.extract(_n,this.consumeTime);return this.currentLine++,{startTime:_l,stopTime:_p}}parseBandWidth(){const _n=[];for(;this.currentLine<this.records.length;){const _l=this.getCurrentRecord();if(_l.type!==q.BANDWIDTH)break;{const _p=this.extractOneOrMore(_l,_i);if(_l.value[_l.cur]!==":")throw new Error("Invalid bandwidth field.");_l.cur++;const p0=this.extractOneOrMore(_l,$);_n.push({bwtype:_p,bandwidth:p0}),this.currentLine++}}return _n}parseVersion(){const _n=this.getCurrentRecord();if(_n.type!==q.VERSION)throw new Error("first sdp record must be version");const _l=_n.value.slice(0,this.consumeOneOrMore(_n.value,0,$));if(_l.length!==_n.value.length)throw new Error('invalid proto version, "v='.concat(_n.value,'"'));return this.currentLine++,_l}parseOrigin(){const _n=this.getCurrentRecord();if(_n.type!==q.ORIGIN)throw new Error("second line of sdp must be origin");const _l=this.extractOneOrMore(_n,_r);this.consumeSpaceForRecord(_n);const _p=this.extractOneOrMore(_n,$);this.consumeSpaceForRecord(_n);const p0=this.extractOneOrMore(_n,$);this.consumeSpaceForRecord(_n);const L0=this.extractOneOrMore(_n,_i);this.consumeSpaceForRecord(_n);const oI=this.extractOneOrMore(_n,_i);this.consumeSpaceForRecord(_n);const rI=this.extract(_n,this.consumeUnicastAddress);return this.currentLine++,{username:_l,sessId:_p,sessVersion:p0,nettype:L0,addrtype:oI,unicastAddress:rI}}parseSessionName(){const _n=this.getCurrentRecord();if(_n.type===q.SESSION_NAME){const _l=this.extract(_n,this.consumeText);return this.currentLine++,_l}}parseInformation(){const _n=this.getCurrentRecord();if(_n.type!==q.INFORMATION)return;const _l=this.extract(_n,this.consumeText);return this.currentLine++,_l}parseUri(){const _n=this.getCurrentRecord();if(_n.type===q.URI)return this.currentLine++,_n.value}parseEmail(){const _n=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.EMAIL)break;_n.push(_l.value),this.currentLine++}return _n}parsePhone(){const _n=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.PHONE)break;_n.push(_l.value),this.currentLine++}return _n}parseConnection(){const _n=this.getCurrentRecord();if(_n.type===q.CONNECTION){const _l=this.extractOneOrMore(_n,_i);this.consumeSpaceForRecord(_n);const _p=this.extractOneOrMore(_n,_i);this.consumeSpaceForRecord(_n);const p0=this.extract(_n,this.consumeAddress);return this.currentLine++,{nettype:_l,addrtype:_p,address:p0}}}parseMedia(){const _n=this.getCurrentRecord(),_l=this.extract(_n,this.consumeToken);this.consumeSpaceForRecord(_n);let _p=this.extract(_n,this.consumePort);_n.value[_n.cur]==="/"&&(_n.cur+=1,_p+=this.extract(_n,this.consumeInteger)),this.consumeSpaceForRecord(_n);const p0=[];for(p0.push(this.extract(_n,this.consumeToken));_n.value[_n.cur]==="/";)_n.cur+=1,p0.push(this.extract(_n,this.consumeToken));if(p0.length===0)throw new Error("Invalid proto");const L0=this.parseFmt(_n);return this.currentLine++,{mediaType:_l,port:_p,protos:p0,fmts:L0}}parseTimeFields(){const _n=[];for(;this.getCurrentRecord().type===q.TIME;){const _l=this.parseTime(),_p=this.parseRepeat(),p0=this.parseZone();_n.push({time:_l,repeats:_p,zones:p0})}return _n}parseMediaDescription(){const _n=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===q.MEDIA;){const _l=this.parseMedia(),_p=this.parseInformation(),p0=this.parseConnections(),L0=this.parseBandWidth(),oI=this.parseKey(),rI=this.parseMediaAttributes(_l);_n.push({media:_l,information:_p,connections:p0,bandwidths:L0,key:oI,attributes:rI})}return _n}parseConnections(){const _n=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===q.CONNECTION;)_n.push(this.parseConnection());return _n}parseFmt(_n){const _l=[];for(;;)try{this.consumeSpaceForRecord(_n),_l.push(this.extract(_n,this.consumeToken))}catch{break}if(_l.length===0)throw new Error("Invalid fmts");return _l}extract(_n,_l,..._p){const p0=_l.call(this,_n.value,_n.cur,..._p),L0=_n.value.slice(_n.cur,p0);return _n.cur=p0,L0}extractOneOrMore(_n,_l){const _p=this.consumeOneOrMore(_n.value,_n.cur,_l),p0=_n.value.slice(_n.cur,_p);return _n.cur=_p,p0}consumeSpaceForRecord(_n){if(_n.value[_n.cur]!==B)throw new Error("Invalid space at ".concat(_n.cur,"."));_n.cur+=1}}class c0 extends D0{constructor(..._n){super(..._n),V0(this,"attributes",void 0),V0(this,"digested",!1)}extractOneOrMore(_n,_l,_p){const p0=this.consumeOneOrMore(_n.attValue,_n._cur,_l),L0=_n.attValue.slice(_n._cur,p0),[oI,rI]=_p||[];if(typeof oI=="number"&&L0.length<oI)throw new Error("error in length, should be more or equal than ".concat(oI," characters."));if(typeof rI=="number"&&L0.length>rI)throw new Error("error in length, should be less or equal than ".concat(rI," characters."));return _n._cur=p0,L0}consumeAttributeSpace(_n){if(_n.attValue[_n._cur]!==B)throw new Error("Invalid space at ".concat(_n._cur,"."));_n._cur+=1}extract(_n,_l,..._p){if(!_n.attValue)throw new Error("Nothing to extract from attValue.");const p0=_l.call(this,_n.attValue,_n._cur,..._p),L0=_n.attValue.slice(_n._cur,p0);return _n._cur=p0,L0}atEnd(_n){if(!_n.attValue)throw new Error;return _n._cur>=_n.attValue.length}peekChar(_n){if(!_n.attValue)throw new Error;return _n.attValue[_n._cur]}peek(_n,_l){if(!_n.attValue)throw new Error;for(let _p=0;_p<_l.length;_p++)if(_l[_p]!==_n.attValue[_n._cur+_p])return!1;return!0}parseIceUfrag(_n){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(_n,_A,[4,256])}parseIcePwd(_n){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(_n,_A,[22,256])}parseIceOptions(_n){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const _l=[];for(;!this.atEnd(_n);){_l.push(this.extractOneOrMore(_n,_A));try{this.consumeAttributeSpace(_n)}catch(_p){if(this.atEnd(_n))break;throw _p}}this.attributes.iceOptions=_l}parseFingerprint(_n){const _l=this.extract(_n,this.consumeToken);this.consumeAttributeSpace(_n);const _p=this.extract(_n,this.consumeTill);this.attributes.fingerprints.push({hashFunction:_l,fingerprint:_p})}parseExtmap(_n){const _l=this.extractOneOrMore(_n,$);let _p;this.peekChar(_n)==="/"&&(this.extract(_n,this.consume,"/"),_p=this.extract(_n,this.consumeToken)),this.consumeAttributeSpace(_n);const p0=this.extract(_n,this.consumeTill,B),L0=m0(m0({entry:parseInt(_l,10)},_p&&{direction:_p}),{},{extensionName:p0});this.peekChar(_n)===B&&(this.consumeAttributeSpace(_n),L0.extensionAttributes=this.extract(_n,this.consumeTill)),this.attributes.extmaps.push(L0)}parseSetup(_n){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const _l=this.extract(_n,this.consumeTill);if(_l!=="active"&&_l!=="passive"&&_l!=="actpass"&&_l!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=_l}}class _m extends c0{constructor(..._n){super(..._n),V0(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(_n){if(this.digested)throw new Error("already digested");try{switch(_n.attField){case"group":this.parseGroup(_n);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(_n);break;case"ice-pwd":this.parseIcePwd(_n);break;case"ice-options":this.parseIceOptions(_n);break;case"fingerprint":this.parseFingerprint(_n);break;case"setup":this.parseSetup(_n);break;case"tls-id":this.parseTlsId(_n);break;case"identity":this.parseIdentity(_n);break;case"extmap":this.parseExtmap(_n);break;case"msid-semantic":this.parseMsidSemantic(_n);break;default:_n.ignored=!0,this.attributes.unrecognized.push(_n)}}catch(_l){throw console.error("parsing session attribute ".concat(_n.attField,' error, "a=').concat(_n.attField,":").concat(_n.attValue,'"')),_l}if(!_n.ignored&&_n.attValue&&!this.atEnd(_n))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(_n){const _l=this.extract(_n,this.consumeToken),_p=[];for(;!this.atEnd(_n)&&this.peekChar(_n)===B;)this.consumeAttributeSpace(_n),_p.push(this.extract(_n,this.consumeToken));this.attributes.groups.push({semantic:_l,identificationTag:_p})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(_n){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(_n,n0)}parseIdentity(_n){const _l=this.extractOneOrMore(_n,f0),_p=[];for(;!this.atEnd(_n)&&this.peekChar(_n)===B;){this.consumeAttributeSpace(_n);const p0=this.extract(_n,this.consumeToken);this.extract(_n,this.consume,"=");const L0=this.extractOneOrMore(_n,oI=>oI!==B&&_h(oI));_p.push({name:p0,value:L0})}this.attributes.identities.push({assertionValue:_l,extensions:_p})}parseMsidSemantic(_n){this.peekChar(_n)===B&&this.consumeAttributeSpace(_n);const _l={semantic:this.extract(_n,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(_n)}catch{break}if(this.peekChar(_n)==="*"){this.extract(_n,this.consume,"*"),_l.applyForAll=!0;break}{const _p=this.extract(_n,this.consumeTill,B);_l.identifierList.push(_p)}}this.attributes.msidSemantic=_l}}class t0 extends c0{constructor(_n){super(),V0(this,"attributes",void 0),_n.protos.indexOf("RTP")!==-1||_n.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(_n){if(this.digested)throw new Error("already digested");try{switch(_n.attField){case"extmap":this.parseExtmap(_n);break;case"setup":this.parseSetup(_n);break;case"ice-ufrag":this.parseIceUfrag(_n);break;case"ice-pwd":this.parseIcePwd(_n);break;case"ice-options":this.parseIceOptions(_n);break;case"candidate":this.parseCandidate(_n);break;case"remote-candidate":this.parseRemoteCandidate(_n);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(_n);break;case"rtpmap":this.parseRtpmap(_n);break;case"ptime":this.parsePtime(_n);break;case"maxptime":this.parseMaxPtime(_n);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(_n);break;case"ssrc":this.parseSSRC(_n);break;case"fmtp":this.parseFmtp(_n);break;case"rtcp-fb":this.parseRtcpFb(_n);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(_n);break;case"mid":this.parseMid(_n);break;case"msid":this.parseMsid(_n);break;case"imageattr":this.parseImageAttr(_n);break;case"rid":this.parseRid(_n);break;case"simulcast":this.parseSimulcast(_n);break;case"sctp-port":this.parseSctpPort(_n);break;case"max-message-size":this.parseMaxMessageSize(_n);break;case"ssrc-group":this.parseSSRCGroup(_n);break;default:_n.ignored=!0,this.attributes.unrecognized.push(_n)}}catch(_l){throw console.error("parsing media attribute ".concat(_n.attField,' error, "a=').concat(_n.attField,":").concat(_n.attValue,'"')),_l}if(!_n.ignored&&_n.attValue&&!this.atEnd(_n))throw new Error("attribute parsing error")}parseCandidate(_n){const _l=this.extractOneOrMore(_n,_A,[1,32]);this.consumeAttributeSpace(_n);const _p=this.extractOneOrMore(_n,$,[1,5]);this.consumeAttributeSpace(_n);const p0=this.extract(_n,this.consumeToken);this.consumeAttributeSpace(_n);const L0=this.extractOneOrMore(_n,$,[1,10]);this.consumeAttributeSpace(_n);const oI=this.extract(_n,this.consumeAddress);this.consumeAttributeSpace(_n);const rI=this.extract(_n,this.consumePort);this.consumeAttributeSpace(_n),this.extract(_n,this.consume,"typ"),this.consumeAttributeSpace(_n);const cI={foundation:_l,componentId:_p,transport:p0,priority:L0,connectionAddress:oI,port:rI,type:this.extract(_n,this.consumeToken),extension:{}};for(this.peek(_n," raddr")&&(this.extract(_n,this.consume," raddr"),this.consumeAttributeSpace(_n),cI.relAddr=this.extract(_n,this.consumeAddress)),this.peek(_n," rport")&&(this.extract(_n,this.consume," rport"),this.consumeAttributeSpace(_n),cI.relPort=this.extract(_n,this.consumePort));this.peekChar(_n)===B;){this.consumeAttributeSpace(_n);const LI=this.extract(_n,this.consumeToken);this.consumeAttributeSpace(_n),cI.extension[LI]=this.extractOneOrMore(_n,_t)}this.attributes.candidates.push(cI)}parseRemoteCandidate(_n){const _l=[];for(;;){const _p=this.extractOneOrMore(_n,$,[1,5]);this.consumeAttributeSpace(_n);const p0=this.extract(_n,this.consumeAddress);this.consumeAttributeSpace(_n);const L0=this.extract(_n,this.consumePort);_l.push({componentId:_p,connectionAddress:p0,port:L0});try{this.consumeAttributeSpace(_n)}catch{break}}this.attributes.remoteCandidatesList.push(_l)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(_n){const _l=this.extract(_n,this.consumeToken);this.consumeAttributeSpace(_n);const _p=this.extract(_n,this.consumeTill,"/");this.extract(_n,this.consume,"/");const p0={encodingName:_p,clockRate:this.extractOneOrMore(_n,$)};this.atEnd(_n)||this.peekChar(_n)!=="/"||(this.extract(_n,this.consume,"/"),p0.encodingParameters=parseInt(this.extract(_n,this.consumeTill),10));const L0=this.attributes.payloads.find(oI=>oI.payloadType===parseInt(_l,10));L0?L0.rtpMap=p0:this.attributes.payloads.push({payloadType:parseInt(_l,10),rtpMap:p0,rtcpFeedbacks:[]})}parsePtime(_n){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(_n,this.consumeTill)}parseMaxPtime(_n){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(_n,this.consumeTill)}parseDirection(_n){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=_n.attField}parseSSRC(_n){const _l=this.extractOneOrMore(_n,$);this.consumeAttributeSpace(_n);const _p=this.extract(_n,this.consumeTill,":");let p0;this.peekChar(_n)===":"&&(this.extract(_n,this.consume,":"),p0=this.extract(_n,this.consumeTill));const L0=this.attributes.ssrcs.find(oI=>oI.ssrcId===parseInt(_l,10));L0?L0.attributes[_p]=p0:this.attributes.ssrcs.push({ssrcId:parseInt(_l,10),attributes:{[_p]:p0}})}parseFmtp(_n){const _l=this.extract(_n,this.consumeTill,B);this.consumeAttributeSpace(_n);const _p=this.extract(_n,this.consumeTill),p0={};_p.split(";").forEach(oI=>{let[rI,cI]=oI.split("=");rI=rI.trim(),cI=typeof cI=="string"?cI.trim():cI,typeof rI=="string"&&rI.length>0&&(p0[rI]=cI)});const L0=this.attributes.payloads.find(oI=>oI.payloadType===parseInt(_l,10));L0?L0.fmtp={parameters:p0}:this.attributes.payloads.push({payloadType:parseInt(_l,10),rtcpFeedbacks:[],fmtp:{parameters:p0}})}parseFmtParameters(_n){const _l={},_p=this.extract(_n,this.consumeTill,"=");_n._cur++;const p0=this.extract(_n,this.consumeTill,";");for(_l[_p]=p0;_n.attValue[_n._cur]===";";){const L0=this.extract(_n,this.consumeTill,"=");_n._cur++;const oI=this.extract(_n,this.consumeTill,";");_l[L0]=oI}return _l}parseRtcpFb(_n){let _l="";_l=this.peekChar(_n)==="*"?this.extract(_n,this.consume,"*"):this.extract(_n,this.consumeTill,B),this.consumeAttributeSpace(_n);const _p=this.extract(_n,this.consumeTill,B);let p0;switch(_p){case"trr-int":p0={type:_p,interval:this.extract(_n,this.consumeTill)};break;case"ack":case"nack":default:{const L0={type:_p};this.peekChar(_n)===B&&(this.consumeAttributeSpace(_n),L0.parameter=this.extract(_n,this.consumeToken),this.peekChar(_n)===B&&(L0.additional=this.extract(_n,this.consumeTill))),p0=L0}}if(_l==="*")this.attributes.rtcpFeedbackWildcards.push(p0);else{const L0=this.attributes.payloads.find(oI=>oI.payloadType===parseInt(_l,10));L0?L0.rtcpFeedbacks.push(p0):this.attributes.payloads.push({payloadType:parseInt(_l,10),rtcpFeedbacks:[p0]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(_n){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const _l={port:this.extract(_n,this.consumePort)};this.peekChar(_n)===B&&(this.consumeAttributeSpace(_n),_l.netType=this.extractOneOrMore(_n,_i),this.consumeAttributeSpace(_n),_l.addressType=this.extractOneOrMore(_n,_i),this.consumeAttributeSpace(_n),_l.address=this.extract(_n,this.consumeAddress)),this.attributes.rtcp=_l}parseMsid(_n){const _l={id:this.extractOneOrMore(_n,_i,[1,64])};this.peekChar(_n)===B&&(this.consumeAttributeSpace(_n),_l.appdata=this.extractOneOrMore(_n,_i,[1,64])),this.attributes.msids.push(_l)}parseImageAttr(_n){this.attributes.imageattr.push(_n.attValue)}parseRid(_n){const _l=this.extractOneOrMore(_n,p0=>_u(p0)||$(p0)||p0==="_"||p0==="-");this.consumeAttributeSpace(_n);const _p={id:_l,direction:this.extract(_n,this.consumeToken),params:[]};if(this.peekChar(_n)===B){if(this.consumeAttributeSpace(_n),this.peek(_n,"pt=")){this.extract(_n,this.consume,"pt=");const p0=[];for(;;){const L0=this.extract(_n,this.consumeToken);p0.push(L0);try{this.extract(_n,this.consume,",")}catch{break}}_p.payloads=p0,this.peekChar(_n)===B&&this.extract(_n,this.consume,B)}for(;;){const p0=this.extract(_n,this.consumeToken);switch(p0){case"depend":{const L0={type:p0,rids:this.extract(_n,this.consume,"=").split(",")};_p.params.push(L0);break}case"max-width":case"height-width":case"max-fps":case"max-fs":case"max-br":case"max-pps":case"max-bpp":default:{const L0={type:p0};this.peekChar(_n)==="="&&(this.extract(_n,this.consume,"="),L0.val=this.extract(_n,this.consumeTill,";")),_p.params.push(L0)}}try{this.extract(_n,this.consume,";")}catch{break}}}this.attributes.rids.push(_p)}parseSimulcast(_n){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=_n.attValue,this.extract(_n,this.consumeTill)}parseSctpPort(_n){this.attributes.sctpPort=this.extractOneOrMore(_n,$,[1,5])}parseMaxMessageSize(_n){this.attributes.maxMessageSize=this.extractOneOrMore(_n,$,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(_n){this.attributes.mid=this.extract(_n,this.consumeToken)}parseSSRCGroup(_n){const _l=this.extract(_n,this.consumeToken),_p=[];for(;;)try{this.consumeAttributeSpace(_n);const p0=this.extract(_n,this.consumeInteger);_p.push(parseInt(p0,10))}catch{break}this.attributes.ssrcGroups.push({semantic:_l,ssrcIds:_p})}}function s0(g0,_n,_l){return _n in g0?Object.defineProperty(g0,_n,{value:_l,enumerable:!0,configurable:!0,writable:!0}):g0[_n]=_l,g0}class P0{constructor(){s0(this,"eol",k)}print(_n,_l){let _p="";return _l&&(this.eol=_l),_p+=this.printVersion(_n.version),_p+=this.printOrigin(_n.origin),_p+=this.printSessionName(_n.sessionName),_p+=this.printInformation(_n.information),_p+=this.printUri(_n.uri),_p+=this.printEmail(_n.emails),_p+=this.printPhone(_n.phones),_p+=this.printConnection(_n.connection),_p+=this.printBandwidth(_n.bandwidths),_p+=this.printTimeFields(_n.timeFields),_p+=this.printKey(_n.key),_p+=this.printSessionAttributes(_n.attributes),_p+=this.printMediaDescription(_n.mediaDescriptions),_p}printVersion(_n){return"v=".concat(_n).concat(this.eol)}printOrigin(_n){return"o=".concat(_n.username," ").concat(_n.sessId," ").concat(_n.sessVersion," ").concat(_n.nettype," ").concat(_n.addrtype," ").concat(_n.unicastAddress).concat(this.eol)}printSessionName(_n){return _n?"s=".concat(_n).concat(this.eol):""}printInformation(_n){return _n?"i=".concat(_n).concat(this.eol):""}printUri(_n){return _n?"u=".concat(_n).concat(this.eol):""}printEmail(_n){let _l="";for(const _p of _n)_l+="e=".concat(_p).concat(this.eol);return _l}printPhone(_n){let _l="";for(const _p of _n)_l+="e=".concat(_p).concat(this.eol);return _l}printConnection(_n){return _n?"c=".concat(_n.nettype," ").concat(_n.addrtype," ").concat(_n.address).concat(this.eol):""}printBandwidth(_n){let _l="";for(const _p of _n)_l+="b=".concat(_p.bwtype,":").concat(_p.bandwidth).concat(this.eol);return _l}printTimeFields(_n){let _l="";for(const _p of _n){_l+="t=".concat(_p.time.startTime," ").concat(_p.time.startTime).concat(this.eol);for(const p0 of _p.repeats)_l+="r=".concat(p0.repeatInterval," ").concat(p0.typedTimes.join(" ")).concat(this.eol);_p.zoneAdjustments&&(_l+="z=",_l+="z=".concat(_p.zoneAdjustments.map(p0=>"".concat(p0.time," ").concat(p0.back?"-":""," ").concat(p0.typedTime)).join(" ")).concat(this.eol),_l+=this.eol)}return _l}printKey(_n){return _n?"k=".concat(_n).concat(this.eol):""}printAttributes(_n){let _l="";for(const _p of _n)_l+="a=".concat(_p.attField).concat(_p.attValue?":".concat(_p.attValue):"").concat(this.eol);return _l}printMediaDescription(_n){let _l="";for(const _p of _n)_l+=this.printMedia(_p.media),_l+=this.printInformation(_p.information),_l+=this.printConnections(_p.connections),_l+=this.printBandwidth(_p.bandwidths),_l+=this.printKey(_p.key),_l+=this.printMediaAttributes(_p);return _l}printConnections(_n){let _l="";for(const _p of _n)_l+=this.printConnection(_p);return _l}printMedia(_n){return"m=".concat(_n.mediaType," ").concat(_n.port," ").concat(_n.protos.join("/")," ").concat(_n.fmts.join(" ")).concat(this.eol)}printSessionAttributes(_n){return new e0(this.eol).print(_n)}printMediaAttributes(_n){return new l0(this.eol).print(_n)}}class Rv{constructor(_n){s0(this,"eol",void 0),this.eol=_n}printIceUfrag(_n){return _n===void 0?"":"a=ice-ufrag:".concat(_n).concat(this.eol)}printIcePwd(_n){return _n===void 0?"":"a=ice-pwd:".concat(_n).concat(this.eol)}printIceOptions(_n){return _n===void 0?"":"a=ice-options:".concat(_n.join(B)).concat(this.eol)}printFingerprints(_n){return _n.length>0?_n.map(_l=>"a=fingerprint:".concat(_l.hashFunction).concat(B).concat(_l.fingerprint)).join(this.eol)+this.eol:""}printExtmap(_n){return _n.map(_l=>"a=extmap:".concat(_l.entry).concat(_l.direction?"/".concat(_l.direction):"").concat(B).concat(_l.extensionName).concat(_l.extensionAttributes?"".concat(B).concat(_l.extensionAttributes):"").concat(this.eol)).join("")}printSetup(_n){return _n===void 0?"":"a=setup:".concat(_n).concat(this.eol)}printUnrecognized(_n){return _n.map(_l=>"a=".concat(_l.attField).concat(_l.attValue?":".concat(_l.attValue):"").concat(this.eol)).join("")}}class e0 extends Rv{print(_n){let _l="";return _l+=this.printGroups(_n.groups),_l+=this.printMsidSemantic(_n.msidSemantic),_l+=this.printIceLite(_n.iceLite),_l+=this.printIceUfrag(_n.iceUfrag),_l+=this.printIcePwd(_n.icePwd),_l+=this.printIceOptions(_n.iceOptions),_l+=this.printFingerprints(_n.fingerprints),_l+=this.printSetup(_n.setup),_l+=this.printTlsId(_n.tlsId),_l+=this.printIdentity(_n.identities),_l+=this.printExtmap(_n.extmaps),_l+=this.printUnrecognized(_n.unrecognized),_l}printGroups(_n){let _l="";return _n.length>0&&(_l+=_n.map(_p=>"a=group:".concat(_p.semantic).concat(_p.identificationTag.map(p0=>"".concat(B).concat(p0)).join("")).concat(this.eol)).join("")),_l}printIceLite(_n){return _n===void 0?"":"a=ice-lite"+this.eol}printTlsId(_n){return _n?"a=tls-id:".concat(_n).concat(this.eol):""}printIdentity(_n){return _n.length===0?"":_n.map(_l=>"a=identity:".concat(_l.assertionValue).concat(_l.extensions.map(_p=>"".concat(B).concat(_p.name).concat(_p.value?"=".concat(_p.value):"")))).join(this.eol)+this.eol}printMsidSemantic(_n){if(!_n)return"";let _l="a=msid-semantic:".concat(_n.semantic);return _n.applyForAll?_l+="".concat(B,"*"):_n.identifierList.length>0&&(_l+=_n.identifierList.map(_p=>"".concat(B).concat(_p))),_l+this.eol}}class l0 extends Rv{print(_n){const _l=_n.attributes;let _p="";return _p+=this.printRTCP(_l.rtcp),_p+=this.printIceUfrag(_l.iceUfrag),_p+=this.printIcePwd(_l.icePwd),_p+=this.printIceOptions(_l.iceOptions),_p+=this.printCandidates(_l.candidates),_p+=this.printRemoteCandidatesList(_l.remoteCandidatesList),_p+=this.printEndOfCandidates(_l.endOfCandidates),_p+=this.printFingerprints(_l.fingerprints),_p+=this.printSetup(_l.setup),_p+=this.printMid(_l.mid),_p+=this.printExtmap(_l.extmaps),_p+=this.printRTPRelated(_l),_p+=this.printPtime(_l.ptime),_p+=this.printMaxPtime(_l.maxPtime),_p+=this.printDirection(_l.direction),_p+=this.printSSRCGroups(_l.ssrcGroups),_p+=this.printSSRC(_l.ssrcs),_p+=this.printRTCPMux(_l.rtcpMux),_p+=this.printRTCPMuxOnly(_l.rtcpMuxOnly),_p+=this.printRTCPRsize(_l.rtcpRsize),_p+=this.printMSId(_l.msids),_p+=this.printImageattr(_l.imageattr),_p+=this.printRid(_l.rids),_p+=this.printSimulcast(_l.simulcast),_p+=this.printSCRPPort(_l.sctpPort),_p+=this.printMaxMessageSize(_l.maxMessageSize),_p+=this.printUnrecognized(_l.unrecognized),_p}printCandidates(_n){return _n.map(_l=>"a=candidate:".concat(_l.foundation).concat(B).concat(_l.componentId).concat(B).concat(_l.transport).concat(B).concat(_l.priority).concat(B).concat(_l.connectionAddress).concat(B).concat(_l.port).concat(B,"typ").concat(B).concat(_l.type).concat(_l.relAddr?"".concat(B,"raddr").concat(B).concat(_l.relAddr):"").concat(_l.relPort?"".concat(B,"rport").concat(B).concat(_l.relPort):"").concat(Object.keys(_l.extension).map(_p=>"".concat(B).concat(_p).concat(B).concat(_l.extension[_p])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(_n){return _n.map(_l=>"a=remote-candidates:".concat(_l.join(B)).concat(this.eol)).join("")}printEndOfCandidates(_n){return _n===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(_n){if(!_n.payloads)return"";const _l=_n.payloads;let _p="";_p+=_n.rtcpFeedbackWildcards.map(p0=>this.printRTCPFeedback("*",p0)).join("");for(const p0 of _l)_p+=this.printRtpMap(p0.payloadType,p0.rtpMap),_p+=this.printFmtp(p0.payloadType,p0.fmtp),_p+=p0.rtcpFeedbacks.map(L0=>this.printRTCPFeedback(p0.payloadType,L0)).join("");return _p}printFmtp(_n,_l){if(!_l)return"";const _p=Object.keys(_l.parameters);return _p.length===1&&_l.parameters[_p[0]]===void 0?"a=fmtp:".concat(_n).concat(B).concat(_p[0]).concat(this.eol):"a=fmtp:".concat(_n).concat(B).concat(Object.keys(_l.parameters).map(p0=>"".concat(p0,"=").concat(_l.parameters[p0])).join(";")).concat(this.eol)}printRtpMap(_n,_l){return _l?"a=rtpmap:".concat(_n).concat(B).concat(_l.encodingName,"/").concat(_l.clockRate).concat(_l.encodingParameters?"/".concat(_l.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(_n,_l){let _p="a=rtcp-fb:".concat(_n).concat(B),p0=_l;switch(p0.type){case"trr-int":_p+="ttr-int".concat(B).concat(p0.interval);break;case"ack":case"nack":default:p0=p0,_p+="".concat(p0.type),p0.parameter&&(_p+="".concat(B).concat(p0.parameter),p0.additional&&(_p+="".concat(B).concat(p0.additional)))}return _p+this.eol}printPtime(_n){return _n===void 0?"":"a=ptime:".concat(_n).concat(this.eol)}printMaxPtime(_n){return _n===void 0?"":"a=maxptime:".concat(_n).concat(this.eol)}printDirection(_n){return _n===void 0?"":"a=".concat(_n).concat(this.eol)}printSSRC(_n){return _n.map(_l=>Object.keys(_l.attributes).map(_p=>"a=ssrc:".concat(_l.ssrcId.toString(10)).concat(B).concat(_p).concat(_l.attributes[_p]?":".concat(_l.attributes[_p]):"").concat(this.eol)).join("")).join("")}printRTCPMux(_n){return _n===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(_n){return _n===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(_n){return _n===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(_n){if(_n===void 0)return"";let _l="a=rtcp:".concat(_n.port);return _n.netType&&(_l+="".concat(B).concat(_n.netType)),_n.addressType&&(_l+="".concat(B).concat(_n.addressType)),_n.address&&(_l+="".concat(B).concat(_n.address)),_l+this.eol}printMSId(_n){return _n.map(_l=>"a=msid:".concat(_l.id).concat(_l.appdata?"".concat(B).concat(_l.appdata):"").concat(this.eol)).join("")}printImageattr(_n){return _n.map(_l=>"a=imageattr:".concat(_l).concat(this.eol)).join("")}printRid(_n){return _n.map(_l=>{let _p="a=rid:".concat(_l.id).concat(B).concat(_l.direction);return _l.payloads&&(_p+="".concat(B,"pt=").concat(_l.payloads.join(","))),_l.params.length>0&&(_p+="".concat(B).concat(_l.params.map(p0=>p0.type==="depend"?"depend=".concat(p0.rids.join(",")):"".concat(p0.type,"=").concat(p0.val)).join(";"))),_p+this.eol}).join("")}printSimulcast(_n){return _n===void 0?"":"a=simulcast:".concat(_n).concat(this.eol)}printSCRPPort(_n){return _n===void 0?"":"a=sctp-port:".concat(_n).concat(this.eol)}printMaxMessageSize(_n){return _n===void 0?"":"a=max-message-size:".concat(_n)}printMid(_n){return _n===void 0?"":"a=mid:".concat(_n).concat(this.eol)}printSSRCGroups(_n){return _n.map(_l=>"a=ssrc-group:".concat(_l.semantic).concat(_l.ssrcIds.map(_p=>"".concat(B).concat(_p.toString(10))).join("")).concat(this.eol)).join("")}}function w0(g0){return new j0().parse(g0)}function B0(g0,_n){return new P0().print(g0,_n)}}},p={};function A(y){if(p[y])return p[y].exports;var g=p[y]={exports:{}};return d[y](g,g.exports,A),g.exports}return A.d=(y,g)=>{for(var b in g)A.o(g,b)&&!A.o(y,b)&&Object.defineProperty(y,b,{enumerable:!0,get:g[b]})},A.o=(y,g)=>Object.prototype.hasOwnProperty.call(y,g),A.r=y=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})},A(8)})()})(J_);class Q_t{constructor(l){_s(this,"sessionDesc",void 0),_s(this,"localCapabilities",void 0),_s(this,"rtpCapabilities",void 0),_s(this,"candidates",void 0),_s(this,"iceParameters",void 0),_s(this,"dtlsParameters",void 0),_s(this,"setup",void 0),_s(this,"currentMidIndex",void 0),_s(this,"cname",void 0),l=L1(l);const{remoteIceParameters:d,remoteDtlsParameters:p,candidates:A,remoteRTPCapabilities:y,remoteSetup:g,localCapabilities:b,sdkCodec:I,cname:k}=l,B=J_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=y,this.candidates=A,this.iceParameters=d,this.dtlsParameters=p,this.setup=g,this.localCapabilities=b,this.cname=k;for(let q=0;q<B.mediaDescriptions.length;q++){const $=B.mediaDescriptions[q];if($.attributes.iceUfrag=d.iceUfrag,$.attributes.icePwd=d.icePwd,$.attributes.fingerprints=p.fingerprints,$.attributes.candidates=A,$.attributes.setup=g,$.media.mediaType==="video"){$.media.fmts=y.videoCodecs.map(_r=>_r.payloadType.toString(10));const _t=y.videoCodecs.filter(_r=>{var _i;return(_i=_r.rtpMap)===null||_i===void 0?void 0:_i.encodingName.toLowerCase().includes(I)});if(_t.length===0)throw new Error("Codec ".concat(I," not supported by remote SDP."));$.attributes.payloads=_t,$.attributes.extmaps=y.videoExtensions}$.media.mediaType==="audio"&&($.media.fmts=y.audioCodecs.map(_t=>_t.payloadType.toString(10)),$.attributes.payloads=y.audioCodecs,$.attributes.extmaps=y.audioExtensions),B.mediaDescriptions[q]=this.mungMediaDesc($)}this.sessionDesc=B,this.currentMidIndex=B.mediaDescriptions.length-1}toString(){return J_.exports.print(this.sessionDesc)}send(l,d,p){const{ssrcs:A,ssrcGroups:y}=x2(d,this.cname),g=this.sessionDesc.mediaDescriptions.find(k=>l===AI.VIDEO?k.media.mediaType==="video":k.media.mediaType==="audio"),b=A[0].attributes.label,I=A[0].attributes.mslabel;return g.attributes.ssrcs=g.attributes.ssrcs.concat(A),g.attributes.ssrcGroups=g.attributes.ssrcGroups.concat(y),{id:b,mslabel:I}}batchSend(l){return l.map(d=>{let{kind:p,ssrcMsg:A}=d;return this.send(p,A,void 0)})}stopSending(l){this.sessionDesc.mediaDescriptions.forEach(d=>{const p=[],A=[],y=[];d.attributes.ssrcs.forEach(g=>{l.includes(g.attributes.label||"")?y.push(g):p.push(g)}),d.attributes.ssrcGroups.forEach(g=>{y.map(b=>b.ssrcId).includes(g.ssrcIds[0])||A.push(g)}),d.attributes.ssrcs=p,d.attributes.ssrcGroups=A})}mute(l){const d=this.sessionDesc.mediaDescriptions.find(p=>p.attributes.mid===l);if(!d)throw new Error("mediaDescription not found with ".concat(l," in remote SDP when calling RemoteSDP.mute."));d.attributes.direction="inactive"}unmute(l){const d=this.sessionDesc.mediaDescriptions.find(p=>p.attributes.mid===l);if(!d)throw new Error("mediaDescription not found with ".concat(l," in remote SDP when calling RemoteSDP.unmute."));d.attributes.direction="sendonly"}receive(l,d,p){l.forEach((A,y)=>{const g=A._mediaStreamTrack,b=this.sessionDesc.mediaDescriptions.findIndex(k=>k.attributes.mid===g.kind),I=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[b],A);this.sessionDesc.mediaDescriptions[b]=I})}stopReceiving(l){}restartICE(l,d){l=L1(l),d=L1(d),this.iceParameters=l,this.candidates=d,this.sessionDesc.mediaDescriptions.forEach(p=>{p.attributes.iceUfrag=l.iceUfrag,p.attributes.icePwd=l.icePwd,p.attributes.candidates=this.candidates})}predictReceivingMids(l){const d=[];for(let p=0;p<l;p++)d.push((this.currentMidIndex+p+1).toString(10));return d}mungRecvMediaDsec(l,d){const p=L1(l);return XP(p,d),m$(p,d),p}updateRecvMedia(l,d){const p=this.sessionDesc.mediaDescriptions.findIndex(A=>A.attributes.mid===l);if(p!==-1){const A=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[p],d);this.sessionDesc.mediaDescriptions[p]=A}}bumpMid(l){this.currentMidIndex+=l}updateTrackLabel(l,d,p){const A=this.sessionDesc.mediaDescriptions.find(g=>l===AI.VIDEO?g.attributes.mid==="video":g.attributes.mid==="audio");if(A){const g=A.attributes.ssrcs.find(b=>b.attributes.label===d);var y;g&&(g.attributes.label=p,(y=g.attributes.msid)===null||y===void 0||y.replace(d,p))}}mungMediaDesc(l){const d=L1(l);return E$(d),function(p){const A=p.attributes.extmaps.find(y=>y.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");A&&p.attributes.extmaps.splice(p.attributes.extmaps.indexOf(A),1),p.attributes.payloads.forEach(y=>{const g=y.rtcpFeedbacks.findIndex(b=>b.type==="transport-cc");g!==-1&&y.rtcpFeedbacks.splice(g,1)})}(d),d}}function iS(e){if(Array.isArray(e))return e.map(function(p){return p});if(!_$(e))return e;var l={};for(var d in e)_$(e[d])||Array.isArray(e[d])?l[d]=iS(e[d]):l[d]=e[d];return l}function _$(e){return!(typeof e!="object"||Array.isArray(e)||!e)}var i8=function(){function e(l){this.input=[],this.size=l}return e.prototype.add=function(l){this.input.push(l),this.input.length>this.size&&this.input.splice(0,1)},e.prototype.diffMean=function(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),y$=function(e,l){return(y$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,p){d.__proto__=p}||function(d,p){for(var A in p)p.hasOwnProperty(A)&&(d[A]=p[A])})(e,l)};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function o8(e,l){function d(){this.constructor=e}y$(e,l),e.prototype=l===null?Object.create(l):(d.prototype=l.prototype,new d)}var yT=function(){return(yT=Object.assign||function(e){for(var l,d=1,p=arguments.length;d<p;d++)for(var A in l=arguments[d])Object.prototype.hasOwnProperty.call(l,A)&&(e[A]=l[A]);return e}).apply(this,arguments)};function s8(e,l,d,p){return new(d||(d=Promise))(function(A,y){function g(k){try{I(p.next(k))}catch(B){y(B)}}function b(k){try{I(p.throw(k))}catch(B){y(B)}}function I(k){k.done?A(k.value):new d(function(B){B(k.value)}).then(g,b)}I((p=p.apply(e,l||[])).next())})}function a8(e,l){var d,p,A,y,g={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return y={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function b(I){return function(k){return function(B){if(d)throw new TypeError("Generator is already executing.");for(;g;)try{if(d=1,p&&(A=2&B[0]?p.return:B[0]?p.throw||((A=p.return)&&A.call(p),0):p.next)&&!(A=A.call(p,B[1])).done)return A;switch(p=0,A&&(B=[2&B[0],A.value]),B[0]){case 0:case 1:A=B;break;case 4:return g.label++,{value:B[1],done:!1};case 5:g.label++,p=B[1],B=[0];continue;case 7:B=g.ops.pop(),g.trys.pop();continue;default:if(A=g.trys,!((A=A.length>0&&A[A.length-1])||B[0]!==6&&B[0]!==2)){g=0;continue}if(B[0]===3&&(!A||B[1]>A[0]&&B[1]<A[3])){g.label=B[1];break}if(B[0]===6&&g.label<A[1]){g.label=A[1],A=B;break}if(A&&g.label<A[2]){g.label=A[2],g.ops.push(B);break}A[2]&&g.ops.pop(),g.trys.pop();continue}B=l.call(e,g)}catch(q){B=[6,q],p=0}finally{d=A=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([I,k])}}}var oS,b$={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},rN={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:b$,remoteCandidate:b$}},C$={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},S$={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},R$={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},T$={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},c8=function(){function e(l,d){var p=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=iS(rN),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=l,this.options=d,this.intervalTimer=window.setInterval(function(){return s8(p,void 0,void 0,function(){return a8(this,function(A){return this.updateStats(),[2]})})},this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(l){this.videoIsReady=l},e.prototype.setVideoIsReady2=function(l,d){this.videoIsReady2[l]=d},e.prototype.getVideoIsReady=function(l){return this.videoIsReady2[l]||!1},e.prototype.setIsFirstAudioDecoded=function(l){},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},e.prototype.calcLossRate=function(l){var d=this;this.lossRateWindowStats.push(l),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var p=this.lossRateWindowStats.length,A=0,y=0,g=0,b=0,I=function(q){l[q].forEach(function($,_t){if(d.lossRateWindowStats[p-1][q][_t]&&d.lossRateWindowStats[0][q][_t]){var _r=d.lossRateWindowStats[p-1][q][_t].packets-d.lossRateWindowStats[0][q][_t].packets,_i=d.lossRateWindowStats[p-1][q][_t].packetsLost-d.lossRateWindowStats[0][q][_t].packetsLost;q==="videoSend"||q==="audioSend"?(A+=_r,g+=_i):(y+=_r,b+=_i),Number.isNaN(_r)||Number.isNaN(_r)?$.packetLostRate=0:$.packetLostRate=_r<=0||_i<=0?0:_i/(_r+_i)}})},k=0,B=["videoSend","audioSend","videoRecv","audioRecv"];k<B.length;k++)I(B[k]);l.sendPacketLossRate=A<=0||g<=0?0:g/(A+g),l.recvPacketLossRate=y<=0||b<=0?0:b/(y+b)},e}(),G_t=function(e){function l(){var d=e!==null&&e.apply(this,arguments)||this;return d._stats=rN,d.lastDecodeVideoReceiverStats=new Map,d}return o8(l,e),l.prototype.updateStats=function(){return s8(this,void 0,void 0,function(){var d,p,A,y;return a8(this,function(g){switch(g.label){case 0:return[4,this._getStats()];case 1:return d=g.sent(),p=this.statsResponsesToObjects(d),this._stats=iS(rN),A=p.filter(function(b){return b.type==="ssrc"}),this.processSSRCStats(A),(y=p.find(function(b){return b.type==="VideoBwe"}))&&this.processBandwidthStats(y),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},l.prototype.processBandwidthStats=function(d){this._stats.bitrate={actualEncoded:Number(d.googActualEncBitrate),targetEncoded:Number(d.googTargetEncBitrate),retransmit:Number(d.googRetransmitBitrate),transmit:Number(d.googTransmitBitrate)},this._stats.sendBandwidth=Number(d.googAvailableSendBandwidth)},l.prototype.processSSRCStats=function(d){var p=this;d.forEach(function(A){var y=A.id.includes("send");switch(A.mediaType+"_"+(y?"send":"recv")){case"video_send":var g=iS(S$);g.codec=A.googCodecName,g.adaptionChangeReason="none",A.googCpuLimitedResolution&&(g.adaptionChangeReason="cpu"),A.googBandwidthLimitedResolution&&(g.adaptionChangeReason="bandwidth"),g.avgEncodeMs=Number(A.googAvgEncodeMs),g.inputFrame={width:Number(A.googFrameWidthInput)||Number(A.googFrameWidthSent),height:Number(A.googFrameHeightInput)||Number(A.googFrameHeightSent),frameRate:Number(A.googFrameRateInput)},g.sentFrame={width:Number(A.googFrameWidthSent),height:Number(A.googFrameHeightSent),frameRate:Number(A.googFrameRateInput)},g.firsCount=Number(A.googFirReceived),g.nacksCount=Number(A.googNacksReceived),g.plisCount=Number(A.googPlisReceived),g.frameCount=Number(A.framesEncoded),g.bytes=Number(A.bytesSent),g.packets=Number(A.packetsSent),g.packetsLost=Number(A.packetsLost),g.ssrc=Number(A.ssrc),g.rttMs=Number(A.googRtt||0),p._stats.videoSend.push(g),p._stats.rtt=g.rttMs;break;case"video_recv":var b=iS(C$),I=p.lastDecodeVideoReceiverStats.get(Number(A.ssrc));if(b.codec=A.googCodecName,b.targetDelayMs=Number(A.googTargetDelayMs),b.renderDelayMs=Number(A.googRenderDelayMs),b.currentDelayMs=Number(A.googCurrentDelayMs),b.minPlayoutDelayMs=Number(A.googMinPlayoutDelayMs),b.decodeMs=Number(A.googDecodeMs),b.maxDecodeMs=Number(A.googMaxDecodeMs),b.receivedFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateReceived)},b.decodedFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateDecoded)},b.outputFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateOutput)},b.jitterBufferMs=Number(A.googJitterBufferMs),b.firsCount=Number(A.googFirsSent),b.nacksCount=Number(A.googNacksSent),b.plisCount=Number(A.googPlisSent),b.framesDecodeCount=Number(A.framesDecoded),b.bytes=Number(A.bytesReceived),b.packets=Number(A.packetsReceived),b.packetsLost=Number(A.packetsLost),b.ssrc=Number(A.ssrc),b.packets>0&&!p.isFirstVideoReceived[b.ssrc]&&(p.onFirstVideoReceived&&p.onFirstVideoReceived(b.ssrc),p.isFirstVideoReceived[b.ssrc]=!0),b.framesDecodeCount>0&&!p.isFirstVideoDecoded[b.ssrc]&&(p.onFirstVideoDecoded&&p.onFirstVideoDecoded(b.ssrc,b.decodedFrame.width,b.decodedFrame.height),p.isFirstVideoDecoded[b.ssrc]=!0),I){var k=I.stats,B=Date.now()-I.lts;b.framesDecodeFreezeTime=k.framesDecodeFreezeTime,b.framesDecodeInterval=k.framesDecodeInterval,b.framesDecodeCount>k.framesDecodeCount&&p.isFirstVideoDecoded?(I.lts=Date.now(),b.framesDecodeInterval=B,b.framesDecodeInterval>=p.options.freezeRateLimit&&(p.getVideoIsReady(parseInt(A.ssrc,10))?b.framesDecodeFreezeTime+=b.framesDecodeInterval:p.setVideoIsReady2(parseInt(A.ssrc,10),!0))):b.framesDecodeCount<I.stats.framesDecodeCount&&(b.framesDecodeInterval=0)}p.lastDecodeVideoReceiverStats.set(b.ssrc,{stats:yT({},b),lts:Date.now()}),p._stats.videoRecv.push(b);break;case"audio_recv":var q=iS(T$);q.codec=A.googCodecName,q.outputLevel=Math.abs(Number(A.audioOutputLevel))/32767,q.decodingCNG=Number(A.googDecodingCNG),q.decodingCTN=Number(A.googDecodingCTN),q.decodingCTSG=Number(A.googDecodingCTSG),q.decodingNormal=Number(A.googDecodingNormal),q.decodingPLC=Number(A.googDecodingPLC),q.decodingPLCCNG=Number(A.googDecodingPLCCNG),q.expandRate=Number(A.googExpandRate),q.accelerateRate=Number(A.googAccelerateRate),q.preemptiveExpandRate=Number(A.googPreemptiveExpandRate),q.secondaryDecodedRate=Number(A.googSecondaryDecodedRate),q.speechExpandRate=Number(A.googSpeechExpandRate),q.preferredJitterBufferMs=Number(A.googPreferredJitterBufferMs),q.jitterBufferMs=Number(A.googJitterBufferMs),q.jitterMs=Number(A.googJitterReceived),q.bytes=Number(A.bytesReceived),q.packets=Number(A.packetsReceived),q.packetsLost=Number(A.packetsLost),q.ssrc=Number(A.ssrc),q.receivedFrames=Number(A.googDecodingCTN)||Number(A.packetsReceived),q.droppedFrames=Number(A.googDecodingPLC)+Number(A.googDecodingPLCCNG)||Number(A.packetsLost),q.receivedFrames>0&&!p.isFirstAudioReceived[q.ssrc]&&(p.onFirstAudioReceived&&p.onFirstAudioReceived(q.ssrc),p.isFirstAudioReceived[q.ssrc]=!0),q.decodingNormal>0&&!p.isFirstAudioDecoded[q.ssrc]&&(p.onFirstAudioDecoded&&p.onFirstAudioDecoded(q.ssrc),p.isFirstAudioDecoded[q.ssrc]=!0),p._stats.audioRecv.push(q);break;case"audio_send":var $=iS(R$);$.codec=A.googCodecName,$.inputLevel=Math.abs(Number(A.audioInputLevel))/32767,$.aecReturnLoss=Number(A.googEchoCancellationReturnLoss||0),$.aecReturnLossEnhancement=Number(A.googEchoCancellationReturnLossEnhancement||0),$.residualEchoLikelihood=Number(A.googResidualEchoLikelihood||0),$.residualEchoLikelihoodRecentMax=Number(A.googResidualEchoLikelihoodRecentMax||0),$.bytes=Number(A.bytesSent),$.packets=Number(A.packetsSent),$.packetsLost=Number(A.packetsLost),$.ssrc=Number(A.ssrc),$.rttMs=Number(A.googRtt||0),p._stats.rtt=$.rttMs,p._stats.audioSend.push($)}})},l.prototype._getStats=function(){var d=this;return new Promise(function(p,A){d.pc.getStats(p,A)})},l.prototype.statsResponsesToObjects=function(d){var p=[];return d.result().forEach(function(A){var y={id:A.id,timestamp:A.timestamp.valueOf().toString(),type:A.type};A.names().forEach(function(g){y[g]=A.stat(g)}),p.push(y)}),p},l}(c8);(function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"})(oS||(oS={}));var OI,w$=function(e){function l(){var d=e!==null&&e.apply(this,arguments)||this;return d._stats=rN,d.lastDecodeVideoReceiverStats=new Map,d.lastVideoFramesRecv=new Map,d.lastVideoFramesSent=new Map,d.lastVideoFramesDecode=new Map,d.lastVideoJBDelay=new Map,d.lastAudioJBDelay=new Map,d.mediaBytesSent=new Map,d.mediaBytesRetransmit=new Map,d.mediaBytesTargetEncode=new Map,d.lastEncoderMs=new Map,d}return o8(l,e),l.prototype.updateStats=function(){return s8(this,void 0,void 0,function(){var d,p=this;return a8(this,function(A){switch(A.label){case 0:return d=this,[4,this.pc.getStats()];case 1:return d.report=A.sent(),this._stats=iS(rN),this.report.forEach(function(y){switch(y.type){case oS.OUTBOUND:y.mediaType==="audio"?p.processAudioOutboundStats(y):y.mediaType==="video"&&p.processVideoOutboundStats(y);break;case oS.INBOUND:y.mediaType==="audio"?p.processAudioInboundStats(y):y.mediaType==="video"&&p.processVideoInboundStats(y);break;case oS.TRANSPORT:var g=p.report.get(y.selectedCandidatePairId);g&&p.processCandidatePairStats(g);break;case oS.CANDIDATE_PAIR:y.selected&&p.processCandidatePairStats(y)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},l.prototype.processCandidatePairStats=function(d){if(this._stats.sendBandwidth=d.availableOutgoingBitrate||0,d.currentRoundTripTime&&(this._stats.rtt=1e3*d.currentRoundTripTime),this._stats.videoSend.forEach(function(y){!y.rttMs&&d.currentRoundTripTime&&(y.rttMs=1e3*d.currentRoundTripTime)}),this._stats.audioSend.forEach(function(y){!y.rttMs&&d.currentRoundTripTime&&(y.rttMs=1e3*d.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=d.id,d.localCandidateId){var p=this.report.get(d.localCandidateId);p&&this.processCandidateStats(p)}if(d.remoteCandidateId){var A=this.report.get(d.remoteCandidateId);A&&this.processCandidateStats(A)}},l.prototype.processCandidateStats=function(d){var p;d.type===oS.LOCAL_CANDIDATE&&(p=this._stats.selectedCandidatePair.localCandidate),d.type===oS.REMOTE_CANDIDATE&&(p=this._stats.selectedCandidatePair.remoteCandidate),p&&(p.type=d.type,p.id=d.id,d.address&&(p.address=d.address),d.candidateType&&(p.candidateType=d.candidateType),d.port&&(p.port=d.port),d.priority&&(p.priority=d.priority),d.protocol&&(p.protocol=d.protocol),d.relayProtocol&&(p.relayProtocol=d.relayProtocol),d.type===oS.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==p.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(yT({},p),yT({},this.stats.selectedCandidatePair.localCandidate)),d.type===oS.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==p.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(yT({},p),yT({},this.stats.selectedCandidatePair.remoteCandidate)))},l.prototype.processAudioInboundStats=function(d){var p=this._stats.audioRecv.find(function(A){return A.ssrc===d.ssrc});p||(p=iS(T$),this._stats.audioRecv.push(p)),p.ssrc=d.ssrc,p.packets=d.packetsReceived,p.packetsLost=d.packetsLost,p.bytes=d.bytesReceived,p.jitterMs=1e3*d.jitter,d.trackId&&this.processAudioTrackReceiverStats(d.trackId,p),d.codecId&&(p.codec=this.getCodecFromCodecStats(d.codecId)),p.receivedFrames||(p.receivedFrames=d.packetsReceived),p.droppedFrames||(p.droppedFrames=d.packetsLost),p.receivedFrames>0&&!this.isFirstAudioReceived[p.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(p.ssrc),this.isFirstAudioReceived[p.ssrc]=!0),p.outputLevel&&p.outputLevel>0&&!this.isFirstAudioDecoded[p.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(p.ssrc),this.isFirstAudioDecoded[p.ssrc]=!0)},l.prototype.processVideoInboundStats=function(d){var p=this._stats.videoRecv.find(function(q){return q.ssrc===d.ssrc});p||(p=iS(C$),this._stats.videoRecv.push(p)),p.ssrc=d.ssrc,p.packets=d.packetsReceived,p.packetsLost=d.packetsLost,p.bytes=d.bytesReceived,p.firsCount=d.firCount,p.nacksCount=d.nackCount,p.plisCount=d.pliCount,p.framesDecodeCount=d.framesDecoded;var A=this.lastDecodeVideoReceiverStats.get(p.ssrc),y=this.lastVideoFramesDecode.get(p.ssrc),g=Date.now();if(p.framesDecodeCount>0&&!this.isFirstVideoDecoded[p.ssrc]){var b=p.decodedFrame?p.decodedFrame.width:0,I=p.decodedFrame?p.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(p.ssrc,b,I),this.isFirstVideoDecoded[p.ssrc]=!0}if(A){var k=A.stats,B=g-A.lts;p.framesDecodeFreezeTime=k.framesDecodeFreezeTime,p.framesDecodeInterval=k.framesDecodeInterval,p.framesDecodeCount>k.framesDecodeCount&&this.isFirstVideoDecoded?(A.lts=Date.now(),p.framesDecodeInterval=B,p.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(d.ssrc))?p.framesDecodeFreezeTime+=p.framesDecodeInterval:this.setVideoIsReady2(parseInt(d.ssrc,10),!0))):p.framesDecodeCount<k.framesDecodeCount&&(p.framesDecodeInterval=0),d.framesDecoded&&d.qpSum&&(A.stats.framesDecodeCount>d.framesDecoded?p.qpSumPerFrame=d.qpSum/d.framesDecoded:p.qpSumPerFrame=(d.qpSum-A.qpSum)/(d.framesDecoded-A.stats.framesDecodeCount))}y&&g-y.lts>=800?(p.decodeFrameRate=Math.round((p.framesDecodeCount-y.count)/((g-y.lts)/1e3)),this.lastVideoFramesDecode.set(p.ssrc,{count:p.framesDecodeCount,lts:g,rate:p.decodeFrameRate})):y?p.decodeFrameRate=y.rate:this.lastVideoFramesDecode.set(p.ssrc,{count:p.framesDecodeCount,lts:g,rate:0}),d.totalDecodeTime&&(p.decodeMs=1e3*d.totalDecodeTime),d.trackId&&this.processVideoTrackReceiverStats(d.trackId,p),d.codecId&&(p.codec=this.getCodecFromCodecStats(d.codecId)),d.framerateMean&&(p.framesRateFirefox=d.framerateMean),p.packets>0&&!this.isFirstVideoReceived[p.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(p.ssrc),this.isFirstVideoReceived[p.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(p.ssrc,{stats:yT({},p),lts:A?A.lts:Date.now(),qpSum:d.qpSum})},l.prototype.processVideoOutboundStats=function(d){var p=this._stats.videoSend.find(function($){return $.ssrc===d.ssrc});p||(p=iS(S$),this._stats.videoSend.push(p));var A,y=this.mediaBytesSent.get(d.ssrc);if(y?y.add(d.bytesSent):((b=new i8(10)).add(d.bytesSent),this.mediaBytesSent.set(d.ssrc,b)),d.retransmittedBytesSent!==void 0){var g=this.mediaBytesRetransmit.get(d.ssrc);g?g.add(d.retransmittedBytesSent):((b=new i8(10)).add(d.retransmittedBytesSent),this.mediaBytesRetransmit.set(d.ssrc,b))}if(d.totalEncodedBytesTarget){var b,I=this.mediaBytesTargetEncode.get(d.ssrc);I?I.add(d.totalEncodedBytesTarget):((b=new i8(10)).add(d.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(d.ssrc,b))}if(p.ssrc=d.ssrc,p.bytes=d.bytesSent,p.packets=d.packetsSent,p.firsCount=d.firCount,p.nacksCount=d.nackCount,p.plisCount=d.pliCount,p.frameCount=d.framesEncoded,p.adaptionChangeReason=d.qualityLimitationReason,d.totalEncodeTime&&d.framesEncoded)if(!(A=this.lastEncoderMs.get(d.ssrc))||A.lastFrameCount>d.framesEncoded)p.avgEncodeMs=1e3*d.totalEncodeTime/d.framesEncoded;else{var k=d.framesEncoded-A.lastFrameCount,B=d.totalEncodeTime-A.lastEncoderTime;p.avgEncodeMs=1e3*B/k}if(d.framesEncoded&&d.qpSum&&(!(A=this.lastEncoderMs.get(d.ssrc))||A.lastFrameCount>d.framesEncoded?p.qpSumPerFrame=d.qpSum/d.framesEncoded:p.qpSumPerFrame=(d.qpSum-A.lastQpSum)/(d.framesEncoded-A.lastFrameCount)),this.lastEncoderMs.set(d.ssrc,{lastFrameCount:d.framesEncoded,lastEncoderTime:d.totalEncodeTime,lastQpSum:d.qpSum,lts:Date.now()}),d.codecId&&(p.codec=this.getCodecFromCodecStats(d.codecId)),d.mediaSourceId&&this.processVideoMediaSource(d.mediaSourceId,p),d.trackId&&this.processVideoTrackSenderStats(d.trackId,p),d.remoteId)this.processRemoteInboundStats(d.remoteId,p);else{var q=this.findRemoteStatsId(d.ssrc,oS.REMOTE_INBOUND);q&&this.processRemoteInboundStats(q,p)}},l.prototype.processAudioOutboundStats=function(d){var p=this._stats.audioSend.find(function(y){return y.ssrc===d.ssrc});if(p||(p=iS(R$),this._stats.audioSend.push(p)),p.ssrc=d.ssrc,p.packets=d.packetsSent,p.bytes=d.bytesSent,d.mediaSourceId&&this.processAudioMediaSource(d.mediaSourceId,p),d.codecId&&(p.codec=this.getCodecFromCodecStats(d.codecId)),d.trackId&&this.processAudioTrackSenderStats(d.trackId,p),d.remoteId)this.processRemoteInboundStats(d.remoteId,p);else{var A=this.findRemoteStatsId(d.ssrc,oS.REMOTE_INBOUND);A&&this.processRemoteInboundStats(A,p)}},l.prototype.findRemoteStatsId=function(d,p){var A=Array.from(this.report.values()).find(function(y){return y.type===p&&y.ssrc===d});return A?A.id:null},l.prototype.processVideoMediaSource=function(d,p){var A=this.report.get(d);A&&A.width&&A.height&&A.framesPerSecond&&(p.inputFrame={width:A.width,height:A.height,frameRate:A.framesPerSecond})},l.prototype.processAudioMediaSource=function(d,p){var A=this.report.get(d);A&&(p.inputLevel=A.audioLevel)},l.prototype.processVideoTrackSenderStats=function(d,p){var A=this.report.get(d);if(A){var y=0,g=Date.now(),b=this.lastVideoFramesSent.get(p.ssrc);b&&g-b.lts>=800?(y=Math.round((A.framesSent-b.count)/((g-b.lts)/1e3)),this.lastVideoFramesSent.set(p.ssrc,{count:A.framesSent,lts:g,rate:y})):b?y=b.rate:this.lastVideoFramesSent.set(p.ssrc,{count:A.framesSent,lts:g,rate:0}),p.sentFrame={width:A.frameWidth,height:A.frameHeight,frameRate:y}}},l.prototype.processVideoTrackReceiverStats=function(d,p){var A=this.report.get(d);if(A){var y=this.lastVideoFramesRecv.get(p.ssrc),g=Date.now();p.framesReceivedCount=A.framesReceived;var b=0;if(y&&g-y.lts>=800?(b=Math.round((A.framesReceived-y.count)/((g-y.lts)/1e3)),this.lastVideoFramesRecv.set(p.ssrc,{count:A.framesReceived,lts:g,rate:b})):y?b=y.rate:this.lastVideoFramesRecv.set(p.ssrc,{count:A.framesReceived,lts:g,rate:0}),p.receivedFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:b||0},p.decodedFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:p.decodeFrameRate||0},p.outputFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:p.decodeFrameRate||0},A.jitterBufferDelay&&A.jitterBufferEmittedCount){var I=this.lastVideoJBDelay.get(p.ssrc);this.lastVideoJBDelay.set(p.ssrc,{jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount}),I||(I={jitterBufferDelay:0,jitterBufferEmittedCount:0});var k=1e3*(A.jitterBufferDelay-I.jitterBufferDelay)/(A.jitterBufferEmittedCount-I.jitterBufferEmittedCount);p.jitterBufferMs=k,p.currentDelayMs=Math.round(k)}}},l.prototype.processAudioTrackSenderStats=function(d,p){var A=this.report.get(d);A&&(p.aecReturnLoss=A.echoReturnLoss||0,p.aecReturnLossEnhancement=A.echoReturnLossEnhancement||0)},l.prototype.processAudioTrackReceiverStats=function(d,p){var A=this.report.get(d);if(A){if(A.removedSamplesForAcceleration&&A.totalSamplesReceived&&(p.accelerateRate=A.removedSamplesForAcceleration/A.totalSamplesReceived),A.jitterBufferDelay&&A.jitterBufferEmittedCount){var y=this.lastAudioJBDelay.get(p.ssrc);this.lastAudioJBDelay.set(p.ssrc,{jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount}),y||(y={jitterBufferDelay:0,jitterBufferEmittedCount:0});var g=1e3*(A.jitterBufferDelay-y.jitterBufferDelay)/(A.jitterBufferEmittedCount-y.jitterBufferEmittedCount);p.jitterBufferMs=Math.round(g)}p.outputLevel=A.audioLevel;var b=1920;A.totalSamplesDuration&&A.totalSamplesReceived&&(b=A.totalSamplesReceived/A.totalSamplesDuration/50,p.receivedFrames=Math.round(A.totalSamplesReceived/b)),A.concealedSamples&&(p.droppedFrames=Math.round(A.concealedSamples/b))}},l.prototype.processRemoteInboundStats=function(d,p){var A=this.report.get(d);A&&(p.packetsLost=A.packetsLost,A.roundTripTime&&(p.rttMs=1e3*A.roundTripTime))},l.prototype.getCodecFromCodecStats=function(d){var p=this.report.get(d);if(!p)return"";var A=p.mimeType.match(/\/(.*)$/);return A&&A[1]?A[1]:""},l.prototype.updateSendBitrate=function(){var d=0,p=null,A=null;this.mediaBytesSent.forEach(function(g){d+=g.diffMean()}),this.mediaBytesRetransmit.forEach(function(g){p=p===null?g.diffMean():p+g.diffMean()}),this.mediaBytesTargetEncode.forEach(function(g){A=A===null?g.diffMean():A+g.diffMean()});var y=p!==null?d-p:d;this._stats.bitrate={actualEncoded:8*y/(this.options.updateInterval/1e3),transmit:8*d/(this.options.updateInterval/1e3)},p!==null&&(this._stats.bitrate.retransmit=8*p/(this.options.updateInterval/1e3)),A!==null&&(this._stats.bitrate.targetEncoded=8*A/(this.options.updateInterval/1e3))},l}(c8),V_t=function(e){function l(){return e!==null&&e.apply(this,arguments)||this}return o8(l,e),l.prototype.updateStats=function(){return Promise.resolve()},l}(c8);function O$(e,l,d,p){l===void 0&&(l=250),d===void 0&&(d=8),p===void 0&&(p=500);var A,y=(A=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&A[0]?Number(A[0].split("/")[1]):null;return y?y<76?new G_t(e,{updateInterval:l,lossRateInterval:d,freezeRateLimit:p}):new w$(e,{updateInterval:l,lossRateInterval:d,freezeRateLimit:p}):function(g){return!!window.RTCStatsReport&&g.getStats()instanceof Promise}(e)?new w$(e,{updateInterval:l,lossRateInterval:d,freezeRateLimit:p}):new V_t(e,{updateInterval:l,lossRateInterval:d,freezeRateLimit:p})}function N$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function k$(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?N$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):N$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let q_t=(X0((OI=class o3 extends eY{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(l,d){super(l,d),_s(this,"store",void 0),_s(this,"peerConnection",void 0),_s(this,"remoteSDP",void 0),_s(this,"initialOffer",void 0),_s(this,"statsFilter",void 0),_s(this,"useRTX",!1),_s(this,"localCapabilities",void 0),_s(this,"localCandidateCount",0),_s(this,"allCandidatesReceived",!1),_s(this,"mutex",new g_("P2PConnection-mutex")),this.store=d,this.peerConnection=new RTCPeerConnection(o3.resolvePCConfiguration(l),{optional:[{googDscp:!0}]}),this.statsFilter=O$(this.peerConnection,void 0,void 0,d_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{const l=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=zP(l.sdp),p=r8(l.sdp,!this.useRTX,!1,["opus"]);return this.localCapabilities=p,this.initialOffer=l,k$(k$({},d),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:p},offerSDP:l.sdp})}catch(l){throw new _E(_f.GET_LOCAL_CONNECTION_PARAMS_FAILED,l.toString())}}async connect(l,d,p,A,y,g){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new Q_t({remoteIceParameters:l,remoteDtlsParameters:d,candidates:p,remoteRTPCapabilities:A.send,remoteSetup:y,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:g});const b=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(b){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(b.toString()))}}send(l,d){var p=this;return nN(function*(){const A=yield o1(p.mutex.lock());try{if(!p.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const y=l.map($=>p.peerConnection.addTrack($._mediaStreamTrack)),g=yield o1(p.peerConnection.createOffer()),b=J_.exports.parse(g.sdp),I=l.map($=>{const _t=$._mediaStreamTrack,_r=b.mediaDescriptions.find(_i=>_i.attributes.mid===_t.kind);if(!_r)throw new Error("Cannot extract ssrc from mediaDescription.");return function(_i,ga,_u){const ah=_i.attributes.ssrcs.filter(_A=>_A.attributes.label===ga),_h=_i.attributes.ssrcGroups;if(ah.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(_h&&ah.length>1){const _A=_h.find(n0=>n0.ssrcIds.indexOf(ah[0].ssrcId)!==-1);return _A?[{ssrcId:_A.ssrcIds[0],rtx:_u?_A.ssrcIds[1]:void 0}]:[{ssrcId:ah[0].ssrcId}]}return[{ssrcId:ah[0].ssrcId}]}(_r,_t.id,p.useRTX)});let k;try{k=yield I}catch($){throw y.forEach(_t=>{y_()&&_t.replaceTrack(null),p.peerConnection.removeTrack(_t)}),$}const B=p.mungSendOfferSDP(g.sdp,l);p.remoteSDP.receive(l,d,k);const q=p.remoteSDP.toString();return yield o1(p.peerConnection.setLocalDescription({type:"offer",sdp:B})),yield o1(p.applySendEncodings(y,l)),yield o1(p.peerConnection.setRemoteDescription({type:"answer",sdp:q})),l.map(($,_t)=>{const _r=$._mediaStreamTrack.id;return{localSSRC:I[_t],id:_r}})}catch(y){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(y.toString()))}finally{A()}})()}async stopSending(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const d=this.peerConnection.getSenders().filter(y=>{var g;return l.indexOf(((g=y.track)===null||g===void 0?void 0:g.id)||"")!==-1});if(d.length!==l.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");d.map(y=>{y_()&&y.replaceTrack(null),this.peerConnection.removeTrack(y)});const p=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(p),this.remoteSDP.stopReceiving(l);const A=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(d.toString()))}}async receive(l,d,p,A){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(l," before remoteSDP created."));const{id:y,mslabel:g}=this.remoteSDP.send(l,d,A),b=new Y0((B,q)=>{const $=setTimeout(()=>{q(new Error("Cannot receive track, id: ".concat(y)))},1e4),_t=_r=>{const _i=MI();if((_i.name==="Safari"&&Number(_i.version)===11||h_())&&_r.track.id!==y&&_r.streams[0].id===g){var ga;const _u=_r.streams[0].getTracks()[0];return(ga=this.remoteSDP)===null||ga===void 0||ga.updateTrackLabel(l,y,_r.track.id),this.peerConnection.removeEventListener("track",_t),clearTimeout($),void B(_u)}if(_r.track.id===y)return this.peerConnection.removeEventListener("track",_t),clearTimeout($),void B(_r.track)};this.peerConnection.addEventListener("track",_t)}),I=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:I});const k=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(k),{track:await b,id:y}}catch(y){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(y.toString()))}}async stopReceiving(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(l);const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:d});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p)}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(d.toString()))}}async muteRemote(l){}async unmuteRemote(l){}async muteLocal(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const d=this.peerConnection.getSenders().filter(p=>{var A;return l.indexOf(((A=p.track)===null||A===void 0?void 0:A.id)||"")!==-1});if(d.length!==l.length)throw new Error("sender' length doesn't match mids' length.");d.map(p=>{if(y_()&&p.track)p.track.enabled=!1;else{const A=p.getParameters();A.encodings.forEach(y=>y.active=!1),p.setParameters(A)}})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(d.toString()))}}async unmuteLocal(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const d=this.peerConnection.getSenders().filter(y=>{var g;return l.indexOf(((g=y.track)===null||g===void 0?void 0:g.id)||"")!==-1});if(d.length!==l.length)throw new Error("Senders' length doesn't match mids' length.");d.map(async y=>{if(y_()&&y.track)y.track.enabled=!0;else{const g=y.getParameters();g.encodings.forEach(b=>b.active=!0),await y.setParameters(g)}});const p=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(p);const A=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(d.toString()))}}async reEstablish(){const l=await this.peerConnection.createOffer({iceRestart:!0});if(!l.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:zP(l.sdp).iceParameters,restartICE:async(d,p)=>this.restartICE(l,d,p),restartOfferSDP:l.sdp}}close(){var l;this.peerConnection.close(),(l=this.onConnectionStateChange)===null||l===void 0||l.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(l){return this.statsFilter.getVideoIsReady(l)}async updateEncoderConfig(l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const p=await this.peerConnection.createOffer(),A=this.mungSendOfferSDP(p.sdp,[d]);this.remoteSDP.updateRecvMedia(d._mediaStreamTrack.kind,d);const y=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:A}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(p){throw new _E(_f.EXCHANGE_SDP_FAILED,p.toString())}}async updateSendParameters(l,d){const p=this.peerConnection.getSenders().filter(A=>{var y;return((y=A.track)===null||y===void 0?void 0:y.id)===l});p.length===1&&await this.applySendEncodings(p,[d])}setStatsRemoteVideoIsReady(l,d){this.statsFilter.setVideoIsReady2(l,d)}async replaceTrack(l,d){const p=this.peerConnection.getSenders().find(A=>{var y;return((y=A.track)===null||y===void 0?void 0:y.id)===d});p&&await p.replaceTrack(l._mediaStreamTrack)}async restartICE(l,d,p){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(d,p);const A=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(A.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var l;(l=this.onICEConnectionStateChange)===null||l===void 0||l.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var l;(l=this.onConnectionStateChange)===null||l===void 0||l.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=l=>{l.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_a.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_a.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},y0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(l){const d={iceServers:[],sdpSemantics:"plan-b"};return l.iceServers?d.iceServers=l.iceServers:l.turnServer&&l.turnServer.mode!=="off"&&(J4(l.turnServer.servers)?d.iceServers=l.turnServer.servers:(d.iceServers&&d.iceServers.push(...o3.turnServerConfigToIceServers(l.turnServer.servers)),y0("USE_TURN_SERVER_OF_GATEWAY")&&d.iceServers&&l.turnServer.serversFromGateway&&d.iceServers.push(...o3.turnServerConfigToIceServers(l.turnServer.serversFromGateway)),l.turnServer.servers.concat(l.turnServer.serversFromGateway||[]).forEach(p=>{p.forceturn&&(d.iceTransportPolicy="relay")}))),d}static turnServerConfigToIceServers(l){const d=[];return l.forEach(p=>{p.security?p.tcpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=tcp")}):(p.udpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.udpport,"?transport=udp")}),p.tcpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=tcp")}))}),d}async applySendEncodings(l,d){try{if(!t_().supportSetRtpSenderParameters||l.length!==d.length)return;for(let A=0;A<l.length;A++){var p;const y=l[A],g=d[A];if(!g)continue;const b={},I={};if(g instanceof A1)switch(g._optimizationMode){case"motion":b.degradationPreference="maintain-framerate";break;case"detail":b.degradationPreference="maintain-resolution";break;default:b.degradationPreference="balanced"}if(y0("DSCP_TYPE")&&e2()){const q=y0("DSCP_TYPE");["very-low","low","medium","high"].includes(q)&&(I.networkPriority=q)}const k=y.getParameters(),B=(p=k.encodings)===null||p===void 0?void 0:p[0];B&&Object.assign(B,I),Object.assign(k,b),await y.setParameters(k)}}catch{_a.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(l,d){const p=J_.exports.parse(l);return d.forEach((A,y)=>{const g=A._mediaStreamTrack,b=p.mediaDescriptions.find(I=>I.attributes.mid===g.kind);b&&XP(b,A)}),J_.exports.print(p)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=l=>{var d;(d=this.onFirstAudioReceived)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstVideoReceived=l=>{var d;(d=this.onFirstVideoReceived)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstAudioDecoded=l=>{var d;(d=this.onFirstAudioDecoded)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstVideoDecoded=(l,d,p)=>{var A;(A=this.onFirstVideoDecoded)===null||A===void 0||A.call(this,l,d,p)},this.statsFilter.onSelectedLocalCandidateChanged=(l,d)=>{var p;(p=this.onSelectedLocalCandidateChanged)===null||p===void 0||p.call(this,l,d)},this.statsFilter.onSelectedRemoteCandidateChanged=(l,d)=>{var p;(p=this.onSelectedRemoteCandidateChanged)===null||p===void 0||p.call(this,l,d)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const d=this.remoteSDP.batchSend(l).map((y,g)=>{let{id:b,mslabel:I}=y;const{kind:k}=l[g];return new Y0((B,q)=>{const $=setTimeout(()=>{q(new Error("Cannot receive track, id: ".concat(b)))},1e4),_t=_r=>{const _i=MI();if(_i.name==="Safari"&&Number(_i.version)===11&&_r.track.id!==b&&_r.streams[0].id===I){var ga;const _u=_r.streams[0].getTracks()[0];return(ga=this.remoteSDP)===null||ga===void 0||ga.updateTrackLabel(k,b,_r.track.id),this.peerConnection.removeEventListener("track",_t),clearTimeout($),void B({track:_u,id:b})}if(_r.track.id===b)return this.peerConnection.removeEventListener("track",_t),clearTimeout($),void B({track:_r.track,id:b})};this.peerConnection.addEventListener("track",_t)})}),p=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:p});const A=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(A),await Y0.all(d)}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}}).prototype,"connect",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"connect"),OI.prototype),X0(OI.prototype,"stopSending",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"stopSending"),OI.prototype),X0(OI.prototype,"receive",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"receive"),OI.prototype),X0(OI.prototype,"stopReceiving",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"stopReceiving"),OI.prototype),X0(OI.prototype,"muteRemote",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"muteRemote"),OI.prototype),X0(OI.prototype,"unmuteRemote",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"unmuteRemote"),OI.prototype),X0(OI.prototype,"muteLocal",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"muteLocal"),OI.prototype),X0(OI.prototype,"unmuteLocal",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"unmuteLocal"),OI.prototype),X0(OI.prototype,"reEstablish",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"reEstablish"),OI.prototype),X0(OI.prototype,"close",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"close"),OI.prototype),X0(OI.prototype,"updateEncoderConfig",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"updateEncoderConfig"),OI.prototype),X0(OI.prototype,"updateSendParameters",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"updateSendParameters"),OI.prototype),X0(OI.prototype,"replaceTrack",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"replaceTrack"),OI.prototype),X0(OI.prototype,"restartICE",[k_],Object.getOwnPropertyDescriptor(OI.prototype,"restartICE"),OI.prototype),OI);function k_(e,l,d){const p=e[l];if(typeof p!="function")throw new Error("Cannot use mutex on object property.");return d.value=async function(){const A=this.mutex,y=await A.lock("Locking from P2PConnection.".concat(l));try{for(var g=arguments.length,b=new Array(g),I=0;I<g;I++)b[I]=arguments[I];return await p.apply(this,b)}finally{y()}},d}var D$;const $P="9",L$=4e4;let H_t=U1("RemoteSDP")(D$=class{get localCapabilities(){return L1(this._localCapabilities)}get rtpCapabilities(){return L1(this._rtpCapabilities)}get candidates(){return L1(this._candidates)}get iceParameters(){return L1(this._iceParameters)}get dtlsParameters(){return L1(this._dtlsParameters)}constructor(e){_s(this,"sessionDesc",void 0),_s(this,"_localCapabilities",void 0),_s(this,"_rtpCapabilities",void 0),_s(this,"_candidates",void 0),_s(this,"_iceParameters",void 0),_s(this,"_dtlsParameters",void 0),_s(this,"setup",void 0),_s(this,"currentMidIndex",void 0),_s(this,"cname",void 0),e=L1(e);const{remoteIceParameters:l,remoteDtlsParameters:d,candidates:p,remoteRTPCapabilities:A,remoteSetup:y,localCapabilities:g,cname:b}=e,I=J_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=A,this._candidates=p,this._iceParameters=l,this._dtlsParameters=d,this._localCapabilities=g,this.setup=y,this.cname=b;const k=this.rtpCapabilities.send;for(const B of I.mediaDescriptions){if(B.attributes.iceUfrag=l.iceUfrag,B.attributes.icePwd=l.icePwd,B.attributes.fingerprints=d.fingerprints,B.attributes.candidates=p,B.attributes.setup=y,B.media.mediaType==="video"&&(B.media.fmts=k.videoCodecs.map(q=>q.payloadType.toString(10)),B.attributes.payloads=k.videoCodecs,B.attributes.extmaps=k.videoExtensions,y0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:q,ssrcGroups:$}=x2([{ssrcId:L$,rtx:y0("USE_RTX")?40001:void 0}],this.cname);B.attributes.ssrcs=q,B.attributes.ssrcGroups=$}if(B.media.mediaType==="audio"&&(B.media.fmts=k.audioCodecs.map(q=>q.payloadType.toString(10)),B.attributes.payloads=k.audioCodecs,B.attributes.extmaps=k.audioExtensions,y0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:q,ssrcGroups:$}=x2([{ssrcId:2e4}],this.cname);B.attributes.ssrcs=q,B.attributes.ssrcGroups=$}}this.sessionDesc=I,this.currentMidIndex=I.mediaDescriptions.length-1}preloadRemoteMedia(){const e=y0("PRELOAD_MEDIA_COUNT");b0("debug",this,"preloadRemoteMedia",e),this.rtpCapabilities;const l=this.candidates,d=this.dtlsParameters,p=this.iceParameters,A=this.rtpCapabilities.send;for(let y=1;y<e;y++){const g=2*y+2e4,b=2*y+L$,{ssrcs:I,ssrcGroups:k}=x2([{ssrcId:g}],this.cname),{ssrcs:B,ssrcGroups:q}=x2([{ssrcId:b,rtx:y0("USE_RTX")?b+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:$P,protos:["UDP","TLS","RTP","SAVPF"],fmts:A.videoCodecs.map($=>$.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:p.iceUfrag,icePwd:p.icePwd,unrecognized:[],candidates:l,extmaps:A.videoExtensions,fingerprints:d.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:B,ssrcGroups:q,rtcpFeedbackWildcards:[],payloads:A.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*y)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:$P,protos:["UDP","TLS","RTP","SAVPF"],fmts:A.audioCodecs.map($=>$.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:p.iceUfrag,icePwd:p.icePwd,unrecognized:[],candidates:l,extmaps:A.audioExtensions,fingerprints:d.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:I,ssrcGroups:k,rtcpFeedbackWildcards:[],payloads:A.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*y+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return J_.exports.print(this.sessionDesc)}send(e,l,d,p){const{ssrcs:A,ssrcGroups:y}=x2(l,this.cname,d),g=this.findPreloadMediaDesc(A);if(g){if(p&&(p.tcc||p.remb)){const b=this.sessionDesc.mediaDescriptions.indexOf(g);return this.sessionDesc.mediaDescriptions[b]=this.mungSendMediaDesc(g,p),{mid:g.attributes.mid,needExchangeSDP:!0}}return{mid:g.attributes.mid,needExchangeSDP:!1}}{const b=this.findAvailableMediaIndex(e);if(y_()||zH()){if(b!==-1&&b!==1){const I=L1(this.sessionDesc.mediaDescriptions[b]);return I.attributes.direction="sendonly",I.attributes.ssrcs=A,I.attributes.ssrcGroups=y,this.sessionDesc.mediaDescriptions[b]=this.mungSendMediaDesc(I,p),{mid:I.attributes.mid,needExchangeSDP:!0}}{const I=this.createOrRecycleSendMedia(e,A,y,"sendonly",p);return this.updateBundleMids(),{mid:I.attributes.mid,needExchangeSDP:!0}}}if(b!==-1){const I=L1(this.sessionDesc.mediaDescriptions[b]);return I.attributes.direction="sendonly",I.attributes.ssrcs=A,I.attributes.ssrcGroups=y,this.sessionDesc.mediaDescriptions[b]=this.mungSendMediaDesc(I,p),{mid:I.attributes.mid,needExchangeSDP:!0}}{const I=this.createOrRecycleSendMedia(e,A,y,"sendonly",p);return this.updateBundleMids(),{mid:I.attributes.mid,needExchangeSDP:!0}}}}batchSend(e){const l=e.map(A=>{let{kind:y,ssrcMsg:g,mslabel:b}=A;return this.send(y,g,b)}),d=[];let p=!1;return l.forEach(A=>{let{mid:y,needExchangeSDP:g}=A;g&&(p=!0),d.push(y)}),{mids:d,needExchangeSDP:p}}stopSending(e){const l=this.sessionDesc.mediaDescriptions.filter(d=>d.attributes.mid&&e.indexOf(d.attributes.mid)!==-1);if(l.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");l.forEach(d=>{d.attributes.mid==="0"||d_()||y_()||zH()?d.attributes.ssrcs=[]:(d.attributes.ssrcs=[],d.attributes.direction="inactive",d.media.port="0")}),this.updateBundleMids()}mute(e){const l=this.sessionDesc.mediaDescriptions.find(d=>d.attributes.mid===e);if(!l)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));l.attributes.direction="inactive"}unmute(e){const l=this.sessionDesc.mediaDescriptions.find(d=>d.attributes.mid===e);if(!l)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));l.attributes.direction="sendonly"}muteRemote(e){const l=this.sessionDesc.mediaDescriptions.filter(d=>e.includes(d.attributes.mid||""));if(l.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");l.forEach(d=>{d.attributes.direction="inactive"})}unmuteRemote(e){const l=this.sessionDesc.mediaDescriptions.filter(d=>e.includes(d.attributes.mid||""));if(l.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");l.forEach(d=>{d.attributes.direction="recvonly"})}receive(e,l,d,p){e.forEach((A,y)=>{this.createOrRecycleRecvMedia(A,[],"recvonly",l,d,p[y])}),this.updateBundleMids()}stopReceiving(e){const l=this.sessionDesc.mediaDescriptions.filter(d=>e.indexOf(d.attributes.mid)!==-1);if(l.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");l.forEach(d=>{d.media.port="0",d.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(e,l){e=L1(e),l=L1(l),this._iceParameters=e,this._candidates=l,this.sessionDesc.mediaDescriptions.forEach(d=>{d.attributes.iceUfrag=e.iceUfrag,d.attributes.icePwd=e.icePwd,d.attributes.candidates=this.candidates})}predictReceivingMids(e){const l=[];for(let d=0;d<e;d++)l.push((this.currentMidIndex+d+1).toString(10));return l}findAvailableMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(l=>l.media.mediaType===e&&l.media.port!=="0"&&(l.attributes.direction==="sendonly"||l.attributes.direction==="sendrecv")&&l.attributes.ssrcs.length===0)}createOrRecycleRecvMedia(e,l,d,p,A,y){const g=e._mediaStreamTrack.kind,b=this.rtpCapabilities.recv,I=this.localCapabilities.send;let k=[];if(g===AI.VIDEO){var B,q;if(y0("H264_PROFILE_LEVEL_ID")&&p==="h264"&&(k=b.videoCodecs.filter(ga=>{var _u,ah;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes(p)&&(ga==null||(ah=ga.fmtp)===null||ah===void 0?void 0:ah.parameters["profile-level-id"])===y0("H264_PROFILE_LEVEL_ID")})),!k||((B=k)===null||B===void 0?void 0:B.length)===0){const ga=I.videoCodecs.filter(_u=>{var ah;return(((ah=_u.rtpMap)===null||ah===void 0?void 0:ah.encodingName.toLowerCase())||"").includes(p)});ga.length!==0&&(k=b.videoCodecs.filter(_u=>ga.some(ah=>ah.payloadType===_u.payloadType)))}if(y0("USE_RTX")){const ga=k.map(ah=>ah.payloadType.toString()),_u=b.videoCodecs.filter(ah=>{var _h,_A;return((_h=ah.rtpMap)===null||_h===void 0?void 0:_h.encodingName)==="rtx"&&ga.includes(((_A=ah.fmtp)===null||_A===void 0?void 0:_A.parameters.apt)||"")});k=[...k,..._u]}k.length===0&&(_a.warning("codec ".concat(p," not included in rtpCapabilities, fallback to default payloads: ").concat((q=b.videoCodecs[0].rtpMap)===null||q===void 0?void 0:q.encodingName)),k=b.videoCodecs)}else k=b.audioCodecs.filter(ga=>{var _u;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes(A)}),k.length===0&&(_a.warning("codec ".concat(A," not included in rtpCapabilities, fallback to opus")),k=b.audioCodecs.filter(ga=>{var _u;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes("opus")}));const $=g===AI.VIDEO?b.videoExtensions:b.audioExtensions;this.currentMidIndex+=1;const _t="".concat(this.currentMidIndex);let _r={media:{mediaType:g,port:$P,protos:["UDP","TLS","RTP","SAVPF"],fmts:k.map(ga=>ga.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:$,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:l,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:k,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:d,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_t)}};_r=this.mungRecvMediaDsec(_r,e,y);const _i=this.findFirstClosedMedia(g);if(_i){const ga=this.sessionDesc.mediaDescriptions.indexOf(_i);this.sessionDesc.mediaDescriptions[ga]=_r}else this.sessionDesc.mediaDescriptions.push(_r);return _r}createOrRecycleSendMedia(e,l,d,p,A){const y=this.rtpCapabilities.send,g=e===AI.VIDEO?y.videoCodecs:y.audioCodecs,b=e===AI.VIDEO?y.videoExtensions:y.audioExtensions;this.currentMidIndex+=1;const I="".concat(this.currentMidIndex);let k={media:{mediaType:e,port:$P,protos:["UDP","TLS","RTP","SAVPF"],fmts:g.map(q=>q.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:b,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:l,ssrcGroups:d,rtcpFeedbackWildcards:[],payloads:g,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:p,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(I)}};k=this.mungSendMediaDesc(k,A);const B=this.findFirstClosedMedia(e);if(B){const q=this.sessionDesc.mediaDescriptions.indexOf(B);this.sessionDesc.mediaDescriptions[q]=k}else this.sessionDesc.mediaDescriptions.push(k);return k}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}mungRecvMediaDsec(e,l,d){const p=L1(e);return E$(p),XP(p,l),m$(p,l),function(A){if(A.media.mediaType!=="video")return;const y=MI();if(y.name!==DI.SAFARI&&y.os!==C1.IOS)return;const g=A.attributes.extmaps.findIndex(b=>/video-orientation/g.test(b.extensionName));g!==-1&&A.attributes.extmaps.splice(g,1)}(p),v$(p,d,this.localCapabilities.send),p}mungSendMediaDesc(e,l){const d=L1(e);return v$(d,l,this.localCapabilities.recv),d}updateRecvMedia(e,l){const d=this.sessionDesc.mediaDescriptions.findIndex(p=>p.attributes.mid===e);if(d!==-1){const p=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[d],l);this.sessionDesc.mediaDescriptions[d]=p}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(l=>d_()?l.media.port==="0"&&l.media.mediaType===e:l.media.port==="0")}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(l=>{var d,p;return((d=l.attributes)===null||d===void 0||(p=d.ssrcs[0])===null||p===void 0?void 0:p.ssrcId)===e[0].ssrcId})}})||D$;var P$,NI;function x$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function B$(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?x$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):x$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let K_t=U1("P2PConnection","store.p2pId")((X0((NI=class s3 extends eY{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(l,d){super(l,d),_s(this,"store",void 0),_s(this,"peerConnection",void 0),_s(this,"remoteSDP",void 0),_s(this,"initialOffer",void 0),_s(this,"transportEventReceiver",void 0),_s(this,"statsFilter",void 0),_s(this,"useRTX",y0("USE_RTX")),_s(this,"localCapabilities",void 0),_s(this,"localCandidateCount",0),_s(this,"allCandidatesReceived",!1),_s(this,"mutex",new g_("P2PConnection-mutex")),this.store=d,this.peerConnection=new RTCPeerConnection(s3.resolvePCConfiguration(l),{optional:[{googDscp:!0}]}),this.statsFilter=O$(this.peerConnection,void 0,void 0,d_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const l=await this.peerConnection.createOffer();if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=zP(l.sdp),p=await async function(A,y,g,b){const I=new RTCPeerConnection;I.addTransceiver("video",{direction:"sendonly"}),I.addTransceiver("audio",{direction:"sendonly"}),I.addTransceiver("video",{direction:"recvonly"}),I.addTransceiver("audio",{direction:"recvonly"});const k=(await I.createOffer()).sdp,B=r8(k,A,y,g,b,"sendonly"),q=r8(k,A,y,g,b,"recvonly"),$={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_t={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ZP(B,q,"videoExtensions",$,_t,_r),ZP(B,q,"videoCodecs",$,_t,_r),ZP(B,q,"audioExtensions",$,_t,_r),ZP(B,q,"audioCodecs",$,_t,_r),y0("RAISE_H264_BASELINE_PRIORITY")){const _i=_r.videoCodecs.findIndex(ga=>{var _u,ah;return((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLocaleLowerCase())==="h264"&&((ah=ga.fmtp)===null||ah===void 0?void 0:ah.parameters["profile-level-id"])==="42001f"});if(_i!==-1){const ga=_r.videoCodecs.findIndex(_u=>{var ah;return((ah=_u.rtpMap)===null||ah===void 0?void 0:ah.encodingName.toLocaleLowerCase())==="h264"});if(ga<_i){_a.debug("raising H264 baseline profile priority");const _u=_r.videoCodecs[_i];_r.videoCodecs.splice(_i,1),_r.videoCodecs.splice(ga,0,_u)}ga!==-1&&(_t.videoCodecs=_t.videoCodecs.filter(_u=>{var ah,_h;return!(((ah=_u.rtpMap)===null||ah===void 0?void 0:ah.encodingName.toLocaleLowerCase())==="h264"&&((_h=_u.fmtp)===null||_h===void 0?void 0:_h.parameters["profile-level-id"])!=="42001f")})),ga!==-1&&y0("FILTER_SEND_H264_BASELINE")&&($.videoCodecs=$.videoCodecs.filter(_u=>{var ah,_h;return!(((ah=_u.rtpMap)===null||ah===void 0?void 0:ah.encodingName.toLocaleLowerCase())==="h264"&&((_h=_u.fmtp)===null||_h===void 0?void 0:_h.parameters["profile-level-id"])!=="42001f")}))}}try{I.close()}catch{}return{send:$,recv:_t,sendrecv:_r}}(!this.useRTX,!1);return this.localCapabilities=I$(p),this.initialOffer=l,B$(B$({},d),{},{rtpCapabilities:p,offerSDP:l.sdp})}catch(l){throw new _E(_f.GET_LOCAL_CONNECTION_PARAMS_FAILED,l.toString())}}async connect(l,d,p,A,y,g){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new H_t({remoteIceParameters:l,remoteDtlsParameters:d,candidates:p,remoteRTPCapabilities:A,remoteSetup:y,localCapabilities:this.localCapabilities,cname:g});const b=this.remoteSDP.toString(),I=this.logSDPExchange(this.initialOffer.sdp||"","offer","local","connect");await this.peerConnection.setLocalDescription(this.initialOffer),I==null||I(b),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b});const k=this.peerConnection.getTransceivers()[0];if(k!=null&&k.receiver&&this.tryBindTransportEvents(k.receiver),y0("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const B=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:B});const q=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(q)}}catch(b){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(b.toString()))}}send(l,d,p){var A=this;return nN(function*(){const y=yield o1(A.mutex.lock());try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const g=[];l.forEach(_i=>{const ga=A.peerConnection.addTransceiver(_i._mediaStreamTrack,{direction:"sendonly"});g.push(ga)}),d_()&&y0("SIMULCAST")===!0&&(H0("debug",A,"apply simulcast for firefox"),yield o1(A.applySimulcastForFirefox(g,l)));const b=yield o1(A.peerConnection.createOffer()),I=A.remoteSDP.predictReceivingMids(l.length),k=A.mungSendOfferSDP(b.sdp,l,I),B=J_.exports.parse(k),q=I.map(_i=>{const ga=B.mediaDescriptions.find(_u=>_u.attributes.mid===_i);if(!ga)throw new Error("Cannot extract ssrc from mediaDescription.");return function(_u,ah){const _h=[],_A=_u.attributes.ssrcGroups.filter(E0=>E0.semantic==="FID"),n0=_u.attributes.ssrcGroups.find(E0=>E0.semantic==="SIM"),f0=_u.attributes.ssrcs;if(n0)n0.ssrcIds.forEach(E0=>{var m0;const V0=(m0=_A.find(D0=>D0.ssrcIds[0]===E0))===null||m0===void 0?void 0:m0.ssrcIds[1];_h.push({ssrcId:E0,rtx:ah?V0:void 0})});else if(_A.length>0){const E0=_A[0].ssrcIds[0],m0=_A[0].ssrcIds[1];_h.push({ssrcId:E0,rtx:ah?m0:void 0})}else{if(f0.length===0)throw new Error("No ssrcs found on local media description.");_h.push({ssrcId:f0[0].ssrcId})}return _h}(ga,A.useRTX)});let $;try{$=yield q}catch(_i){$=[],A.remoteSDP.receive(l,d,p,$);const ga=A.remoteSDP.toString();throw yield o1(A.peerConnection.setLocalDescription({type:"offer",sdp:k})),yield o1(A.peerConnection.setRemoteDescription({type:"answer",sdp:ga})),yield o1(A.stopSending(I,!0)),_i}A.remoteSDP.receive(l,d,p,$);const _t=A.remoteSDP.toString(),_r=A.logSDPExchange(k,"offer","local","send");return yield o1(A.peerConnection.setLocalDescription({type:"offer",sdp:k})),yield o1(A.applySimulcastEncodings(g,l)),yield o1(A.applySendEncodings(g,l)),_r==null||_r(_t),yield o1(A.peerConnection.setRemoteDescription({type:"answer",sdp:_t})),g.map((_i,ga)=>{const _u=I[ga];return{localSSRC:q[ga],id:_u,transceiver:_i}})}catch(g){throw g instanceof _E?g:new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(g.toString()))}finally{y()}})()}async stopSending(l,d){const p=d?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const A=this.peerConnection.getTransceivers().filter(I=>l.indexOf(I.mid)!==-1);if(A.length!==l.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");A.map(I=>{var k;I.direction="inactive",(k=I.stop)===null||k===void 0||k.call(I)});const y=await this.peerConnection.createOffer(),g=this.logSDPExchange(y.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(y),this.remoteSDP.stopReceiving(l);const b=this.remoteSDP.toString();g==null||g(b),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(A.toString()))}finally{p&&p()}}async receive(l,d,p,A){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(l," before remoteSDP created."));const{mid:y,needExchangeSDP:g}=this.remoteSDP.send(l,d,p,A);if(g){const I=this.remoteSDP.toString(),k=this.logSDPExchange(I,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:I});const B=await this.peerConnection.createAnswer();k==null||k(B.sdp||""),await this.peerConnection.setLocalDescription(B),_a.debug("[P2PConnection] receive ".concat(l," by exchanging SDP."))}else _a.debug("[P2PConnection] receive ".concat(l," no need to exchange SDP."));const b=this.peerConnection.getTransceivers().find(I=>I.mid===y);if(!b)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:b.receiver.track,id:y}}catch(y){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(y.toString()))}}async batchReceive(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:d,needExchangeSDP:p}=this.remoteSDP.batchSend(l);if(p){const A=this.remoteSDP.toString(),y=this.logSDPExchange(A,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:A});const g=await this.peerConnection.createAnswer();y==null||y(g.sdp||""),await this.peerConnection.setLocalDescription(g),_a.debug("[P2PConnection] batchReceive by exchanging SDP.")}else _a.debug("[P2PConnection] batchReceive no need to exchange SDP.");return d.map(A=>{const y=this.peerConnection.getTransceivers().find(g=>g.mid===A);if(!y)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:y.receiver.track,id:A}})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}async stopReceiving(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(l);const d=this.remoteSDP.toString(),p=this.logSDPExchange(d,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:d});const A=await this.peerConnection.createAnswer();p==null||p(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(d.toString()))}}async muteRemote(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(l," before remote SDP created."));this.remoteSDP.mute(l);const d=this.remoteSDP.toString(),p=this.logSDPExchange(d,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:d});const A=await this.peerConnection.createAnswer();p==null||p(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(d.toString()))}}async unmuteRemote(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(l," before remote SDP created."));this.remoteSDP.unmute(l);const d=this.remoteSDP.toString(),p=this.logSDPExchange(d,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:d});const A=await this.peerConnection.createAnswer();p==null||p(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(d.toString()))}}async muteLocal(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const d=this.peerConnection.getTransceivers().filter(g=>g.mid&&l.indexOf(g.mid)!==-1);if(d.length!==l.length)throw new Error("Transceivers' length doesn't match mids' length.");d.map(g=>{g.direction="inactive"});const p=await this.peerConnection.createOffer(),A=this.logSDPExchange(p.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(p),this.remoteSDP.muteRemote(l);const y=this.remoteSDP.toString();A==null||A(y),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(d.toString()))}}async unmuteLocal(l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const d=this.peerConnection.getTransceivers().filter(g=>g.mid&&l.indexOf(g.mid)!==-1);if(d.length!==l.length)throw new Error("Transceivers' length doesn't match mids' length.");d.map(async(g,b)=>{g.direction="sendonly"});const p=await this.peerConnection.createOffer(),A=this.logSDPExchange(p.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(p),this.remoteSDP.unmuteRemote(l);const y=this.remoteSDP.toString();A==null||A(y),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(d.toString()))}}async reEstablish(){const l=await this.peerConnection.createOffer({iceRestart:!0});if(!l.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:zP(l.sdp).iceParameters,restartICE:async(d,p)=>this.restartICE(l,d,p),restartOfferSDP:l.sdp}}close(){var l;this.peerConnection.close(),(l=this.onConnectionStateChange)===null||l===void 0||l.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(l){return this.statsFilter.getVideoIsReady(l)}async updateEncoderConfig(l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const p=await this.peerConnection.createOffer(),A=this.mungSendOfferSDP(p.sdp,[d],[l]);this.remoteSDP.updateRecvMedia(l,d);const y=this.remoteSDP.toString(),g=this.logSDPExchange(A,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:A}),g==null||g(y),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(p){throw new _E(_f.EXCHANGE_SDP_FAILED,p.toString())}}async updateSendParameters(l,d){const p=this.peerConnection.getTransceivers().filter(A=>A.mid===l);p.length===1&&(this.isVP8Simulcast(d)?d_()||await this.applySimulcastEncodings(p,[d]):await this.applySendEncodings(p,[d]))}setStatsRemoteVideoIsReady(l,d){this.statsFilter.setVideoIsReady2(l,d)}async replaceTrack(l,d){const p=this.peerConnection.getTransceivers().find(A=>A.mid===d);p&&await p.sender.replaceTrack(l._mediaStreamTrack)}async restartICE(l,d,p){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(d,p);const A=this.remoteSDP.toString(),y=this.logSDPExchange(l.sdp||"","offer","local","restartICE");await this.peerConnection.setLocalDescription(l),y==null||y(A),await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(A.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var l;(l=this.onICEConnectionStateChange)===null||l===void 0||l.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var l;(l=this.onConnectionStateChange)===null||l===void 0||l.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=l=>{l.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_a.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_a.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},y0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(l){const d={iceServers:[]};return l.iceServers?d.iceServers=l.iceServers:l.turnServer&&l.turnServer.mode!=="off"&&(J4(l.turnServer.servers)?d.iceServers=l.turnServer.servers:(d.iceServers&&d.iceServers.push(...s3.turnServerConfigToIceServers(l.turnServer.servers)),y0("USE_TURN_SERVER_OF_GATEWAY")&&d.iceServers&&l.turnServer.serversFromGateway&&d.iceServers.push(...s3.turnServerConfigToIceServers(l.turnServer.serversFromGateway)),l.turnServer.servers.concat(l.turnServer.serversFromGateway||[]).forEach(p=>{p.forceturn&&(d.iceTransportPolicy="relay")}))),d}static turnServerConfigToIceServers(l){const d=[];return l.forEach(p=>{p.security?p.tcpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(z5(p.turnServerURL),":").concat(p.tcpport,"?transport=tcp")}):(p.udpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.udpport,"?transport=udp")}),p.tcpport&&d.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=tcp")}))}),d}tryBindTransportEvents(l){l.transport&&(this.transportEventReceiver=l,l.transport.onstatechange=()=>{var d,p;(d=l.transport)!==null&&d!==void 0&&d.state&&((p=this.onDTLSTransportStateChange)===null||p===void 0||p.call(this,l.transport.state))},l.transport.onerror=d=>{var p;(p=this.onDTLSTransportError)===null||p===void 0||p.call(this,d.error)},l.transport.iceTransport&&(l.transport.iceTransport.onstatechange=()=>{var d,p,A;(d=l.transport)!==null&&d!==void 0&&d.iceTransport.state&&((p=this.onICETransportStateChange)===null||p===void 0||p.call(this,(A=l.transport)===null||A===void 0?void 0:A.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(l,d){try{if(!t_().supportSetRtpSenderParameters||l.length!==d.length)return;for(let k=0;k<l.length;k++){const B=l[k],q=d[k];if(q&&q instanceof A1){var p,A;if(this.isVP8Simulcast(q))continue;const $={},_t={};switch(q._optimizationMode){case"motion":$.degradationPreference="maintain-framerate";break;case"detail":$.degradationPreference="maintain-resolution";break;default:$.degradationPreference="balanced"}var y,g,b,I;if((p=q._encoderConfig)!==null&&p!==void 0&&p.bitrateMax&&(_t.maxBitrate=1e3*((y=q._encoderConfig)===null||y===void 0?void 0:y.bitrateMax)),q._hints.includes(F1.LOW_STREAM)&&((g=q._encoderConfig)!==null&&g!==void 0&&g.frameRate&&(_t.maxFramerate=CR(q._encoderConfig.frameRate)),(b=q._encoderConfig)!==null&&b!==void 0&&b.scaleResolutionDownBy&&((I=q._encoderConfig)===null||I===void 0?void 0:I.scaleResolutionDownBy)>1&&(_t.scaleResolutionDownBy=q._encoderConfig.scaleResolutionDownBy)),y0("DSCP_TYPE")&&e2()){const ga=y0("DSCP_TYPE");["very-low","low","medium","high"].includes(ga)&&(_t.networkPriority=ga)}const _r=B.sender.getParameters(),_i=(A=_r.encodings)===null||A===void 0?void 0:A[0];d_()&&!_i&&($.encodings=[_t]),_i&&Object.assign(_i,_t),Object.assign(_r,$),await B.sender.setParameters(_r)}}}catch{_a.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(l,d,p){const A=J_.exports.parse(l);return d.forEach((y,g)=>{const b=p[g],I=A.mediaDescriptions.find(k=>k.attributes.mid===b);I&&(XP(I,y),function(k,B,q){if(d_()||k.media.mediaType!=="video"||!(B instanceof A1)||q!=="vp9"&&q!=="vp8"||q==="vp8"&&!y0("SIMULCAST")||B._scalabiltyMode===void 0||B._scalabiltyMode.numSpatialLayers<=1)return;const $=q==="vp8"?2:B._scalabiltyMode.numSpatialLayers,_t=k.attributes.ssrcs[0],_r=k.attributes.ssrcGroups.find(ga=>ga.semantic==="FID"&&ga.ssrcIds[0]===_t.ssrcId),_i={semantic:"SIM",ssrcIds:[_t.ssrcId]};for(let ga=1;ga<$;ga++)k.attributes.ssrcs.push({ssrcId:_t.ssrcId+ga,attributes:L1(_t.attributes)}),_i.ssrcIds.push(_t.ssrcId+ga),_r&&(k.attributes.ssrcs.push({ssrcId:_r.ssrcIds[1]+ga,attributes:L1(_t.attributes)}),k.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[_t.ssrcId+ga,_r.ssrcIds[1]+ga]}));k.attributes.ssrcGroups.unshift(_i)}(I,y,this.store.codec))}),J_.exports.print(A)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=l=>{var d;(d=this.onFirstAudioReceived)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstVideoReceived=l=>{var d;(d=this.onFirstVideoReceived)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstAudioDecoded=l=>{var d;(d=this.onFirstAudioDecoded)===null||d===void 0||d.call(this,l)},this.statsFilter.onFirstVideoDecoded=(l,d,p)=>{var A;(A=this.onFirstVideoDecoded)===null||A===void 0||A.call(this,l,d,p)},this.statsFilter.onSelectedLocalCandidateChanged=(l,d)=>{var p;(p=this.onSelectedLocalCandidateChanged)===null||p===void 0||p.call(this,l,d)},this.statsFilter.onSelectedRemoteCandidateChanged=(l,d)=>{var p;(p=this.onSelectedRemoteCandidateChanged)===null||p===void 0||p.call(this,l,d)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async applySimulcastForFirefox(l,d){if(l.length===d.length)for(let b=0;b<l.length;b++){var p,A,y,g;const I=l[b],k=d[b];if(k instanceof A1&&!k._hints.includes(F1.LOW_STREAM)&&(p=k._encoderConfig)!==null&&p!==void 0&&p.bitrateMax&&((A=k._encoderConfig)===null||A===void 0?void 0:A.bitrateMax)>200&&(y=k._scalabiltyMode)!==null&&y!==void 0&&y.numSpatialLayers&&((g=k._scalabiltyMode)===null||g===void 0?void 0:g.numSpatialLayers)>1&&this.store.codec==="vp8"){const B={},q={high:1e3*(k._encoderConfig.bitrateMax-50),medium:5e4};B.encodings=[{rid:"m",active:!0,maxBitrate:q.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:q.high}];const $=I.sender.getParameters();await I.sender.setParameters(Object.assign($,B))}}}async applySimulcastEncodings(l,d){if(!d_()&&l.length===d.length)for(let p=0;p<l.length;p++){const A=d[p];if(A instanceof A1&&this.isVP8Simulcast(A)){const y=l[p],g={},b={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};g.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:b.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:b.medium,scaleResolutionDownBy:4}];const I=y.sender.getParameters();await y.sender.setParameters(Object.assign(I,g))}}}isVP8Simulcast(l){var d,p,A,y;return!!(l instanceof A1&&y0("SIMULCAST")&&this.store.codec==="vp8"&&!l._hints.includes(F1.LOW_STREAM)&&(d=l._encoderConfig)!==null&&d!==void 0&&d.bitrateMax&&((p=l._encoderConfig)===null||p===void 0?void 0:p.bitrateMax)>200&&(A=l._scalabiltyMode)!==null&&A!==void 0&&A.numSpatialLayers&&((y=l._scalabiltyMode)===null||y===void 0?void 0:y.numSpatialLayers)>1)}logSDPExchange(l,d,p,A){if(y0("SDP_LOGGING"))return _a.upload("exchanging ".concat(p," ").concat(d," SDP during P2PConnection.").concat(A,`
`),l),d==="offer"?y=>{this.logSDPExchange(y,"answer",p==="local"?"remote":"local",A)}:void 0}}).prototype,"connect",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"connect"),NI.prototype),X0(NI.prototype,"receive",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"receive"),NI.prototype),X0(NI.prototype,"batchReceive",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"batchReceive"),NI.prototype),X0(NI.prototype,"stopReceiving",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"stopReceiving"),NI.prototype),X0(NI.prototype,"muteRemote",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"muteRemote"),NI.prototype),X0(NI.prototype,"unmuteRemote",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"unmuteRemote"),NI.prototype),X0(NI.prototype,"muteLocal",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"muteLocal"),NI.prototype),X0(NI.prototype,"unmuteLocal",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"unmuteLocal"),NI.prototype),X0(NI.prototype,"reEstablish",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"reEstablish"),NI.prototype),X0(NI.prototype,"close",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"close"),NI.prototype),X0(NI.prototype,"updateEncoderConfig",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"updateEncoderConfig"),NI.prototype),X0(NI.prototype,"updateSendParameters",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"updateSendParameters"),NI.prototype),X0(NI.prototype,"replaceTrack",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"replaceTrack"),NI.prototype),X0(NI.prototype,"restartICE",[D_],Object.getOwnPropertyDescriptor(NI.prototype,"restartICE"),NI.prototype),P$=NI))||P$;function D_(e,l,d){const p=e[l];if(typeof p!="function")throw new Error("Cannot use mutex on object property.");return d.value=async function(){const A=this.mutex,y=await A.lock("From P2PConnection.".concat(l));try{for(var g=arguments.length,b=new Array(g),I=0;I<g;I++)b[I]=arguments[I];return await p.apply(this,b)}finally{y()}},d}function Y_t(e,l){let d=document.createElement("video"),p=document.createElement("canvas");d.setAttribute("style","display:none"),p.setAttribute("style","display:none"),d.setAttribute("muted",""),d.muted=!0,d.setAttribute("autoplay",""),d.autoplay=!0,d.setAttribute("playsinline",""),p.width=CR(l.width),p.height=CR(l.height);const A=CR(l.framerate||15);document.body.append(d),document.body.append(p);let y=e._mediaStreamTrack;d.srcObject=new MediaStream([y]),d.play();const g=p.getContext("2d");if(!g)throw new _E(_f.UNEXPECTED_ERROR,"can not get canvas context");const b=t_(),I=p.captureStream(b.supportRequestFrame?0:A).getVideoTracks()[0],k=Y5(()=>(()=>{if(d.paused&&d.play(),d.videoHeight>2&&d.videoWidth>2){const q=d.videoWidth,$=d.videoHeight/q,_t=p.width*$;Math.abs(_t-p.height)>=2&&(_a.debug("adjust low stream resolution","".concat(p.width,"x").concat(p.height," -> ").concat(p.width,"x").concat(_t)),p.height=_t)}g.drawImage(d,0,0,p.width,p.height),I.requestFrame&&I.requestFrame(),y!==e._mediaStreamTrack&&(y=e._mediaStreamTrack,d.srcObject=new MediaStream([y]))})(),A),B=I.stop;return I.stop=()=>{B.call(I),k(),d.remove(),p.width=0,p.remove(),p=null,d=null,_a.debug("clean low stream renderer")},I}var M$,U$;function j$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function _x(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?j$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):j$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}class F$ extends UW{getUserId(){return this._userId}constructor(l,d,p,A){super(l,"track-".concat(l.kind,"-").concat(d,"-").concat(A.clientId,"_").concat(i1(5,""))),_s(this,"_userId",void 0),_s(this,"_uintId",void 0),_s(this,"_isDestroyed",!1),_s(this,"store",void 0),this._userId=d,this._uintId=p,this.store=A}_updateOriginMediaStreamTrack(l){this._originMediaStreamTrack=l,this._mediaStreamTrack=l,this._updatePlayerSource()}_destroy(){this._isDestroyed=!0,_a.info("[".concat(this.getTrackId(),"] is destroyed")),b0("info",this,"_destroy"),this.stop(),super.close()}}let _B=U1("RemoteVideoTrack","getTrackId")(M$=class extends F${get isPlaying(){return!(!this._player||this._player.videoElementStatus!==j1.PLAYING)}constructor(e,l,d,p){super(e,l,d,p),_s(this,"_videoVisibleTimer",null),_s(this,"_previousVideoVisibleStatus",void 0),_s(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_s(this,"trackMediaType","video"),_s(this,"_videoWidth",void 0),_s(this,"_videoHeight",void 0),_s(this,"_player",void 0),b0("info",this,"constructor",{userId:l}),this.updateMediaStreamTrackResolution()}getStats(){return UO(()=>{_a.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead"),H0("warning",this,"[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),pT(this,tI.GET_STATS)||_x({},zK)}play(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),typeof e=="string"?e:"HTMLElement",l]});if(typeof e=="string"){const A=document.getElementById(e);A?e=A:(_a.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),H0("warning",this,'can not find "#'.concat(e,'" element, use document.body')),e=document.body)}_a.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(l)),b0("debug",this,"play",l);const p=_x(_x({fit:"cover"},l),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(p):(this._player=new rZ(p),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,performance.now()),this.emit(l2.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const A=this.getVideoElementVisibleStatus();this.emit(l2.VIDEO_ELEMENT_VISIBLE_STATUS,A)}catch{}},y0("CHECK_VIDEO_VISIBLE_INTERVAL")),d.onSuccess()}stop(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_a.debug("[".concat(this.getTrackId(),"] stop video playback")),b0("debug",this,"stop"),e.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){kJ(this._originMediaStreamTrack).then(e=>{let[l,d]=e;this._videoHeight=d,this._videoWidth=l}).catch(bP)}_updatePlayerSource(){_a.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,l;const d=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),p={track:this,element:this==null||(l=this._player)===null||l===void 0?void 0:l.getVideoElement(),slot:d==null?void 0:d.parentElement},{element:A,slot:y}=p;if(this.isPlaying&&A instanceof HTMLVideoElement&&y instanceof HTMLElement){const g=DZ.checkOneElementVisible(A),b=Object.assign({},g);if(b.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=b.visible;const I=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});b.visible?I.onSuccess("Video is visible"):I.onSuccess("Invisible because of ".concat(b.reason))}return b}return}catch(d){throw new _E(_f.GET_VIDEO_ELEMENT_VISIBLE_ERROR,d.message)}}})||M$,t3=U1("RemoteAudioTrack","getTrackId")(U$=class extends F${get isPlaying(){return this._useAudioElement?m_.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,l,d,p){super(e,l,d,p),_s(this,"trackMediaType","audio"),_s(this,"_source",void 0),_s(this,"_useAudioElement",!0),_s(this,"_volume",100),b0("info",this,"constructor",{userId:l}),y0("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),this._source=new GW(e,!0),this._source.once(p_.RECEIVE_TRACK_BUFFER,()=>{this.emit(l2.FIRST_FRAME_DECODED)})}setAudioFrameCallback(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(p_.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(l),this._source.removeAllListeners(p_.ON_AUDIO_BUFFER),this._source.on(p_.ON_AUDIO_BUFFER,d=>e(d))}setVolume(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._useAudioElement?m_.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),l.onSuccess()}async setPlaybackDevice(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new _E(_f.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await m_.setSinkID(this.getTrackId(),e)}catch(d){throw l.onError(d),d}l.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return UO(()=>{_a.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead"),H0("warning",this,"[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),pT(this,tI.GET_STATS)||_x({},JK)}play(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});_a.debug("[".concat(this.getTrackId(),"] start audio playback")),b0("debug",this,"play"),this._useAudioElement?(_a.debug("[".concat(this.getTrackId(),"] use audio element to play")),H0("debug",this,"use audio element to play"),m_.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),e.onSuccess()}stop(){const e=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});_a.debug("[".concat(this.getTrackId(),"] stop audio playback")),b0("debug",this,"stop"),this._useAudioElement?m_.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}_destroy(){super._destroy(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){_a.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&m_.updateTrack(this.getTrackId(),this._mediaStreamTrack)}})||U$;function Q$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function G$(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?Q$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):Q$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}class W_t extends e1{constructor(){super(),_s(this,"uplinkStatsUploadInterval",void 0),_s(this,"uplinkStatsUploadSlowInterval",void 0),_s(this,"uplinkRelatedStatsUploadInterval",void 0),_s(this,"uplinkDenoiserStatsUploadInterval",void 0),_s(this,"transportStatsUploadInterval",void 0),_s(this,"extensionStatsUploadInterval",void 0),_s(this,"downlinkStatsUploadInterval",void 0),_s(this,"downlinkStatsUploadSlowInterval",void 0),_s(this,"downlinkRelatedStatsUploadInterval",void 0),_s(this,"lastStats",void 0),_s(this,"uploadUnplinkStarted",!1),_s(this,"uploadDownlinkStarted",!1),_s(this,"uploadTransportStarted",!1),_s(this,"requestStats",void 0),_s(this,"requestLocalMedia",void 0),_s(this,"requestRemoteMedia",void 0),_s(this,"requestAllTracks",void 0),_s(this,"requestVideoIsReady",void 0),_s(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&this.uploadTransportStats(d)},6e3))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&(this.uploadUplinkStats(d,this.lastStats),this.lastStats=d)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&this.uploadSlowUplinkStats(d)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&this.uploadRelatedUplinkStats(d,this.lastStats),this.lastStats=d},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestAllTracks)===null||l===void 0?void 0:l.call(this);d&&this.uploadDenoiserStats(d)},2e3),this.extensionStatsUploadInterval&&window.clearInterval(this.extensionStatsUploadInterval),this.extensionStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestAllTracks)===null||l===void 0?void 0:l.call(this);d&&this.uploadExtensionStats(d)},2e3))}uploadTransportStats(l){Y_(()=>{var d;(d=this.requestUpload)===null||d===void 0||d.call(this,c_.TRANSPORT_STATS,function(p){const A={connectionType:100};if(p.selectedCandidatePair.localCandidate.candidateType==="relay"){const y=p.selectedCandidatePair.localCandidate.relayProtocol;y==="udp"&&(A.connectionType=101),y==="tcp"&&(A.connectionType=103),y==="tls"&&(A.connectionType=104)}return A}(l))})}uploadUplinkStats(l,d){var p;(((p=this.requestLocalMedia)===null||p===void 0?void 0:p.call(this))||[]).forEach(A=>{let[y,{track:g,ssrcs:b}]=A;switch(y){case Q0.LocalVideoLowTrack:case Q0.LocalVideoTrack:{const k=function(q,$,_t){var _r;const _i=$.videoSend.find(_u=>_u.ssrc===q);if(!_i)return null;const ga={id:i1(10,""),timestamp:new Date($.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:_i.ssrc.toString()};switch(ga.A_vstd=_t._originMediaStreamTrack&&!_t._originMediaStreamTrack.enabled||!_t._mediaStreamTrack.enabled?"1":"0",_i.sentFrame&&(ga.A_fhs=_i.sentFrame.height.toString(),ga.A_frs=_i.sentFrame.frameRate.toString(),ga.A_fws=_i.sentFrame.width.toString()),_i.adaptionChangeReason){case"none":ga.A_ac="0";break;case"cpu":ga.A_ac="1";break;case"bandwidth":ga.A_ac="2";break;case"other":ga.A_ac="3"}return ga.A_lvps=Y4[_t._player?_t._player.videoElementStatus:"uninit"].toString(),ga.A_nr=(_r=_i.nacksCount)===null||_r===void 0?void 0:_r.toString(),_i.avgEncodeMs&&(ga.A_aem=_i.avgEncodeMs.toFixed(0).toString()),ga}(b[0].ssrcId,l,g),B=TJ(b[0].ssrcId,l,d);k&&Y_(()=>{var q;return(q=this.requestUpload)===null||q===void 0?void 0:q.call(this,c_.PUBLISH_STATS,{stream_type:y===Q0.LocalVideoLowTrack?"low":"high",stats:G$(G$({},k),B)})});break}case Q0.LocalAudioTrack:{const k=function(B,q,$){const _t=q.audioSend.find(_i=>_i.ssrc===B);if(!_t)return null;const _r={id:i1(10,""),timestamp:new Date(q.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_t.ssrc.toString()};return _r.A_astd=$._originMediaStreamTrack.enabled&&$._mediaStreamTrack.enabled?"0":"1",_t.inputLevel?_r.A_ail=Math.round(100*_t.inputLevel).toString():_r.A_ail=Math.round(100*$._source.getAccurateVolumeLevel()).toString(),_r.A_apil=Math.round(100*$._source.getAccurateVolumeLevel()).toString(),_t.aecReturnLoss&&(_r.A_ecrl=Math.round(_t.aecReturnLoss).toString()),_t.aecReturnLossEnhancement&&(_r.A_ecrle=Math.round(_t.aecReturnLossEnhancement).toString()),_r}(b[0].ssrcId,l,g);k&&Y_(()=>{var B;return(B=this.requestUpload)===null||B===void 0?void 0:B.call(this,c_.PUBLISH_STATS,{stream_type:"high",stats:k})});break}}const I=function(k){const B={id:"bweforvideo",timestamp:new Date(k.timestamp).toISOString(),type:"VideoBwe"};return k.bitrate.retransmit&&(B.A_rb=k.bitrate.retransmit.toString()),k.bitrate.targetEncoded&&(B.A_teb=k.bitrate.targetEncoded.toString()),B.A_aeb=k.bitrate.actualEncoded.toString(),B.A_tb=k.bitrate.transmit.toString(),k.sendBandwidth!==void 0&&(B.A_asb=k.sendBandwidth.toString()),B}(l);I&&Y_(()=>{var k;return(k=this.requestUpload)===null||k===void 0?void 0:k.call(this,c_.PUBLISH_STATS,{stream_type:y===Q0.LocalVideoLowTrack?"low":"high",stats:I})})})}uploadSlowUplinkStats(l){var d;(((d=this.requestLocalMedia)===null||d===void 0?void 0:d.call(this))||[]).filter(p=>{let[A]=p;return A===Q0.LocalVideoLowTrack||A===Q0.LocalVideoTrack}).forEach(p=>{let[A,{ssrcs:y}]=p;const g=TJ(y[0].ssrcId,l);g&&Y_(()=>{var b;return(b=this.requestUpload)===null||b===void 0?void 0:b.call(this,c_.PUBLISH_STATS,{stream_type:A===Q0.LocalVideoLowTrack?"low":"high",stats:g})})})}uploadRelatedUplinkStats(l,d){var p;(((p=this.requestLocalMedia)===null||p===void 0?void 0:p.call(this))||[]).filter(A=>{let[y]=A;return y===Q0.LocalVideoLowTrack||y===Q0.LocalVideoTrack}).forEach(A=>{let[y,{ssrcs:g}]=A;const b=function(I,k){const B=k.videoSend.find(q=>q.ssrc===I);return B?{mediaType:"video",isVideoMute:!1,frameRateInput:B.inputFrame&&B.inputFrame.frameRate.toString(),frameRateSent:B.sentFrame&&B.sentFrame.frameRate.toString(),googRtt:B.rttMs.toString(),qpSumPerFrame:Math.floor(B.qpSumPerFrame).toString()}:null}(g[0].ssrcId,l);b&&Y_(()=>{var I;(I=this.requestUpload)===null||I===void 0||I.call(this,c_.PUBLISH_RELATED_STATS,{stream_type:y===Q0.LocalVideoLowTrack?"low":"high",stats:b})})})}uploadDenoiserStats(l){for(let y=0;y<l.length;y++){const g=l[y];if(g instanceof MO){var d,p,A;const b=(d=(p=g._external).getDenoiserStats)===null||d===void 0?void 0:d.call(p);return void(b&&((A=this.requestUpload)===null||A===void 0||A.call(this,c_.DENOISER_STATS,b)))}}}uploadExtensionStats(l){for(let d=0;d<l.length;d++){const p=l[d];if(p instanceof MO)return void p.getProcessorStats().forEach(A=>{var y;A.type===c_.DENOISER_STATS&&((y=this.requestUpload)===null||y===void 0||y.call(this,c_.DENOISER_STATS,A.stats))})}}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&(this.uploadDownlinkStats(d,this.lastStats),this.lastStats=d)},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&this.uploadSlowDownlinkStats(d)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var l;const d=(l=this.requestStats)===null||l===void 0?void 0:l.call(this);d&&(this.uploadRelatedDownlinkStats(d,this.lastStats),this.lastStats=d)},1e3))}uploadDownlinkStats(l,d){var p;(((p=this.requestRemoteMedia)===null||p===void 0?void 0:p.call(this))||[]).forEach(A=>{let[y,g]=A;if(g.has(AI.VIDEO)&&y.videoTrack){const b=y.videoTrack?function(I,k,B){const q=k.videoRecv.find(_i=>_i.ssrc===I);if(!q)return null;const $={id:i1(10,""),timestamp:new Date(k.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:q.ssrc.toString()};var _t,_r;return $.bytesReceived=q.bytes.toString(),$.packetsLost=q.packetsLost.toString(),$.packetsReceived=q.packets.toString(),q.framesRateFirefox&&($.A_frr=q.framesRateFirefox.toString()),q.receivedFrame?($.A_frr=q.receivedFrame.frameRate.toString(),$.A_fhr=q.receivedFrame.height.toString(),$.A_fwr=q.receivedFrame.width.toString()):($.A_fhr=(_t=B._videoHeight)===null||_t===void 0?void 0:_t.toString(),$.A_fwr=(_r=B._videoWidth)===null||_r===void 0?void 0:_r.toString()),$.A_frd=q.decodeFrameRate.toString(),q.outputFrame&&($.A_fro=q.outputFrame.frameRate.toString()),q.jitterBufferMs!==void 0&&($.A_jbm=Math.floor(q.jitterBufferMs).toString()),q.currentDelayMs!==void 0&&($.A_cdm=Math.floor(q.currentDelayMs).toString()),$.A_fs=q.firsCount.toString(),$.A_ns=q.nacksCount.toString(),$.A_ps=q.plisCount.toString(),B&&($.A_vrtd=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?"0":"1"),B._player&&B._player.freezeTimeCounterList.length>0&&($.A_vrft=B._player.freezeTimeCounterList.splice(0,1)[0].toString()),$.A_rvps=Y4[B._player?B._player.videoElementStatus:"uninit"].toString(),$}(y._videoSSRC,l,y.videoTrack):void 0;b&&Y_(()=>{var I;return(I=this.requestUpload)===null||I===void 0?void 0:I.call(this,c_.SUBSCRIBE_STATS,{stream_id:y.uid,stats:b})})}if(g.has(AI.AUDIO)&&y.audioTrack){const b=y.audioTrack?function(I,k,B){const q=k.audioRecv.find(_t=>_t.ssrc===I);if(!q)return null;const $={id:i1(10,""),timestamp:new Date(k.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:q.ssrc.toString()};return $.bytesReceived=q.bytes.toString(),$.packetsLost=q.packetsLost.toString(),$.packetsReceived=q.packets.toString(),q.outputLevel?$.A_aol=Math.round(100*q.outputLevel).toString():$.A_aol=Math.round(100*B._source.getAccurateVolumeLevel()).toString(),$.A_apol=Math.round(100*B._source.getAccurateVolumeLevel()).toString(),B&&($.A_artd=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?"0":"1"),$.A_jr=q.jitterMs.toString(),$.A_jbm=Math.floor(q.jitterBufferMs).toString(),$.A_cdm=Math.floor(q.jitterBufferMs).toString(),$.A_raps=Y4[m_.getPlayerState(B.getTrackId())].toString(),$}(y._audioSSRC,l,y.audioTrack):void 0;b&&Y_(()=>{var I;return(I=this.requestUpload)===null||I===void 0?void 0:I.call(this,c_.SUBSCRIBE_STATS,{stream_id:y.uid,stats:b})})}})}uploadSlowDownlinkStats(l){}uploadRelatedDownlinkStats(l,d){var p;(((p=this.requestRemoteMedia)===null||p===void 0?void 0:p.call(this))||[]).forEach(A=>{let[y,g]=A;if(g.has(AI.VIDEO)&&y.videoTrack){var b;const I=(y._videoSSRC&&((b=this.requestVideoIsReady)===null||b===void 0?void 0:b.call(this,y._videoSSRC))||!1)===!0,k=function(B,q,$,_t,_r,_i){const ga=$.videoRecv.find(_A=>_A.ssrc===B),_u=_r?_r.videoRecv.find(_A=>_A.ssrc===B):void 0;if(!ga)return null;const ah=I2.isRemoteVideoFreeze(_i,ga,_u)&&q,_h={mediaType:"video",isVideoMute:!1,peerId:_t,frameRateReceived:ga.receivedFrame&&ga.receivedFrame.frameRate.toString(),frameRateDecoded:ga.decodedFrame&&ga.decodedFrame.frameRate.toString(),isFreeze:ah,bytesReceived:ga.bytes.toString(),packetsReceived:ga.packets.toString(),packetsLost:ga.packetsLost.toString(),qpSumPerFrame:Math.floor(ga.qpSumPerFrame).toString()};return ga.framesRateFirefox&&(_h.frameRateDecoded=ga.framesRateFirefox.toString(),_h.frameRateReceived=ga.framesRateFirefox.toString()),_h}(y._videoSSRC,I,l,y.uid,d,y.videoTrack);k&&Y_(()=>{var B;(B=this.requestUpload)===null||B===void 0||B.call(this,c_.SUBSCRIBE_RELATED_STATS,{stream_id:y.uid,stats:k})})}if(g.has(AI.AUDIO)&&y.audioTrack){const I=function(k,B,q,$){const _t=B.audioRecv.find(_i=>_i.ssrc===k);if(!_t)return null;const _r=I2.isRemoteAudioFreeze($);return{mediaType:"audio",isAudioMute:!1,peerId:q,googJitterReceived:_t.jitterMs.toString(),isFreeze:_r,bytesReceived:_t.bytes.toString(),packetsReceived:_t.packets.toString(),packetsLost:_t.packetsLost.toString(),frameReceived:_t.receivedFrames.toString(),frameDropped:_t.droppedFrames.toString()}}(y._audioSSRC,l,y.uid,y.audioTrack);I&&Y_(()=>{var k;(k=this.requestUpload)===null||k===void 0||k.call(this,c_.SUBSCRIBE_RELATED_STATS,{stream_id:y.uid,stats:I})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}}var V$,kI;function q$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function NR(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?q$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):q$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function H$(e){var l,d,p,A=2;for(typeof Symbol!="undefined"&&(d=S_t,p=Symbol.iterator);A--;){if(d&&(l=e[d])!=null)return l.call(e);if(p&&(l=e[p])!=null)return new u8(l.call(e));d="@@asyncIterator",p="@@iterator"}throw new TypeError("Object is not async iterable")}function u8(e){function l(d){if(Object(d)!==d)return Y0.reject(new TypeError(d+" is not an object."));var p=d.done;return Y0.resolve(d.value).then(function(A){return{value:A,done:p}})}return(u8=function(d){this.s=d,this.n=d.next}).prototype={s:null,n:null,next:function(){return l(this.n.apply(this.s,arguments))},return:function(d){var p=this.s.return;return p===void 0?Y0.resolve({value:d,done:!0}):l(p.apply(this.s,arguments))},throw:function(d){var p=this.s.return;return p===void 0?Y0.reject(d):l(p.apply(this.s,arguments))}},new u8(e)}let J_t=U1("P2PChannel","store.p2pId")((X0((kI=class extends e1{get state(){return this._state}set state(e){const l=this._state;this._state=e,this.emit(TI.StateChange,l,this._state)}constructor(e,l){super(),_s(this,"store",void 0),_s(this,"statsUploader",void 0),_s(this,"connection",void 0),_s(this,"localTrackMap",new Map),_s(this,"remoteUserMap",new Map),_s(this,"pendingLocalTracks",[]),_s(this,"pendingRemoteTracks",[]),_s(this,"statsCollector",void 0),_s(this,"isPlanB",!1),_s(this,"iceFailedCount",0),_s(this,"dtlsFailedCount",0),_s(this,"mutex",new g_("P2PChannel-mutex")),_s(this,"_state",S_.Disconnected),_s(this,"handleMuteLocalTrack",async(d,p,A)=>{const y=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection)return void A(new _E(_f.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));b0("debug",this,"handleMuteLocalTrack",d.getTrackId()),await this.waitTillConnected();const g=this.filterTobeMutedTracks(d);if(g.length===0)return void p();await this.connection.muteLocal(g.map(I=>{let[,{id:k}]=I;return k}));const b=this.createMuteMessage(g);await YI(this,TI.RequestMuteLocal,b),p()}catch(g){A(g)}finally{y()}}),_s(this,"handleUnmuteLocalTrack",async(d,p,A)=>{const y=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection)return void A(new _E(_f.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));b0("debug",this,"handleUnmuteLocalTrack",d.getTrackId()),await this.waitTillConnected();const g=this.filterTobeUnmutedTracks(d);if(g.length===0)return void p();await this.connection.unmuteLocal(g.map(I=>{let[,{id:k}]=I;return k}));const b=this.createUnmuteMessage(g);await YI(this,TI.RequestUnmuteLocal,b),p()}catch(g){A(g)}finally{y()}}),_s(this,"handleUpdateVideoEncoder",async(d,p,A)=>{const y=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const g=this.localTrackMap.get(Q0.LocalVideoTrack);if(!this.connection||!g||g.track!==d)return void p();await this.waitTillConnected();const{id:b,track:I}=g;await this.connection.updateSendParameters(b,I),await this.connection.updateEncoderConfig(b,I),this.emit(TI.UpdateVideoEncoder,I),p()}catch(g){A(g)}finally{y()}}),_s(this,"handleSetOptimizationMode",async(d,p,A)=>{const y=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const g=this.localTrackMap.get(Q0.LocalVideoTrack);if(!this.connection||!g||g.track!==d)return;await this.waitTillConnected();const{id:b,track:I}=g;await this.connection.updateSendParameters(b,I),p()}catch(g){A(g)}finally{y()}}),_s(this,"handleReplaceTrack",async(d,p,A,y)=>{let g;_a.debug("P2PChannel handleReplaceTrack for [track-id-".concat(d.getTrackId(),"]")),typeof y=="boolean"&&y||(g=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{const I=Array.from(this.localTrackMap.entries()).find(k=>{let[,{track:B}]=k;return d===B});if(!this.connection||!I)return void p();if(await this.waitTillConnected(),await this.connection.replaceTrack(d,I[1].id),this.isPlanB){const k=I[1];k.id=d._mediaStreamTrack.id,this.localTrackMap.set(I[0],k)}if(I[0]===Q0.LocalVideoTrack&&t_().supportDualStreamEncoding){const k=this.localTrackMap.get(Q0.LocalVideoLowTrack);if(k){const B=d._mediaStreamTrack.clone();k.track._originMediaStreamTrack.stop(),k.track._mediaStreamTrack=B,k.track._originMediaStreamTrack=B,await new Y0((q,$)=>{this.handleReplaceTrack(k.track,q,$,!0)})}}p()}catch(I){A(I)}finally{var b;(b=g)===null||b===void 0||b()}}),_s(this,"handleGetLocalVideoStats",d=>{d(this.statsCollector.getLocalVideoTrackStats())}),_s(this,"handleGetLocalAudioStats",d=>{d(this.statsCollector.getLocalAudioTrackStats())}),_s(this,"handleGetRemoteVideoStats",d=>this.statsCollector.getRemoteVideoTrackStats(d.uid)[d.uid]),_s(this,"handleGetRemoteAudioStats",d=>this.statsCollector.getRemoteAudioTrackStats(d.uid)[d.uid]),this.store=e,this.statsCollector=l,this.statsCollector.addP2PChannel(this),this.statsUploader=new W_t,this.bindStatsUploaderEvents(),this.isPlanB=!t_().supportUnifiedPlan||y0("CHROME_FORCE_PLAN_B")&&e2()}async startP2PConnection(e){return this.state=S_.New,this.connection=this.isPlanB?new q_t(e,this.store):new K_t(e,this.store),this.bindConnectionEvents(this.connection),this.store.peerConnectionStart(),this.connection.establish()}async connect(e,l,d,p,A,y){if(!this.connection)throw new _E(_f.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");await this.connection.connect(e,l,d,p,A,y),this.statsUploader.startUploadTransportStats(),this.state=S_.Connected}publish(e,l,d){var p=this;return nN(function*(){const A=yield o1(p.mutex.lock("From P2PChannel.publish"));try{if(!p.connection){if(p.state===S_.Disconnected)throw new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected.");p.throwIfTrackTypeNotMatch(e);const g=e.filter(b=>p.pendingLocalTracks.indexOf(b)===-1);return void(p.pendingLocalTracks=p.pendingLocalTracks.concat(g))}p.store.pubId=p.store.pubId+1,K_.markPublishStart(p.store.clientId,p.store.pubId),yield o1(p.waitTillConnected());const y=p.filterTobePublishedTracks(e,l,d);if(y.length===0)return void(yield o1(p.tryToUnmuteAudio(e)));yield*h$(H$(p.doPublish(p.connection,y)),o1)}finally{A()}})()}doPublish(e,l){var d=this;return nN(function*(){l.forEach(k=>{let{track:B,type:q}=k;const $=performance.now();d.store.publish(B.getTrackId(),q===Q0.LocalAudioTrack?"audio":"video",$)}),d.bindLocalTrackEvents(l);const p=yield o1(e.send(l.map(k=>{let{track:B}=k;return B}),d.store.codec,d.store.audioCodec)),A=(yield o1(p.next())).value,y=d.createGatewayPublishMessage(l,A);let g;try{g=yield y}catch(k){throw H0("error",d,"doPublish yield error: ".concat(k.toString())),p.throw(k),(k==null?void 0:k.code)===_f.WS_ABORT&&l.forEach(B=>{let{track:q}=B;d.pendingLocalTracks.indexOf(q)===-1&&d.pendingLocalTracks.push(q)}),d.unbindLocalTrackEvents(l),k}const b=d.mapPubResToRemoteConfig(y,g);b0("debug",d,"doPublish",{remoteConfigs:b,tracks:l.map(k=>{let{track:B}=k;return B.getTrackId()}),pubMsg:y,pubAns:g});const I=(yield o1(p.next(b))).value;l.forEach(k=>{let{type:B}=k;d.statsCollector.addLocalStats(B)}),d.assignLocalTracks(l,I),d.statsUploader.startUploadUplinkStats(),l.forEach(k=>{let{track:B,type:q}=k;const $=performance.now();d.store.publish(B.getTrackId(),q===Q0.LocalAudioTrack?"audio":"video",void 0,$)})})()}publishLowStream(e){var l=this;return nN(function*(){if(!l.connection)return;b0("debug",l,"publishLowStream",e);const d=yield o1(l.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const A=l.localTrackMap.get(Q0.LocalVideoTrack);if(!A)throw new _E(_f.UNEXPECTED_ERROR,"Could not find high stream");if(l.localTrackMap.has(Q0.LocalVideoLowTrack))throw new _E(_f.UNEXPECTED_ERROR,"[".concat(l.store.clientId,"] Can't publish low stream when stream already publish"));yield o1(l.waitTillConnected());const y=[{track:l.getLowVideoTrack(A.track,e),type:Q0.LocalVideoLowTrack}];if(yield*h$(H$(l.doPublish(l.connection,y)),o1),A.track.muted||!A.track.enabled){var p;const g=(p=l.localTrackMap.get(Q0.LocalVideoLowTrack))===null||p===void 0?void 0:p.id;g!==void 0&&(yield o1(l.connection.muteLocal([g])))}}finally{d()}})()}async republish(){this.pendingLocalTracks.length>0&&(_a.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),b0("debug",this,"republish",this.pendingLocalTracks.map(e=>e.getTrackId())),await O_(this,TI.RequestRePublish,this.pendingLocalTracks),this.emit(TI.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(e){b0("debug",this,"reSubscribe",this.pendingRemoteTracks.map(l=>{let{user:d}=l;return d.uid}));for(let l=this.pendingRemoteTracks.length-1;l>=0;l--){const{user:d,kind:p}=this.pendingRemoteTracks[l];(p!==AI.AUDIO||d._audio_added_&&d._audioSSRC)&&(p!==AI.VIDEO||d._video_added_&&d._videoSSRC)||this.pendingRemoteTracks.splice(l,1)}if(e)await O_(this,TI.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:l,kind:d}of this.pendingRemoteTracks)await this.subscribe(l,d,d===AI.VIDEO?l._videoSSRC:l._audioSSRC);this.pendingRemoteTracks.forEach(l=>{let{user:d}=l;this.emit(TI.MediaReconnectEnd,d.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection)return void e.forEach(d=>{const p=this.pendingLocalTracks.indexOf(d);p!==-1&&this.pendingLocalTracks.splice(p,1)});await this.waitTillConnected();const l=this.filterTobeUnpublishedTracks(e);return l.length!==0?(b0("debug",this,"unpublish"),this.doUnpublish(this.connection,l)):void 0}async unpublishLowStream(){if(!this.connection)return;b0("debug",this,"unpublishLowStream");const e=this.localTrackMap.get(Q0.LocalVideoLowTrack);if(!e)return;await this.waitTillConnected();const l=[[Q0.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,l)}async doUnpublish(e,l){const d=this.createGatewayUnpublishMessage(l);return await e.stopSending(l.map(p=>{let[,{id:A}]=p;return A})),this.withdrawLocalTracks(l),this.unbindLocalTrackEvents(l.map(p=>{let[A,{track:y}]=p;return{type:A,track:y}})),l.forEach(p=>{let[A]=p;this.statsCollector.removeLocalStats(A)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),d}async subscribe(e,l,d,p,A){var y;if(!this.connection)throw new _E(_f.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(b0("debug",this,"subscribe",{uid:e.uid,mediaType:l,ssrcId:d}),(y=this.remoteUserMap.get(e))!==null&&y!==void 0&&y.has(l))return;let g,b;if(await this.waitTillConnected(),A){const B=A.find($=>{let{stream_type:_t}=$;return _t===l});if(!B)throw new _E(_f.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(l," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(l,"."));const q=await this.connection.receive(l,B.ssrcs,String(e.uid),B.attributes);g=q.track,b=q.id}else{const B=await this.connection.receive(l,[{ssrcId:d,rtx:p}],String(e.uid),void 0);g=B.track,b=B.id}l===AI.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(g):(e._audioTrack=new t3(g,e.uid,e._uintid,this.store),_a.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(g):(e._videoTrack=new _B(g,e.uid,e._uintid,this.store),_a.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._videoTrack));const I=this.remoteUserMap.get(e);I?I.set(l,b):this.remoteUserMap.set(e,new Map([[l,b]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadDownlinkStats();const k=this.pendingRemoteTracks.findIndex(B=>{let{user:q,kind:$}=B;return q.uid===e.uid&&l===$});k!==-1&&(this.pendingRemoteTracks.splice(k,1),this.emit(TI.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection)throw new _E(_f.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");b0("debug",this,"subscribeAll",e.map(d=>{let{user:p,mediaType:A,ssrcId:y}=d;return{uid:p.uid,mediaType:A,ssrcId:y}})),e=e.filter(d=>{var p;let{user:A,mediaType:y}=d;return!((p=this.remoteUserMap.get(A))!==null&&p!==void 0&&p.has(y))}),await this.waitTillConnected();const l=await this.connection.batchReceive(e.map(d=>{let{user:p,mediaType:A,ssrcId:y,rtxSsrcId:g}=d;return{kind:A,ssrcMsg:[{ssrcId:y,rtx:g}],mslabel:String(p.uid)}}));e.forEach((d,p)=>{let{user:A,mediaType:y}=d;const{track:g,id:b}=l[p];y===AI.AUDIO?(A._audioTrack?A._audioTrack._updateOriginMediaStreamTrack(g):(A._audioTrack=new t3(g,A.uid,A._uintid,this.store),_a.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(A._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(A,A._audioTrack)):(A._videoTrack?A._videoTrack._updateOriginMediaStreamTrack(g):(A._videoTrack=new _B(g,A.uid,A._uintid,this.store),_a.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(A._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(A,A._videoTrack));const I=this.remoteUserMap.get(A);I?I.set(y,b):this.remoteUserMap.set(A,new Map([[y,b]])),this.statsCollector.addRemoteStats(A.uid),this.statsUploader.startUploadDownlinkStats();const k=this.pendingRemoteTracks.findIndex(B=>{let{user:q,kind:$}=B;return q.uid===A.uid&&y===$});k!==-1&&(this.pendingRemoteTracks.splice(k,1),this.emit(TI.MediaReconnectEnd,A.uid))})}async unsubscribe(e,l){const d=this.pendingRemoteTracks.filter(y=>{let{user:g,kind:b}=y;return l!==void 0?g.uid===e.uid&&l===b:g.uid===e.uid});if(d.forEach(y=>{const g=this.pendingRemoteTracks.indexOf(y);this.pendingRemoteTracks.splice(g,1)}),!this.connection)return void d.forEach(y=>{let{kind:g}=y;var b;if(g===AI.AUDIO)(b=e._audioTrack)===null||b===void 0||b._destroy(),e._audioTrack=void 0;else if(g===AI.VIDEO){var I;(I=e._videoTrack)===null||I===void 0||I._destroy(),e._videoTrack=void 0}});b0("debug",this,"unsubscribe",{uid:e.uid,mediaType:l});const p=this.filterTobeUnSubscribedTracks(e,l);if(p.length===0)return;await this.connection.stopReceiving(p.map(y=>{let[,{id:g}]=y;return g}));const A=this.createUnsubscribeMessage(p);return this.withdrawRemoteTracks(p),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),p.forEach(y=>{let[g,{kind:b}]=y;var I,k;if(b===AI.VIDEO&&g._videoSSRC&&((I=this.connection)===null||I===void 0||I.setStatsRemoteVideoIsReady(g._videoSSRC,!1)),b===AI.VIDEO)this.unbindRemoteTrackEvents(g._videoTrack),(k=g._videoTrack)===null||k===void 0||k._destroy(),g._videoTrack=void 0;else if(b===AI.AUDIO){var B;this.unbindRemoteTrackEvents(g._audioTrack),(B=g._audioTrack)===null||B===void 0||B._destroy(),g._audioTrack=void 0}}),A}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let l=[];for(const{user:A,mediaType:y}of e){const g=this.pendingRemoteTracks.filter(b=>{let{user:I,kind:k}=b;return y!==void 0?I.uid===A.uid&&y===k:I.uid===A.uid});g.forEach(b=>{const I=this.pendingRemoteTracks.indexOf(b);this.pendingRemoteTracks.splice(I,1)}),l=l.concat(g)}if(!this.connection)return void l.forEach(A=>{let{user:y,kind:g}=A;var b;if(g===AI.AUDIO)(b=y._audioTrack)===null||b===void 0||b._destroy(),y._audioTrack=void 0;else if(g===AI.VIDEO){var I;(I=y._videoTrack)===null||I===void 0||I._destroy(),y._videoTrack=void 0}});b0("debug",this,"batchUnsubscribe",e.map(A=>{let{user:y,mediaType:g}=A;return{uid:y.uid,mediaType:g}}));const d=VR(e).call(e,(A,y)=>{let{user:g,mediaType:b}=y;const I=this.filterTobeUnSubscribedTracks(g,b);return A.concat(I)},[]);if(d.length===0)return;await this.connection.stopReceiving(d.map(A=>{let[,{id:y}]=A;return y}));const p=this.createUnsubscribeAllMessage(d);return this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),d.forEach(A=>{let[y,{kind:g}]=A;var b,I;if(g===AI.VIDEO&&y._videoSSRC&&((b=this.connection)===null||b===void 0||b.setStatsRemoteVideoIsReady(y._videoSSRC,!1)),g===AI.VIDEO)this.unbindRemoteTrackEvents(y._videoTrack),(I=y._videoTrack)===null||I===void 0||I._destroy(),y._videoTrack=void 0;else if(g===AI.AUDIO){var k;this.unbindRemoteTrackEvents(y._audioTrack),(k=y._audioTrack)===null||k===void 0||k._destroy(),y._audioTrack=void 0}}),p}async muteRemote(e,l){if(!this.connection)return;b0("debug",this,"muteRemote",{uid:e.uid,kind:l});const d=this.remoteUserMap.get(e);if(!d)return _a.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid,".")),void H0("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid,"."));if(!d.get(l))return _a.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(l,".")),void H0("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(l,"."));const p=l===AI.VIDEO?e._videoSSRC:e._audioSSRC;p!==void 0&&this.connection.setStatsRemoteVideoIsReady(p,!1)}async unmuteRemote(e,l){return this.unmuteRemoteNoLock(e,l)}async unmuteRemoteNoLock(e,l){if(!this.connection)return;b0("debug",this,"unmuteRemote",{uid:e.uid,kind:l});const d=this.remoteUserMap.get(e);return d?d.get(l)?void 0:(_a.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid," media type ").concat(l,".")),void H0("warning",this,"unmuteRemote has no remote user ".concat(e.uid," media type ").concat(l))):(_a.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid,".")),void H0("warning",this,"unmuteRemote has no remote user ".concat(e.uid)))}getAllTracks(e){const l=this.localTrackMap.get(Q0.LocalAudioTrack);if((l==null?void 0:l.track)instanceof H_){const d=l.track;return Array.from(this.localTrackMap.entries()).filter(p=>{let[A]=p;return A!==Q0.LocalAudioTrack}).filter(p=>{let[A]=p;return!(e&&A===Q0.LocalVideoLowTrack)}).map(p=>{let[,{track:A}]=p;return A}).concat(d.trackList)}return Array.from(this.localTrackMap.entries()).filter(d=>{let[p]=d;return!(e&&p===Q0.LocalVideoLowTrack)}).map(d=>{let[,{track:p}]=d;return p})}reportPublishEvent(e,l,d,p,A){if(e){const g=this.localTrackMap.get(Q0.LocalAudioTrack),b=p?this.localTrackMap.get(Q0.LocalVideoLowTrack):this.localTrackMap.get(Q0.LocalVideoTrack);_0.publish(this.store.sessionId,{eventElapse:K_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:l,audioName:g==null?void 0:g.track.getTrackLabel(),videoName:b==null?void 0:b.track.getTrackLabel(),screenshare:(b==null?void 0:b.track._hints.indexOf(F1.SCREEN_TRACK))!==-1,audio:!!g,video:!!b,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:A})}else{var y;d||(d=[]);const g=d.find(I=>I instanceof D1),b=p?(y=this.localTrackMap.get(Q0.LocalVideoTrack))===null||y===void 0?void 0:y.track:d.find(I=>I instanceof A1);_0.publish(this.store.sessionId,{eventElapse:K_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:l,audioName:g==null?void 0:g.getTrackLabel(),videoName:b==null?void 0:b.getTrackLabel(),screenshare:(b==null?void 0:b._hints.indexOf(F1.SCREEN_TRACK))!==-1,audio:!!g,video:!!b,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:A})}}reportSubscribeEvent(e,l,d,p){const A=p===AI.VIDEO?d._videoSSRC:d._audioSSRC;A&&_0.subscribe(this.store.sessionId,{succ:e,ec:l,video:p===AI.VIDEO,audio:p===AI.AUDIO,peerid:d.uid,subscribeRequestid:p===AI.VIDEO?d._videoSSRC:d._audioSSRC,p2pid:this.store.p2pId,eventElapse:K_.measureFromSubscribeStart(this.store.clientId,A)})}reset(){_a.debug("P2PChannel.reset"),this.mutex=new g_("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=S_.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var l;return((l=this.connection)===null||l===void 0?void 0:l.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Q0.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Q0.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const l=this.localTrackMap.get(e);return l&&l.track instanceof A1||l&&l.track instanceof D1?l.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,l){if(!e)return this.remoteUserMap.size>0;const d=this.remoteUserMap.get(e);return!!d&&(!l||d.has(l))}async hasRemoteMediaWithLock(e,l){if(!e)return this.remoteUserMap.size>0;const d=this.remoteUserMap.get(e);return!!d&&(!l||d.has(l))}getRemoteMedia(e){var l;const d=Array.from(cT(l=this.remoteUserMap).call(l)).find(p=>p.uid===e);return d?{audioTrack:d.audioTrack,audioSSRC:d._audioSSRC,videoTrack:d.videoTrack,videoSSRC:d._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(d=>{let[p]=d;return{uid:p.uid,level:p.audioTrack?100*p.audioTrack._source.getAccurateVolumeLevel():0}});const l=this.localTrackMap.get(Q0.LocalAudioTrack);return l&&e.push({level:100*l.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=q4(e).call(e,(d,p)=>d.level-p.level),e}async disconnectForReconnect(){this.connection&&(b0("debug",this,"disconnectForReconnect"),_a.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),this.state=S_.Reconnecting,this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{let[l,{track:d}]=e;switch(l){case Q0.LocalVideoTrack:d._hints.includes(F1.LOW_STREAM)?d.close():this.pendingLocalTracks.push(d);break;case Q0.LocalAudioTrack:d instanceof H_?this.pendingLocalTracks=this.pendingLocalTracks.concat(d.trackList):this.pendingLocalTracks.push(d);break;case Q0.LocalVideoLowTrack:}}),this.emit(TI.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[l,d]=e;Array.from(cT(d).call(d)).forEach(p=>{this.setPendingRemoteMedia(l,p)}),this.emit(TI.MediaReconnectStart,l.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),_a.debug("P2PChannel disconnected, waiting to reconnect."))}hasPendingRemoteMedia(e,l){for(const d of this.pendingRemoteTracks){const{user:p,kind:A}=d;if((e instanceof j6?e.uid:e)===p.uid&&l===A)return!0}return!1}setPendingRemoteMedia(e,l){this.hasPendingRemoteMedia(e,l)||this.pendingRemoteTracks.push({user:e,kind:l})}async reEstablish(){if(this.connection)return this.connection.reEstablish()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),l=this.localTrackMap.get(Q0.LocalVideoTrack),d=this.localTrackMap.get(Q0.LocalAudioTrack),p=e.videoSend.find(_t=>_t.ssrc===(l==null?void 0:l.ssrcs[0].ssrcId)),A=e.audioSend.find(_t=>_t.ssrc===(d==null?void 0:d.ssrcs[0].ssrcId));if(!p||!A)return 1;const y=pT(this,TI.NeedSignalRTT),g=p?p.rttMs:void 0,b=A?A.rttMs:void 0,I=g&&b?(g+b)/2:g||b,k=(I&&y?(I+y)/2:I||y)||0,B=100*e.sendPacketLossRate*.7/50+.3*k/1500,q=B<.17?1:B<.36?2:B<.59?3:B<.1?4:5,$=l==null?void 0:l.track;if($&&$._encoderConfig&&$._hints.indexOf(F1.SCREEN_TRACK)===-1){const _t=$._encoderConfig.bitrateMax,_r=e.bitrate.actualEncoded;if(_t&&_r){const _i=(1e3*_t-_r)/(1e3*_t);return HAt[_i<.15?0:_i<.3?1:_i<.45?2:_i<.6?3:4][q]}}return q}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let l=0;return Array.from(this.remoteUserMap.entries()).forEach(d=>{let[p]=d;const A=p._audioSSRC,y=p._videoSSRC,g=e.audioRecv.find(_r=>_r.ssrc===A),b=e.videoRecv.find(_r=>_r.ssrc===y);if(!g&&!b)return void(l+=1);const I=pT(this,TI.NeedSignalRTT),k=e.rtt,B=(k&&I?(k+I)/2:k||I)||0,q=g?g.jitterMs:void 0,$=e.recvPacketLossRate;let _t=.7*$*100/50+.3*B/1500;q&&(_t=.6*$*100/50+.2*B/1500+.2*q/400),l+=_t<.1?1:_t<.17?2:_t<.36?3:_t<.59?4:5}),this.remoteUserMap.size>0?Math.round(l/this.remoteUserMap.size):l}async muteLocalTrack(e){return new Y0((l,d)=>{this.handleMuteLocalTrack(e,l,d)})}filterTobePublishedTracks(e,l,d){const p=[],A=t_(),y=this.getAllTracks();e=DJ(e=e.filter(I=>y.indexOf(I)===-1));let g=!1,b=!1;for(const I of e){if(I instanceof A1&&(this.localTrackMap.has(Q0.LocalVideoTrack)||g?new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(p.push({track:I,type:Q0.LocalVideoTrack}),g=!0),l)){const k=this.getLowVideoTrack(I,d);p.push({track:k,type:Q0.LocalVideoLowTrack})}if(I instanceof D1){const k=this.localTrackMap.get(Q0.LocalAudioTrack);if(k){if(!(k.track instanceof H_))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(I._bypassWebAudio)throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");k.track.addAudioTrack(I),this.bindLocalAudioTrackEvents(I,!0)}else if(b){const B=p.find(q=>{let{type:$}=q;return $===Q0.LocalAudioTrack});if(!(B.track instanceof H_))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(I._bypassWebAudio)throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");B.track.addAudioTrack(I)}else{if(!A.webAudioMediaStreamDest||I instanceof H_||I._bypassWebAudio)p.push({track:I,type:Q0.LocalAudioTrack});else{const B=new H_;B.addAudioTrack(I),p.push({track:B,type:Q0.LocalAudioTrack})}b=!0}}}return p}filterTobeUnpublishedTracks(e){const l=[],d=this.getAllTracks();e=DJ(e=e.filter(p=>d.indexOf(p)!==-1));for(const p of e){if(p instanceof D1){const A=this.localTrackMap.get(Q0.LocalAudioTrack);if(!A)continue;A.track instanceof H_?(A.track.removeAudioTrack(p),this.unbindLocalAudioTrackEvents(p),A.track.trackList.length===0&&(l.push([Q0.LocalAudioTrack,A]),A.track.close())):l.push([Q0.LocalAudioTrack,A])}if(p instanceof A1){const A=this.localTrackMap.get(Q0.LocalVideoTrack);if(!A)continue;l.push([Q0.LocalVideoTrack,A]);const y=this.localTrackMap.get(Q0.LocalVideoLowTrack);y&&l.push([Q0.LocalVideoLowTrack,y])}}return l}bindLocalTrackEvents(e){e.forEach(l=>{let{track:d,type:p}=l;switch(p){case Q0.LocalVideoTrack:d.addListener(tI.GET_STATS,this.handleGetLocalVideoStats),d.addListener(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),d.addListener(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),d.addListener(tI.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),d.addListener(tI.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),d.addListener(tI.NEED_REPLACE_TRACK,this.handleReplaceTrack),d.addListener(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),d.addListener(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Q0.LocalAudioTrack:this.bindLocalAudioTrackEvents(d);break;case Q0.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,l){e instanceof H_?e.trackList.forEach(d=>{d.addListener(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),d.addListener(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),d.addListener(tI.GET_STATS,this.handleGetLocalAudioStats),d.addListener(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),d.addListener(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(tI.GET_STATS,this.handleGetLocalAudioStats),e.addListener(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),l||e.addListener(tI.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(l=>{let[d,{track:p}]=l;return{track:p,type:d}})),e.forEach(l=>{let{track:d,type:p}=l;switch(p){case Q0.LocalVideoTrack:d.off(tI.GET_STATS,this.handleGetLocalVideoStats),d.off(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),d.off(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),d.off(tI.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),d.off(tI.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),d.off(tI.NEED_REPLACE_TRACK,this.handleReplaceTrack),d.off(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),d.off(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Q0.LocalAudioTrack:this.unbindLocalAudioTrackEvents(d);break;case Q0.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof H_?e.trackList.forEach(l=>{l.off(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),l.off(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),l.off(tI.GET_STATS,this.handleGetLocalAudioStats),l.off(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),l.off(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(tI.GET_STATS,this.handleGetLocalAudioStats),e.off(tI.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(tI.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(tI.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(tI.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(tI.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,l){l instanceof _B&&l.addListener(tI.GET_STATS,d=>{d(this.handleGetRemoteVideoStats(e))}),l instanceof t3&&l.addListener(tI.GET_STATS,d=>{d(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(tI.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[l,d]=e;d.has(AI.AUDIO)&&this.unbindRemoteTrackEvents(l._audioTrack),d.has(AI.VIDEO)&&this.unbindRemoteTrackEvents(l._videoTrack)})}createGatewayPublishMessage(e,l){return e.map((d,p)=>{let A,y,{track:g,type:b}=d;switch(b){case Q0.LocalAudioTrack:A=r1.Audio,y={dtx:g instanceof MO&&g._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Q0.LocalVideoTrack:A=g._hints.includes(F1.SCREEN_TRACK)?r1.Screen:r1.High,y=NR(NR({},RJ(g)),{},{codec:this.store.codec});break;case Q0.LocalVideoLowTrack:A=r1.Low,y=NR(NR({},RJ(g)),{},{codec:this.store.codec})}return{stream_type:A,attributes:y,ssrcs:l[p]}})}createGatewayUnpublishMessage(e){return e.map(l=>{let d,[p,{track:A,ssrcs:y,id:g}]=l;switch(p){case Q0.LocalVideoTrack:d=A._hints.includes(F1.SCREEN_TRACK)?r1.Screen:r1.High;break;case Q0.LocalAudioTrack:d=r1.Audio;break;case Q0.LocalVideoLowTrack:d=r1.Low}return{stream_type:d,ssrcs:y,mid:g}})}assignLocalTracks(e,l){e.forEach((d,p)=>{let{track:A,type:y}=d;this.localTrackMap.set(y,{track:A,id:l[p].id,ssrcs:l[p].localSSRC})})}withdrawLocalTracks(e){e.forEach(l=>{let[d]=l;this.localTrackMap.delete(d)})}async waitTillConnected(){return new Y0((e,l)=>{switch(this.state){case S_.New:case S_.Reconnecting:{const d=(p,A)=>A===S_.Disconnected?(this.off(TI.StateChange,d),void l(new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):A===S_.Connected?(this.off(TI.StateChange,d),void e(void 0)):void 0;this.on(TI.StateChange,d);break}case S_.Connected:e(void 0);break;case S_.Disconnected:l(new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}})}bindConnectionEvents(e){e.onConnectionStateChange=async l=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(l,")")),VI("info",this,"connectionStateChange",l),this.emit(TI.PeerConnectionStateChange,l),l!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),l==="failed"&&(e.iceConnectionState==="failed"?(setTimeout(()=>this.emit(TI.P2PLost),0),this.iceFailedCount+=1,await Q1(O4(this.iceFailedCount,a1)),this.emit(TI.RequestRestartICE)):await this.requestReconnect())},e.onICEConnectionStateChange=l=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(l,")")),VI("info",this,"iceConnectionStateChange",l),_0.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:l,tag:z0.TRACER}).onSuccess(),this.emit(TI.IceConnectionStateChange,l)},e.onICETransportStateChange=l=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(l,")")),VI("info",this,"ICETransportStateChange",l)},e.onDTLSTransportStateChange=l=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(l,")")),VI("info",this,"DTLSTransportStateChange",l)},e.onDTLSTransportError=l=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(l,")")),VI("info",this,"DTLSTransportError",l)},e.onFirstAudioDecoded=l=>{var d;const p=Array.from(cT(d=this.remoteUserMap).call(d)).find(y=>y._audioSSRC===l);var A;p&&((A=p.audioTrack)===null||A===void 0||A.emit(l2.FIRST_FRAME_DECODED),_0.firstRemoteFrame(this.store.sessionId,N1.FIRST_AUDIO_DECODE,WI.FIRST_AUDIO_DECODE,{peer:p._uintid,subscribeElapse:K_.measureFromSubscribeStart(this.store.clientId,l),subscribeRequestid:l,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=l=>{var d;const p=Array.from(cT(d=this.remoteUserMap).call(d)).find(A=>A._audioSSRC===l);p&&_0.firstRemoteFrame(this.store.sessionId,N1.FIRST_AUDIO_RECEIVED,WI.FIRST_AUDIO_RECEIVED,{peer:p._uintid,subscribeElapse:K_.measureFromSubscribeStart(this.store.clientId,l),subscribeRequestid:l,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(l,d,p)=>{var A;const y=Array.from(cT(A=this.remoteUserMap).call(A)).find(g=>g._videoSSRC===l);y&&_0.firstRemoteFrame(this.store.sessionId,N1.FIRST_VIDEO_DECODE,WI.FIRST_VIDEO_DECODE,{peer:y._uintid,videowidth:d,videoheight:p,subscribeElapse:K_.measureFromSubscribeStart(this.store.clientId,l),subscribeRequestid:l,p2pid:this.store.p2pId})},e.onFirstVideoReceived=l=>{var d;const p=Array.from(cT(d=this.remoteUserMap).call(d)).find(A=>A._videoSSRC===l);p&&_0.firstRemoteFrame(this.store.sessionId,N1.FIRST_VIDEO_RECEIVED,WI.FIRST_VIDEO_RECEIVED,{peer:p._uintid,subscribeElapse:K_.measureFromSubscribeStart(this.store.clientId,l),subscribeRequestid:l,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(l,d)=>{const p=l.candidateType==="relay",A=d.candidateType==="relay";d.candidateType!=="unknown"&&p===A||this.emit(TI.ConnectionTypeChange,p),_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(SR(d))," -> ").concat(JSON.stringify(SR(l)),")")),VI("info",this,"SelectedLocalCandidateChanged","".concat(JSON.stringify(SR(d))," -> ").concat(JSON.stringify(SR(l))))},e.onSelectedRemoteCandidateChanged=(l,d)=>{_a.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(SR(d))," -> ").concat(JSON.stringify(SR(l)),")")),VI("info",this,"SelectedRemoteCandidateChanged","".concat(JSON.stringify(SR(d))," -> ").concat(JSON.stringify(SR(l))))}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0}filterTobeMutedTracks(e){const l=[];if(this.getAllTracks().indexOf(e)===-1)return l;const d=this.localTrackMap.get(Q0.LocalAudioTrack);if(e instanceof D1&&(d==null?void 0:d.track)instanceof H_)return d.track.isActive||l.push([Q0.LocalAudioTrack,d]),l;const p=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:y}]=A;return e===y});if(p&&(l.push(p),p[0]===Q0.LocalVideoTrack)){const A=this.localTrackMap.get(Q0.LocalVideoLowTrack);A&&l.push([Q0.LocalVideoLowTrack,A])}return l}filterTobeUnmutedTracks(e){const l=[],d=this.localTrackMap.get(Q0.LocalAudioTrack);if(e instanceof D1&&(d==null?void 0:d.track)instanceof H_)return d.track.isActive&&l.push([Q0.LocalAudioTrack,d]),l;const p=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:y}]=A;return e===y});if(p)if(p[0]===Q0.LocalVideoTrack){l.push(p);const A=this.localTrackMap.get(Q0.LocalVideoLowTrack);A&&l.push([Q0.LocalVideoLowTrack,A])}else l.push(p);return l}createMuteMessage(e){return e.map(l=>{let d,[p,{track:A,ssrcs:y,id:g}]=l;switch(p){case Q0.LocalAudioTrack:d=r1.Audio;break;case Q0.LocalVideoTrack:d=A._hints.includes(F1.SCREEN_TRACK)?r1.Screen:r1.High;break;case Q0.LocalVideoLowTrack:d=r1.Low}return{stream_type:d,ssrcs:y,mid:g}})}createUnmuteMessage(e){return e.map(l=>{let d,[p,{track:A,ssrcs:y,id:g}]=l;switch(p){case Q0.LocalAudioTrack:d=r1.Audio;break;case Q0.LocalVideoTrack:d=A._hints.includes(F1.SCREEN_TRACK)?r1.Screen:r1.High;break;case Q0.LocalVideoLowTrack:d=r1.Low}return{stream_type:d,ssrcs:y,mid:g}})}filterTobeUnSubscribedTracks(e,l){const d=[],p=this.remoteUserMap.get(e);if(!p)return d;if(l){const A=p.get(l);if(!A)return d;d.push([e,{kind:l,id:A}])}else Array.from(p.entries()).forEach(A=>{let[y,g]=A;d.push([e,{kind:y,id:g}])});return d}createUnsubscribeMessage(e){const l=[];return e.forEach(d=>{let[p,{kind:A,id:y}]=d;switch(A){case AI.VIDEO:return void(p._videoSSRC&&l.push({stream_type:AI.VIDEO,ssrcId:p._videoSSRC}));case AI.AUDIO:return void(p._audioSSRC&&l.push({stream_type:AI.AUDIO,ssrcId:p._audioSSRC}))}}),l}createUnsubscribeAllMessage(e){const l=new Map;return e.forEach(d=>{let[p,{kind:A}]=d;if(l.has(p)){let y=l.get(p);A===AI.VIDEO?y|=XI.Video:y|=XI.Audio,l.set(p,y)}else A===AI.VIDEO?l.set(p,XI.Video):l.set(p,XI.Audio)}),{users:Array.from(l.entries()).map(d=>{let[p,A]=d;return{stream_id:p.uid,stream_type:A}})}}withdrawRemoteTracks(e){e.forEach(l=>{let[d,{kind:p}]=l;const A=this.remoteUserMap.get(d);A&&(A.delete(p),Array.from(A.entries()).length===0&&this.remoteUserMap.delete(d))})}async updateBitrateLimit(e){const l=this.localTrackMap.get(Q0.LocalVideoTrack),d=this.localTrackMap.get(Q0.LocalVideoLowTrack);l&&await l.track.setBitrateLimit(e.uplink),d&&e.low_stream_uplink&&await d.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,l){return e.map((d,p)=>{var A;let{stream_type:y}=d;return(A=l.find(g=>{let{stream_type:b}=g;return y===b}))===null||A===void 0?void 0:A.attributes})}async tryToUnmuteAudio(e){for(let d=0;d<e.length;d++)if(e[d]instanceof D1){var l;const p=this.filterTobeUnmutedTracks(e[d]);if(p.length===0)continue;await((l=this.connection)===null||l===void 0?void 0:l.unmuteLocal(p.map(y=>{let[,{id:g}]=y;return g})));const A=this.createUnmuteMessage(p);return void await YI(this,TI.RequestUnmuteLocal,A)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var l;return!((l=this.connection)===null||l===void 0||!l.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,l)=>this.emit(TI.RequestUploadStats,e,l),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Q1(O4(this.dtlsFailedCount,a1)),this.emit(TI.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),l=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),l.length>0&&await O_(this,TI.RequestUnpublishForReconnectPC,l),this.disconnectForReconnect(),this.emit(TI.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Q0.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof A1)}throwIfTrackTypeNotMatch(e){if(e.filter(l=>l instanceof A1).length>1)throw new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(l=>l instanceof D1).length>1&&(e.some(l=>l instanceof D1&&l._bypassWebAudio)||!t_().webAudioMediaStreamDest))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const l of e){if(l instanceof A1&&this.pendingLocalTracks.some(d=>d instanceof A1))throw new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(l instanceof D1&&this.pendingLocalTracks.some(d=>d instanceof D1)&&(!t_().webAudioMediaStreamDest||l._bypassWebAudio||this.pendingLocalTracks.some(d=>d instanceof D1&&d._bypassWebAudio)))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,l){const d=t_().supportDualStreamEncoding,p=NR(NR({},{width:160,height:120,framerate:15,bitrate:50}),l);let A;A=d?e._mediaStreamTrack.clone():Y_t(e,p);const y=new A1(A,NR(NR({},d&&{scaleResolutionDownBy:p0t(p,e)}),{},{frameRate:p.framerate,bitrateMax:p.bitrate,bitrateMin:p.bitrate}));return y._hints.push(F1.LOW_STREAM),y}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}}).prototype,"startP2PConnection",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"startP2PConnection"),kI.prototype),X0(kI.prototype,"connect",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"connect"),kI.prototype),X0(kI.prototype,"unpublish",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"unpublish"),kI.prototype),X0(kI.prototype,"unpublishLowStream",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"unpublishLowStream"),kI.prototype),X0(kI.prototype,"subscribe",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"subscribe"),kI.prototype),X0(kI.prototype,"massSubscribe",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"massSubscribe"),kI.prototype),X0(kI.prototype,"unsubscribe",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"unsubscribe"),kI.prototype),X0(kI.prototype,"massUnsubscribe",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"massUnsubscribe"),kI.prototype),X0(kI.prototype,"muteRemote",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"muteRemote"),kI.prototype),X0(kI.prototype,"unmuteRemote",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"unmuteRemote"),kI.prototype),X0(kI.prototype,"hasRemoteMediaWithLock",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"hasRemoteMediaWithLock"),kI.prototype),X0(kI.prototype,"disconnectForReconnect",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"disconnectForReconnect"),kI.prototype),X0(kI.prototype,"reEstablish",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"reEstablish"),kI.prototype),X0(kI.prototype,"updateBitrateLimit",[L_],Object.getOwnPropertyDescriptor(kI.prototype,"updateBitrateLimit"),kI.prototype),V$=kI))||V$;function L_(e,l,d){const p=e[l];if(typeof p!="function")throw new Error("Cannot use mutex on object property.");return d.value=async function(){const A=this.mutex,y=await A.lock("From P2PChannel.".concat(l));try{for(var g=arguments.length,b=new Array(g),I=0;I<g;I++)b[I]=arguments[I];return await p.apply(this,b)}finally{y()}},d}function sS(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var wI,K$=typeof Symbol=="function"&&Symbol.observable||"@@observable",l8=function(){return Math.random().toString(36).substring(7).split("").join(".")},Y$={INIT:"@@redux/INIT"+l8(),REPLACE:"@@redux/REPLACE"+l8(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l8()}};function z_t(e){if(typeof e!="object"||e===null)return!1;for(var l=e;Object.getPrototypeOf(l)!==null;)l=Object.getPrototypeOf(l);return Object.getPrototypeOf(e)===l}function W$(e,l,d){var p;if(typeof l=="function"&&typeof d=="function"||typeof d=="function"&&typeof arguments[3]=="function")throw new Error(sS(0));if(typeof l=="function"&&d===void 0&&(d=l,l=void 0),d!==void 0){if(typeof d!="function")throw new Error(sS(1));return d(W$)(e,l)}if(typeof e!="function")throw new Error(sS(2));var A=e,y=l,g=[],b=g,I=!1;function k(){b===g&&(b=g.slice())}function B(){if(I)throw new Error(sS(3));return y}function q(_i){if(typeof _i!="function")throw new Error(sS(4));if(I)throw new Error(sS(5));var ga=!0;return k(),b.push(_i),function(){if(ga){if(I)throw new Error(sS(6));ga=!1,k();var _u=b.indexOf(_i);b.splice(_u,1),g=null}}}function $(_i){if(!z_t(_i))throw new Error(sS(7));if(_i.type===void 0)throw new Error(sS(8));if(I)throw new Error(sS(9));try{I=!0,y=A(y,_i)}finally{I=!1}for(var ga=g=b,_u=0;_u<ga.length;_u++)(0,ga[_u])();return _i}function _t(_i){if(typeof _i!="function")throw new Error(sS(10));A=_i,$({type:Y$.REPLACE})}function _r(){var _i,ga=q;return(_i={subscribe:function(_u){if(typeof _u!="object"||_u===null)throw new Error(sS(11));function ah(){_u.next&&_u.next(B())}return ah(),{unsubscribe:ga(ah)}}})[K$]=function(){return this},_i}return $({type:Y$.INIT}),(p={dispatch:$,subscribe:q,getState:B,replaceReducer:_t})[K$]=_r,p}function J$(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function J0(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?J$(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):J$(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}(function(e){e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_UID="SET_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS"})(wI||(wI={}));class X_t{constructor(l,d,p,A){_s(this,"store",void 0),_s(this,"reducer",void 0);const y={codec:l,audioCodec:d,mode:p,clientId:A,sessionId:null,p2pId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y,b=arguments.length>1?arguments[1]:void 0;switch(b.type){case wI.SET_SESSION_ID:return J0(J0({},g),{},{sessionId:b.sessionId});case wI.SET_P2P_ID:return J0(J0({},g),{},{p2pId:b.p2pId});case wI.SET_UID:return J0(J0({},g),{},{uid:b.uid});case wI.SET_PUB_ID:return J0(J0({},g),{},{pubId:b.pubId});case wI.KEY_METRIC_CLIENT_CREATED:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{clientCreated:b.metric})});case wI.KEY_METRIC_JOIN_START:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{joinStart:b.metric})});case wI.AVOID_JOIN_START:return J0(J0({},g),{},{avoidJoinStart:b.avoidJoinStart});case wI.KEY_METRIC_JOIN_END:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{joinEnd:b.metric})});case wI.KEY_METRIC_REQUEST_AP_START:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{requestAPStart:b.metric})});case wI.KEY_METRIC_REQUEST_AP_END:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{requestAPEnd:b.metric})});case wI.KEY_METRIC_JOIN_GATEWAY_START:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{joinGatewayStart:b.metric})});case wI.KEY_METRIC_JOIN_GATEWAY_END:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{joinGatewayEnd:b.metric})});case wI.KEY_METRIC_PEER_CONNECTION_START:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{peerConnectionStart:b.metric})});case wI.KEY_METRIC_PEER_CONNECTION_END:return J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{peerConnectionEnd:b.metric})});case wI.KEY_METRIC_PUBLISH:{const I=g.keyMetrics.publish,k=I.findIndex(B=>B.trackId===b.metric.trackId);return k!==-1?(I[k]=J0(J0({},I[k]),b.metric),J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{publish:[...I]})})):J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{publish:[...g.keyMetrics.publish,b.metric]})})}case wI.KEY_METRIC_SUBSCRIBE:{const I=g.keyMetrics.subscribe,k=I.findIndex(B=>B.userId===b.metric.userId&&B.type===b.metric.type);return k!==-1?(I[k]=J0(J0({},I[k]),b.metric),J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{subscribe:[...I]})})):J0(J0({},g),{},{keyMetrics:J0(J0({},g.keyMetrics),{},{subscribe:[...g.keyMetrics.subscribe,b.metric]})})}case wI.SET_CLOUD_PROXY_SERVER_MODE:return g.cloudProxyServerMode=b.mode,g;case wI.RECORD_JOIN_CHANNEL_SERVICE:return typeof b.index!="number"?g.joinChannelServiceRecords=[...g.joinChannelServiceRecords,b.record]:(g.joinChannelServiceRecords[b.index]=J0(J0({},g.joinChannelServiceRecords[b.index]),b.record),g.joinChannelServiceRecords=[...g.joinChannelServiceRecords]),g;case wI.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return g.joinChannelServiceRecords=[],g;case wI.RESET_KEY_METRICS:return g.keyMetrics={publish:[],subscribe:[]},g;default:return g}},this.store=W$(this.reducer)}set sessionId(l){this.store.dispatch({type:wI.SET_SESSION_ID,sessionId:l})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(l){this.store.dispatch({type:wI.SET_P2P_ID,p2pId:l})}get p2pId(){return this.store.getState().p2pId}set uid(l){this.store.dispatch({type:wI.SET_UID,uid:l})}get uid(){return this.store.getState().uid}set pubId(l){this.store.dispatch({type:wI.SET_PUB_ID,pubId:l})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(l){this.store.dispatch({type:wI.SET_CLOUD_PROXY_SERVER_MODE,mode:l})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:wI.KEY_METRIC_CLIENT_CREATED,metric:performance.now()})}joinStart(){this.store.dispatch({type:wI.KEY_METRIC_JOIN_START,metric:performance.now()})}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(l){this.store.dispatch({type:wI.AVOID_JOIN_START,avoidJoinStart:l})}joinEnd(){this.store.dispatch({type:wI.KEY_METRIC_JOIN_END,metric:performance.now()})}requestAPStart(){this.store.dispatch({type:wI.KEY_METRIC_REQUEST_AP_START,metric:performance.now()})}requestAPEnd(){this.store.dispatch({type:wI.KEY_METRIC_REQUEST_AP_END,metric:performance.now()})}joinGatewayStart(){this.store.dispatch({type:wI.KEY_METRIC_JOIN_GATEWAY_START,metric:performance.now()})}joinGatewayEnd(){this.store.dispatch({type:wI.KEY_METRIC_JOIN_GATEWAY_END,metric:performance.now()})}peerConnectionStart(){this.store.dispatch({type:wI.KEY_METRIC_PEER_CONNECTION_START,metric:performance.now()})}peerConnectionEnd(){this.store.dispatch({type:wI.KEY_METRIC_PEER_CONNECTION_END,metric:performance.now()})}publish(l,d,p,A){this.store.dispatch({type:wI.KEY_METRIC_PUBLISH,metric:J0(J0({trackId:l,type:d},p&&{publishStart:p}),A&&{publishEnd:A})})}subscribe(l,d,p,A,y){this.store.dispatch({type:wI.KEY_METRIC_SUBSCRIBE,metric:J0(J0(J0({userId:l,type:d},p&&{subscribeStart:p}),A&&{subscribeEnd:A}),y&&{firstFrame:y})})}massSubscribe(l,d,p,A){l.forEach(y=>{this.store.dispatch({type:wI.KEY_METRIC_SUBSCRIBE,metric:J0(J0(J0({userId:y.userId,type:y.type},d&&{subscribeStart:d}),p&&{subscribeEnd:p}),A&&{firstFrame:A})})})}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(l,d){l.service==="gateway"&&Array.isArray(l.urls)&&(l.urls=l.urls.map(p=>p.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof d!="number"?(this.store.dispatch({type:wI.RECORD_JOIN_CHANNEL_SERVICE,record:J0(J0({},l),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(d<0||d>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:wI.RECORD_JOIN_CHANNEL_SERVICE,record:l,index:d}),d)}catch{return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:wI.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:wI.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch{return[]}}}let e3;const Z_t=()=>(e3||e3||(e3=(window.location.protocol.split(":")[0]||"").toUpperCase(),e3))==="HTTPS",z$=()=>window.isSecureContext!==void 0;class $_t{constructor(l,d){_s(this,"time",void 0),_s(this,"sequence",void 0),_s(this,"name",void 0),_s(this,"elapse",void 0),this.name=l,this.time=performance.now(),this.sequence=Ogt[d].indexOf(l)}setElapse(l){this.elapse=l}}const tyt=new Map;class eyt{constructor(l,d){_s(this,"records",[]),_s(this,"_id",void 0),_s(this,"_group",void 0),_s(this,"_localTimeStamp",void 0),_s(this,"_performanceTimeStamp",void 0),this._id=l,this._group=d,this._localTimeStamp=Date.now(),this._performanceTimeStamp=performance.now()}checkPoint(l){const d=new $_t(l,this._group);d.sequence===-1&&_a.warning("[".concat(this._id,"] check point record failed, cannot get the sequence")),this.records.push(d);const p=this.records.find(A=>A.sequence===d.sequence-1);p&&d.setElapse(d.time-p.time)}getRecord(l){return this.records.find(d=>d&&d.name===l)}resetRecords(){this.records.length=0}}var X$,Z$,$$,ttt,ett,ntt,rtt,itt,ott,b1;function stt(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function iN(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?stt(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):stt(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}let nyt=(X$=U1("AgoraRTCClient","store.clientId"),Z$=E2({report:_0}),$$=E2(),ttt=E2({report:_0}),ett=mP(),ntt=E2({report:_0}),rtt=mP({report:_0}),itt=E2({reportResult:!0,report:_0}),X$((X0((b1=class extends e1{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}constructor(e){let l;if(super(),_s(this,"store",void 0),_s(this,"_uid",void 0),_s(this,"_channelName",void 0),_s(this,"_uintUid",void 0),_s(this,"_users",[]),_s(this,"_codec",void 0),_s(this,"_mode",void 0),_s(this,"_config",void 0),_s(this,"_clientId",void 0),_s(this,"_appId",void 0),_s(this,"_sessionId",null),_s(this,"_key",void 0),_s(this,"_joinInfo",void 0),_s(this,"_gateway",void 0),_s(this,"_statsCollector",void 0),_s(this,"_configDistribute",void 0),_s(this,"_leaveMutex",new g_("client-leave")),_s(this,"_publishMutex",new g_("client-publish")),_s(this,"_renewTokenMutex",new g_("client-renewtoken")),_s(this,"_subscribeMutex",new g_("client-subscribe")),_s(this,"_encryptionMode","none"),_s(this,"_encryptionSecret",null),_s(this,"_encryptionSalt",null),_s(this,"_proxyServer",void 0),_s(this,"_performanceRecorder",void 0),_s(this,"_turnServer",{servers:[],mode:"auto"}),_s(this,"_cloudProxyServerMode","disabled"),_s(this,"_isDualStreamEnabled",!1),_s(this,"_defaultStreamFallbackType",void 0),_s(this,"_lowStreamParameter",void 0),_s(this,"_streamFallbackTypeCacheMap",new Map),_s(this,"_remoteStreamTypeCacheMap",new Map),_s(this,"_axiosCancelSource",lS.CancelToken.source()),_s(this,"_audioVolumeIndicationInterval",void 0),_s(this,"_networkQualityInterval",void 0),_s(this,"_userOfflineTimeout",void 0),_s(this,"_streamRemovedTimeout",void 0),_s(this,"_injectStreamingClient",void 0),_s(this,"_liveTranscodeStreamingClient",void 0),_s(this,"_liveRawStreamingClient",void 0),_s(this,"_channelMediaRelayClient",void 0),_s(this,"_networkQualitySensitivity","normal"),_s(this,"_p2pChannel",void 0),_s(this,"_useLocalAccessPoint",!1),_s(this,"_joinAndNotLeaveYet",!1),_s(this,"_numberOfJoinCount",0),_s(this,"_remoteDefaultVideoStreamType",void 0),_s(this,"_handleLocalTrackEnable",(d,p,A)=>{this.publish(d,!1).then(p).catch(A)}),_s(this,"_handleLocalTrackDisable",(d,p,A)=>{this.unpublish(d).then(p).catch(A)}),_s(this,"_handleUserOnline",d=>{this.isStringUID&&typeof d.uid!="string"&&(_a.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID")),H0("error",this,"StringUID is Mixed with UintUID"));const p=this._users.find(A=>A.uid===d.uid);if(p)p._trust_in_room_=!0;else{const A=new j6(d.uid,d.uint_id||d.uid);this._users.push(A),_a.debug("[".concat(this._clientId,"] user online"),d.uid),V_("info",this,"user-joined",{uid:d.uid}),this.emit(mI.USER_JOINED,A)}}),_s(this,"_handleUserOffline",d=>{const p=this._users.find(A=>A.uid===d.uid);p&&(this._handleRemoveStream(d),Z5(this._users,p),this._remoteStreamTypeCacheMap.delete(p.uid),this._streamFallbackTypeCacheMap.delete(p.uid),_a.debug("[".concat(this._clientId,"] user offline"),d.uid,"reason:",d.reason),V_("info",this,"user-left",{reason:d.reason,uid:d.uid}),this.emit(mI.USER_LEAVED,p,d.reason))}),_s(this,"_handleAddAudioOrVideoStream",(d,p,A,y,g,b,I)=>{const k=this._users.find(q=>q.uid===p);if(!k)return _a.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void VI("error",["AgoraRTCGateway",this._clientId],"add_".concat(d,"_stream"),"can not find target user!");_a.debug("[".concat(this._clientId,"] stream added with uid ").concat(p,", type ").concat(d)),VI("debug",["AgoraRTCGateway",this._clientId],"add_".concat(d,"_stream"),{uid:p,mediaType:d});const B=d==="audio"?k.hasAudio:k.hasVideo;k._uintid||(k._uintid=g||p),k._trust_stream_added_state_=!0,d==="audio"?(k._audio_added_=!0,A!==void 0&&(k._audioSSRC=A),y!==void 0&&(k._cname=y),b&&(k._audioOrtc=b)):(k._video_added_=!0,A!==void 0&&(k._videoSSRC=A),y!==void 0&&(k._cname=y),I!==void 0&&(k._rtxSsrcId=I),b&&(k._videoOrtc=b)),(d==="audio"?k.hasAudio:k.hasVideo)&&!B&&(_a.info("[".concat(this._clientId,"] remote user ").concat(k.uid," published ").concat(d)),H0("info",this,"remote user ".concat(k.uid," published ").concat(d)),V_("info",this,"user-published",{uid:k.uid,mediaType:d}),this.emit(mI.USER_PUBLISHED,k,d)),d==="video"?_0.onGatewayStream(this._sessionId,N1.ON_ADD_VIDEO_STREAM,WI.ON_ADD_VIDEO_STREAM,{peer:g||p}):_0.onGatewayStream(this._sessionId,N1.ON_ADD_AUDIO_STREAM,WI.ON_ADD_AUDIO_STREAM,{peer:g||p}),this._p2pChannel.hasPendingRemoteMedia(k,d)&&this.subscribe(k,d).catch(q=>{_a.error("[".concat(this._clientId,"] resubscribe error"),q.toString()),H0("error",this,"resubscribe error: ".concat(q.toString()))})}),_s(this,"_handleRemoveStream",d=>{const p=this._users.find(y=>y.uid===d.uid);if(!p)return _a.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)")),void VI("warning",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:d.uid,info:"can not find target user!"});_a.debug("[".concat(this._clientId,"] stream removed with uid ").concat(d.uid)),VI("debug",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:d.uid});let A=()=>{};p.hasAudio&&p.hasVideo?A=()=>{_a.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished audio track")),V_("info",this,"user-unpublished",{uid:p.uid,mediaType:"audio"}),this.emit(mI.USER_UNPUBLISHED,p,"audio"),_a.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished video track")),V_("info",this,"user-unpublished",{uid:p.uid,mediaType:"video"}),this.emit(mI.USER_UNPUBLISHED,p,"video")}:p.hasVideo?A=()=>{_a.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished video track")),V_("info",this,"user-unpublished",{uid:p.uid,mediaType:"video"}),this.emit(mI.USER_UNPUBLISHED,p,"video")}:p.hasAudio&&(A=()=>{_a.info("[".concat(this._clientId,"] remote user ").concat(p.uid," unpublished audio track")),V_("info",this,"user-unpublished",{uid:p.uid,mediaType:"audio"}),this.emit(mI.USER_UNPUBLISHED,p,"audio")}),p._trust_stream_added_state_=!0,p._audio_added_=!1,p._video_added_=!1,this._p2pChannel.unsubscribe(p).then(y=>{if(y)return this._gateway.unsubscribe(y,p.uid)}),p._audioSSRC=void 0,p._videoSSRC=void 0,p._audioOrtc=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0,_0.onGatewayStream(this._sessionId,N1.ON_REMOVE_STREAM,WI.ON_REMOVE_STREAM,{peer:d.uint_id||d.uid}),A()}),_s(this,"_handleSetStreamLocalEnable",(d,p,A)=>{const y=this._users.find(I=>I.uid===p);if(!y)return _a.error("[".concat(this._clientId,"] can not find target user!(disable_local)")),void VI("error",this,"disable_local_video","can not find target user!(disable_local)");_a.debug("[".concat(this._clientId,"] local ").concat(d," ").concat(A?"enabled":"disabled"," with uid ").concat(p)),VI("debug",this,"disable_local_video","local ".concat(d," ").concat(A?"enabled":"disabled"," with uid ").concat(p));const g=d==="audio"?y.hasAudio:y.hasVideo;if(d==="audio"){y._trust_audio_enabled_state_=!0;const I=y._audio_enabled_;if(y._audio_enabled_=A,y._audio_enabled_===I)return;{const k=y._audio_enabled_?"enable-local-audio":"disable-local-audio";_a.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(p,", msg: ").concat(k)),Z0("debug",this,"user-info-updated",{uid:p,msg:k}),this.emit(mI.USER_INFO_UPDATED,p,k)}}else{y._trust_video_enabled_state_=!0;const I=y._video_enabled_;if(y._video_enabled_=A,y._video_enabled_===I)return;{const k=y._video_enabled_?"enable-local-video":"disable-local-video";_a.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(p,", msg: ").concat(k)),Z0("debug",this,"user-info-updated",{uid:p,msg:k}),this.emit(mI.USER_INFO_UPDATED,p,k)}}const b=d==="audio"?y.hasAudio:y.hasVideo;return g!==b?!g&&b?(_a.info("[".concat(this._clientId,"] remote user ").concat(p," published ").concat(d)),V_("info",this,"user-published",{uid:p,mediaType:d}),void this.emit(mI.USER_PUBLISHED,y,d)):(d==="video"&&y._videoTrack&&y._videoTrack._destroy(),d==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,d),_a.info("[".concat(this._clientId,"] remote user ").concat(p," unpublished ").concat(d)),V_("info",this,"user-unpublished",{uid:p,mediaType:d}),void this.emit(mI.USER_UNPUBLISHED,y,d)):void 0}),_s(this,"_handleMuteStream",(d,p,A)=>{_a.debug("[".concat(this._clientId,"] receive mute message"),d,p,A),VI("debug",this,"mute_".concat(p),A);const y=this._users.find(I=>I.uid===d);if(!y)return _a.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d)),void VI("warning",this,"mute_".concat(p),"can not find remote user, ignore mute event, uid: ".concat(d));const g=p==="audio"?y.hasAudio:y.hasVideo;if(p==="audio"){y._trust_audio_mute_state_=!0;const I=y._audio_muted_;if(y._audio_muted_=A,y._audio_muted_===I)return;{const k=y._audio_muted_?"mute-audio":"unmute-audio";_a.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(k)),Z0("debug",this,"user-info-updated",{uid:d,msg:k}),this.emit(mI.USER_INFO_UPDATED,d,k)}}else{y._trust_video_mute_state_=!0;const I=y._video_muted_;if(y._video_muted_=A,y._video_muted_===I)return;{const k=y._video_muted_?"mute-video":"unmute-video";_a.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(k)),Z0("debug",this,"user-info-updated",{uid:d,msg:k}),this.emit(mI.USER_INFO_UPDATED,d,k)}}const b=p==="audio"?y.hasAudio:y.hasVideo;return g!==b?!g&&b?(_a.info("[".concat(this._clientId,"] remote user ").concat(d," published ").concat(p)),V_("info",this,"user-published",{uid:y.uid,mediaType:p}),void this.emit(mI.USER_PUBLISHED,y,p)):(p==="video"&&y._videoTrack&&y._videoTrack._destroy(),p==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,p),_a.info("[".concat(this._clientId,"] remote user ").concat(d," unpublished ").concat(p)),V_("info",this,"user-unpublished",{uid:d,mediaType:p}),void this.emit(mI.USER_UNPUBLISHED,y,p)):void 0}),_s(this,"_handleP2PLost",async d=>{if(_a.debug("[".concat(this._clientId,"] receive p2p lost"),d),VI("debug",this,"p2p_lost",d),parseInt(d.p2pid,10)!==this.store.p2pId)return _a.warning("P2PLost stream not found",d),void VI("warning",this,"p2p_lost","P2PLost stream not found, ".concat(d));await this._p2pChannel.requestReconnect()}),_s(this,"_handleTokenWillExpire",()=>{_a.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),VI("debug",this,"token_privilege_will_expire"),this.emit(mI.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),_s(this,"_handleBeforeUnload",d=>{d.type==="beforeunload"&&d.returnValue!==void 0&&d.returnValue!==""||(this.leave(),_a.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")),qS("info",["window",this.store.clientId],y_()?"beforeunload":"pagehide"))}),_s(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.emit(mI.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const d={downlinkNetworkQuality:0,uplinkNetworkQuality:0};d.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),d.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(mI.NETWORK_QUALITY,d)}),this._codec=e.codec,this._mode=e.mode,this._clientId=i1(5,"client-"),this.store=new X_t(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),_a.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(s_," build: ").concat($L,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),Z0("info",this,"constructor",{version:s_,build:$L,mode:this._mode,codec:this._codec}),this._performanceRecorder=function(d,p){const A=new eyt(d,p);return tyt.set(d,A),A}(this._clientId,"join"),e.clientRoleOptions)try{WK(e.clientRoleOptions),l=Object.assign({},e.clientRoleOptions)}catch(d){_a.warning("[".concat(this._clientId,"] ").concat(d.toString())),H0("warning",this,d.toString())}this._statsCollector=new I2(this.store),this._statsCollector.onStatsException=(d,p,A)=>{_a.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(d,", msg: ").concat(p,", uid: ").concat(A)),V_("debug",this,mI.EXCEPTION,{code:d,message:p,uid:A}),this.emit(mI.EXCEPTION,{code:d,msg:p,uid:A})},this._statsCollector.onUploadPublishDuration=(d,p,A,y)=>{const g=this._users.find(b=>b.uid===d);g&&_0.peerPublishStatus(this._sessionId,{subscribeElapse:y,audioPublishDuration:p,videoPublishDuration:A,peer:g._uintid})},this._gateway=new e1t(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:e.websocketRetryConfig||a1,httpRetryConfig:e.httpRetryConfig||a1,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:l}),this._config=e,this._configDistribute=new l1t,this._p2pChannel=new J_t(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents()}async join(e,l,d,p,A){const y=++this._numberOfJoinCount;this._performanceRecorder.checkPoint("startJoin"),this.store.joinStart(),p&&(this.store.uid=p);const g=Z_t(),b=z$()?window.isSecureContext:"Browser Not Support";if(!z$()&&!g||!window.isSecureContext){const _t="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";_a.warning(_t),b0("warning",this,_t)}const I=NJ();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),_a.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)),b0("debug",this,"join",void 0,"[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const k=_0.reportApiInvoke(I,{name:$0.JOIN,options:[e,l,d,p],states:{isHttps:g,isSecureContext:b},tag:z0.TRACER});try{if(!d&&d!==null)throw new _E(_f.INVALID_PARAMS,"Invalid token: ".concat(d,". If you don not use token, set it to null"));d&&K1(d,"token",1,2047),K1(e,"appid",1,2047),H4(l),p&&K4(p),A&&K1(A,"optionalInfo",1,2047)}catch(_t){throw k.onError(_t),_t}if(_a.info("[".concat(this._clientId,"] start join channel ").concat(l,", join number: ").concat(y)),Z0("info",this,"join",{channel:l}),this._leaveMutex.isLocked&&(_a.debug("[".concat(this._clientId,"] join: waiting leave operation")),H0("debug",this,"join: waiting leave operation"),(await this._leaveMutex.lock())(),_a.debug("[".concat(this._clientId,"] join: continue")),H0("debug",this,"join: continue")),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const _t=new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw k.onError(_t),_t}this._sessionId||(this._sessionId=I,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const B=iN({clientId:this._clientId,appId:e,sid:this._sessionId,cname:l,uid:typeof p!="string"?p:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:d||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:A,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(typeof p=="string"&&(B.stringUid=p,this._uintUid?(B.uid=this._uintUid,this._uintUid=void 0):B.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(B.aesmode=this._encryptionMode,B.aespassword=await(async _t=>{const _r=$5(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),_i=await window.crypto.subtle.importKey("spki",_r,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),ga=bJ(_t),_u=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},_i,ga);return SP(new Uint8Array(_u))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(B.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:l,appId:e});const q=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&q===this._sessionId&&_0.joinChannelTimeout(this._sessionId,5)},5e3);try{let _t;const _r=B.cloudProxyServer;if(_r==="443only")B.proxyServer=y0("PROXY_SERVER_TYPE2");else if(["proxy3","proxy4","proxy5"].includes(_r)){const _u=y0("PROXY_SERVER_TYPE3");Array.isArray(_u)?B.proxyServer=_u[0]:B.proxyServer=_u}if(_0.setProxyServer(B.proxyServer),_a.setProxyServer(B.proxyServer),tT(B.proxyServer),this._performanceRecorder.checkPoint("startRequestAp"),this.store.requestAPStart(),B.stringUid&&!B.uid&&_r==="normal"){await B6(B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,!1,this.store);const _u=await M6(B.stringUid,B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,this.store);_a.debug("getUserAccount Success ".concat(B.stringUid," => ").concat(_u)),H0("debug",this,"getUserAccount Success ".concat(B.stringUid," => ").concat(_u)),B.uid=_u,_t=await N2(B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,this.store)}else if(B.stringUid&&!B.uid){const _u=await M6(B.stringUid,B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,this.store);_a.debug("getUserAccount Success ".concat(B.stringUid," => ").concat(_u)),H0("debug",this,"getUserAccount Success ".concat(B.stringUid," => ").concat(_u)),B.uid=_u,_t=await B6(B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,!0,this.store)}else _t=await B6(B,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,!0,this.store);if(!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),this._performanceRecorder.checkPoint("startJoinGateway"),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(B,this._axiosCancelSource.token),this._configDistribute.on(NO.UPDATE_BITRATE_LIMIT,_u=>{this._p2pChannel.updateBitrateLimit(_u)})},0),this._key=d||e;const _i=_t.gatewayInfo;this._joinInfo=iN(iN({},B),{},{cid:_i.cid,uid:B.uid?B.uid:_i.uid,vid:_i.vid,apResponse:_i.res,uni_lbs_ip:_i.uni_lbs_ip,gatewayAddrs:_i.gatewayAddrs});const ga=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));return k.onSuccess(ga),this._appId=e,this._channelName=B.cname,this._uid=ga,this.store.uid=ga,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(y_()?"beforeunload":"pagehide",this._handleBeforeUnload)},0),_a.info("[".concat(this._clientId,"] Joining channel success: ").concat(l)),Z0("info",this,"join",l,"success"),setTimeout(()=>{y0("USE_NEW_LOG")?ZL():_a.startUpload()},5e3),this._performanceRecorder.checkPoint("finishJoin"),this.store.joinEnd(),$=this,a2.includes($)||a2.push($),ga}catch(_t){const _r=Array.isArray(_t)?_t[0]:_t;throw _a.error("[".concat(this._clientId,"] join number: ").concat(y,", Joining channel failed, rollback"),_r),Z0("error",this,"join",l,_r.toString()),_r.code!==_f.OPERATION_ABORTED&&this._numberOfJoinCount===y&&(this._gateway.state="DISCONNECTED",this._reset()),k.onError(_r),_r}var $}_joinGateway(){if(!this._joinInfo||!this._key)throw new _E(_f.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||!y0("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(e=>e).catch(e=>{if(e.code===_f.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,I1.FALLBACK);throw e}).then(e=>{if(e)return e;if(_a.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new _E(_f.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const l=y0("PROXY_SERVER_TYPE3");if(Array.isArray(l))if(this._joinInfo.apUrl){const d=new kX(this._joinInfo.apUrl).host.split("."),p=d.slice(d.length-2).join(".");l.forEach(A=>{this._joinInfo&&A.includes(p)&&(this._joinInfo.proxyServer=A)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=l[0])}else this._joinInfo.proxyServer=l[0];else this._joinInfo.proxyServer=l;return _a.setProxyServer(this._joinInfo.proxyServer),_0.setProxyServer(this._joinInfo.proxyServer),tT(this._joinInfo.proxyServer),_0.reportApiInvoke(this._sessionId,{name:$0.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:z0.TRACER}).onSuccess(),this.emit(mI.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)}).then(e=>e)}async leave(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.LEAVE,options:[],tag:z0.TRACER});_a.info("[".concat(this._clientId,"] Leaving channel")),Z0("info",this,"leave"),window.removeEventListener(y_()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(d){const p=a2.indexOf(d);p!==-1&&a2.splice(p,1)}(this);const l=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return _a.info("[".concat(this._clientId,"] Leaving channel repeated, success")),l(),e.onSuccess();await this._gateway.leave(this.connectionState!=="CONNECTED"),_a.info("[".concat(this._clientId,"] Leaving channel success")),Z0("info",this,"leave",void 0,"success"),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),l(),e.onSuccess()}async publish(e){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];Array.isArray(e)||(e=[e]);const d=_0.reportApiInvoke(this._sessionId,{name:$0.PUBLISH,options:e.map(A=>A?Object(A).toString():"null"),tag:z0.TRACER});if(e.length===0){const A=new _E(_f.INVALID_PARAMS,"track list is empty");return d.onError(A),A.throw()}if(this._gateway.role==="audience"){const A=new _E(_f.INVALID_OPERATION,"audience can not publish stream");return d.onError(A),A.throw()}for(const A of e){if(!(A instanceof q5)){const y=new _E(_f.INVALID_PARAMS,"parameter is not local track");return d.onError(y),y.throw()}if(!A._enabled&&l){const y=new _E(_f.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(A.getTrackId()));return d.onError(y),y.throw()}}_a.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(e.map(A=>"".concat(A.getTrackId()," ")))),Z0("info",this,"publish",e.map(A=>"".concat(A.getTrackId()))),await this._configDistribute.awaitConfigDistributeComplete(),l&&e.forEach(A=>{const y=this._configDistribute.getBitrateLimit();A instanceof A1&&y&&A.setBitrateLimit(y.uplink)});const p=await this._publishMutex.lock();try{await this._publishHighStream(e),d.onSuccess(e.map(A=>A.trackMediaType+":"+A.getTrackLabel()).toString()),_a.info("[".concat(this._clientId,"] Publish success, id ").concat(e.map(A=>"".concat(A.getTrackId()," ")))),Z0("info",this,"publish",e.map(A=>"".concat(A.getTrackId())),"success")}catch(A){throw d.onError(A),_a.error("[".concat(this._clientId,"] publish error"),A.toString()),Z0("error",this,"publish",void 0,A.toString()),A}finally{p()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");e?Array.isArray(e)||(e=[e]):e=this._p2pChannel.getAllTracks(!0);const l=_0.reportApiInvoke(this._sessionId,{name:$0.UNPUBLISH,options:e.map(p=>p.getTrackId()),tag:z0.TRACER});_a.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(e.map(p=>"".concat(p.getTrackId()," "))," ")),Z0("info",this,"unpublish",e.map(p=>"".concat(p.getTrackId())));const d=await this._publishMutex.lock();try{const p=await this._p2pChannel.unpublish(e);p&&await this._gateway.unpublish(p,this._uid),_a.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(e.map(A=>"".concat(A.getTrackId())))),Z0("info",this,"unpublish",e.map(A=>"".concat(A.getTrackId())),"success"),l.onSuccess()}catch(p){throw l.onError(p),_a.error("[".concat(this._clientId,"] unpublish error"),p.toString()),Z0("error",this,"unpublish",void 0,p.toString()),p}finally{d&&d()}}async subscribe(e,l){O1(l,"mediaType",["audio","video"]);const d=_0.reportApiInvoke(this._sessionId,{name:$0.SUBSCRIBE,options:[e.uid,l],tag:z0.TRACER});if(!this._joinInfo){const I=new _E(_f.INVALID_OPERATION,"Can't subscribe stream, not joined");throw d.onError(I),I}if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING"){const I=new _E(_f.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw d.onError(I),I}if(!this._users.find(I=>I===e)){const I=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");throw _a.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),Z0("error",this,"subscribe",e.uid,"this user is not in the channel"),d.onError(I),I}if(!e.hasAudio&&!e.hasVideo){const I=new _E(_f.INVALID_REMOTE_USER,"user is not published");throw _a.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),Z0("error",this,"subscribe",e.uid,"this user is not published"),d.onError(I),I}if(l==="audio"&&(!e.hasAudio||e._audioSSRC===void 0)||l==="video"&&(!e.hasVideo||e._videoSSRC===void 0)){const I=new _E(_f.REMOTE_USER_IS_NOT_PUBLISHED);throw _a.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(l,", remote track is not published")),Z0("error",this,"subscribe",e.uid,"mediaType ".concat(l,", remote track is not published")),d.onError(I),I}const p=l==="audio"?e._audioSSRC:e._videoSSRC,A=l==="audio"?e._audioOrtc:e._videoOrtc,y=l==="video"?e._rtxSsrcId:void 0,g={stream_type:l==="audio"?AI.AUDIO:AI.VIDEO,ssrcId:p},b=await this._subscribeMutex.lock();_a.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(l)),Z0("info",this,"subscribe",{uid:e.uid,mediaType:l});try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,l))await this._p2pChannel.unmuteRemote(e,l);else try{K_.markSubscribeStart(this.store.clientId,p),this.store.subscribe(e.uid,l,performance.now()),await this._p2pChannel.subscribe(e,l,p,y,A);try{await this._gateway.subscribe(e.uid,g,!0)}catch(k){throw await this._p2pChannel.unsubscribe(e,l),k}this.store.subscribe(e.uid,l,void 0,performance.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,l)}catch(k){throw this._p2pChannel.reportSubscribeEvent(!1,k==null?void 0:k.code,e,l),k}_a.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(l)),Z0("info",this,"subscribe",{uid:e.uid,mediaType:l},"success"),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(k=>{_a.warning("[".concat(this._clientId,"] auto set fallback failed"),k),H0("warning",this,"auto set fallback failed, ".concat(k.toString()))});const I=l==="audio"?e._audioTrack:e._videoTrack;if(!I){const k=new _E(_f.UNEXPECTED_ERROR,"can not find remote track in user object");return d.onError(k),k.throw()}return d.onSuccess(I.getTrackId()),I}catch(I){throw d.onError(I),_a.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),I),Z0("error",this,"subscribe",{uid:e.uid,mediaType:l},I.toString()),I}finally{b()}}async massSubscribe(e){wO(e,"subscribeList");const l=_0.reportApiInvoke(this._sessionId,{name:$0.MASS_SUBSCRIBE,options:e.map(I=>{let{user:k,mediaType:B}=I;return[k==null?void 0:k.uid,B]}),tag:z0.TRACER});if(!this._joinInfo){const I=new _E(_f.INVALID_OPERATION,"Can't subscribe stream, not joined");throw l.onError(I),I}if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING"){const I=new _E(_f.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw l.onError(I),I}const d=performance.now(),p=new Map,A=await this._subscribeMutex.lock();_a.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(I=>{let{user:k,mediaType:B}=I;return"user: ".concat(k==null?void 0:k.uid,", mediaType: ").concat(B)}).join("; "))),Z0("info",this,"massSubscribe",e);const y=(e=[...e]).map(I=>{let{user:k,mediaType:B}=I;return{user:k,mediaType:B}}),g=await this._p2pChannel.globalLock();try{var b;for(let k=e.length-1;k>=0;k--){const B=e[k],{user:q,mediaType:$}=B;if(O1($,"mediaType",["audio","video"]),!q){const _i=new _E(_f.INVALID_PARAMS,"user property does not exist in subscribeList item");throw _a.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),l.onError(_i),_i}if(!this._users.find(_i=>_i===q)){const _i=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");_a.error("[".concat(this._clientId,"] can not massSubscribe ").concat(q.uid,", this user is not in the channel")),Z0("error",this,"massSubscribe",q.uid,"this user is not in the channel"),y[k].error=_i,e.splice(k,1);continue}if($==="audio"&&(!q.hasAudio||q._audioSSRC===void 0)||$==="video"&&(!q.hasVideo||q._videoSSRC===void 0)){const _i=new _E(_f.REMOTE_USER_IS_NOT_PUBLISHED);_a.error("[".concat(this._clientId,"] can not subscribe ").concat(q.uid," with mediaType ").concat($,", remote user is not published")),Z0("error",this,"subscribe",q.uid,"mediaType ".concat($,", remote user is not published")),y[k].error=_i,e.splice(k,1);continue}const _t=XI.Video|XI.LwoVideo,_r=p.get(q);if(_r){if($==="video"?_r&_t:_r&XI.Audio){e.splice(k,1),_a.warning("repeat massSubscribe user:".concat(q.uid,", mediaType:").concat($," twice"));continue}p.set(q,_r|($==="video"?_t:XI.Audio))}else p.set(q,$==="video"?_t:XI.Audio)}for(let k=e.length-1;k>=0;k--){const B=e[k],{user:q,mediaType:$}=B,_t=XI.Video|XI.LwoVideo;if(this._p2pChannel.hasRemoteMedia(q,$)){await this._p2pChannel.unmuteRemoteNoLock(q,$);const _r=p.get(q);p.set(q,$==="video"?_r^_t:_r^XI.Audio),e.splice(k,1)}}this.store.massSubscribe(e.map(k=>({userId:k.user.uid,type:k.mediaType})),d);const I=VR(b=Array.from(p.entries())).call(b,(k,B)=>{let[q,$]=B;if($===0)return k;const _t={stream_id:q.uid,stream_type:$};return $&XI.Audio&&(_t.audio_ssrc=q._audioSSRC),$&XI.Video&&(_t.video_ssrc=q._videoSSRC),k.push(_t),k},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(B=>{let{user:q,mediaType:$}=B;return{user:q,mediaType:$,ssrcId:$===AI.VIDEO?q._videoSSRC:q._audioSSRC,rtxSsrcId:q._rtxSsrcId}}));const k=new Map;if(I.length>0){const B=await this._gateway.subscribeAll(I,!0);((B==null?void 0:B.users)||[]).forEach(q=>{let{stream_id:$,video_error_code:_t,audio_error_code:_r,error_code:_i}=q;(_t||_r||_i)&&k.set($,{video_error_code:_t,audio_error_code:_r,error_code:_i})})}if(Array.from(k.entries()).length>0){const B=Array.from(k.entries()).map(q=>{let $,[_t,_r]=q;return _r.error_code||_r.video_error_code&&_r.audio_error_code?$=void 0:_r.video_error_code?$=AI.VIDEO:_r.audio_error_code&&($=AI.AUDIO),{user:this.remoteUsers.find(_i=>_i.uid===_t),mediaType:$}});await this._p2pChannel.massUnsubscribeNoLock(B)}for(const B of y){const q=k.get(B.user.uid);if(q){const $=q.error_code||B.mediaType==="audio"&&q.audio_error_code||B.mediaType==="video"&&q.video_error_code;if($){const _t=O6($);_a.error("user:".concat(B.user.uid," mediaType:").concat(B.mediaType," has massSubscribe error ").concat(_t.desc)),B.error=new _E(_f.SUBSCRIBE_FAILED,"code ".concat($,": ").concat(_t.desc))}}B.error||(B.mediaType==="video"?B.track=B.user.videoTrack:B.track=B.user.audioTrack)}return this.store.massSubscribe(y.filter(B=>!B.error).map(B=>({userId:B.user.uid,type:B.mediaType})),void 0,performance.now()),y.forEach(B=>{var q;_0.subscribe(this.store.sessionId,{succ:!!B.error,ec:((q=B.error)===null||q===void 0?void 0:q.code)||null,video:B.mediaType===AI.VIDEO,audio:B.mediaType===AI.AUDIO,peerid:B.user.uid,subscribeRequestid:B.mediaType===AI.VIDEO?B.user._videoSSRC:B.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-d)},!0)}),l.onSuccess(),_a.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(B=>{let{user:q,mediaType:$}=B;return"user: ".concat(q==null?void 0:q.uid,", mediaType: ").concat($)}).join("; "))),Z0("info",this,"massSubscribe",e,"success"),y}catch(k){throw await this._p2pChannel.massUnsubscribeNoLock(e),l.onError(k),k}}finally{g(),A()}}async unsubscribe(e,l){if(l&&O1(l,"mediaType",["audio","video"]),!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const d=_0.reportApiInvoke(this._sessionId,{name:$0.UNSUBSCRIBE,options:[e.uid,l],tag:z0.TRACER});if(!this._users.find(p=>p===e)){const p=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");throw _a.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not in the channel")),Z0("error",this,"unsubscribe",{uid:e.uid,mediaType:l},"user is not in the channel"),d.onError(p),p}_a.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(l)),Z0("info",this,"unsubscribe",{uid:e.uid,mediaType:l});try{const p=await this._p2pChannel.unsubscribe(e,l);p&&await this._gateway.unsubscribe(p,e.uid),_a.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(l)),Z0("info",this,"unsubscribe",{uid:e.uid,mediaType:l},"success"),d.onSuccess()}catch(p){if(p.code===_f.DISCONNECT_P2P)return _a.warning("disconnecting p2p, abort unsubscribe request."),void d.onSuccess();throw _a.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),p.toString()),Z0("error",this,"unsubscribe",{uid:e.uid,mediaType:l},p.toString()),d.onError(p),p}}async massUnsubscribe(e){wO(e,"unsubscribeList");const l=_0.reportApiInvoke(this._sessionId,{name:$0.UNSUBSCRIBE,options:e.map(p=>{let{user:A,mediaType:y}=p;return{uid:A==null?void 0:A.uid,mediaType:y}}),tag:z0.TRACER});if(!this._joinInfo){const p=new _E(_f.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");throw l.onError(p),p}_a.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(p=>{let{user:A,mediaType:y}=p;return"user: ".concat(A==null?void 0:A.uid,", mediaType: ").concat(y,";")}).join())),Z0("info",this,"massUnsubscribe",e),e=[...e];const d=new Map;for(let p=e.length-1;p>=0;p--){const{user:A,mediaType:y}=e[p];if(!A){const b=new _E(_f.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw _a.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),l.onError(b),b}if(O1(y,"mediaType",["video","audio",void 0]),!this._users.find(b=>b===A)){_a.warning("[".concat(this._clientId,"] can not subscribe ").concat(A.uid,", user is not in the channel")),Z0("error",this,"unsubscribe",{uid:A.uid,mediaType:y},"user is not in the channel"),e.splice(p,1);continue}const g=XI.Video|XI.LwoVideo;if(d.has(A)){const b=d.get(A);let I;switch(y){case"video":I=b&g;break;case"audio":I=b&XI.Audio;break;default:I=b&(XI.Audio|g)}if(I){_a.warning("repeat massUnsubscribe user:".concat(A.uid,",mediaType:").concat(y," twice.")),e.splice(p,1);continue}y?y==="audio"?d.set(A,b|XI.Audio):y==="video"&&d.set(A,b|g):d.set(A,b|XI.Audio|g)}else y?y==="audio"?d.set(A,XI.Audio):y==="video"&&d.set(A,g):d.set(A,XI.Audio|g)}try{const p=await this._p2pChannel.massUnsubscribe(e);p&&await this._gateway.massUnsubscribe(p),_a.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(A=>{let{user:y,mediaType:g}=A;return"user: ".concat(y==null?void 0:y.uid,", mediaType: ").concat(g,";")}).join())),Z0("info",this,"massUnsubscribe",e,"success"),l.onSuccess()}catch(p){if(p.code===_f.DISCONNECT_P2P)return _a.warning("disconnecting p2p, abort unsubscribe request."),void l.onSuccess();throw _a.error("[".concat(this._clientId,"] massUnsubscribe error"),p.toString()),Z0("error",this,"massUnsubscribe",e,p.toString()),l.onError(p),p}}setLowStreamParameter(e){(function(p){if(!p)throw new _E(_f.INVALID_PARAMS);GI(p.width)||jI(p.width,"streamParameter.width"),GI(p.height)||jI(p.height,"streamParameter.height"),GI(p.framerate)||jI(p.framerate,"streamParameter.framerate"),GI(p.bitrate)||jI(p.bitrate,"streamParameter.bitrate")})(e);const l=_0.reportApiInvoke(this._sessionId,{name:$0.SET_LOW_STREAM_PARAMETER,options:[e],tag:z0.TRACER});(!e.width&&e.height||e.width&&!e.height)&&(_a.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),H0("warning",this,"The width and height parameters take effect only when both are set")),_a.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e)),Z0("info",this,"setLowStreamParameter",e);const d=this._configDistribute.getLowStreamConfigDistribute();d&&d.bitrate&&e.bitrate&&d.bitrate<e.bitrate&&(e.bitrate=d.bitrate),this._lowStreamParameter=e,l.onSuccess()}async enableDualStream(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.ENABLE_DUAL_STREAM,options:[],tag:z0.TRACER});if(!t_().supportDualStream){_0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1});const l=new _E(_f.NOT_SUPPORTED,"Your browser is not support dual stream");throw e.onError(l),l}if(this._isDualStreamEnabled){const l=new _E(_f.INVALID_OPERATION,"Dual stream is already enabled");throw e.onError(l),l}if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(l){throw _0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e.onError(l),l}this._isDualStreamEnabled=!0,_0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),_a.info("[".concat(this._clientId,"] enable dual stream")),Z0("info",this,"enableDualStream"),e.onSuccess()}async disableDualStream(){if(!this._isDualStreamEnabled)return;if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const e=_0.reportApiInvoke(this._sessionId,{name:$0.DISABLE_DUAL_STREAM,options:[],tag:z0.TRACER});if(this._p2pChannel.getLocalMedia(Q0.LocalVideoLowTrack))try{const l=await this._p2pChannel.unpublishLowStream();l&&await this._gateway.unpublish(l,this._joinInfo.stringUid||this._joinInfo.uid)}catch(l){throw _0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e.onError(l),l}this._isDualStreamEnabled=!1,_0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),_a.info("[".concat(this._clientId,"] disable dual stream")),Z0("info",this,"disableDualStream"),e.onSuccess()}async setClientRole(e,l){(function(p){O1(p,"role",["audience","host"])})(e),l&&WK(l);const d=_0.reportApiInvoke(this._sessionId,{name:$0.SET_CLIENT_ROLE,options:[e,l],tag:z0.TRACER});if(this._mode==="rtc"){_a.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),Z0("warning",this,"setClientRole",e,"rtc mode can not use setClientRole");const p=new _E(_f.INVALID_OPERATION,"rtc mode can not use setClientRole");return d.onError(p),p.throw()}if(l&&l.level&&e==="host"){const p=new _E(_f.INVALID_OPERATION,"host mode can not set audience latency level");return d.onError(p),p.throw()}try{if(e==="audience"&&this._p2pChannel.hasLocalMedia()){const p=new _E(_f.INVALID_OPERATION,"can not set client role to audience when publishing stream");return d.onError(p),p.throw()}await this._gateway.setClientRole(e,l),_a.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(l&&l.level)),Z0("info",this,"setClientRole",{role:e,level:l&&l.level}),d.onSuccess()}catch(p){throw d.onError(p),p}}setProxyServer(e,l){if(K1(e,"proxyServer"),!l){if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new _E(_f.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,_0.setProxyServer(this._proxyServer),_a.setProxyServer(this._proxyServer),tT(this._proxyServer),_a.info("[".concat(this._clientId,"] Set proxy server ").concat(l?"by initialize call":""," success.")),Z0("info",this,"setProxyServer",[...arguments],"success")}setTurnServer(e,l){if(Array.isArray(e)||(e=[e]),!l){if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new _E(_f.INVALID_OPERATION,"You have already set the proxy")}if(J4(e))return this._turnServer={servers:e,mode:"original-manual"},_a.info("[".concat(this._clientId,"] Set original turnserver ").concat(l?"by initialize call":""," success: ").concat(e.map(d=>d.urls).join(","),".")),void Z0("info",this,"setOriginalTurnServer",[...arguments],"success");e.forEach(d=>YK(d)),this._turnServer={servers:e,mode:"manual"},_a.info("[".concat(this._clientId,"] Set turnserver ").concat(l?"by initialize call":""," success.")),Z0("info",this,"setTurnServer",[...arguments],"success")}startProxyServer(e){const l=_0.reportApiInvoke(this._sessionId,{name:$0.START_PROXY_SERVER,options:[],tag:z0.TRACER});if(this.connectionState!=="DISCONNECTED"){const A=new _E(_f.INVALID_OPERATION,"Start proxy server before join channel");throw l.onError(A),A}if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint){const A=new _E(_f.INVALID_OPERATION,"You have already set the proxy");throw l.onError(A),A}const d=[1,2,3,4,5];let p;switch(e===void 0&&(e=1),e){case 1:p="normal";break;case 2:p="443only";break;case 3:p="proxy3";break;case 4:p="proxy4";break;case 5:p="proxy5";break;default:{const A=new _E(_f.INVALID_PARAMS,"proxy server mode must be ".concat(d.join("|")));throw l.onError(A),A}}this._cloudProxyServerMode=p,this.store.cloudProxyServerMode=p,_a.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),Z0("info",this,"startProxyServer",this._cloudProxyServerMode),l.onSuccess()}stopProxyServer(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.STOP_PROXY_SERVER,options:[],tag:z0.TRACER});if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Stop proxy server after leave channel");_0.setProxyServer(),_a.setProxyServer(),tT(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",_a.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),Z0("info",this,"stopProxyServer",this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}setLocalAccessPoints(e,l){if(wO(e,"serverList"),K1(l,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new _E(_f.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const d=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(p=>d.test(p)?"".concat(p.replace(/\./g,"-"),".").concat(l):p),this._useLocalAccessPoint=!0,H1("WEBCS_DOMAIN",e),H1("WEBCS_DOMAIN_BACKUP_LIST",e),H1("GATEWAY_DOMAINS",[l]),H1("EVENT_REPORT_DOMAIN",e[0]),H1("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),H1("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),_a.info("set local access point success"),Z0("info",this,"setLocalAccessPoints")}async setRemoteDefaultVideoStreamType(e){if(O1(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(l){throw _a.error("[".concat(this._clientId,"] set default remote video stream type error"),l.toString()),l}else _a.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(e))}async setRemoteVideoStreamType(e,l){O1(l,"streamType",[0,1]);const d=_0.reportApiInvoke(this._sessionId,{name:$0.SET_REMOTE_VIDEO_STREAM_TYPE,options:[e,l],tag:z0.TRACER});try{await this._gateway.setRemoteVideoStreamType(e,l),setTimeout(()=>{const p=this._users.find(A=>A.uid===e);p&&p.videoTrack&&p.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(p){throw d.onError(p),_a.error("[".concat(this._clientId,"] set remote video stream type error"),p.toString()),Z0("error",this,"setRemoteVideoStreamType",void 0,p.toString()),p}_a.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(l)),Z0("info",this,"setRemoteVideoStreamType",{uid:e,streamType:l}),this._remoteStreamTypeCacheMap.set(e,l),d.onSuccess()}async setStreamFallbackOption(e,l){O1(l,"fallbackType",[0,1,2]);const d=_0.reportApiInvoke(this._sessionId,{name:$0.SET_STREAM_FALLBACK_OPTION,options:["too long to show",l],tag:z0.TRACER});try{await this._gateway.setStreamFallbackOption(e,l)}catch(p){throw d.onError(p),_a.error("[".concat(this._clientId,"] set stream fallback option"),p.toString()),Z0("error",this,"setStreamFallbackOption",void 0,p.toString()),p}_a.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(l)),Z0("info",this,"setStreamFallbackOption",{uid:e,fallbackType:l}),this._streamFallbackTypeCacheMap.set(e,l),d.onSuccess()}setEncryptionConfig(e,l,d){if(function(p){O1(p,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),K1(l,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(e)){if(!d||!(d instanceof Uint8Array&&d.length===32))throw new _E(_f.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(d)throw new _E(_f.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(l)||(_a.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),H0("warning",this,`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `)),this._encryptionMode=e,this._encryptionSecret=l,d&&(this._encryptionSalt=SP(d))}async renewToken(e){K1(e,"token",1,2047);const l=_0.reportApiInvoke(this._sessionId,{name:$0.RENEW_TOKEN,options:[e],tag:z0.TRACER});if(!this._key||!this._joinInfo){const A=new _E(_f.INVALID_OPERATION,"renewToken should not be called before user join");return l.onError(A),A.throw()}const d=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const p=await this._renewTokenMutex.lock();try{if(y0("USE_NEW_TOKEN")){_a.debug("start renew token with ticket from unilbs"),Z0("debug",this,"renewToken","unilbs");const A=await u1t(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||a1);_a.debug("[".concat(this._clientId,"] get ticket from unilbs success")),Z0("debug",this,"renewToken","unilbs","success"),await this._gateway.renewToken({token:e,ticket:A})}else _a.debug("start renew token without ticket"),Z0("debug",this,"renewToken"),await this._gateway.renewToken({token:e});_a.debug("[".concat(this._clientId,"] renewToken success")),Z0("debug",this,"renewToken",void 0,"success"),l.onSuccess()}catch(A){throw this._key=d,this._joinInfo.token=d,l.onError(A),_a.error("[".concat(this._clientId,"] renewToken failed"),A.toString()),Z0("error",this,"renewToken",void 0,A.toString()),A}finally{p()}}enableAudioVolumeIndicator(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:z0.TRACER});if(this._audioVolumeIndicationInterval)return _a.warning("you have already enabled audio volume indicator!"),Z0("warning",this,"enableAudioVolumeIndicator","you have already enabled audio volume indicator!"),e.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{const l=this._p2pChannel.getAudioLevels();this.emit(mI.VOLUME_INDICATOR,l)},y0("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),e.onSuccess()}getRTCStats(){const e=this._statsCollector.getRTCStats(),l=this._gateway.getInChannelInfo();return e.Duration=Math.round(l.duration/1e3),e}startLiveStreaming(e,l){const d=_0.reportApiInvoke(this._sessionId,{name:$0.START_LIVE_STREAMING,options:[e,l],tag:z0.TRACER});if(!l){if(this._codec!=="h264"){const A=new _E(_f.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return d.onError(A),Y0.reject(A)}if(!this._p2pChannel.hasLocalMedia()){const A=new _E(_f.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return d.onError(A),Y0.reject(A)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)){const A=new _E(_f.LIVE_STREAMING_TASK_CONFLICT);return d.onError(A),Y0.reject(A)}const p=l?n1.TRANSCODE:n1.RAW;return this._createLiveStreamingClient(p).startLiveStreamingTask(e,p).then(()=>d.onSuccess()).catch(A=>{throw d.onError(A),A})}setLiveTranscoding(e){const l=_0.reportApiInvoke(this._sessionId,{name:$0.SET_LIVE_TRANSCODING,options:[e],tag:z0.TRACER});return this._createLiveStreamingClient(n1.TRANSCODE).setTranscodingConfig(e).then(()=>l.onSuccess()).catch(d=>{throw l.onError(d),d})}stopLiveStreaming(e){const l=_0.reportApiInvoke(this._sessionId,{name:$0.STOP_LIVE_STREAMING,options:[e],tag:z0.TRACER}),d=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(p=>p&&p.hasUrl(e));if(!d.length){const p=new _E(_f.INVALID_PARAMS,"can not find live streaming url to stop");return l.onError(p),Y0.reject(p)}return Y0.all(d.map(p=>p&&p.stopLiveStreamingTask(e))).then(()=>l.onSuccess()).catch(p=>{throw l.onError(p),p})}async addInjectStreamUrl(e,l){const d=_0.reportApiInvoke(this._sessionId,{name:$0.ADD_INJECT_STREAM_URL,options:[e,l],tag:z0.TRACER});try{if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const p=this._createLiveStreamingClient(n1.INJECT);p.setInjectStreamConfig(l,0),await p.startLiveStreamingTask(e,n1.INJECT)}catch(p){throw d.onError(p),p}d.onSuccess()}async removeInjectStreamUrl(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.REMOVE_INJECT_STREAM_URL,options:[],tag:z0.TRACER});try{var l;const d=this._createLiveStreamingClient(n1.INJECT),p=Array.from(zS(l=d.streamingTasks).call(l)).find(A=>A.mode===n1.INJECT);if(!this._joinInfo||!p)throw new _E(_f.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await d.stopLiveStreamingTask(p.url)}catch(d){throw e.onError(d),d}e.onSuccess()}async startChannelMediaRelay(e){const l=_0.reportApiInvoke(this._sessionId,{name:$0.START_CHANNEL_MEDIA_RELAY,options:[e],tag:z0.TRACER});try{eZ(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}catch(d){return l.onError(d),d.throw()}l.onSuccess()}async updateChannelMediaRelay(e){const l=_0.reportApiInvoke(this._sessionId,{name:$0.UPDATE_CHANNEL_MEDIA_RELAY,options:[e],tag:z0.TRACER});try{eZ(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}catch(d){return l.onError(d),d.throw()}l.onSuccess()}async stopChannelMediaRelay(){const e=_0.reportApiInvoke(this._sessionId,{name:$0.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:z0.TRACER});try{await this._createChannelMediaRelayClient().stopChannelMediaRelay()}catch(l){return e.onError(l),l.throw()}e.onSuccess()}sendStreamMessage(e){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not send data stream, not joined");if(typeof e=="string"&&(e=new TextEncoder().encode(e)),new Blob([e]).size>1024)throw new _E(_f.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(vI.DATA_STREAM,{payload:SP(e)},!l)}sendMetadata(e){if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new _E(_f.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(vI.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:SP(e)})}async sendCustomReportMessage(e){Array.isArray(e)||(e=[e]),e.forEach(_gt);const l=_0.reportApiInvoke(this._sessionId,{name:$0.SEND_CUSTOM_REPORT_MESSAGE,options:[JSON.stringify(e)],tag:z0.TRACER});if(!this._joinInfo){const d=new _E(_f.INVALID_OPERATION,"can not send custom report, not joined");return l.onError(d),d.throw()}await _0.sendCustomReportMessage(this._joinInfo.sid,e),l.onSuccess()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,l){O1(l.spatialLayer,"spatialLayer",[0,1,2,3]),O1(l.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,l)}catch(d){throw _a.error("[".concat(this._clientId,"] pick SVC layer failed"),d.toString()),b0("error",this,"pickSVCLayer",l,d.toString()),d}}_reset(){_a.debug("[".concat(this._clientId,"] reset client")),b0("debug",this,"_reset"),this._axiosCancelSource.cancel(),this._axiosCancelSource=lS.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new g_("client-publish"),this._subscribeMutex=new g_("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}_startSession(e,l){const d=e||NJ();e?_a.debug("[".concat(this._clientId,"] new Session ").concat(d)):_a.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(d)),b0("debug",this,"_startSession",{newSid:d,sid:this._sessionId}),this._sessionId=d,this.store.sessionId=d,l?_0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:l.channel,appid:l.appId,mode:this._mode}):this._joinInfo?_0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&_0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=d),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=d)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&y0("FORCE_TURN")&&!y0("TURN_ENABLE_TCP")&&!y0("TURN_ENABLE_UDP"))throw new _E(_f.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");_a.debug("[".concat(this._clientId,"] publish high stream")),b0("debug",this,"_publishHighStream");try{const d=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter),p=(await d.next()).value;if(p){var l;let A;try{A=await this._gateway.publish(this._uid,p,!0)}catch(y){if(y.code!==_f.DISCONNECT_P2P)throw d.throw(y),y}await d.next(((l=A)===null||l===void 0?void 0:l.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const A of e)A instanceof A1&&A._encoderConfig&&this._gateway.setVideoProfile(A._encoderConfig),!A.muted&&A.enabled||await this._p2pChannel.muteLocalTrack(A)}catch(d){if(this._p2pChannel.reportPublishEvent(!1,d==null?void 0:d.code,e),(d==null?void 0:d.code)===_f.WS_ABORT)return;throw d}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));_a.debug("[".concat(this._clientId,"] publish low stream")),b0("debug",this,"_publishLowStream");const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const d=await this._p2pChannel.publishLowStream(this._lowStreamParameter),p=(await d.next()).value;if(p){var l;let A;try{A=await this._gateway.publish(this._uid,p,!0)}catch(y){if(y.code!==_f.DISCONNECT_P2P)throw d.throw(y),y}d.next(((l=A)===null||l===void 0?void 0:l.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(d){if(this._p2pChannel.reportPublishEvent(!1,d==null?void 0:d.code,void 0,!0),(d==null?void 0:d.code)===_f.WS_ABORT)return;throw d}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new _E(_f.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const l=()=>new h1t(this._joinInfo,this._config.websocketRetryConfig||a1,this._config.httpRetryConfig||a1),d=p=>{p.onLiveStreamError=(A,y)=>{_0.reportApiInvoke(this._sessionId,{name:$0.ON_LIVE_STREAM_ERROR,options:[A,y],tag:z0.TRACER}).onSuccess(),this.emit(mI.LIVE_STREAMING_ERROR,A,y)},p.onLiveStreamWarning=(A,y)=>{_0.reportApiInvoke(this._sessionId,{name:$0.ON_LIVE_STREAM_WARNING,options:[A,y],tag:z0.TRACER}).onSuccess(),this.emit(mI.LIVE_STREAMING_WARNING,A,y)},p.on(u2.REQUEST_WORKER_MANAGER_LIST,(A,y,g)=>{if(!this._joinInfo)return g(new _E(_f.INVALID_OPERATION,"can not find join info to get worker manager"));WX(A,this._joinInfo,this._axiosCancelSource.token,a1).then(y).catch(g)})};switch(e){case n1.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=l(),d(this._liveRawStreamingClient)),this._liveRawStreamingClient;case n1.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=l(),d(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case n1.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=l(),this._injectStreamingClient.on(u2.REQUEST_WORKER_MANAGER_LIST,(p,A,y)=>{if(!this._joinInfo)return y(new _E(_f.INVALID_OPERATION,"can not find join info to get worker manager"));WX(p,this._joinInfo,this._axiosCancelSource.token,a1).then(A).catch(y)}),this._injectStreamingClient.onInjectStatusChange=(p,A,y)=>{this.emit(mI.INJECT_STREAM_STATUS,p,A,y)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new f1t(this._joinInfo,this._clientId,this._config.websocketRetryConfig||a1,this._config.httpRetryConfig||a1),this._channelMediaRelayClient.on("state",e=>{e===Z1.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(mI.CHANNEL_MEDIA_RELAY_STATE,e)}),this._channelMediaRelayClient.on("event",e=>{this.emit(mI.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient):new _E(_f.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(c1.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(c1.CONNECTION_STATE_CHANGE,(e,l,d)=>{var p;if(d===I1.FALLBACK)return;const A=()=>{this.emit(mI.CONNECTION_STATE_CHANGE,e,l,d)};if(_0.reportApiInvoke(this._sessionId||((p=this._gateway.joinInfo)===null||p===void 0?void 0:p.sid)||null,{name:$0.CONNECTION_STATE_CHANGE,options:[e,l,d],tag:z0.TRACER}).onSuccess(JSON.stringify({cur:e,prev:l,reason:d})),_a.info("[".concat(this._clientId,"] connection state change: ").concat(l," -> ").concat(e)),VI("info",this,"connection-state-change","".concat(l," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void A();if(e==="RECONNECTING")this._users.forEach(g=>{g._trust_in_room_=!1,g._trust_audio_enabled_state_=!1,g._trust_video_enabled_state_=!1,g._trust_audio_mute_state_=!1,g._trust_video_mute_state_=!1,g._trust_stream_added_state_=!1}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var y;this._streamFallbackTypeCacheMap.forEach((g,b)=>{this._gateway.setStreamFallbackOption(b,g).catch(I=>{_a.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),I),H0("warning",this,"auto set stream fallback option failed, ".concat(I.toString()))})}),this._remoteStreamTypeCacheMap.forEach((g,b)=>{this._gateway.setRemoteVideoStreamType(b,g).catch(I=>{_a.warning("[".concat(this._clientId,"] auto set remote stream type failed"),I),H0("warning",this,"auto set remote stream type failed, ".concat(I.toString()))})}),this._remoteDefaultVideoStreamType!==void 0&&((y=this._joinInfo)===null||y===void 0?void 0:y.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{_a.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(g=>{_a.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(g))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(g=>!g._trust_in_room_).forEach(g=>{_a.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(g.uid)),H0("debug",this,"user offline timeout, emit user offline ".concat(g.uid)),this._handleUserOffline({uid:g.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(g=>{g._trust_audio_mute_state_||(_a.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(g.uid)),H0("debug",this,"auto dispatch audio unmute event ".concat(g.uid)),this._handleMuteStream(g.uid,"audio",!1)),g._trust_video_mute_state_||(_a.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(g.uid)),H0("debug",this,"auto dispatch video unmute event ".concat(g.uid)),this._handleMuteStream(g.uid,"video",!1)),g._trust_audio_enabled_state_||(_a.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(g.uid)),H0("debug",this,"auto dispatch enable local audio ".concat(g.uid)),this._handleSetStreamLocalEnable("audio",g.uid,!0)),!g._trust_video_enabled_state_&&g._video_enabled_&&(_a.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(g.uid)),H0("debug",this,"auto dispatch enable local video ".concat(g.uid)),this._handleSetStreamLocalEnable("video",g.uid,!0)),g._trust_stream_added_state_||(_a.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(g.uid)),H0("debug",this,"auto dispatch stream remove ".concat(g.uid)),this._handleRemoveStream({uid:g.uid,uint_id:g._uintid}))}))},1e3)}A()}),this._gateway.on(c1.REQUEST_NEW_GATEWAY_LIST,(e,l)=>{if(!this._joinInfo)return l(new _E(_f.UNEXPECTED_ERROR,"can not recover, no join info"));N2(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||a1,this.store).then(d=>{this._joinInfo&&(this._joinInfo.apResponse=d.gatewayInfo.res,this._joinInfo.gatewayAddrs=d.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=d.gatewayInfo.uni_lbs_ip),e(d.gatewayInfo.gatewayAddrs.map(p=>{if(this._joinInfo&&this._joinInfo.proxyServer){const A=p.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(A[0],"&p=").concat(A[1])}return"wss://".concat(p.address)}))}).catch(l)}),this._gateway.on(c1.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.emit(mI.NETWORK_QUALITY,e)}),this._gateway.on(c1.STREAM_TYPE_CHANGE,(e,l)=>{this.emit(mI.STREAM_TYPE_CHANGED,e,l),_0.reportApiInvoke(this._sessionId,{name:$0.STREAM_TYPE_CHANGE,options:[e,l],tag:z0.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:l}))}),this._gateway.on(c1.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(c1.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(c1.REQUEST_P2P_CONNECTION_PARAMS,async(e,l,d)=>{try{l(await this._p2pChannel.startP2PConnection(e))}catch(p){d(p)}}),this._gateway.on(c1.JOIN_RESPONSE,(e,l,d)=>{const{dtlsParameters:p,iceParameters:A,candidates:y,rtpCapabilities:g,setup:b,cname:I}=g$(e.ortc,l,d);this._p2pChannel.connect(A,p,y,g,b,I)}),this._gateway.signal.on(xI.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(xI.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(xI.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(xI.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(xI.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(xI.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(xI.MUTE_AUDIO,e=>(VI("debug",["AgoraRTCGateway",this._clientId],"mute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!0))),this._gateway.signal.on(xI.UNMUTE_AUDIO,e=>(VI("debug",["AgoraRTCGateway",this._clientId],"unmute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!1))),this._gateway.signal.on(xI.MUTE_VIDEO,e=>(VI("debug",["AgoraRTCGateway",this._clientId],"mute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!0))),this._gateway.signal.on(xI.UNMUTE_VIDEO,e=>(VI("debug",["AgoraRTCGateway",this._clientId],"unmute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!1))),this._gateway.signal.on(xI.RECEIVE_METADATA,e=>{const l=$5(e.metadata);this.emit(mI.RECEIVE_METADATA,e.uid,l)}),this._gateway.signal.on(xI.ON_DATA_STREAM,e=>{e.seq&&delete e.seq,e.payload=$5(e.payload),this.emit(mI.STREAM_MESSAGE,e.uid,e.payload),this.onStreamMessage&&this.onStreamMessage(e)}),this._gateway.signal.on(xI.ON_CRYPT_ERROR,()=>{UO(()=>{_a.warning("[".concat(this._clientId,"] on crypt error")),VI("warning",this,"crypt_error"),this.emit(mI.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(xI.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(xI.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{_a.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),VI("warning",this,"token_privilege_did_expire"),this._gateway.leave(!0),this.emit(mI.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(xI.ON_STREAM_FALLBACK_UPDATE,e=>{_a.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),VI("debug",this,"stream_fallback_update",{peerId:e.stream_id,attr:e.stream_type}),this.emit(mI.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(xI.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),_a.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))),VI("info",this,"publish_stream",e))}),this._gateway.signal.on(xI.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(xI.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(fI.REQUEST_TIMEOUT,(e,l)=>{if(this._joinInfo)switch(e){case vI.PUBLISH:{if(!l)return;const g=(l=l).ortc;if(g){var d,p,A,y;const b=g.some(B=>{let{stream_type:q}=B;return q===r1.Audio}),I=g.some(B=>{let{stream_type:q}=B;return q!==r1.Audio}),k=g.some(B=>{let{stream_type:q}=B;return q===r1.Screen||q===r1.ScreenLow});l.state==="offer"&&_0.publish(this._joinInfo.sid,{eventElapse:K_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:_f.TIMEOUT,audio:b,video:I,p2pid:l.p2p_id,publishRequestid:this.store.pubId,screenshare:k,audioName:b?(d=g.find(B=>{let{stream_type:q}=B;return q===r1.Audio}))===null||d===void 0||(p=d.ssrcs[0])===null||p===void 0?void 0:p.ssrcId.toString():void 0,videoName:I?(A=g.find(B=>{let{stream_type:q}=B;return q!==r1.Audio}))===null||A===void 0||(y=A.ssrcs[0])===null||y===void 0?void 0:y.ssrcId.toString():void 0})}break}case vI.SUBSCRIBE:(l=l)&&_0.subscribe(this._joinInfo.sid,{succ:!1,ec:_f.TIMEOUT,audio:l.stream_type===AI.AUDIO,video:l.stream_type===AI.VIDEO,peerid:l.stream_id,subscribeRequestid:l.ssrcId,p2pid:this.store.p2pId,eventElapse:K_.measureFromSubscribeStart(this.store.clientId,l.ssrcId)})}}),this._gateway.signal.on(xI.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(xI.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;const l=[],d=[];for(const p of e.users){let A=this._users.find(k=>k.uid===p.stream_id);A?A._trust_in_room_=!0:(A=new j6(p.stream_id,p.stream_id),this._users.push(A),this.getListeners(mI.PUBLISHED_USER_LIST).length===0&&(_a.debug("[".concat(this._clientId,"] user online"),p.stream_id),V_("info",this,"user-joined",{uid:p.stream_id}),this.emit(mI.USER_JOINED,A)));const y=XI.Audio&p.stream_type,g=(XI.Video|XI.LwoVideo)&p.stream_type,b=y&&A.hasAudio,I=g&&A.hasVideo;p.stream_type!==XI.Nothing&&(A._trust_stream_added_state_=!0),g&&(A._video_added_=!0,A._videoSSRC=p.video_ssrc),y&&(A._audio_added_=!0,A._audioSSRC=p.audio_ssrc),y&&!b&&this.getListeners(mI.PUBLISHED_USER_LIST).length===0&&(_a.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published audio")),H0("info",this,"remote user ".concat(A.uid," published audio")),this.emit(mI.USER_PUBLISHED,A,"audio")),g&&!I&&this.getListeners(mI.PUBLISHED_USER_LIST).length===0&&(_a.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published video")),H0("info",this,"remote user ".concat(A.uid," published video")),this.emit(mI.USER_PUBLISHED,A,"video")),(y&&!b||g&&!I)&&l.push(A),g&&this._p2pChannel.hasPendingRemoteMedia(A,"video")&&d.push({user:A,mediaType:"video"}),y&&this._p2pChannel.hasPendingRemoteMedia(A,"audio")&&d.push({user:A,mediaType:"audio"})}d.length>0&&(_a.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(d.map(p=>"user: ".concat(p.user.uid,", mediaType: ").concat(p.mediaType)).join("; ")," ")),this.massSubscribe(d).catch(p=>{_a.error("[".concat(this._clientId,"] mass resubscribe error"),p.toString())})),this.getListeners(mI.PUBLISHED_USER_LIST).length>0?(_a.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(l.map(p=>p.uid).join(", "))),this.emit(mI.PUBLISHED_USER_LIST,l)):_a.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(l.map(p=>p.uid).join(", ")))})}_handleP2PChannelEvents(){this._p2pChannel.on(TI.RequestMuteLocal,async(e,l,d)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),l()}catch(p){p.code===_f.DISCONNECT_P2P?l():d(p)}else l()}),this._p2pChannel.on(TI.RequestUnmuteLocal,async(e,l,d)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),l()}catch(p){p.code===_f.DISCONNECT_P2P?l():d(p)}else l()}),this._p2pChannel.on(TI.RequestRePublish,(e,l,d)=>{this.publish(e,!1).then(l).catch(d)}),this._p2pChannel.on(TI.RequestReSubscribe,async(e,l,d)=>{try{for(const{user:p,kind:A}of e)A===AI.VIDEO?await this.subscribe(p,"video"):await this.subscribe(p,"audio");l()}catch(p){d(p)}}),this._p2pChannel.on(TI.RequestUploadStats,(e,l)=>{this._gateway.uploadStats(e,l)}),this._p2pChannel.on(TI.MediaReconnectStart,e=>{this.emit(mI.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(TI.MediaReconnectEnd,e=>{this.emit(mI.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(TI.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(TI.RequestRestartICE,async()=>{const e=await this._p2pChannel.reEstablish();if(e){const{restartICEResponse:l,gatewayIP:d,gatewayPort:p}=await this._gateway.restartICE({iceParameters:e.iceParameters}),{candidates:A,iceParameters:y}=function(g,b,I){const k=g.ice;let B;return b!==void 0&&I!==void 0?(B=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:b,port:I.toString(),type:"host",extension:{}}],_a.debug("Using remote candidate from AP ".concat(b,":").concat(I)),H0("debug",[],"Using remote candidate from AP ".concat(b,":").concat(I))):B=k.candidates.map(q=>({foundation:q.foundation,componentId:"1",transport:q.protocol,priority:q.priority.toString(),connectionAddress:q.ip,port:q.port.toString(),type:q.type,extension:{}})),{candidates:B,iceParameters:{iceUfrag:k.iceUfrag,icePwd:k.icePwd}}}(l,d,p);await e.restartICE(y,A)}}),this._p2pChannel.on(TI.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(TI.RequestReconnectPC,async()=>{var e;const{iceParameters:l,dtlsParameters:d,rtpCapabilities:p}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:A,gatewayIP:y,gatewayPort:g}=await this._gateway.reconnectPC({iceParameters:l,dtlsParameters:d,rtpCapabilities:p}),{dtlsParameters:b,iceParameters:I,candidates:k,rtpCapabilities:B,setup:q,cname:$}=g$(A,y,g);await this._p2pChannel.connect(I,b,k,B,q,$),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(TI.RequestUnpublishForReconnectPC,async(e,l,d)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),l()):d()}),this._p2pChannel.on(TI.P2PLost,()=>{this.emit(mI.P2P_LOST,this.store.uid)}),this._p2pChannel.on(TI.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(TI.ConnectionTypeChange,e=>{this.emit(mI.IS_USING_CLOUD_PROXY,e)})}getKeyMetrics(){return this.store.keyMetrics}getJoinChannelServiceRecords(){return _a.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}}).prototype,"setProxyServer",[Z$],Object.getOwnPropertyDescriptor(b1.prototype,"setProxyServer"),b1.prototype),X0(b1.prototype,"setTurnServer",[$$],Object.getOwnPropertyDescriptor(b1.prototype,"setTurnServer"),b1.prototype),X0(b1.prototype,"setLocalAccessPoints",[ttt],Object.getOwnPropertyDescriptor(b1.prototype,"setLocalAccessPoints"),b1.prototype),X0(b1.prototype,"setRemoteDefaultVideoStreamType",[ett],Object.getOwnPropertyDescriptor(b1.prototype,"setRemoteDefaultVideoStreamType"),b1.prototype),X0(b1.prototype,"setEncryptionConfig",[ntt],Object.getOwnPropertyDescriptor(b1.prototype,"setEncryptionConfig"),b1.prototype),X0(b1.prototype,"pickSVCLayer",[rtt],Object.getOwnPropertyDescriptor(b1.prototype,"pickSVCLayer"),b1.prototype),X0(b1.prototype,"getJoinChannelServiceRecords",[itt],Object.getOwnPropertyDescriptor(b1.prototype,"getJoinChannelServiceRecords"),b1.prototype),ott=b1))||ott);class ryt extends QW{set currentState(l){l!==this._currentState&&(this._currentState=l,this.emit(p_.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),_s(this,"audioBuffer",void 0),_s(this,"sourceNode",void 0),_s(this,"startPlayTime",0),_s(this,"startPlayOffset",0),_s(this,"pausePlayTime",0),_s(this,"options",void 0),_s(this,"currentLoopCount",0),_s(this,"_currentState","stopped"),this.audioBuffer=l,this.options=d,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(l){this.currentState==="stopped"?(this.options=l,this.startPlayOffset=this.options.startPlayTime||0):_a.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(l){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=l,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=l))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const l=this.context.createBufferSource();return l.buffer=this.audioBuffer,l.loop=!!this.options.loop,l.connect(this.outputNode),l}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const att=new Map;async function iyt(e,l){let d=null;if(typeof e=="string"){const A=att.get(e);if(A)return _a.debug("use cached audio resource: ",e),A;try{d=(await Q_(()=>lS.get(e,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(y){throw new _E(_f.FETCH_AUDIO_FILE_FAILED,y.toString())}}else d=await new Y0((y,g)=>{const b=new FileReader;b.onload=I=>{I.target?y(I.target.result):g(new _E(_f.READ_LOCAL_AUDIO_FILE_ERROR))},b.onerror=()=>{g(new _E(_f.READ_LOCAL_AUDIO_FILE_ERROR))},b.readAsArrayBuffer(e)});const p=await function(A){const y=xO();return new Y0((g,b)=>{y.decodeAudioData(A,I=>{g(I)},I=>{b(new _E(_f.DECODE_AUDIO_FILE_FAILED,I.toString()))})})}(d);return typeof e=="string"&&l&&att.set(e,p),p}function ctt(e,l){var d=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);l&&(p=p.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),d.push.apply(d,p)}return d}function n3(e){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?ctt(Object(d),!0).forEach(function(p){_s(e,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(d)):ctt(Object(d)).forEach(function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(d,p))})}return e}function d8(e,l,d,p){d.optimizationMode&&(p&&p.width&&p.height?(d.encoderConfig=n3(n3({},p),{},{bitrateMin:p.bitrateMin,bitrateMax:p.bitrateMax}),d.optimizationMode!=="motion"&&d.optimizationMode!=="detail"||(l.contentHint=d.optimizationMode,l.contentHint===d.optimizationMode?(_a.debug("[".concat(e,"] set content hint to"),d.optimizationMode),Z0("debug",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,d,p])):(_a.debug("[".concat(e,"] set content hint failed")),Z0("warning",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,d,p],"failed")))):(_a.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")),H0("warning",["AgoraRTC"],"[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig"))))}const oyt=MI().name;function syt(e,l,d,p){let A,y=0,g=null;return new Y0((b,I)=>{setTimeout(()=>{A&&(A(),b(y))},l),A=Y5(()=>{(function(){y>p&&A&&(A(),b(y));const k=d.getContext("2d");if(!k){const $=new _E(_f.UNEXPECTED_ERROR,"can not get canvas 2d context.");return _a.error($.toString()),void I($)}k.drawImage(e,0,0,160,120);const B=k.getImageData(0,0,d.width,d.height),q=Math.floor(B.data.length/3);if(g){for(let $=0;$<q;$+=3)if(B.data[$]!==g[$])return y+=1,void(g=B.data);g=B.data}else g=B.data})()},30)})}class oN{constructor(l,d){_s(this,"id",0),_s(this,"element",void 0),_s(this,"peerPair",void 0),_s(this,"context",void 0),_s(this,"audioPlayerElement",void 0),_s(this,"audioTrack",void 0),oN.count+=1,this.id=oN.count,this.element=l,this.context=d}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=l=>{const d=document.createElement("audio");d.srcObject=new MediaStream([l.track]),d.play(),this.audioPlayerElement=d}}async switchSdp(){if(!this.peerPair)return;const l=async(p,A)=>{const y=A==="offer"?await p.createOffer():await p.createAnswer();return await p.setLocalDescription(y),p.iceGatheringState==="complete"?p.localDescription:new Y0(g=>{p.onicegatheringstatechange=()=>{p.iceGatheringState==="complete"&&g(p.localDescription)}})},d=async(p,A)=>await p.setRemoteDescription(A);try{const p=await l(this.peerPair[0],"offer");await d(this.peerPair[1],p);const A=await l(this.peerPair[1],"answer");await d(this.peerPair[0],A)}catch(p){throw new _E(_f.LOCAL_AEC_ERROR,p.toString()).print()}}async getTracksFromMediaElement(l){if(this.audioTrack)return this.audioTrack;let d;try{l instanceof HTMLVideoElement&&(l.captureStream?l.captureStream():l.mozCaptureStream()),d=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(l).connect(d)}catch(A){throw new _E(_f.LOCAL_AEC_ERROR,A.toString()).print()}if(!d)throw new _E(_f.LOCAL_AEC_ERROR,"no dest node when local aec").print();const p=d.stream.getAudioTracks()[0];return this.audioTrack=p,p}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const l=this.element,d=await this.getTracksFromMediaElement(l);this.peerPair&&this.peerPair[0].addTrack(d),await this.switchSdp()}close(){_a.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(l=>{l.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var utt,r3;_s(oN,"count",0);const ayt=window.AudioContext||window.webkitAudioContext,cyt=new(utt=E2({report:_0}),X0((r3=class{constructor(){_s(this,"units",[]),_s(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return _a.debug("the system does not need to process local aec"),-1;this.context||(this.context=new ayt);let l=this.units.find(d=>d&&d.getElement()===e);return l||(l=new oN(e,this.context),this.units.push(l)),l.startEchoCancellation(),_a.debug("start processing local audio echo cancellation, id is",l.id),l.id}_doesEnvironmentNeedAEC(){return MI().name!==DI.SAFARI}}).prototype,"processExternalMediaAEC",[utt],Object.getOwnPropertyDescriptor(r3.prototype,"processExternalMediaAEC"),r3.prototype),r3);H1("PROCESS_ID","process-".concat(i1(8,""),"-").concat(i1(4,""),"-").concat(i1(4,""),"-").concat(i1(4,""),"-").concat(i1(12,""))),function(){const e=MI();$1.getDisplayMedia=function(l){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),$1.getStreamFromExtension=e.name===DI.CHROME&&Number(e.version)>34,$1.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const l=new RTCPeerConnection;let d=!1;try{l.addTransceiver("audio"),d=!0}catch{}return l.close(),d}(),$1.supportMinBitrate=e.name===DI.CHROME||e.name===DI.EDGE,$1.supportSetRtpSenderParameters=function(){const l=MI();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!e2()||!(!y_()&&!BL())||l.name===DI.FIREFOX&&Number(l.version)>=64}(),e.name===DI.SAFARI&&(Number(e.version)>=14?$1.supportDualStream=!0:$1.supportDualStream=!1),$1.webAudioMediaStreamDest=function(){const l=MI();return!(l.name===DI.SAFARI&&Number(l.version)<12)}(),$1.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),$1.supportWebGL=typeof WebGLRenderingContext!="undefined",$1.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,e2()||($1.webAudioWithAEC=!0),$1.supportShareAudio=function(){const l=MI();return(l.os===C1.WIN_10||l.os===C1.WIN_81||l.os===C1.WIN_7||l.os===C1.LINUX||l.os===C1.MAC_OS)&&l.name===DI.CHROME&&Number(l.version)>=74}(),$1.supportDualStreamEncoding=function(){const l=MI();return l.name==="Safari"&&Number(l.version)>=14}(),_a.info("browser compatibility",JSON.stringify($1),JSON.stringify(e)),b0("info",[],"updateAgoraRTCCompatibility",{browserCompatibility:$1,browserInfo:e})}(),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(l){return void _a.error("Error loading sdk config",l.message)}if(e)try{const l=JSON.parse(window.atob(e)),d=Date.now();_a.debug("Loading global parameters from cache",l),b0("debug",[],"loadConfigFromLocalStorage",l),Object.keys(l).forEach(p=>{if(Object.prototype.hasOwnProperty.call(a_,p)){const{value:A,expires:y}=l[p];if(y&&y<=d)return;U4[p]=A,a_[p]=A}})}catch(l){_a.error("Error loading mutableParamsCache: ".concat(e),l.message)}}();const rR={__CLIENT_LIST__:a2,__TRACK_LIST__:TO,VERSION:s_,BUILD:$L,setParameter:H1,getParameter:y0,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let l=new RTCPeerConnection;l.addTransceiver("video",{direction:"recvonly"}),l.addTransceiver("audio",{direction:"recvonly"});const d=(await l.createOffer()).sdp;if(!d)return e;l.close(),l=null,e=function(p){const A={video:[],audio:[]};return p.match(/ VP8/i)&&A.video.push("VP8"),p.match(/ VP9/i)&&A.video.push("VP9"),p.match(/ AV1/i)&&A.video.push("AV1"),p.match(/ H264/i)&&A.video.push("H264"),p.match(/ opus/i)&&A.audio.push("OPUS"),p.match(/ PCMU/i)&&A.audio.push("PCMU"),p.match(/ PCMA/i)&&A.audio.push("PCMA"),p.match(/ G722/i)&&A.audio.push("G722"),A}(d)}catch(l){throw new _E(_f.CREATE_OFFER_FAILED,l.toString&&l.toString()).print()}return e},checkSystemRequirements:function(){const e=_0.reportApiInvoke(null,{name:$0.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:z0.TRACER});let l=!1;try{const y=window.RTCPeerConnection,g=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,b=window.WebSocket;l=!!(y&&g&&b)}catch(y){return _a.error("check system requirement failed: ",y),!1}let d=!1;const p=MI();p.name===DI.CHROME&&Number(p.version)>=58&&(!aAt()||sAt())&&(d=!0),p.name===DI.FIREFOX&&Number(p.version)>=56&&(d=!0),p.name===DI.OPERA&&Number(p.version)>=45&&(d=!0),p.name===DI.SAFARI&&Number(p.version)>=11&&(d=!0),($H()||MI().name===DI.QQ)&&(d=!0),_a.debug("checkSystemRequirements, api:",l,"browser",d);const A=l&&d;return e.onSuccess(A),A},getDevices:function(e){return E_.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return E_.getRecordingDevices(e)},getCameras:function(e){return E_.getCamerasDevices(e)},getElectronScreenSources:qW,getPlaybackDevices:function(e){return E_.getSpeakers(e)},createClient:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const l=_0.reportApiInvoke(null,{name:$0.CREATE_CLIENT,options:[e],tag:z0.TRACER});try{bgt(e)}catch(d){throw l.onError(d),d}return e.audioCodec===void 0&&(e.audioCodec="opus"),l.onSuccess(),new nyt(iN(iN({forceWaitGatewayResponse:!0},e),{},{role:e.mode==="rtc"?"host":e.role}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{encoderConfig:"480p_1"};const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_CAM_VIDEO_TRACK,options:[n3({},e)]}),d=U6(e),p=i1(8,"track-cam-");let A=null;_a.info("start create camera video track with config",JSON.stringify(e),"trackId",p),Z0("info",["AgoraRTC"],"createCameraVideoTrack",e);try{A=(await _C({video:d},p)).getVideoTracks()[0]||null}catch(g){throw l.onError(g),g}if(!A){const g=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(g),g.throw()}e.optimizationMode&&d8(p,A,e,e.encoderConfig&&o2(e.encoderConfig));const y=new PZ(A,e,d,e.scalabiltyMode?tP(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,p);return l.onSuccess(y.getTrackId()),_a.info("create camera video success, trackId:",p),Z0("info",["AgoraRTC"],"createCameraVideoTrack",void 0,p),y},createCustomVideoTrack:function(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),d=new A1(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?tP(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return l.onSuccess(d.getTrackId()),_a.info("create custom video track success with config",e,"trackId",d.getTrackId()),Z0("info",["AgoraRTC"],"createCustomVideoTrack",e,d.getTrackId()),d},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_SCREEN_VIDEO_TRACK,options:[n3({},e),l]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const p=D1t(e),A=i1(8,"track-scr");let y=null,g=null;const b=t_();if(!b.supportShareAudio&&l==="enable"){const B=new _E(_f.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return d.onError(B),B.throw()}_a.info("start create screen video track with config",e,"withAudio",l,"trackId",A),Z0("info",["AgoraRTC"],"createScreenVideoTrack",[e,l]);try{const B=await _C({screen:p,screenAudio:l==="auto"?b.supportShareAudio:l==="enable"},A);y=B.getVideoTracks()[0]||null,g=B.getAudioTracks()[0]||null}catch(B){throw d.onError(B),B}if(!y){const B=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return d.onError(B),B.throw()}if(!g&&l==="enable"){y&&y.stop();const B=new _E(_f.SHARE_AUDIO_NOT_ALLOWED);return d.onError(B),B.throw()}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(d8(A,y,e,e.encoderConfig&&M4(e.encoderConfig)),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const I=new A1(y,e.encoderConfig?M4(e.encoderConfig):{},e.scalabiltyMode?tP(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,A,[F1.SCREEN_TRACK]);if(!g)return d.onSuccess(I.getTrackId()),_a.info("create screen video track success","video:",I.getTrackId()),Z0("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:I.getTrackId()}),I;const k=new D1(g);return d.onSuccess([I.getTrackId(),k.getTrackId()]),_a.info("create screen video track success","video:",I.getTrackId(),"audio:",k.getTrackId()),Z0("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:I.getTrackId(),audioTrack:k.getTrackId()}),[I,k]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{encoderConfig:"480p_1"};const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_MIC_AND_CAM_TRACKS,options:[e,l]}),p=U6(l),A=lZ(e),y=i1(8,"track-mic-"),g=i1(8,"track-cam-");let b=null,I=null;_a.info("start create camera video track(".concat(g,") and microphone audio track(").concat(y,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(l))),Z0("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",{videoConfig:l,audioConfig:e});try{const q=await _C({audio:A,video:p},"".concat(y,"-").concat(g));b=q.getAudioTracks()[0],I=q.getVideoTracks()[0]}catch(q){throw d.onError(q),q}if(!b||!I){const q=new _E(_f.UNEXPECTED_ERROR,"can not find tracks in media stream");return d.onError(q),q.throw()}l.optimizationMode&&d8(g,I,l,l.encoderConfig&&o2(l.encoderConfig));const k=new MO(b,e,A,y),B=new PZ(I,l,p,l.scalabiltyMode?tP(l.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},l.optimizationMode,g);return d.onSuccess([k.getTrackId(),B.getTrackId()]),_a.info("create camera video track(".concat(g,") and microphone audio track(").concat(y,") success")),Z0("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",void 0,{videoTrackId:g,audioTrackId:y}),[k,B]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_MIC_AUDIO_TRACK,options:[e]}),d=lZ(e),p=i1(8,"track-mic-");let A=null;_a.info("start create microphone audio track with config",JSON.stringify(e),"trackId",p),Z0("info",["AgoraRTC"],"createMicrophoneAudioTrack",e);try{A=(await _C({audio:d},p)).getAudioTracks()[0]||null}catch(g){throw l.onError(g),g}if(!A){const g=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(g),g.throw()}const y=new MO(A,e,d,p);return l.onSuccess(y.getTrackId()),_a.info("create microphone audio track success, trackId:",p),Z0("info",["AgoraRTC"],"createMicrophoneAudioTrack",e,p),y},createCustomAudioTrack:function(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),d=new D1(e.mediaStreamTrack,e.encoderConfig?eP(e.encoderConfig):{});return _a.info("create custom audio track success with config",e,"trackId",d.getTrackId()),Z0("info",["AgoraRTC"],"createCustomAudioTrack",e,d.getTrackId()),l.onSuccess(d.getTrackId()),d},createBufferSourceAudioTrack:async function(e){const l=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CREATE_BUFFER_AUDIO_TRACK,options:[e]}),d=i1(8,"track-buf-");_a.info("start create buffer source audio track with config",JSON.stringify(e),"trackId",d),Z0("info",[],"createBufferSourceAudioTrack",e);const p=e.source;if(!(e.source instanceof AudioBuffer))try{e.source=await iyt(e.source,e.cacheOnlineFile)}catch(g){return l.onError(g),g.throw()}const A=new ryt(e.source),y=new s0t(p,A,e.encoderConfig?eP(e.encoderConfig):{},d);return _a.info("create buffer source audio track success, trackId:",d),Z0("info",["AgoraRTC"],"createBufferSourceAudioTrack",void 0,d),l.onSuccess(y.getTrackId()),y},setLogLevel:function(e){y0("USE_NEW_LOG")?function(l){l=Math.min(Math.max(0,l),4),TK=l}(e):_a.setLogLevel(e)},enableLogUpload:function(){y0("USE_NEW_LOG")?H1("UPLOAD_LOG",!0):_a.enableLogUpload()},disableLogUpload:function(){y0("USE_NEW_LOG")?H1("UPLOAD_LOG",!1):_a.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new tZ},checkAudioTrackIsActive:async function(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[l]});if(!(e instanceof D1||e instanceof t3)){const I=new _E(_f.INVALID_TRACK,"the parameter is not a audio track");return d.onError(I),I.throw()}l&&l<1e3&&(l=1e3);const p=e instanceof D1?e.getTrackLabel():"remote_track",A=e.getVolumeLevel();let y=A,g=A;const b=Date.now();return new Y0(I=>{const k=setInterval(()=>{const B=e.getVolumeLevel();y=B>y?B:y,g=B<g?B:g;const q=y-g>1e-4,$=Date.now()-b;if(q||$>l){clearInterval(k);const _t=q,_r={duration:$,deviceLabel:p,maxVolumeLevel:y,result:_t};_a.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(_r))),d.onSuccess(_r),I(_t)}},200)})},checkVideoTrackIsActive:async function(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const d=_0.reportApiInvoke(null,{tag:z0.TRACER,name:$0.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[l]});if(!(e instanceof A1||e instanceof _B)){const $=new _E(_f.INVALID_TRACK,"the parameter is not a video track");return d.onError($),$.throw()}const p=4;l&&l<1e3&&(l=1e3);const A=e instanceof A1?e.getTrackLabel():"remote_track",y=e.getMediaStreamTrack(!0),g=document.createElement("video");g.style.width="1px",g.style.height="1px",g.setAttribute("muted",""),g.muted=!0,g.setAttribute("playsinline",""),g.controls=!1,(y_()||BL())&&(g.style.opacity="0.01",g.style.position="fixed",g.style.left="0",g.style.top="0",document.body.appendChild(g)),g.srcObject=new MediaStream([y]),g.play();const b=document.createElement("canvas");b.width=160,b.height=120;let I=0,k=0;try{const $=Date.now();I=await syt(g,l,b,p),k=Date.now()-$}catch($){throw d.onError($),$}oyt===DI.SAFARI&&(g.pause(),g.remove()),g.srcObject=null;const B=I>p,q={duration:k,changedPicNum:I,deviceLabel:A,result:B};return _a.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(q))),d.onSuccess(q),B},setArea:function(e){const l=_0.reportApiInvoke(null,{name:$0.SET_AREA,options:e,tag:z0.TRACER});try{let d=[];if(typeof e=="string"&&(d=[e]),Array.isArray(e)&&(e.forEach(A=>{if(!wgt.includes(A))throw new _E(_f.INVALID_PARAMS,"invalid area code")}),d=e),Object.prototype.toString.call(e)==="[object Object]"){const{areaCode:A,excludedArea:y}=e;if(!A)throw new _E(_f.INVALID_PARAMS,"area code is needed");let g=A;typeof A=="string"&&(g=[A]),d=y?s1t(g,y):g}H1("AREAS",d);const p=(A=>{const y={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return A.map(g=>{const b=n5[g],I=Object.keys(b);I&&I.map(k=>{k!=="CODE"&&(y[k]=y[k].concat(b[k]))})}),y})(d);Object.keys(p).map(A=>{A==="LOG_UPLOAD_SERVER"||A==="EVENT_REPORT_DOMAIN"||A==="EVENT_REPORT_BACKUP_DOMAIN"||A==="PROXY_SERVER_TYPE3"?H1(A,p[A][0]):H1(A,p[A])}),_a.debug("set area success:",d.join(","))}catch(d){throw l.onError(d),d}l.onSuccess()},loadModule:async function(e,l){if(_a.debug("loadModule: ".concat(e.name,", loadOption: ").concat(JSON.stringify(l))),!e.moduleInit)throw _a.debug("Invalid Plugin"),new _E(_f.INVALID_PLUGIN,"invalid plugin");try{vP.installPlugin(e),await e.moduleInit({logger:_a,report:_0,pluginCenter:vP,getParameter:y0},l)}catch(d){throw new _E(_f.UNEXPECTED_ERROR,"unexpected error in loadModule",d)}},audioElementPlayCenter:m_,processExternalMediaAEC:function(e){cyt.processExternalMediaAEC(e)},registerExtensions:function(e){e.forEach(l=>{const d=l;d.__registered__=!0,d.logger.hookLog=_a.extLog,d.reporter.hookApiInvoke=_0.extApiInvoke,d.parameters&&Object.keys(d.parameters).forEach(p=>{d.parameters[p]=y0(p)})})},ChannelMediaRelayError:ER,ChannelMediaRelayEvent:dS,ChannelMediaRelayState:Z1,RemoteStreamFallbackType:e5,RemoteStreamType:t5,ConnectionDisconnectedReason:I1,AudienceLatencyLevelType:W4,AREAS:RI};return Object.defineProperties(rR,{onAudioAutoplayFailed:{get:()=>w_.onAudioAutoplayFailed,set:e=>{w_.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>w_.onAutoplayFailed,set:e=>{w_.onAutoplayFailed=e}}}),E_.on(HS.CAMERA_DEVICE_CHANGED,e=>{_a.info("camera device changed",JSON.stringify(e)),rR.onCameraChanged&&rR.onCameraChanged(e)}),E_.on(HS.RECORDING_DEVICE_CHANGED,e=>{_a.info("microphone device changed",JSON.stringify(e)),rR.onMicrophoneChanged&&rR.onMicrophoneChanged(e)}),E_.on(HS.PLAYOUT_DEVICE_CHANGED,e=>{_a.debug("playout device changed",JSON.stringify(e)),rR.onPlaybackDeviceChanged&&rR.onPlaybackDeviceChanged(e)}),m_.onAutoplayFailed=()=>{_a.info("detect audio element autoplay failed"),w_.onAudioAutoplayFailed&&w_.onAudioAutoplayFailed()},bI.on("autoplay-failed",()=>{_a.info("detect webaudio autoplay failed"),w_.onAudioAutoplayFailed&&w_.onAudioAutoplayFailed()}),window&&(window.__ARTC__=rR),rR})})(AgoraRTC_NProduction);var AgoraRTC__default=getDefaultExportFromCjs(AgoraRTC_NProduction.exports);function _objectWithoutPropertiesLoose(o,i){if(o==null)return{};var s={},h=Object.keys(o),f,_;for(_=0;_<h.length;_++)f=h[_],!(i.indexOf(f)>=0)&&(s[f]=o[f]);return s}var AgoraRTCErrorCode;(function(o){o.UNEXPECTED_ERROR="UNEXPECTED_ERROR",o.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",o.TIMEOUT="TIMEOUT",o.INVALID_PARAMS="INVALID_PARAMS",o.NOT_SUPPORTED="NOT_SUPPORTED",o.INVALID_OPERATION="INVALID_OPERATION",o.OPERATION_ABORTED="OPERATION_ABORTED",o.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",o.NETWORK_ERROR="NETWORK_ERROR",o.NETWORK_TIMEOUT="NETWORK_TIMEOUT",o.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",o.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",o.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",o.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",o.ELECTRON_IS_NULL="ELECTRON_IS_NULL",o.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",o.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",o.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",o.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",o.PERMISSION_DENIED="PERMISSION_DENIED",o.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",o.TRACK_IS_DISABLED="TRACK_IS_DISABLED",o.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",o.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",o.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",o.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",o.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",o.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",o.UID_CONFLICT="UID_CONFLICT",o.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",o.INVALID_TRACK="INVALID_TRACK",o.SENDER_NOT_FOUND="SENDER_NOT_FOUND",o.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",o.SET_ANSWER_FAILED="SET_ANSWER_FAILED",o.ICE_FAILED="ICE_FAILED",o.PC_CLOSED="PC_CLOSED",o.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",o.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",o.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",o.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",o.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",o.INVALID_REMOTE_USER="INVALID_REMOTE_USER",o.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",o.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",o.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",o.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",o.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",o.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",o.WS_ABORT="WS_ABORT",o.WS_DISCONNECT="WS_DISCONNECT",o.WS_ERR="WS_ERR",o.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",o.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",o.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",o.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",o.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",o.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",o.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",o.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",o.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",o.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",o.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",o.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",o.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",o.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",o.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",o.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",o.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",o.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"})(AgoraRTCErrorCode||(AgoraRTCErrorCode={}));var createClient=function(i){var s;function h(){return s||(s=AgoraRTC__default.createClient(i)),s}return function(){return h()}};function createMicrophoneAndCameraTracks(o,i){var s=function(){try{return Promise.resolve(AgoraRTC__default.createMicrophoneAndCameraTracks(o,i)).then(function(_){return h=_,h})}catch(_){return Promise.reject(_)}},h=null;return function(){var _=react.exports.useState(!1),w=_[0],j=_[1],F=react.exports.useState(null),K=F[0],_e=F[1],_o=react.exports.useRef(h);return react.exports.useEffect(function(){return _o.current===null?s().then(function(ca){_o.current=ca,j(!0)},function(ca){_e(ca)}):j(!0),function(){h=null}},[]),{ready:w,tracks:_o.current,error:K}}}var AgoraVideoPlayer=function(i){var s=react.exports.useRef(null),h=i.videoTrack,f=i.config,_=_objectWithoutPropertiesLoose(i,["videoTrack","config"]);return react.exports.useLayoutEffect(function(){return s.current!==null&&h.play(s.current,f),function(){h.stop()}},[h]),jsx("div",ptt({},Object.assign({},_,{ref:s})))},agoraRtmSdk={exports:{}};/*
 @preserve
 AgoraRTM Web SDK 1.4.5 - commit: v1.4.5-0-g9cf39592
 Copyright (C) 2018-2022 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(module,exports){(function(o,i){module.exports=i()})(commonjsGlobal,function(){function oe(o,i){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(o);i&&(h=h.filter(function(f){return Object.getOwnPropertyDescriptor(o,f).enumerable})),s.push.apply(s,h)}return s}function wa(o){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?oe(Object(s),!0).forEach(function(h){m(o,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):oe(Object(s)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(s,h))})}return o}function V(o){return(V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}function um(o,i,s,h,f,_,w){try{var j=o[_](w),F=j.value}catch(K){return void s(K)}j.done?i(F):Promise.resolve(F).then(h,f)}function J(o){return function(){var i=this,s=arguments;return new Promise(function(h,f){function _(F){um(j,h,f,_,w,"next",F)}function w(F){um(j,h,f,_,w,"throw",F)}var j=o.apply(i,s);_(void 0)})}}function X(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function vm(o,i){for(var s=0;s<i.length;s++){var h=i[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function Ia(o,i,s){return i&&vm(o.prototype,i),s&&vm(o,s),o}function m(o,i,s){return i in o?Object.defineProperty(o,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[i]=s,o}function ja(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),i&&wf(o,i)}function Fd(o){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)})(o)}function wf(o,i){return(wf=Object.setPrototypeOf||function(s,h){return s.__proto__=h,s})(o,i)}function wm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(o,i,s){return(wi=wm()?Reflect.construct:function(h,f,_){var w=[null];return w.push.apply(w,f),h=new(Function.bind.apply(h,w)),_&&wf(h,_.prototype),h}).apply(null,arguments)}function xf(o){var i=typeof Map=="function"?new Map:void 0;return(xf=function(s){function h(){return wi(s,arguments,Fd(this).constructor)}if(s===null||Function.toString.call(s).indexOf("[native code]")===-1)return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(i!==void 0){if(i.has(s))return i.get(s);i.set(s,h)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),wf(h,s)})(o)}function yf(o,i){if(o==null)return{};if(o==null)var s={};else{s={};var h,f=Object.keys(o);for(h=0;h<f.length;h++){var _=f[h];0<=i.indexOf(_)||(s[_]=o[_])}}if(Object.getOwnPropertySymbols)for(h=Object.getOwnPropertySymbols(o),_=0;_<h.length;_++)f=h[_],0<=i.indexOf(f)||Object.prototype.propertyIsEnumerable.call(o,f)&&(s[f]=o[f]);return s}function n(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function ka(o){var i=wm();return function(){var s=Fd(o);if(i){var h=Fd(this).constructor;s=Reflect.construct(s,arguments,h)}else s=s.apply(this,arguments);return s=!s||typeof s!="object"&&typeof s!="function"?n(this):s}}function xi(o,i,s){return(xi=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(h,f,_){for(;!Object.prototype.hasOwnProperty.call(h,f)&&(h=Fd(h))!==null;);if(h)return(f=Object.getOwnPropertyDescriptor(h,f)).get?f.get.call(_):f.value})(o,i,s||o)}function ua(o,i){var s=Array.isArray(o)?o:void 0;if(!s)if((s=o&&(typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"]))==null)s=void 0;else{var h,f=[],_=!0,w=!1;try{for(s=s.call(o);!(_=(h=s.next()).done)&&(f.push(h.value),!i||f.length!==i);_=!0);}catch(F){w=!0;var j=F}finally{try{_||s.return==null||s.return()}finally{if(w)throw j}}s=f}if(!(o=s||xm(o,i)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return o}function G(o){var i=Array.isArray(o)?yi(o):void 0;if(i||(i=typeof Symbol!="undefined"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null?Array.from(o):void 0),!(o=i||xm(o)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return o}function xm(o,i){if(o){if(typeof o=="string")return yi(o,i);var s=Object.prototype.toString.call(o).slice(8,-1);if(s==="Object"&&o.constructor&&(s=o.constructor.name),s==="Map"||s==="Set")return Array.from(o);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return yi(o,i)}}function yi(o,i){(i==null||i>o.length)&&(i=o.length);for(var s=0,h=Array(i);s<i;s++)h[s]=o[s];return h}function la(o,i,s,h,f){var _={};return Object.keys(h).forEach(function(w){_[w]=h[w]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=s.slice().reverse().reduce(function(w,j){return j(o,i,w)||w},_),f&&_.initializer!==void 0&&(_.value=_.initializer?_.initializer.call(f):void 0,_.initializer=void 0),_.initializer===void 0&&(Object.defineProperty(o,i,_),_=null),_}function cb(o){var i={exports:{}};return o(i,i.exports),i.exports}function pe(o){o||(o={});var i=o.ua;if(i||typeof navigator=="undefined"||(i=navigator.userAgent),i&&i.headers&&typeof i.headers["user-agent"]=="string"&&(i=i.headers["user-agent"]),typeof i!="string")return!1;var s=iu.test(i)&&!ju.test(i)||!!o.tablet&&ku.test(i);return!s&&o.tablet&&o.featureDetect&&navigator&&1<navigator.maxTouchPoints&&i.indexOf("Macintosh")!==-1&&i.indexOf("Safari")!==-1&&(s=!0),s}function ym(o,i){var s,h=3>arguments.length?o:arguments[2];return sa(o)===h?o[i]:(s=Jb.f(o,i))?Q(s,"value")?s.value:s.get===void 0?void 0:s.get.call(h):ha(s=ac(o))?ym(s,i,h):void 0}function lu(o){var i=o.charCodeAt(0)<<24,s=0|mu(~i),h=0,f=0|o.length,_="";if(5>s&&f>=s){for(i=i<<s>>>24+s,h=1;h<s;h=h+1|0)i=i<<6|63&o.charCodeAt(h);65535>=i?_+=Gd(i):1114111>=i?_+=Gd(55296+((i=i-65536|0)>>10)|0,56320+(1023&i)|0):h=0}for(;h<f;h=h+1|0)_+="\uFFFD";return _}function zm(){}function nu(o){var i=0|o.charCodeAt(0);if(55296<=i&&56319>=i){var s=0|o.charCodeAt(1);if(!(s==s&&56320<=s&&57343>=s))return Gd(239,191,189);if(65535<(i=(i-55296<<10)+s-56320+65536|0))return Gd(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)}return 127>=i?o:2047>=i?Gd(192|i>>>6,128|63&i):Gd(224|i>>>12,128|i>>>6&63,128|63&i)}function Am(){}function ia(){ia.init.call(this)}function Kg(o){if(typeof o!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+V(o))}function Bm(o,i,s,h){Kg(s);var f=o._events;if(f===void 0)f=o._events=Object.create(null),o._eventsCount=0;else{f.newListener!==void 0&&(o.emit("newListener",i,s.listener?s.listener:s),f=o._events);var _=f[i]}return _===void 0?(f[i]=s,++o._eventsCount):(typeof _=="function"?_=f[i]=h?[s,_]:[_,s]:h?_.unshift(s):_.push(s),0<(s=o._maxListeners===void 0?ia.defaultMaxListeners:o._maxListeners)&&_.length>s&&!_.warned&&(_.warned=!0,(s=Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",s.emitter=o,s.type=i,s.count=_.length,console&&console.warn&&console.warn(s))),o}function ou(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Cm(o,i,s){return o={fired:!1,wrapFn:void 0,target:o,type:i,listener:s},(i=ou.bind(o)).listener=s,o.wrapFn=i}function Dm(o,i,s){if((o=o._events)===void 0)return[];if((i=o[i])===void 0)return[];if(typeof i=="function")return s?[i.listener||i]:[i];if(s)for(s=Array(i.length),o=0;o<s.length;++o)s[o]=i[o].listener||i[o];else s=Em(i,i.length);return s}function Fm(o){var i=this._events;if(i!==void 0){if(typeof(o=i[o])=="function")return 1;if(o!==void 0)return o.length}return 0}function Em(o,i){for(var s=Array(i),h=0;h<i;++h)s[h]=o[h];return s}function pu(o,i,s){typeof o.on=="function"&&Gm(o,"error",i,s)}function Gm(o,i,s,h){if(typeof o.on=="function")h.once?o.once(i,s):o.on(i,s);else{if(typeof o.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+V(o));o.addEventListener(i,function f(_){h.once&&o.removeEventListener(i,f),s(_)})}}function qu(o){return o?G(o):ru(function(){return[]},function(i,s){return i.push(s),i})}function Hm(o,i){var s,h,f,_;return x.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:s=Im(o)([Jm,Jm,function(j,F){return F}])[2],h=0;case 2:if(!(h<i.length)){w.next=17;break}if(f=i[h],!((_=s(zi,f))instanceof Lg)){w.next=11;break}if((_=Ai(_.deref()))===zi){w.next=10;break}return w.next=10,_;case 10:return w.abrupt("return");case 11:if(_===zi){w.next=14;break}return w.next=14,_;case 14:h++,w.next=2;break;case 17:case"end":return w.stop()}},su)}function Mg(o,i){return i!=null&&typeof i[Symbol.iterator]=="function"?Hm(Mg(o),i):function(s){var h=s[2];return tu(s,function(f,_){return h(f,o(_))})}}function Jc(o){return Object.prototype.toString.call(o).slice(8,-1)}function Hd(o){return Jc(o)==="Object"&&o.constructor===Object&&Object.getPrototypeOf(o)===Object.prototype}function Km(o){var i;return(i=Jc(o)==="Boolean"||Jc(o)==="Null"||Jc(o)==="Undefined")||(i=Jc(o)==="Number"&&!isNaN(o)),i||Jc(o)==="String"||Jc(o)==="Symbol"}function Id(o){var i=-1,s=o==null?0:o.length;for(this.clear();++i<s;){var h=o[i];this.set(h[0],h[1])}}function qe(o){var i=-1,s=o==null?0:o.length;for(this.clear();++i<s;){var h=o[i];this.set(h[0],h[1])}}function re(o){var i=-1,s=o==null?0:o.length;for(this.clear();++i<s;){var h=o[i];this.set(h[0],h[1])}}function zf(o){var i=-1,s=o==null?0:o.length;for(this.__data__=new Ng;++i<s;)this.add(o[i])}function se(o){this.size=(this.__data__=new Og(o)).size}function te(o,i,s,h,f,_){var w,j=1&i,F=2&i,K=4&i;if(s&&(w=f?s(o,h,f,_):s(o)),w!==void 0)return w;if(!ob(o))return o;if(h=Za(o)){if(w=uu(o),!j)return Bi(o,w)}else{var _e=Af(o),_o=_e=="[object Function]"||_e=="[object GeneratorFunction]";if(Bf(o))return Lm(o,j);if(_e=="[object Object]"||_e=="[object Arguments]"||_o&&!f){if(w=F||_o?{}:Mm(o),!j)return F?vu(o,wu(w,o)):xu(o,yu(w,o))}else{if(!xa[_e])return f?o:{};w=zu(o,_e,j)}}if(_||(_=new ue),f=_.get(o))return f;_.set(o,w),Au(o)?o.forEach(function(_c){w.add(te(_c,i,s,_c,o,_))}):Bu(o)&&o.forEach(function(_c,ch){w.set(ch,te(_c,i,s,ch,o,_))}),F=K?F?Nm:Ci:F?Cf:Jd;var ca=h?void 0:F(o);return Cu(ca||o,function(_c,ch){ca&&(_c=o[ch=_c]),Om(w,ch,te(_c,i,s,ch,o,_))}),w}function Di(o,i){if(typeof o!="function"||i!=null&&typeof i!="function")throw new TypeError("Expected a function");var s=function h(){var f=arguments,_=i?i.apply(this,f):f[0],w=h.cache;return w.has(_)?w.get(_):(f=o.apply(this,f),h.cache=w.set(_,f)||w,f)};return s.cache=new(Di.Cache||Ng),s}function Pm(o){if(typeof o=="string")return o;if(Za(o))return ve(o,Pm)+"";if(we(o))return Qm?Qm.call(o):"";var i=o+"";return i=="0"&&1/o==-Du?"-0":i}function Ei(o,i,s,h,f){var _=-1,w=o.length;for(s||(s=Eu),f||(f=[]);++_<w;){var j=o[_];0<i&&s(j)?1<i?Ei(j,i-1,s,h,f):Fi(f,j):h||(f[f.length]=j)}return f}function xe(o,i,s,h,f){if(o===i)i=!0;else if(o==null||i==null||!oc(o)&&!oc(i))i=o!=o&&i!=i;else t:{var _=Za(o),w=Za(i),j=_?"[object Array]":Af(o),F=w?"[object Array]":Af(i),K=(j=j=="[object Arguments]"?"[object Object]":j)=="[object Object]";if(w=(F=F=="[object Arguments]"?"[object Object]":F)=="[object Object]",(F=j==F)&&Bf(o)){if(!Bf(i)){i=!1;break t}_=!0,K=!1}if(F&&!K)f||(f=new ue),i=_||Gi(o)?Rm(o,i,s,h,xe,f):Fu(o,i,j,s,h,xe,f);else{if(!(1&s)&&(_=K&&Sm.call(o,"__wrapped__"),j=w&&Sm.call(i,"__wrapped__"),_||j)){o=_?o.value():o,i=j?i.value():i,f||(f=new ue),i=xe(o,i,s,h,f);break t}if(F)e:if(f||(f=new ue),_=1&s,j=Ci(o),w=j.length,F=Ci(i).length,w==F||_){for(F=w;F--;){var _e=j[F];if(!(_?_e in i:Gu.call(i,_e))){i=!1;break e}}if(K=f.get(o),_e=f.get(i),K&&_e)i=K==i&&_e==o;else{K=!0,f.set(o,i),f.set(i,o);for(var _o=_;++F<w;){var ca=o[_e=j[F]],_c=i[_e];if(h)var ch=_?h(_c,ca,_e,i,o,f):h(ca,_c,_e,o,i,f);if(ch===void 0?ca!==_c&&!xe(ca,_c,s,h,f):!ch){K=!1;break}_o||(_o=_e=="constructor")}K&&!_o&&(s=o.constructor)!=(h=i.constructor)&&"constructor"in o&&"constructor"in i&&!(typeof s=="function"&&s instanceof s&&typeof h=="function"&&h instanceof h)&&(K=!1),f.delete(o),f.delete(i),i=K}}else i=!1;else i=!1}}return i}function ya(o,i,s){this.low=0|o,this.high=0|i,this.unsigned=!!s}function pb(o){return(o&&o.__isLong__)===!0}function Kd(o,i){var s;if(i){if((i=0<=(o>>>=0)&&256>o)&&(s=Tm[o]))return s;s=za(o,0>(0|o)?-1:0,!0),i&&(Tm[o]=s)}else{if((i=-128<=(o|=0)&&128>o)&&(s=Um[o]))return s;s=za(o,0>o?-1:0,!1),i&&(Um[o]=s)}return s}function Kb(o,i){if(isNaN(o))return i?Ld:Lb;if(i){if(0>o)return Ld;if(o>=Vm)return Wm}else{if(o<=-Xm)return qb;if(o+1>=Xm)return Ym}return 0>o?Kb(-o,i).neg():za(o%ye|0,o/ye|0,i)}function za(o,i,s){return new ya(o,i,s)}function Hi(o,i,s){if(o.length===0)throw Error("empty string");if(o==="NaN"||o==="Infinity"||o==="+Infinity"||o==="-Infinity")return Lb;if(typeof i=="number"?(s=i,i=!1):i=!!i,2>(s=s||10)||36<s)throw RangeError("radix");var h;if(0<(h=o.indexOf("-")))throw Error("interior hyphen");if(h===0)return Hi(o.substring(1),i,s).neg();h=Kb(Pg(s,8));for(var f=Lb,_=0;_<o.length;_+=8){var w=Math.min(8,o.length-_),j=parseInt(o.substring(_,_+w),s);8>w?(w=Kb(Pg(s,w)),f=f.mul(w).add(Kb(j))):f=(f=f.mul(h)).add(Kb(j))}return f.unsigned=i,f}function bc(o,i){return typeof o=="number"?Kb(o,i):typeof o=="string"?Hi(o,i):za(o.low,o.high,typeof i=="boolean"?i:o.unsigned)}function O(o,i){function s(){this.constructor=o}Ii(o,i),o.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}function ze(o){return typeof o=="function"}function Ae(o){setTimeout(function(){throw o},0)}function Ji(o){return o!==null&&V(o)==="object"}function Zm(o){return o.reduce(function(i,s){return i.concat(s instanceof Df?s.errors:s)},[])}function Ki(o){for(;o;){var i=o.destination,s=o.isStopped;if(o.closed||s)return!1;o=i&&i instanceof ma?i:null}return!0}function ed(o){return o}function Li(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return $m(o)}function $m(o){return o.length===0?ed:o.length===1?o[0]:function(i){return o.reduce(function(s,h){return h(s)},i)}}function an(o){if(o||(o=Mb.Promise||Promise),!o)throw Error("no Promise impl found");return o}function bn(){return function(o){return o.lift(new Hu(o))}}function Ef(o){return o?Iu(o):yb}function Iu(o){return new Y(function(i){return o.schedule(function(){return i.complete()})})}function fd(o){return o&&typeof o.schedule=="function"}function Mi(o,i){return new Y(function(s){var h=new Ta,f=0;return h.add(i.schedule(function(){f===o.length?s.complete():(s.next(o[f++]),s.closed||h.add(this.schedule()))})),h})}function Ff(o,i){return i?Mi(o,i):new Y(cn(o))}function eb(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return fd(i=o[o.length-1])?(o.pop(),Mi(o,i)):Ff(o)}function Z(o,i){return new Y(i?function(s){return i.schedule(Ju,0,{error:o,subscriber:s})}:function(s){return s.error(o)})}function Ju(o){o.subscriber.error(o.error)}function Ku(o,i){return i===void 0&&(i=0),function(s){return s.lift(new Lu(o,i))}}function dn(o){return o in Ni&&(delete Ni[o],!0)}function pc(){}function ea(o,i){return function(s){if(typeof o!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return s.lift(new Mu(o,i))}}function en(o,i,s){if(i){if(!fd(i))return function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];return en(o,s).apply(void 0,h).pipe(ea(function(_){return Nb(_)?i.apply(void 0,_):i(_)}))};s=i}return function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];var _,w=this,j={context:w,subject:_,callbackFunc:o,scheduler:s};return new Y(function(F){if(s)return s.schedule(Nu,0,{args:h,subscriber:F,params:j});if(!_){_=new Gf;try{o.apply(w,h.concat([function(){for(var K=[],_e=0;_e<arguments.length;_e++)K[_e]=arguments[_e];_.next(1>=K.length?K[0]:K),_.complete()}]))}catch(K){Ki(_)?_.error(K):console.warn(K)}}return _.subscribe(F)})}}function Nu(o){var i=this,s=o.args,h=o.subscriber,f=o.params;o=f.callbackFunc;var _=f.context,w=f.scheduler,j=f.subject;if(!j){j=f.subject=new Gf,f=function(){for(var F=[],K=0;K<arguments.length;K++)F[K]=arguments[K];i.add(w.schedule(Ou,0,{value:1>=F.length?F[0]:F,subject:j}))};try{o.apply(_,s.concat([f]))}catch(F){j.error(F)}}this.add(j.subscribe(h))}function Ou(o){var i=o.subject;i.next(o.value),i.complete()}function fn(o,i,s){if(i){if(!fd(i))return function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];return fn(o,s).apply(void 0,h).pipe(ea(function(_){return Nb(_)?i.apply(void 0,_):i(_)}))};s=i}return function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];var _={subject:void 0,args:h,callbackFunc:o,scheduler:s,context:this};return new Y(function(w){var j=_.context,F=_.subject;if(s)return s.schedule(Pu,0,{params:_,subscriber:w,context:j});if(!F){F=_.subject=new Gf;try{o.apply(j,h.concat([function(){for(var K=[],_e=0;_e<arguments.length;_e++)K[_e]=arguments[_e];(_e=K.shift())?F.error(_e):(F.next(1>=K.length?K[0]:K),F.complete())}]))}catch(K){Ki(F)?F.error(K):console.warn(K)}}return F.subscribe(w)})}}function Pu(o){var i=this,s=o.params,h=o.subscriber;o=o.context;var f=s.callbackFunc,_=s.args,w=s.scheduler,j=s.subject;if(!j){j=s.subject=new Gf,s=function(){for(var F=[],K=0;K<arguments.length;K++)F[K]=arguments[K];(K=F.shift())?i.add(w.schedule(gn,0,{err:K,subject:j})):i.add(w.schedule(Qu,0,{value:1>=F.length?F[0]:F,subject:j}))};try{f.apply(o,_.concat([s]))}catch(F){this.add(w.schedule(gn,0,{err:F,subject:j}))}}this.add(j.subscribe(h))}function Qu(o){var i=o.subject;i.next(o.value),i.complete()}function gn(o){o.subject.error(o.err)}function hn(o){return!!o&&typeof o.subscribe!="function"&&typeof o.then=="function"}function Oi(o,i,s,h,f){if(f===void 0&&(f=new Ru(o,s,h)),!f.closed)return i instanceof Y?i.subscribe(f):Hf(i)(f)}function Su(o,i){return new Y(function(s){var h=new Ta;return h.add(i.schedule(function(){var f=o[Be]();h.add(f.subscribe({next:function(_){h.add(i.schedule(function(){return s.next(_)}))},error:function(_){h.add(i.schedule(function(){return s.error(_)}))},complete:function(){h.add(i.schedule(function(){return s.complete()}))}}))})),h})}function Tu(o,i){return new Y(function(s){var h=new Ta;return h.add(i.schedule(function(){return o.then(function(f){h.add(i.schedule(function(){s.next(f),h.add(i.schedule(function(){return s.complete()}))}))},function(f){h.add(i.schedule(function(){return s.error(f)}))})})),h})}function Uu(o,i){if(!o)throw Error("Iterable cannot be null");return new Y(function(s){var h,f=new Ta;return f.add(function(){h&&typeof h.return=="function"&&h.return()}),f.add(i.schedule(function(){h=o[gd](),f.add(i.schedule(function(){if(!s.closed){try{var _=h.next(),w=_.value,j=_.done}catch(F){return void s.error(F)}j?s.complete():(s.next(w),this.schedule())}}))})),f})}function jn(o,i){if(o!=null){if(o&&typeof o[Be]=="function")return Su(o,i);if(hn(o))return Tu(o,i);if(kn(o))return Mi(o,i);if(o&&typeof o[gd]=="function"||typeof o=="string")return Uu(o,i)}throw new TypeError((o!==null&&V(o)||o)+" is not observable")}function Ob(o,i){return i?jn(o,i):o instanceof Y?o:new Y(Hf(o))}function qc(o,i){if(!i.closed){if(o instanceof Y)return o.subscribe(i);try{var s=Hf(o)(i)}catch(h){i.error(h)}return s}}function fb(o,i,s){return s===void 0&&(s=Number.POSITIVE_INFINITY),typeof i=="function"?function(h){return h.pipe(fb(function(f,_){return Ob(o(f,_)).pipe(ea(function(w,j){return i(f,w,_,j)}))},s))}:(typeof i=="number"&&(s=i),function(h){return h.lift(new Vu(o,s))})}function Qg(o){return o===void 0&&(o=Number.POSITIVE_INFINITY),fb(ed,o)}function ln(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return Qg(1)(eb.apply(void 0,o))}function hd(o){return new Y(function(i){try{var s=o()}catch(h){return void i.error(h)}return(s?Ob(s):Ef()).subscribe(i)})}function mn(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===1){var s=o[0];if(Nb(s))return Rg(s,null);if(Ji(s)&&Object.getPrototypeOf(s)===Object.prototype)return Rg((o=Object.keys(s)).map(function(f){return s[f]}),o)}if(typeof o[o.length-1]=="function"){var h=o.pop();return Rg(o=o.length===1&&Nb(o[0])?o[0]:o,null).pipe(ea(function(f){return h.apply(void 0,f)}))}return Rg(o,null)}function Rg(o,i){return new Y(function(s){var h=o.length;if(h===0)s.complete();else for(var f=Array(h),_=0,w=0,j=function(K){var _e=Ob(o[K]),_o=!1;s.add(_e.subscribe({next:function(ca){_o||(_o=!0,w++),f[K]=ca},error:function(ca){return s.error(ca)},complete:function(){++_!==h&&_o||(w===h&&s.next(i?i.reduce(function(ca,_c,ch){return ca[_c]=f[ch],ca},{}):f),s.complete())}}))},F=0;F<h;F++)j(F)})}function jb(o,i,s,h){return ze(s)&&(h=s,s=void 0),h?jb(o,i,s).pipe(ea(function(f){return Nb(f)?h.apply(void 0,f):h(f)})):new Y(function(f){nn(o,i,function(_){1<arguments.length?f.next(Array.prototype.slice.call(arguments)):f.next(_)},f,s)})}function nn(o,i,s,h,f){if(o&&typeof o.addEventListener=="function"&&typeof o.removeEventListener=="function"){o.addEventListener(i,s,f);var _=function(){return o.removeEventListener(i,s,f)}}else if(o&&typeof o.on=="function"&&typeof o.off=="function")o.on(i,s),_=function(){return o.off(i,s)};else if(o&&typeof o.addListener=="function"&&typeof o.removeListener=="function")o.addListener(i,s),_=function(){return o.removeListener(i,s)};else{if(!o||!o.length)throw new TypeError("Invalid event target");for(var w=0,j=o.length;w<j;w++)nn(o[w],i,s,h,f)}h.add(_)}function on(o,i,s){return s?on(o,i).pipe(ea(function(h){return Nb(h)?s.apply(void 0,h):s(h)})):new Y(function(h){var f=function(){for(var w=[],j=0;j<arguments.length;j++)w[j]=arguments[j];return h.next(w.length===1?w[0]:w)};try{var _=o(f)}catch(w){return void h.error(w)}if(ze(i))return function(){return i(f,_)}})}function Wu(o){var i=o.subscriber,s=o.condition;if(!i.closed){if(o.needIterate)try{o.state=o.iterate(o.state)}catch(_){return void i.error(_)}else o.needIterate=!0;if(s){var h=void 0;try{h=s(o.state)}catch(_){return void i.error(_)}if(!h)return void i.complete();if(i.closed)return}try{var f=o.resultSelector(o.state)}catch(_){return void i.error(_)}if(!i.closed&&(i.next(f),!i.closed))return this.schedule(o)}}function Pi(o){return!Nb(o)&&0<=o-parseFloat(o)+1}function pn(o,i){return o===void 0&&(o=0),i===void 0&&(i=id),(!Pi(o)||0>o)&&(o=0),i&&typeof i.schedule=="function"||(i=id),new Y(function(s){return s.add(i.schedule(Xu,o,{subscriber:s,counter:0,period:o})),s})}function Xu(o){var i=o.subscriber,s=o.counter;o=o.period,i.next(s),this.schedule({subscriber:i,counter:s+1,period:o},o)}function cc(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];i=Number.POSITIVE_INFINITY;var s=null,h=o[o.length-1];return fd(h)?(s=o.pop(),1<o.length&&typeof o[o.length-1]=="number"&&(i=o.pop())):typeof h=="number"&&(i=o.pop()),s===null&&o.length===1&&o[0]instanceof Y?o[0]:Qg(i)(Ff(o,s))}function Qi(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===0)return yb;var s=o[0],h=o.slice(1);return o.length===1&&Nb(s)?Qi.apply(void 0,s):new Y(function(f){var _=function(){return f.add(Qi.apply(void 0,h).subscribe(f))};return Ob(s).subscribe({next:function(w){f.next(w)},error:_,complete:_})})}function Yu(o){var i=o.keys,s=o.index,h=o.subscriber,f=o.subscription;if(o=o.obj,!h.closed)if(s<i.length){var _=i[s];h.next([_,o[_]]),f.add(this.schedule({keys:i,index:s+1,subscriber:h,subscription:f,obj:o}))}else h.complete()}function Zu(o,i){function s(){return!s.pred.apply(s.thisArg,arguments)}return s.pred=o,s.thisArg=i,s}function zb(o,i){return function(s){return s.lift(new $u(o,i))}}function Da(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===1){if(!Nb(o[0]))return o[0];o=o[0]}return Ff(o,void 0).lift(new av)}function bv(o){var i=o.start,s=o.index,h=o.subscriber;s>=o.count?h.complete():(h.next(i),h.closed||(o.index=s+1,o.start=i+1,this.schedule(o)))}function Kc(o,i,s){o===void 0&&(o=0);var h=-1;return Pi(i)?h=1>Number(i)?1:Number(i):fd(i)&&(s=i),fd(s)||(s=id),new Y(function(f){var _=Pi(o)?o:+o-s.now();return s.schedule(cv,_,{index:0,period:h,subscriber:f})})}function cv(o){var i=o.index,s=o.period,h=o.subscriber;if(h.next(i),!h.closed){if(s===-1)return h.complete();o.index=i+1,this.schedule(o,s)}}function Ri(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return typeof(i=o[o.length-1])=="function"&&o.pop(),Ff(o,void 0).lift(new dv(i))}function Ja(o){return function(i){var s=new ev(o);return i=i.lift(s),s.caught=i}}function Si(o,i){return fb(o,i,1)}function qn(o){return o===void 0&&(o=null),function(i){return i.lift(new fv(o))}}function jd(o,i){i===void 0&&(i=id);var s=o instanceof Date&&!isNaN(+o)?+o-i.now():Math.abs(o);return function(h){return h.lift(new gv(s,i))}}function rn(o,i){return function(s){return s.lift(new hv(o,i))}}function Md(o){return o===void 0&&(o=iv),function(i){return i.lift(new jv(o))}}function iv(){return new Sg}function Pa(o){return function(i){return o===0?Ef():i.lift(new kv(o))}}function sn(o,i){return i?function(s){return s.pipe(sn(function(h,f){return Ob(o(h,f)).pipe(ea(function(_,w){return i(h,_,f,w)}))}))}:function(s){return s.lift(new lv(o))}}function Tg(o){return function(i){return i.lift(new mv(o))}}function aa(o,i){var s=2<=arguments.length;return function(h){return h.pipe(o?zb(function(f,_){return o(f,_,h)}):ed,Pa(1),s?qn(i):Md(function(){return new Sg}))}}function nv(){return function(o){return o.lift(new ov)}}function tn(o){return function(i){return o===0?Ef():i.lift(new pv(o))}}function If(o){return function(i){return i.lift(new qv(o))}}function Ug(o,i){var s=!1;return 2<=arguments.length&&(s=!0),function(h){return h.lift(new rv(o,i,s))}}function un(o,i){return 2<=arguments.length?function(s){return Li(Ug(o,i),tn(1),qn(i))(s)}:function(s){return Li(Ug(function(h,f,_){return o(h,f,_+1)}),tn(1))(s)}}function sv(o,i){return function(s){var h=typeof o=="function"?o:function(){return o};if(typeof i=="function")return s.lift(new tv(h,i));var f=Object.create(s,uv);return f.source=s,f.subjectFactory=h,f}}function Ce(o){return function(i){return i.lift(new vv(o,i))}}function wv(){return new Ua}function De(){return function(o){return bn()(sv(wv)(o))}}function vn(o,i,s){var h=o&&V(o)==="object"?o:{bufferSize:o,windowTime:i,refCount:!1,scheduler:s};return function(f){return f.lift(xv(h))}}function xv(o){var i,s,h=o.bufferSize,f=h===void 0?Number.POSITIVE_INFINITY:h,_=(h=o.windowTime)===void 0?Number.POSITIVE_INFINITY:h,w=o.refCount,j=o.scheduler,F=0,K=!1,_e=!1;return function(_o){if(F++,!i||K){K=!1;var ca=(i=new Ee(f,_,j)).subscribe(this);s=_o.subscribe({next:function(_c){i.next(_c)},error:function(_c){K=!0,i.error(_c)},complete:function(){_e=!0,s=void 0,i.complete()}}),_e&&(s=void 0)}else ca=i.subscribe(this);this.add(function(){F--,ca.unsubscribe(),ca=void 0,s&&!_e&&w&&F===0&&(s.unsubscribe(),i=s=void 0)})}}function Lc(o,i){return typeof i=="function"?function(s){return s.pipe(Lc(function(h,f){return Ob(o(h,f)).pipe(ea(function(_,w){return i(h,_,f,w)}))}))}:function(s){return s.lift(new yv(o))}}function rb(o){return function(i){return i.lift(new zv(o))}}function Av(o,i){return i===void 0&&(i=!1),function(s){return s.lift(new Bv(o,i))}}function ba(o,i,s){return function(h){return h.lift(new Cv(o,i,s))}}function Dv(o,i,s){return i===void 0&&(i=id),s===void 0&&(s=Ev),function(h){return h.lift(new Fv(o,i,s.leading,s.trailing))}}function Gv(o){o.subscriber.clearThrottle()}function Hv(o,i,s){return s===void 0&&(s=id),function(h){var f=o instanceof Date&&!isNaN(+o),_=f?+o-s.now():Math.abs(o);return h.lift(new Iv(_,f,i,s))}}function kb(o,i){return i===void 0&&(i=id),Hv(o,Z(new sb),i)}function Jv(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return function(s){var h;return typeof o[o.length-1]=="function"&&(h=o.pop()),s.lift(new Kv(o,h))}}function wn(o){(Ti||o)&&(xn.abort(),o&&(xn=new AbortController),Ti=o)}function yn(o,i,s,h,f){o!==i&&zn(i,function(_,w){if(f||(f=new ue),ob(_)){_=f;var j=Ui(o,w),F=Ui(i,w),K=_.get(F);if(K)Vi(o,w,K);else{var _e=(K=h?h(j,F,w+"",o,i,_):void 0)===void 0;if(_e){var _o=Za(F),ca=!_o&&Bf(F),_c=!_o&&!ca&&Gi(F);K=F,_o||ca||_c?Za(j)?K=j:oc(j)&&Nd(j)?K=Bi(j):ca?(_e=!1,K=Lm(F,!0)):_c?(_e=!1,K=An(F,!0)):K=[]:Bn(F)||Jf(F)?(K=j,Jf(j)?K=Fe(j,Cf(j)):ob(j)&&!Wi(j)||(K=Mm(F))):_e=!1}_e&&(_.set(F,K),yn(K,F,s,h,_),_.delete(F)),Vi(o,w,K)}}else(j=h?h(Ui(o,w),_,w+"",o,i,f):void 0)===void 0&&(j=_),Vi(o,w,j)},Cf)}function Lv(o){var i=1,s=Xi;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?i=1>=arguments.length?void 0:arguments[1]:s=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(i=1>=arguments.length?void 0:arguments[1],s=2>=arguments.length?void 0:arguments[2]);var h=i||1;return function(f){return f.pipe(Ug(function(_,w){var j=s.now(),F=j-o;if((_=_.filter(function(_o){return _o.until>F})).length>=h){var K=_[_.length-1],_e=_[0].until+o*Math.floor(_.length/h);_.push({delay:K.until<j?_e-j:_e-K.until,until:_e,value:w})}else _.push({delay:0,until:j,value:w});return _},[]),ea(function(_){return _[_.length-1]}),Si(function(_){var w=eb(_.value);return _.delay?w.pipe(jd(_.delay,s)):w}))}}function Mv(o,i){var s=(i=i===void 0?{protocols:Cn,makeWebSocket:Dn}:i).protocols,h=s===void 0?Cn:s,f=(i=i.makeWebSocket)===void 0?Dn:i;return new Y(function(_){var w,j=new Ua,F=f(o,h),K=!1,_e=!1,_o=!1,ca=function(_c){if(w)throw K=!0,_c=Error("Web socket message factory function called more than once"),_.error(_c),_c;return w=_c.subscribe(function(ch){F.send(ch)}),j};return F.onopen=function(){_o=!0,_e?(K=!0,F.close()):_.next(ca)},F.onmessage=function(_c){j.next(_c.data)},F.onerror=function(_c){K=!0,_.error(Error(_c.message))},F.onclose=function(_c){K||(K=!0,_e?(_.complete(),j.complete()):_.error(Error(_c.code===1e3?"Normal closure":_c.reason)))},function(){_e=!0,w&&w.unsubscribe(),K||(K=!0,_o&&F.close())}})}function Vg(){this._listeners={}}function En(o){return typeof Float32Array!="undefined"?function(){function i(F,K,_e){_[0]=F,K[_e]=w[0],K[_e+1]=w[1],K[_e+2]=w[2],K[_e+3]=w[3]}function s(F,K,_e){_[0]=F,K[_e]=w[3],K[_e+1]=w[2],K[_e+2]=w[1],K[_e+3]=w[0]}function h(F,K){return w[0]=F[K],w[1]=F[K+1],w[2]=F[K+2],w[3]=F[K+3],_[0]}function f(F,K){return w[3]=F[K],w[2]=F[K+1],w[1]=F[K+2],w[0]=F[K+3],_[0]}var _=new Float32Array([-0]),w=new Uint8Array(_.buffer),j=w[3]===128;o.writeFloatLE=j?i:s,o.writeFloatBE=j?s:i,o.readFloatLE=j?h:f,o.readFloatBE=j?f:h}():function(){function i(h,f,_,w){var j=0>f?1:0;if(j&&(f=-f),f===0)h(0<1/f?0:2147483648,_,w);else if(isNaN(f))h(2143289344,_,w);else if(34028234663852886e22<f)h((j<<31|2139095040)>>>0,_,w);else if(11754943508222875e-54>f)h((j<<31|Math.round(f/1401298464324817e-60))>>>0,_,w);else{var F=Math.floor(Math.log(f)/Math.LN2);h((j<<31|F+127<<23|8388607&Math.round(f*Math.pow(2,-F)*8388608))>>>0,_,w)}}function s(h,f,_){return _=h(f,_),h=2*(_>>31)+1,f=_>>>23&255,_&=8388607,f===255?_?NaN:1/0*h:f===0?1401298464324817e-60*h*_:h*Math.pow(2,f-150)*(_+8388608)}o.writeFloatLE=i.bind(null,Fn),o.writeFloatBE=i.bind(null,Gn),o.readFloatLE=s.bind(null,Hn),o.readFloatBE=s.bind(null,In)}(),typeof Float64Array!="undefined"?function(){function i(F,K,_e){_[0]=F,K[_e]=w[0],K[_e+1]=w[1],K[_e+2]=w[2],K[_e+3]=w[3],K[_e+4]=w[4],K[_e+5]=w[5],K[_e+6]=w[6],K[_e+7]=w[7]}function s(F,K,_e){_[0]=F,K[_e]=w[7],K[_e+1]=w[6],K[_e+2]=w[5],K[_e+3]=w[4],K[_e+4]=w[3],K[_e+5]=w[2],K[_e+6]=w[1],K[_e+7]=w[0]}function h(F,K){return w[0]=F[K],w[1]=F[K+1],w[2]=F[K+2],w[3]=F[K+3],w[4]=F[K+4],w[5]=F[K+5],w[6]=F[K+6],w[7]=F[K+7],_[0]}function f(F,K){return w[7]=F[K],w[6]=F[K+1],w[5]=F[K+2],w[4]=F[K+3],w[3]=F[K+4],w[2]=F[K+5],w[1]=F[K+6],w[0]=F[K+7],_[0]}var _=new Float64Array([-0]),w=new Uint8Array(_.buffer),j=w[7]===128;o.writeDoubleLE=j?i:s,o.writeDoubleBE=j?s:i,o.readDoubleLE=j?h:f,o.readDoubleBE=j?f:h}():function(){function i(h,f,_,w,j,F){var K=0>w?1:0;if(K&&(w=-w),w===0)h(0,j,F+f),h(0<1/w?0:2147483648,j,F+_);else if(isNaN(w))h(0,j,F+f),h(2146959360,j,F+_);else if(17976931348623157e292<w)h(0,j,F+f),h((K<<31|2146435072)>>>0,j,F+_);else if(22250738585072014e-324>w)h((w/=5e-324)>>>0,j,F+f),h((K<<31|w/4294967296)>>>0,j,F+_);else{var _e=Math.floor(Math.log(w)/Math.LN2);_e===1024&&(_e=1023),h(4503599627370496*(w*=Math.pow(2,-_e))>>>0,j,F+f),h((K<<31|_e+1023<<20|1048576*w&1048575)>>>0,j,F+_)}}function s(h,f,_,w,j){return f=h(w,j+f),w=h(w,j+_),h=2*(w>>31)+1,f=4294967296*(1048575&w)+f,(_=w>>>20&2047)===2047?f?NaN:1/0*h:_===0?5e-324*h*f:h*Math.pow(2,_-1075)*(f+4503599627370496)}o.writeDoubleLE=i.bind(null,Fn,0,4),o.writeDoubleBE=i.bind(null,Gn,4,0),o.readDoubleLE=s.bind(null,Hn,0,4),o.readDoubleBE=s.bind(null,In,4,0)}(),o}function Fn(o,i,s){i[s]=255&o,i[s+1]=o>>>8&255,i[s+2]=o>>>16&255,i[s+3]=o>>>24}function Gn(o,i,s){i[s]=o>>>24,i[s+1]=o>>>16&255,i[s+2]=o>>>8&255,i[s+3]=255&o}function Hn(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16|o[i+3]<<24)>>>0}function In(o,i){return(o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3])>>>0}function $a(o,i){this.lo=o>>>0,this.hi=i>>>0}function Kf(o,i,s){this.fn=o,this.len=i,this.next=void 0,this.val=s}function Yi(){}function Nv(o){this.head=o.head,this.tail=o.tail,this.len=o.len,this.next=o.states}function na(){this.len=0,this.tail=this.head=new Kf(Yi,0,0),this.states=null}function Zi(o,i,s){i[s]=255&o}function $i(o,i){this.len=o,this.next=void 0,this.val=i}function aj(o,i,s){for(;o.hi;)i[s++]=127&o.lo|128,o.lo=(o.lo>>>7|o.hi<<25)>>>0,o.hi>>>=7;for(;127<o.lo;)i[s++]=127&o.lo|128,o.lo>>>=7;i[s++]=o.lo}function bj(o,i,s){i[s]=255&o,i[s+1]=o>>>8&255,i[s+2]=o>>>16&255,i[s+3]=o>>>24}function rc(){cj.call(this)}function Ov(o,i,s){40>o.length?W.utf8.write(o,i,s):i.utf8Write?i.utf8Write(o,s):i.write(o,s)}function dc(o,i){return RangeError("index out of range: "+o.pos+" + "+(i||1)+" > "+o.len)}function Qa(o){this.buf=o,this.pos=0,this.len=o.length}function dj(){var o=new Jn(0,0),i=0;if(!(4<this.len-this.pos)){for(;3>i;++i){if(this.pos>=this.len)throw dc(this);if(o.lo=(o.lo|(127&this.buf[this.pos])<<7*i)>>>0,128>this.buf[this.pos++])return o}return o.lo=(o.lo|(127&this.buf[this.pos++])<<7*i)>>>0,o}for(;4>i;++i)if(o.lo=(o.lo|(127&this.buf[this.pos])<<7*i)>>>0,128>this.buf[this.pos++])return o;if(o.lo=(o.lo|(127&this.buf[this.pos])<<28)>>>0,o.hi=(o.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return o;if(i=0,4<this.len-this.pos){for(;5>i;++i)if(o.hi=(o.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,128>this.buf[this.pos++])return o}else for(;5>i;++i){if(this.pos>=this.len)throw dc(this);if(o.hi=(o.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,128>this.buf[this.pos++])return o}throw Error("invalid varint encoding")}function Wg(o,i){return(o[i-4]|o[i-3]<<8|o[i-2]<<16|o[i-1]<<24)>>>0}function Kn(){if(this.pos+8>this.len)throw dc(this,8);return new Jn(Wg(this.buf,this.pos+=4),Wg(this.buf,this.pos+=4))}function Od(o){ej.call(this,o)}function Lf(o,i,s){if(typeof o!="function")throw TypeError("rpcImpl must be a function");W.EventEmitter.call(this),this.rpcImpl=o,this.requestDelimited=!!i,this.responseDelimited=!!s}function Aa(o){return typeof o=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(o)&&o!=="null"}function Ln(o){try{var i=o.split(".").map(function(h){return Number(h)})}catch{return!1}if(i.length!==4||i[0]===0)return!1;for(o=0;o<i.length;o++){var s=i[o];if(!Number.isInteger(s)||0>s||255<s)return!1}return!0}function Mn(o,i){if(!Array.isArray(i)||i.length===0||32<i.length||i.some(function(s){return s.length===0||32<s.length}))throw new H("arguments is not valid",Oa);if(!Aa(o))throw new H("ID is invalid",Oa)}function Mf(o){var i=o.attributes,s=o.attrSizeMap,h=o.maxAttrsCount,f=o.maxAttrValueSize;if(o=o.maxTotalSize,!Hd(i))throw new H("attributes must be an object",Oa);if(Object.keys(i).length>h)throw new lb("Exceed the limit of ".concat(h," attributes"),Ge);if(Object.keys(i).length===0)throw new H("The attributes is an empty object",Oa);var _=0,w=0;for(i=Object.entries(i);w<i.length;w++){var j=ua(i[w],2),F=j[1];j=new Blob([j[0]]).size;var K=new Blob([F]).size;if(j===0||32<j)throw new H("Invalid attribute key",Oa);if(K>f)throw new lb("Invalid attribute value, over the limit of ".concat(f," bytes"),Ge);if(typeof F!="string"||F.length===0)throw new H("Invalid attribute value",Oa);_+=j,_+=K}if(_>o)throw new lb("The attributes size overflow",Ge);if(s!==void 0){if(Object.keys(s).length>h)throw new lb("Exceed the limit of ".concat(h," attributes"),Ge);for(_=h=0,s=Object.entries(s);_<s.length;_++){if(w=(i=ua(s[_],2))[1],(i=new Blob([i[0]]).size)===0)throw new H("Invalid attribute key",Oa);if(w>f)throw new lb("Invalid attribute value, over the limit of ".concat(f," bytes"),Ge);h+=i,h+=w}if(h>o)throw new lb("The attributes size overflow",Ge)}}function Xg(o,i){return Math.floor(Math.random()*(Math.floor(i)-Math.ceil(o)+1))+o}function Yg(){var o=Xg(0,4294967295),i=Xg(1,4294967295);return new U(o,i,!0)}function ab(o){return o.toString().padEnd(32,"0")}function Nn(o,i){return new TypeError("Unexpected ".concat(o,": ").concat(i))}function On(o,i){return o=o.split(".").map(function(s){return Number(s)}),i=i.split(".").map(function(s){return Number(s)}),Math.sqrt(1e3*Math.pow(o[0]-i[0],2)+100*Math.pow(o[1]-i[1],2)+10*Math.pow(o[2]-i[2],2)+1*Math.pow(o[3]-i[3],2))}function Pn(o){return o.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?o.toNumber():o.toString()}function fj(o,i){i="".concat(o).concat(i||"");var s=Qn.get(i)||1;return Qn.set(i,s+1),"".concat(o).concat(s)}function Rn(o,i){var s=typeof i=="number"?i:i!==void 0&&typeof i!="string"?i.code:void 0;return i=typeof i!="number"&&typeof i!="string"&&i!==void 0&&i.serverCode!==void 0?i.serverCode:void 0,s="".concat(s!==void 0?" Error Code ".concat(s):"").concat(i!==void 0?", server Code ".concat(i):""),o=typeof o=="string"&&o?Zg(o):Array.isArray(o)&&typeof o[0]=="string"&&o[0]?Zg(Sn.apply(void 0,[o[0]].concat(G(o.slice(1))))):"","".concat(s===""?"":"".concat(s," - ")).concat(o)}function gj(o,i){return hj.apply(this,arguments)}function hj(){return(hj=J(x.mark(function o(i,s){return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!s||!s.aborted){h.next=2;break}return h.abrupt("return");case 2:return h.abrupt("return",new Promise(function(f){setTimeout(f,i),s==null||s.addEventListener("abort",f)}));case 3:case"end":return h.stop()}},o)}))).apply(this,arguments)}function Tn(o){return o instanceof Blob||Object.prototype.toString.call(o)==="[object Blob]"}function $g(o){var i=255&o,s=o>>8&255,h=o>>16&255;return"".concat(o>>24&255,".").concat(h,".").concat(s,".").concat(i)}function He(o,i,s){return ij.apply(this,arguments)}function ij(){return(ij=J(x.mark(function o(i,s,h){var f,_,w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0,R0,k0,G0,pI,u0,C0,v0,T0;return x.wrap(function(Qv){for(;;)switch(Qv.prev=Qv.next){case 0:if(f=s.body,_=s.headers,w=_===void 0?{}:_,j=s.timeout,F=j===void 0?1e4:j,K=s.signal,_e=s.withCredentials,_o=_e!==void 0&&_e,ca=(h||{}).useBinaryResponse,_c=ca!==void 0&&ca,(ch=new XMLHttpRequest).open("POST",i,!0),ch.responseType=_c?"arraybuffer":"text",ch.withCredentials=_o,ch.timeout=F,Nf=f instanceof FormData,bh=f instanceof Uint8Array,!(1<(_g=Object.keys(w).filter(function(r0){return r0.toLowerCase()==="content-type"})).length)){Qv.next=14;break}throw new RangeError("multiple content-type");case 14:_g.length===0&&(bh?w["Content-Type"]="application/octet-stream":Nf||(w["Content-Type"]="application/json"));case 15:if("setRequestHeader"in ch){Qv.next=46;break}return ch.abort(),Qv.next=19,fetch(i,{body:Nf||bh?f:JSON.stringify(f),cache:"no-cache",credentials:_o?"include":"same-origin",headers:w,method:"POST",mode:"cors",referrer:"no-referrer",signal:K});case 19:if(_v=Qv.sent,!(200<=(h0=_v.status)&&300>h0||h0===304)){Qv.next=31;break}if(!_c){Qv.next=27;break}return Qv.next=25,_v.arrayBuffer();case 25:return A0=Qv.sent,Qv.abrupt("return",{status:h0,responseData:A0});case 27:return Qv.next=29,_v.text();case 29:return M0=Qv.sent,Qv.abrupt("return",{status:h0,responseText:M0});case 31:return R0=new da(["Post XHR failure, status %d",h0]),Qv.prev=32,Qv.next=35,_v.text();case 35:throw k0=Qv.sent,R0.statusCode=h0,R0.message=k0||"Request failed, status ".concat(h0),R0;case 41:throw Qv.prev=41,Qv.t0=Qv.catch(32),R0.statusCode=h0,R0.message="Request failed, status ".concat(h0),R0;case 46:if(Object.keys(w).length!==0)for(G0=0,pI=Object.entries(w);G0<pI.length;G0++)u0=ua(pI[G0],2),C0=u0[0],v0=u0[1],ch.setRequestHeader(C0,v0);return K!==void 0&&(T0=function r0(){ch.abort(),K.removeEventListener("abort",r0)},K.addEventListener("abort",T0)),Nf||bh?ch.send(f):ch.send(JSON.stringify(f)),Qv.abrupt("return",new Promise(function(r0,a0){ch.onload=function(){var I0=ch.status;if(200<=I0&&300>I0||I0===304)r0(_c?{status:I0,responseData:ch.response}:{status:I0,responseText:ch.responseText});else{var O0=new da(["Post XHR failure, status %d",I0]);O0.statusCode=I0,O0.message=ch.response||"Request failed, status ".concat(ch.status),a0(O0)}},ch.ontimeout=function(I0){a0(new gb(["XHR request timed out after %d ms",F],{originalError:I0}))},ch.onerror=function(){var I0=new da(["Post XHR failure, status %d",ch.status]);I0.statusCode=ch.status,I0.message=ch.response||"Request failed, status ".concat(ch.status),a0(I0)},ch.onabort=function(){try{a0(new DOMException("The request aborted.","AbortError"))}catch{var I0=Error("The request aborted.");I0.name="AbortError",a0(I0)}}}));case 50:case"end":return Qv.stop()}},o,null,[[32,41]])}))).apply(this,arguments)}function Un(o){return nj.apply(this,arguments)}function nj(){return(nj=J(x.mark(function o(i){var s;return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return(s=new Image).src=i,h.abrupt("return",new Promise(function(f,_){s.onload=function(){f({width:s.width,height:s.height})},s.onerror=_}));case 3:case"end":return h.stop()}},o)}))).apply(this,arguments)}function Sv(o,i){return oj.apply(this,arguments)}function oj(){return(oj=J(x.mark(function o(i,s){var h,f,_,w,j,F,K,_e,_o,ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(h=i.thumbnailHeight,f=h===void 0?0:h,_=i.thumbnailWidth,w=_===void 0?0:_,j=i.width,F=j===void 0?0:j,K=i.height,_e=K===void 0?0:K,_o=i.thumbnail,ca=[],typeof f=="number"&&typeof w=="number"&&typeof F=="number"&&typeof _e=="number"){_c.next=5;break}throw new H("Invalid message params",Of);case 5:return 0>=F&&0>=_e&&ca.push(Un(Vn(s)).then(function(ch){F=ch.width,_e=ch.height})),0>=w&&0>=f&&_o!==void 0&&ca.push(pj(_o).then(function(){var ch=J(x.mark(function Nf(bh){var _g;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return _v.next=2,Un(Vn(bh));case 2:_g=_v.sent,w=_g.width,f=_g.height;case 5:case"end":return _v.stop()}},Nf)}));return function(Nf){return ch.apply(this,arguments)}}())),_c.next=9,Promise.all(ca).catch(function(){});case 9:return _c.abrupt("return",{width:F,height:_e,thumbnailWidth:w,thumbnailHeight:f});case 10:case"end":return _c.stop()}},o)}))).apply(this,arguments)}function Wn(o,i){if(!Hd(o))throw new H("message object is not a plain object",i);if(o.messageType===void 0)if(o.rawMessage instanceof Uint8Array){if(o.messageType="RAW",o.text!==void 0)throw new H("Raw messages cannot have text property. Use description instead",i)}else{if(typeof o.text!="string")throw new H("messageType is undefined",i);if(o.messageType="TEXT",o.rawMessage!==void 0)throw new H("Text messages cannot have rawMessage property",i)}}function dh(o){return qj.apply(this,arguments)}function qj(){return(qj=J(x.mark(function o(i){var s,h,f,_,w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0,R0;return x.wrap(function(k0){for(;;)switch(k0.prev=k0.next){case 0:if(s=i.message,h=i.peerId,f=i.toPeer,_=i.session,w=i.errorCodes,j=i.diff,F=i.logger,K=i.options,_!==void 0){k0.next=3;break}throw new L("The client is not logged in. Cannot do the operation",w.NOT_LOGGED_IN);case 3:if(_e=!1,s.messageType!=="TEXT"||!s.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!f){k0.next=11;break}if(_o=s.text.split("_"),ca=ua(_o,3),_c=ca[0],ch=ca[1],ca[2]!==void 0&&Aa(ch)&&_c==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){k0.next=10;break}throw new H("Message is not valid",Ie);case 10:_e=!0;case 11:if(Nf=Date.now(),bh=_.messageSentTimes.length-1,!((_g=_.messageSentTimes[bh])&&_g+3e3<Nf)){k0.next=18;break}_.messageSentTimes=[Nf],k0.next=29;break;case 18:_v=bh;case 19:if(!(0<=_v)){k0.next=28;break}if(!(_.messageSentTimes[_v]+3e3<Nf)){k0.next=23;break}return _.messageSentTimes=_.messageSentTimes.slice(_v+1,bh+1),k0.abrupt("break",28);case 23:if(!(180<=bh-_v+1)){k0.next=25;break}throw new lb("Message sent failed, exceeded the 180 message in 3 seconds",w.TOO_OFTEN);case 25:_v--,k0.next=19;break;case 28:_.messageSentTimes.push(Nf);case 29:k0.t0=s.messageType,k0.next=k0.t0==="TEXT"?32:k0.t0==="RAW"?37:k0.t0==="FILE"||k0.t0==="IMAGE"?39:40;break;case 32:if(!_e){k0.next=36;break}return h0=s.text.split("_"),A0=ua(h0,3),M0=A0[1],R0=A0[2],F.info("[rtm-API] EndCall message send api is called"),k0.abrupt("return",_.sendInvitationMessage({peerId:h,type:"CallCancel",extra:R0,channelId:M0,callId:"0"}));case 36:return k0.abrupt("return",_.sendTextMessage(s.text,h,f,K,1e4-j));case 37:return s.description===void 0&&(s.description=""),k0.abrupt("return",_.sendRawMessage(s.rawMessage,s.description,h,f,K,1e4-j));case 39:return k0.abrupt("return",_.sendMediaMessage(s.messageType,s,h,f,K,1e4-j));case 40:throw new H("Invalid message type",Ie);case 41:case"end":return k0.stop()}},o)}))).apply(this,arguments)}function Tv(o){var i=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=o.replace(/(https?:\/\/)?(www.)?/i,"");return i||(s=s.split(".").slice(o.length-2).join(".")),s.indexOf("/")!==-1?s.split("/")[0]:s}function pa(o){if(typeof o!="string")return"[Sensitive Info]";var i=Math.floor(.7*o.length),s=o.length;return Xn(o,i,s,"*".repeat(s-i))}function Yn(o,i,s){function h(f){if(o===void 0)return o;if(Km(f))return f;if(Array.isArray(f))return f.map(h);var _={},w=0;for(f=eh(f);w<f.length;w++){var j=ua(f[w],2),F=j[0];if(typeof(j=j[1])=="string"&&s.includes(F)){_[F]=typeof j=="string"?pa(j):"[Sensitive Info]";break}i.includes(F)?_[F]="[Hidden Info]":_[F]=j==null?j:s.includes(F)?"[Sensitive Info]":h(j)}return _}return Array.isArray(o)?o.map(h):h(o)}function Zn(o){return Object.getOwnPropertyNames(o).forEach(function(i){V(i=o[i])=="object"&&i!==null&&Zn(i)}),Object.freeze(o)}function ra(o){return new TextDecoder("utf-8").decode(o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength))}function fh(o){return new TextEncoder().encode(o).length}function $n(){for(var o=0,i=arguments.length,s=Array(i),h=0;h<i;h++)s[h]=arguments[h];for(i=0;i<s.length;i++)o+=s[i].length;for(o=new Uint8Array(o),h=i=0;h<s.length;h++){var f=s[h];o.set(f,i),i+=f.length}return o}function Je(o,i,s){var h=o.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(o=h==null?void 0:h[1],h=h==null?void 0:h[2]){var f;for(h=h.substr(1).split("&"),f=0;f<h.length;f++)if(h[f].split("=")[0]==i){h[f]=i+"="+encodeURIComponent(s);break}return f==h.length&&h.push(i+"="+encodeURIComponent(s)),o+"?"+h.join("&")}return o+"?"+i+"="+encodeURIComponent(s)}function pj(o){return new Promise(function(i,s){var h=new FileReader;h.onloadend=function(){var f=h.result||new ArrayBuffer(0);i(f)},h.onerror=s,h.readAsArrayBuffer(o)})}function Uv(o,i){o=o=[o],typeof(i=i||{})=="string"&&(i={type:i});try{var s=new Blob(o,i)}catch(f){if(f.name!=="TypeError")throw f;s=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder);for(var h=0;h<o.length;h+=1)s.append(o[h]);s=s.getBlob(i.type)}return s}function Xn(o,i,s,h){return typeof o!="string"?"[Sensitive Info]":o.substring(0,i)+h+o.substring(s)}function Pd(o){return typeof o=="string"&&o.length!==0&&o!=="false"&&o!=="null"&&o!=="undefined"}function ao(o){var i=[];return function s(h){if(h===null||V(h)!=="object")return h;if(i.indexOf(h)!==-1)return"[Circular]";if(i.push(h),typeof h.toJSON=="function")try{var f=s(h.toJSON());return i.pop(),f}catch(_){return"[Throws: "+(_?_.message:"?")+"]"}return Array.isArray(h)?(f=h.map(s),i.pop(),f):(f=Object.keys(h).reduce(function(_,w){t:{if(Vv.call(h,w))try{var j=h[w];break t}catch(F){j="[Throws: "+(F?F.message:"?")+"]";break t}j=h[w]}return _[w]=s(j),_},{}),i.pop(),f)}(o)}function Wv(o){if(!(100<(o=String(o)).length)&&(o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o))){var i=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return 864e5*i;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*i;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i}}}function gh(o,i,s,h){return Math.round(o/s)+" "+h+(i>=1.5*s?"s":"")}function Xv(o){var i=o.areas,s=o.excludedArea;if(i.length===1&&i[0]===D.GLOBAL&&s===D.CHINA)return Ke([D.OVERSEA]);if(i.includes(D.GLOBAL)){if(o=Pf(hh).filter(function(_){return _!==D.GLOBAL&&_!==D.OVERSEA}),s in Qf){i=Qf[s];var h=[].concat(G(i!=null?i:[]),[s]);return Ke(o.filter(function(_){return!h.includes(_)}))}if(bo(s)){var f=Yv(s);return Ke(o.filter(function(_){return _!==s&&_!==f}))}}if(bo(s)||s in Qf)return Ke(i);throw new H("Invalid excludedArea area config")}function Ra(o,i,s){s===void 0&&(s=Object.getOwnPropertyDescriptor(o,i));var h=s.value;return s.value=function(){for(var f=this,_=arguments.length,w=Array(_),j=0;j<_;j++)w[j]=arguments[j];this.invokeTracker.apply(this,["%s: ".concat(0<w.length?"%s with args: ".concat(w.map(function(){return"%o"})):"%s"),this.name,i].concat(G(w.map(Le))));try{var F=h.apply(this,w)}catch(_e){throw this.logError.apply(this,["".concat(_e.code!==void 0?"Error Code ".concat(_e.code,": "):"","%s failed").concat(0<w.length?" with args: ".concat(w.map(function(){return"%o"})):""),i].concat(G(w.map(Le)))),_e.originalError&&this.logError(_e.originalError),this.errorTracker(_e),_e}var K=Date.now();return J(x.mark(function _e(){var _o,ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return _c.prev=0,_c.next=3,F;case 3:_o=_c.sent,_c.next=12;break;case 6:return _c.prev=6,_c.t0=_c.catch(0),f.logError.apply(f,["".concat(_c.t0.code!==void 0?"Error Code ".concat(_c.t0.code,": "):"","%s failed").concat(0<w.length?" with args: ".concat(w.map(function(){return"%o"})):""),i].concat(G(w.map(Le)))),_c.t0.originalError&&f.logError(_c.t0.originalError),f.errorTracker(_c.t0),_c.abrupt("return");case 12:_o!==F?_o===void 0?f.resultTracker("%s promise resolves after %dms",i,Date.now()-K):f.resultTracker("%s promise resolves after %dms, result is %o",i,Date.now()-K,Le(_o)):Jc(_o)!=="Object"||Hd(_o)?f.resultTracker("%s result is %o",i,Le(_o)):f.resultTracker("%s result is %s",i,_o.name||((ca=_o.constructor)===null||ca===void 0?void 0:ca.name));case 13:case"end":return _c.stop()}},_e,null,[[0,6]])}))(),F},s}function Qb(o,i,s){s===void 0&&(s=Object.getOwnPropertyDescriptor(o,i));var h=s.value;return s.value=function(){for(var f=this,_=arguments.length,w=Array(_),j=0;j<_;j++)w[j]=arguments[j];this.invokeTracker.apply(this,["%s: ".concat(0<w.length?"%s with args: ".concat(w.map(function(){return"%o"})):"%s"),this.name,i].concat(w));try{var F=h.apply(this,w)}catch(_e){throw this.logError.apply(this,["".concat(_e.code!==void 0?"Error Code ".concat(_e.code,": "):"","%s failed").concat(0<w.length?" with args: ".concat(w.map(function(){return"%o"})):""),i].concat(w)),_e.originalError&&this.logError(_e.originalError),this.errorTracker(_e),_e}var K=Date.now();return J(x.mark(function _e(){var _o,ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return _c.prev=0,_c.next=3,F;case 3:_o=_c.sent,_c.next=12;break;case 6:return _c.prev=6,_c.t0=_c.catch(0),f.logError.apply(f,["".concat(_c.t0.code!==void 0?"Error Code ".concat(_c.t0.code,": "):"","%s failed").concat(0<w.length?" with args: ".concat(w.map(function(){return"%o"})):""),i].concat(w)),_c.t0.originalError&&f.logError(_c.t0.originalError),f.errorTracker(_c.t0),_c.abrupt("return");case 12:_o!==F?_o===void 0?f.resultTracker("%s promise resolves after %dms",i,Date.now()-K):f.resultTracker("%s promise resolves after %dms, result is %o",i,Date.now()-K,_o):Jc(_o)!=="Object"||Hd(_o)?f.resultTracker("%s result is %o",i,_o):f.resultTracker("%s result is %s",i,_o.name||((ca=_o.constructor)===null||ca===void 0?void 0:ca.name));case 13:case"end":return _c.stop()}},_e,null,[[0,6]])}))(),F},s}function Zv(o,i){var s="".concat(o,"Uri");if(typeof(s=rj[s])!="number"||s===0)throw new TypeError("Got Unknown URI Name");return i=new(o=co[o])(i),i=o.encode(i).finish(),new $v({uri:s,data:i})}function eo(o,i){var s=Pd(null);return"".concat(o.split(".").join("-"),".edge.").concat(s?null:i?"sd-rtn.com":"agora.io")}function hb(o,i,s){return sj.apply(this,arguments)}function sj(){return(sj=J(x.mark(function o(i,s,h){var f,_,w,j=arguments;return x.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return f=3<j.length&&j[3]!==void 0&&j[3],_=aw[i].encode(s).finish(),w=function(){var K=J(x.mark(function _e(_o){var ca,_c,ch,Nf=arguments;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if(!(3<(_c=1<Nf.length&&Nf[1]!==void 0?Nf[1]:0))){bh.next=3;break}return bh.abrupt("return");case 3:if(ch=Je(ch=h?"https://".concat((ca=P==null?void 0:P.PROXY_NGINX[0])!==null&&ca!==void 0?ca:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(_o,"&p=443&d=events/proto-raw"):"https://".concat(_o,"/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),ch=Je(ch,"id",bw[i].toString()),!f){bh.next=9;break}return bh.next=9,gj(1e4);case 9:return bh.next=11,He(ch,{body:_,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(_g){return w(_o,_c+1)});case 11:case"end":return bh.stop()}},_e)}));return function(_e){return K.apply(this,arguments)}}(),F.prev=3,F.next=6,w((P==null?void 0:P.EVENT_REPORT_DOMAIN[0])||Pd(null)&&null||"webcollector-rtm.agora.io");case 6:F.next=12;break;case 8:return F.prev=8,F.t0=F.catch(3),F.next=12,w(P&&fo(1<(P==null?void 0:P.EVENT_REPORT_DOMAIN.length)?P==null?void 0:P.EVENT_REPORT_DOMAIN.slice(1):P==null?void 0:P.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 12:case"end":return F.stop()}},o,null,[[3,8]])}))).apply(this,arguments)}function ib(o){return o===void 0?U.fromNumber(0):U.fromNumber(Date.now()-o)}function cw(o){return btoa(String.fromCharCode.apply({},o.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map(function(i){return parseInt(i,16)}))).replace(/={1,2}$/,"")}function ih(o,i){return U.fromValue(o).eq(i)}function jh(o,i){var s=i===void 0?o.val:i,h=o.isBoolean;i=o.isNumber;var f=o.oneof,_=o.len;if([h,i,f].filter(function(w){return!w}).length!==2)throw new TypeError("invalid field type");if(s!==void 0&&(o=!1,f!==void 0&&(f=tj(f),dw(f,ih).length===f.length&&ew(f,function(w){return ih(s,w)})!==void 0&&(o=!0)),h=h!==void 0&&(s===0||s===1)&&_===1,i=i!==void 0&&s.toString(2).length<=_,!(o||h||i)))throw Error("invalid field value")}function go(o){return o.reduce(function(i,s){return i.concat(s instanceof kh.UnsubscriptionError?s.errors:s)},[])}function fw(o,i){do Rf==2147483647?Rf=0:Rf++;while(Me.hasOwnProperty(Rf));var s=Rf;return Me[s]={callback:o,parameters:Array.prototype.slice.call(arguments,2)},uj.postMessage({name:"setInterval",fakeId:s,time:i}),s}function ho(o){return function(){var i=o();if(!i)throw new L("Client is not logged in. Cannot do the operation");return i}}var Ka=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof commonjsGlobal!="undefined"?commonjsGlobal:typeof self!="undefined"?self:{},lh=function(o){return o&&o.Math==Math&&o},C=lh(typeof globalThis=="object"&&globalThis)||lh(typeof window=="object"&&window)||lh(typeof self=="object"&&self)||lh(typeof Ka=="object"&&Ka)||function(){return this}()||Function("return this")(),R=function(o){try{return!!o()}catch{return!0}},fa=!R(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),io={}.propertyIsEnumerable,jo=Object.getOwnPropertyDescriptor,Sf=jo&&!io.call({1:2},1)?function(o){return!!(o=jo(this,o))&&o.enumerable}:io,sc=function(o,i){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:i}},gw={}.toString,ec=function(o){return gw.call(o).slice(8,-1)},hw="".split,Tf=R(function(){return!Object("z").propertyIsEnumerable(0)})?function(o){return ec(o)=="String"?hw.call(o,""):Object(o)}:Object,mb=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o},tb=function(o){return Tf(mb(o))},ha=function(o){return typeof o=="object"?o!==null:typeof o=="function"},tc=function(o,i){if(!ha(o))return o;var s,h;if(i&&typeof(s=o.toString)=="function"&&!ha(h=s.call(o))||typeof(s=o.valueOf)=="function"&&!ha(h=s.call(o))||!i&&typeof(s=o.toString)=="function"&&!ha(h=s.call(o)))return h;throw TypeError("Can't convert object to primitive value")},Va=function(o){return Object(mb(o))},iw={}.hasOwnProperty,Q=function(o,i){return iw.call(Va(o),i)},Ne=C.document,mh=ha(Ne)&&ha(Ne.createElement),ko=!fa&&!R(function(){return Object.defineProperty(mh?Ne.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),lo=Object.getOwnPropertyDescriptor,Jb={f:fa?lo:function(o,i){if(o=tb(o),i=tc(i,!0),ko)try{return lo(o,i)}catch{}if(Q(o,i))return sc(!Sf.call(o,i),o[i])}},sa=function(o){if(!ha(o))throw TypeError(String(o)+" is not an object");return o},mo=Object.defineProperty,Wa={f:fa?mo:function(o,i,s){if(sa(o),i=tc(i,!0),sa(s),ko)try{return mo(o,i,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(o[i]=s.value),o}},Sa=fa?function(o,i,s){return Wa.f(o,i,sc(1,s))}:function(o,i,s){return o[i]=s,o},vj=function(o,i){try{Sa(C,o,i)}catch{C[o]=i}return i},kd=C["__core-js_shared__"]||vj("__core-js_shared__",{}),jw=Function.toString;typeof kd.inspectSource!="function"&&(kd.inspectSource=function(o){return jw.call(o)});var wj=kd.inspectSource,no=C.WeakMap,kw=typeof no=="function"&&/native code/.test(wj(no)),ld=cb(function(o){(o.exports=function(i,s){return kd[i]||(kd[i]=s!==void 0?s:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"\xA9 2021 Denis Pushkarev (zloirock.ru)"})}),lw=0,mw=Math.random(),Oe=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++lw+mw).toString(36)},oo=ld("keys"),nh=function(o){return oo[o]||(oo[o]=Oe(o))},Pe={},nw=C.WeakMap;if(kw||kd.state)var Qd=kd.state||(kd.state=new nw),ow=Qd.get,po=Qd.has,pw=Qd.set,xj=function(o,i){if(po.call(Qd,o))throw new TypeError("Object already initialized");return i.facade=o,pw.call(Qd,o,i),i},oh=function(o){return ow.call(Qd,o)||{}},yj=function(o){return po.call(Qd,o)};else{var Qe=nh("state");Pe[Qe]=!0,xj=function(o,i){if(Q(o,Qe))throw new TypeError("Object already initialized");return i.facade=o,Sa(o,Qe,i),i},oh=function(o){return Q(o,Qe)?o[Qe]:{}},yj=function(o){return Q(o,Qe)}}var La={set:xj,get:oh,has:yj,enforce:function(o){return yj(o)?oh(o):xj(o,{})},getterFor:function(o){return function(i){var s;if(!ha(i)||(s=oh(i)).type!==o)throw TypeError("Incompatible receiver, "+o+" required");return s}}},Ea=cb(function(o){var i=La.get,s=La.enforce,h=String(String).split("String");(o.exports=function(f,_,w,j){var F=!!j&&!!j.unsafe,K=!!j&&!!j.enumerable;if(j=!!j&&!!j.noTargetGet,typeof w=="function"){typeof _!="string"||Q(w,"name")||Sa(w,"name",_);var _e=s(w);_e.source||(_e.source=h.join(typeof _=="string"?_:""))}f===C?K?f[_]=w:vj(_,w):(F?!j&&f[_]&&(K=!0):delete f[_],K?f[_]=w:Sa(f,_,w))})(Function.prototype,"toString",function(){return typeof this=="function"&&i(this).source||wj(this)})}),qo=function(o){return typeof o=="function"?o:void 0},Rb=function(o,i){return 2>arguments.length?qo(C[o])||qo(C[o]):C[o]&&C[o][i]||C[o]&&C[o][i]},qw=Math.ceil,rw=Math.floor,fc=function(o){return isNaN(o=+o)?0:(0<o?rw:qw)(o)},sw=Math.min,va=function(o){return 0<o?sw(fc(o),9007199254740991):0},tw=Math.max,uw=Math.min,Ab=function(o,i){return 0>(o=fc(o))?tw(o+i,0):uw(o,i)},ro=function(o){return function(i,s,h){i=tb(i);var f=va(i.length);if(h=Ab(h,f),o&&s!=s){for(;f>h;)if((s=i[h++])!=s)return!0}else for(;f>h;h++)if((o||h in i)&&i[h]===s)return o||h||0;return!o&&-1}},so=ro(!0),zj=ro(!1),to=function(o,i){o=tb(o);var s,h=0,f=[];for(s in o)!Q(Pe,s)&&Q(o,s)&&f.push(s);for(;i.length>h;)Q(o,s=i[h++])&&(~zj(f,s)||f.push(s));return f},ph="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),vw=ph.concat("length","prototype"),Rd={f:Object.getOwnPropertyNames||function(o){return to(o,vw)}},Uf={f:Object.getOwnPropertySymbols},uo=Rb("Reflect","ownKeys")||function(o){var i=Rd.f(sa(o)),s=Uf.f;return s?i.concat(s(o)):i},vo=function(o,i){for(var s=uo(i),h=Wa.f,f=Jb.f,_=0;_<s.length;_++){var w=s[_];Q(o,w)||h(o,w,f(i,w))}},ww=/#|\.prototype\./,uc=function(o,i){return(o=xw[yw(o)])==zw||o!=Aw&&(typeof i=="function"?R(i):!!i)},yw=uc.normalize=function(o){return String(o).replace(ww,".").toLowerCase()},xw=uc.data={},Aw=uc.NATIVE="N",zw=uc.POLYFILL="P",Bw=Jb.f,M=function(o,i){var s,h,f,_=o.target,w=o.global,j=o.stat;if(h=w?C:j?C[_]||vj(_,{}):(C[_]||{}).prototype)for(f in i){var F=i[f],K=o.noTargetGet?(s=Bw(h,f))&&s.value:h[f];if(!(s=uc(w?f:_+(j?".":"#")+f,o.forced))&&K!==void 0){if(typeof F==typeof K)continue;vo(F,K)}(o.sham||K&&K.sham)&&Sa(F,"sham",!0);try{Ea(h,f,F,o)}catch{}}},Aj=function(){var o=sa(this),i="";return o.global&&(i+="g"),o.ignoreCase&&(i+="i"),o.multiline&&(i+="m"),o.dotAll&&(i+="s"),o.unicode&&(i+="u"),o.sticky&&(i+="y"),i},vc=R(function(){var o=RegExp("a","y");return o.lastIndex=2,o.exec("abcd")!=null}),Cw=R(function(){var o=RegExp("^r","gy");return o.lastIndex=2,o.exec("str")!=null}),qh=RegExp.prototype.exec,Dw=ld("native-string-replace",String.prototype.replace),wo=qh,Bj=(c=/a/,a=/b*/g,qh.call(c,"a"),qh.call(a,"a"),c.lastIndex!==0||a.lastIndex!==0),xo=vc||Cw,Cj=/()??/.exec("")[1]!==void 0,c,a;(Bj||Cj||xo)&&(wo=function(o){var i,s=xo&&this.sticky,h=Aj.call(this),f=this.source,_=0,w=o;if(s){(h=h.replace("y","")).indexOf("g")===-1&&(h+="g"),w=String(o).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&o[this.lastIndex-1]!==`
`)&&(f="(?: "+f+")",w=" "+w,_++);var j=new RegExp("^(?:"+f+")",h)}if(Cj&&(j=new RegExp("^"+f+"$(?!\\s)",h)),Bj)var F=this.lastIndex;var K=qh.call(s?j:this,w);return s?K?(K.input=K.input.slice(_),K[0]=K[0].slice(_),K.index=this.lastIndex,this.lastIndex+=K[0].length):this.lastIndex=0:Bj&&K&&(this.lastIndex=this.global?K.index+K[0].length:F),Cj&&K&&1<K.length&&Dw.call(K[0],j,function(){for(i=1;i<arguments.length-2;i++)arguments[i]===void 0&&(K[i]=void 0)}),K});var Vf=wo;M({target:"RegExp",proto:!0,forced:/./.exec!==Vf},{exec:Vf});var Re=Rb("navigator","userAgent")||"",yo=C.process,zo=yo&&yo.versions,Ao=zo&&zo.v8;if(Ao)var md=Ao.split("."),Dj=4>md[0]?1:md[0]+md[1];else Re&&(md=Re.match(/Edge\/(\d+)/),(!md||74<=md[1])&&(md=Re.match(/Chrome\/(\d+)/))&&(Dj=md[1]));var nd=Dj&&+Dj,wc=!!Object.getOwnPropertySymbols&&!R(function(){return!String(Symbol())||!Symbol.sham&&nd&&41>nd}),Bo=wc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Wf=ld("wks"),Xf=C.Symbol,Ew=Bo?Xf:Xf&&Xf.withoutSetter||Oe,qa=function(o){return Q(Wf,o)&&(wc||typeof Wf[o]=="string")||(wc&&Q(Xf,o)?Wf[o]=Xf[o]:Wf[o]=Ew("Symbol."+o)),Wf[o]},Fw=qa("species"),Ej=RegExp.prototype,Gw=!R(function(){var o=/./;return o.exec=function(){var i=[];return i.groups={a:"7"},i},"".replace(o,"$<a>")!=="7"}),Co="a".replace(/./,"$0")==="$0",Do=qa("replace"),Eo=!!/./[Do]&&/./[Do]("a","$0")==="",Hw=!R(function(){var o=/(?:)/,i=o.exec;return o.exec=function(){return i.apply(this,arguments)},(o="ab".split(o)).length!==2||o[0]!=="a"||o[1]!=="b"}),rh=function(o,i,s,h){var f=qa(o),_=!R(function(){var K={};return K[f]=function(){return 7},""[o](K)!=7}),w=_&&!R(function(){var K=!1,_e=/a/;return o==="split"&&((_e={constructor:{}}).constructor[Fw]=function(){return _e},_e.flags="",_e[f]=/./[f]),_e.exec=function(){return K=!0,null},_e[f](""),!K});if(!_||!w||o==="replace"&&(!Gw||!Co||Eo)||o==="split"&&!Hw){var j=/./[f],F=(s=s(f,""[o],function(K,_e,_o,ca,_c){var ch=_e.exec;return ch===Vf||ch===Ej.exec?_&&!_c?{done:!0,value:j.call(_e,_o,ca)}:{done:!0,value:K.call(_o,_e,ca)}:{done:!1}},{REPLACE_KEEPS_$0:Co,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Eo}))[1];Ea(String.prototype,o,s[0]),Ea(Ej,f,i==2?function(K,_e){return F.call(K,this,_e)}:function(K){return F.call(K,this)})}h&&Sa(Ej[f],"sham",!0)},Iw=qa("match"),Fj=function(o){var i;return ha(o)&&((i=o[Iw])!==void 0?!!i:ec(o)=="RegExp")},Bb=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o},Jw=qa("species"),od=function(o,i){var s;return(o=sa(o).constructor)===void 0||(s=sa(o)[Jw])==null?i:Bb(s)},Fo=function(o){return function(i,s){i=String(mb(i)),s=fc(s);var h,f=i.length;if(0>s||s>=f)return o?"":void 0;var _=i.charCodeAt(s);return 55296>_||56319<_||s+1===f||56320>(h=i.charCodeAt(s+1))||57343<h?o?i.charAt(s):_:o?i.slice(s,s+2):h-56320+(_-55296<<10)+65536}},Kw=Fo(!1),Go=Fo(!0),Gj=function(o,i,s){return i+(s?Go(o,i).length:1)},Se=function(o,i){var s=o.exec;if(typeof s=="function"){if(typeof(o=s.call(o,i))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return o}if(ec(o)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Vf.call(o,i)},Lw=[].push,Mw=Math.min;rh("split",2,function(o,i,s){var h="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(f,_){var w=String(mb(this));if((_=_===void 0?4294967295:_>>>0)===0)return[];if(f===void 0)return[w];if(!Fj(f))return i.call(w,f,_);var j,F,K,_e=[],_o=0;for(f=new RegExp(f.source,(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(f.sticky?"y":"")+"g");(j=Vf.call(f,w))&&!((F=f.lastIndex)>_o&&(_e.push(w.slice(_o,j.index)),1<j.length&&j.index<w.length&&Lw.apply(_e,j.slice(1)),K=j[0].length,_o=F,_e.length>=_));)f.lastIndex===j.index&&f.lastIndex++;return _o===w.length?(K||!f.test(""))&&_e.push(""):_e.push(w.slice(_o)),_e.length>_?_e.slice(0,_):_e}:"0".split(void 0,0).length?function(f,_){return f===void 0&&_===0?[]:i.call(this,f,_)}:i;return[function(f,_){var w=mb(this),j=f==null?void 0:f[o];return j!==void 0?j.call(f,w,_):h.call(String(w),f,_)},function(f,_){var w=s(h,f,this,_,h!==i);if(w.done)return w.value;var j=sa(f);f=String(this);var F=od(j,RegExp);if(w=j.unicode,j=new F(vc?"^(?:"+j.source+")":j,(j.ignoreCase?"i":"")+(j.multiline?"m":"")+(j.unicode?"u":"")+(vc?"g":"y")),(_=_===void 0?4294967295:_>>>0)===0)return[];if(f.length===0)return Se(j,f)===null?[f]:[];var K=0,_e=0;for(F=[];_e<f.length;){j.lastIndex=vc?0:_e;var _o,ca=Se(j,vc?f.slice(_e):f);if(ca===null||(_o=Mw(va(j.lastIndex+(vc?_e:0)),f.length))===K)_e=Gj(f,_e,w);else{if(F.push(f.slice(K,_e)),F.length===_)return F;for(K=1;K<=ca.length-1;K++)if(F.push(ca[K]),F.length===_)return F;_e=K=_o}}return F.push(f.slice(K)),F}]},vc);var Nw=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,Ow=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Hj=function(o){return function(i){return i=String(mb(i)),1&o&&(i=i.replace(Nw,"")),2&o&&(i=i.replace(Ow,"")),i}},Ij=Hj(3),sh=C.parseInt,Pw=/^[+-]?0[Xx]/,Ho=sh(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF08`)!==8||sh(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF0x16`)!==22?function(o,i){return o=Ij(String(o)),sh(o,i>>>0||(Pw.test(o)?16:10))}:sh;M({global:!0,forced:parseInt!=Ho},{parseInt:Ho});var pd=function(o,i,s){if(Bb(o),i===void 0)return o;switch(s){case 0:return function(){return o.call(i)};case 1:return function(h){return o.call(i,h)};case 2:return function(h,f){return o.call(i,h,f)};case 3:return function(h,f,_){return o.call(i,h,f,_)}}return function(){return o.apply(i,arguments)}},qd=Array.isArray||function(o){return ec(o)=="Array"},Qw=qa("species"),th=function(o,i){if(qd(o)){var s=o.constructor;typeof s!="function"||s!==Array&&!qd(s.prototype)?ha(s)&&(s=s[Qw])===null&&(s=void 0):s=void 0}return new(s===void 0?Array:s)(i===0?0:i)},Io=[].push,rd=function(o){var i=o==1,s=o==2,h=o==3,f=o==4,_=o==6,w=o==7,j=o==5||_;return function(F,K,_e,_o){var ca=Va(F),_c=Tf(ca);K=pd(K,_e,3),_e=va(_c.length);var ch,Nf=0;for(_o=_o||th,F=i?_o(F,_e):s||w?_o(F,0):void 0;_e>Nf;Nf++)if((j||Nf in _c)&&(ch=K(_o=_c[Nf],Nf,ca),o))if(i)F[Nf]=ch;else if(ch)switch(o){case 3:return!0;case 5:return _o;case 6:return Nf;case 2:Io.call(F,_o)}else switch(o){case 4:return!1;case 7:Io.call(F,_o)}return _?-1:h||f?f:F}},Sd=rd(0),Jo=rd(1),Ko=rd(2),Rw=rd(3),Sw=rd(4),Lo=rd(5),Mo=rd(6),Tw=qa("species"),Yf=function(o){return 51<=nd||!R(function(){var i=[];return(i.constructor={})[Tw]=function(){return{foo:1}},i[o](Boolean).foo!==1})},Uw=Yf("filter");M({target:"Array",proto:!0,forced:!Uw},{filter:function(o){return Ko(this,o,1<arguments.length?arguments[1]:void 0)}});var Mc=Object.keys||function(o){return to(o,ph)},Vw=R(function(){Mc(1)});M({target:"Object",stat:!0,forced:Vw},{keys:function(o){return Mc(Va(o))}});var Te=function(o,i){var s=[][o];return!!s&&R(function(){s.call(null,i||function(){throw 1},1)})},Ww=[].join,Xw=Tf!=Object,Yw=Te("join",",");M({target:"Array",proto:!0,forced:Xw||!Yw},{join:function(o){return Ww.call(tb(this),o===void 0?",":o)}});var Zw=Yf("map");M({target:"Array",proto:!0,forced:!Zw},{map:function(o){return Jo(this,o,1<arguments.length?arguments[1]:void 0)}});var Jj=function(o){var i=o.return;if(i!==void 0)return sa(i.call(o)).value},Ue={},$w=qa("iterator"),ax=Array.prototype,Kj=function(o){return o!==void 0&&(Ue.Array===o||ax[$w]===o)},Ve=function(o,i,s){(i=tc(i))in o?Wa.f(o,i,sc(0,s)):o[i]=s},bx=qa("toStringTag"),No={};No[bx]="z";var Lj=String(No)==="[object z]",cx=qa("toStringTag"),dx=ec(function(){return arguments}())=="Arguments",We=Lj?ec:function(o){var i;if(o===void 0)var s="Undefined";else{if(o===null)var h="Null";else{t:{var f=o=Object(o);try{h=f[cx];break t}catch{}h=void 0}h=typeof(s=h)=="string"?s:dx?ec(o):(i=ec(o))=="Object"&&typeof o.callee=="function"?"Arguments":i}s=h}return s},ex=qa("iterator"),Zf=function(o){if(o!=null)return o[ex]||o["@@iterator"]||Ue[We(o)]},Td=function(o){var i,s=Va(o),h=typeof this=="function"?this:Array,f=arguments.length,_=1<f?arguments[1]:void 0,w=_!==void 0,j=Zf(s),F=0;if(w&&(_=pd(_,2<f?arguments[2]:void 0,2)),j==null||h==Array&&Kj(j)){var K=va(s.length);for(h=new h(K);K>F;F++)j=w?_(s[F],F):s[F],Ve(h,F,j)}else for(f=(s=j.call(s)).next,h=new h;!(i=f.call(s)).done;F++){if(w){j=s;var _e=_;i=[i.value,F];try{K=_e(sa(i)[0],i[1])}catch(_o){throw Jj(j),_o}}else K=i.value;Ve(h,F,j=K)}return h.length=F,h},Oo=qa("iterator"),Po=!1;try{var fx=0,Qo={next:function(){return{done:!!fx++}},return:function(){Po=!0}};Qo[Oo]=function(){return this},Array.from(Qo,function(){throw 2})}catch(o){}var uh=function(o,i){if(!i&&!Po)return!1;var s=!1;try{(i={})[Oo]=function(){return{next:function(){return{done:s=!0}}}},o(i)}catch{}return s},gx=!uh(function(o){Array.from(o)});M({target:"Array",stat:!0,forced:gx},{from:Td});var Ro=!R(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}),So=nh("IE_PROTO"),hx=Object.prototype,ac=Ro?Object.getPrototypeOf:function(o){return o=Va(o),Q(o,So)?o[So]:typeof o.constructor=="function"&&o instanceof o.constructor?o.constructor.prototype:o instanceof Object?hx:null},Mj=qa("iterator"),To=!1,ix=function(){return this},Ud;if([].keys){var Uo=[].keys();if("next"in Uo){var Vo=ac(ac(Uo));Vo!==Object.prototype&&(Ud=Vo)}else To=!0}(Ud==null||R(function(){var o={};return Ud[Mj].call(o)!==o}))&&(Ud={}),Q(Ud,Mj)||Sa(Ud,Mj,ix);var vh=Ud,wh=To,Wo=fa?Object.defineProperties:function(o,i){sa(o);for(var s,h=Mc(i),f=h.length,_=0;f>_;)Wa.f(o,s=h[_++],i[s]);return o},Nj=Rb("document","documentElement"),Xo=nh("IE_PROTO"),Oj=function(){},Pj,xh=function(){try{Pj=document.domain&&new ActiveXObject("htmlfile")}catch{}if(Pj){var o=Pj;o.write("<script><\/script>"),o.close(),o=o.parentWindow.Object}else(o=mh?Ne.createElement("iframe"):{}).style.display="none",Nj.appendChild(o),o.src="javascript:",(o=o.contentWindow.document).open(),o.write("<script>document.F=Object<\/script>"),o.close(),o=o.F;for(xh=o,o=ph.length;o--;)delete xh.prototype[ph[o]];return xh()};Pe[Xo]=!0;var Sb=Object.create||function(o,i){if(o!==null){Oj.prototype=sa(o);var s=new Oj;Oj.prototype=null,s[Xo]=o}else s=xh();return i===void 0?s:Wo(s,i)},jx=Wa.f,Yo=qa("toStringTag"),gc=function(o,i,s){o&&!Q(o=s?o:o.prototype,Yo)&&jx(o,Yo,{configurable:!0,value:i})},kx=function(){return this},Zo=function(o,i,s){return i+=" Iterator",o.prototype=Sb(vh,{next:sc(1,s)}),gc(o,i,!1),Ue[i]=kx,o},Ya=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,i={};try{var s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;s.call(i,[]),o=i instanceof Array}catch{}return function(h,f){if(sa(h),!ha(f)&&f!==null)throw TypeError("Can't set "+String(f)+" as a prototype");return o?s.call(h,f):h.__proto__=f,h}}():void 0),$f=qa("iterator"),lx=function(){return this},Qj=function(o,i,s,h,f,_,w){Zo(s,i,h),h=function(Nf){if(Nf===f&&ca)return ca;if(!wh&&Nf in _e)return _e[Nf];switch(Nf){case"keys":case"values":case"entries":return function(){return new s(this,Nf)}}return function(){return new s(this)}};var j,F=i+" Iterator",K=!1,_e=o.prototype,_o=_e[$f]||_e["@@iterator"]||f&&_e[f],ca=!wh&&_o||h(f),_c=i=="Array"&&_e.entries||_o;if(_c&&(o=ac(_c.call(new o)),vh!==Object.prototype&&o.next&&(ac(o)!==vh&&(Ya?Ya(o,vh):typeof o[$f]!="function"&&Sa(o,$f,lx)),gc(o,F,!0))),f=="values"&&_o&&_o.name!=="values"&&(K=!0,ca=function(){return _o.call(this)}),_e[$f]!==ca&&Sa(_e,$f,ca),Ue[i]=ca,f){var ch={values:h("values"),keys:_?ca:h("keys"),entries:h("entries")};if(w)for(j in ch)!wh&&!K&&j in _e||Ea(_e,j,ch[j]);else M({target:i,proto:!0,forced:wh||K},ch)}return ch},mx=La.set,nx=La.getterFor("String Iterator");Qj(String,"String",function(o){mx(this,{type:"String Iterator",string:String(o),index:0})},function(){var o=nx(this),i=o.string,s=o.index;return s>=i.length?{value:void 0,done:!0}:(i=Go(i,s),o.index+=i.length,{value:i,done:!1})});var Rj=qa("unscopables"),Sj=Array.prototype;Sj[Rj]==null&&Wa.f(Sj,Rj,{configurable:!0,value:Sb(null)});var Vd=function(o){Sj[Rj][o]=!0},$o=!0;"find"in[]&&Array(1).find(function(){$o=!1}),M({target:"Array",proto:!0,forced:$o},{find:function(o){return Lo(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("find");var ap=function(o){var i=String(mb(this)),s="";if(0>(o=fc(o))||1/0==o)throw RangeError("Wrong number of repetitions");for(;0<o;(o>>>=1)&&(i+=i))1&o&&(s+=i);return s};M({target:"String",proto:!0},{repeat:ap});var bp=[].indexOf,cp=!!bp&&0>1/[1].indexOf(1,-0),ox=Te("indexOf");M({target:"Array",proto:!0,forced:cp||!ox},{indexOf:function(o){return cp?bp.apply(this,arguments)||0:zj(this,o,1<arguments.length?arguments[1]:void 0)}});var iu=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ju=/CrOS/,ku=/android|ipad|playbook|silk/i;pe.isMobile=pe,pe.default=pe,M({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),M({target:"Number",stat:!0},{isNaN:function(o){return o!=o}}),C.Number.isNaN;var px=Lj?{}.toString:function(){return"[object "+We(this)+"]"};Lj||Ea(Object.prototype,"toString",px,{unsafe:!0});var Nc=C.Promise,Xe=function(o,i,s){for(var h in i)Ea(o,h,i[h],s);return o},dp=qa("species"),ag=function(o){o=Rb(o);var i=Wa.f;fa&&o&&!o[dp]&&i(o,dp,{configurable:!0,get:function(){return this}})},hc=function(o,i,s){if(!(o instanceof i))throw TypeError("Incorrect "+(s?s+" ":"")+"invocation");return o},bg=function(o,i){this.stopped=o,this.result=i},yh=function(o,i,s){var h,f=!(!s||!s.AS_ENTRIES),_=!(!s||!s.IS_ITERATOR),w=!(!s||!s.INTERRUPTED),j=pd(i,s&&s.that,1+f+w),F=function(_e){return K&&Jj(K),new bg(!0,_e)};if(i=function(_e){return f?(sa(_e),w?j(_e[0],_e[1],F):j(_e[0],_e[1])):w?j(_e,F):j(_e)},_)var K=o;else{if(typeof(_=Zf(o))!="function")throw TypeError("Target is not iterable");if(Kj(_)){for(_=0,s=va(o.length);s>_;_++)if((h=i(o[_]))&&h instanceof bg)return h;return new bg(!1)}K=_.call(o)}for(o=K.next;!(_=o.call(K)).done;){try{h=i(_.value)}catch(_e){throw Jj(K),_e}if(typeof h=="object"&&h&&h instanceof bg)return h}return new bg(!1)},ep=/(?:iphone|ipod|ipad).*applewebkit/i.test(Re),Oc=ec(C.process)=="process",zh=C.location,Tj=C.setImmediate,fp=C.clearImmediate,qx=C.process,gp=C.MessageChannel,Uj=C.Dispatch,Vj=0,cg={},Wj=function(o){if(cg.hasOwnProperty(o)){var i=cg[o];delete cg[o],i()}},Xj=function(o){return function(){Wj(o)}},hp=function(o){Wj(o.data)},ip=function(o){C.postMessage(o+"",zh.protocol+"//"+zh.host)};if(!Tj||!fp)if(Tj=function(o){for(var i=[],s=1;arguments.length>s;)i.push(arguments[s++]);return cg[++Vj]=function(){(typeof o=="function"?o:Function(o)).apply(void 0,i)},dg(Vj),Vj},fp=function(o){delete cg[o]},Oc)var dg=function(o){qx.nextTick(Xj(o))};else if(Uj&&Uj.now)dg=function(o){Uj.now(Xj(o))};else if(gp&&!ep){var jp=new gp,kp=jp.port2;jp.port1.onmessage=hp,dg=pd(kp.postMessage,kp,1)}else C.addEventListener&&typeof postMessage=="function"&&!C.importScripts&&zh&&zh.protocol!=="file:"&&!R(ip)?(dg=ip,C.addEventListener("message",hp,!1)):dg="onreadystatechange"in(mh?Ne.createElement("script"):{})?function(o){Nj.appendChild(mh?Ne.createElement("script"):{}).onreadystatechange=function(){Nj.removeChild(this),Wj(o)}}:function(o){setTimeout(Xj(o),0)};var Yj=Tj,rx=/web0s(?!.*chrome)/i.test(Re),sx=Jb.f,lp=C.MutationObserver||C.WebKitMutationObserver,mp=C.document,np=C.process,Ah=C.Promise,op=sx(C,"queueMicrotask"),pp=op&&op.value,Wd,eg;if(!pp){var Ch=function(){var o;for(Oc&&(o=np.domain)&&o.exit();Wd;){var i=Wd.fn;Wd=Wd.next;try{i()}catch(s){throw Wd?Bh():eg=void 0,s}}eg=void 0,o&&o.enter()};if(ep||Oc||rx||!lp||!mp)if(Ah&&Ah.resolve){var Zj=Ah.resolve(void 0);Zj.constructor=Ah;var tx=Zj.then,Bh=function(){tx.call(Zj,Ch)}}else Bh=Oc?function(){np.nextTick(Ch)}:function(){Yj.call(C,Ch)};else{var qp=!0,rp=mp.createTextNode("");new lp(Ch).observe(rp,{characterData:!0}),Bh=function(){rp.data=qp=!qp}}}var sp=pp||function(o){o={fn:o,next:void 0},eg&&(eg.next=o),Wd||(Wd=o,Bh()),eg=o},ux=function(o){var i,s;this.promise=new o(function(h,f){if(i!==void 0||s!==void 0)throw TypeError("Bad Promise constructor");i=h,s=f}),this.resolve=Bb(i),this.reject=Bb(s)},ak={f:function(o){return new ux(o)}},bk=function(o,i){return sa(o),ha(i)&&i.constructor===o?i:((0,(o=ak.f(o)).resolve)(i),o.promise)},vx=function(o,i){var s=C.console;s&&s.error&&(arguments.length===1?s.error(o):s.error(o,i))},ck=function(o){try{return{error:!1,value:o()}}catch(i){return{error:!0,value:i}}},wx=typeof window=="object",xx=qa("species"),tp=La.get,yx=La.set,zx=La.getterFor("Promise"),Xd=Nc&&Nc.prototype,Cb=Nc,Dh=Xd,up=C.TypeError,dk=C.document,ek=C.process,Ye=ak.f,Ax=Ye,Bx=!!(dk&&dk.createEvent&&C.dispatchEvent),vp=typeof PromiseRejectionEvent=="function",wp=!1,fg=uc("Promise",function(){var o=wj(Cb)!==String(Cb);if(!o&&nd===66)return!0;if(51<=nd&&/native code/.test(Cb))return!1;var i=new Cb(function(h){h(1)}),s=function(h){h(function(){},function(){})};return(i.constructor={})[xx]=s,!(wp=i.then(function(){})instanceof s)||!o&&wx&&!vp}),Cx=fg||!uh(function(o){Cb.all(o).catch(function(){})}),xp=function(o){var i;return!(!ha(o)||typeof(i=o.then)!="function")&&i},fk=function(o,i){if(!o.notified){o.notified=!0;var s=o.reactions;sp(function(){for(var h=o.value,f=o.state==1,_=0;s.length>_;){var w,j=s[_++],F=f?j.ok:j.fail,K=j.resolve,_e=j.reject,_o=j.domain;try{if(F){if(f||(o.rejection===2&&Dx(o),o.rejection=1),F===!0)var ca=h;else if(_o&&_o.enter(),ca=F(h),_o){_o.exit();var _c=!0}ca===j.promise?_e(up("Promise-chain cycle")):(w=xp(ca))?w.call(ca,K,_e):K(ca)}else _e(h)}catch(ch){_o&&!_c&&_o.exit(),_e(ch)}}o.reactions=[],o.notified=!1,i&&!o.rejection&&Ex(o)})}},yp=function(o,i,s){var h;if(Bx){var f=dk.createEvent("Event");f.promise=i,f.reason=s,f.initEvent(o,!1,!0),C.dispatchEvent(f)}else f={promise:i,reason:s};!vp&&(h=C["on"+o])?h(f):o==="unhandledrejection"&&vx("Unhandled promise rejection",s)},Ex=function(o){Yj.call(C,function(){var i=o.facade,s=o.value;if(o.rejection!==1&&!o.parent){var h=ck(function(){Oc?ek.emit("unhandledRejection",s,i):yp("unhandledrejection",i,s)});if(o.rejection=Oc||o.rejection!==1&&!o.parent?2:1,h.error)throw h.value}})},Dx=function(o){Yj.call(C,function(){var i=o.facade;Oc?ek.emit("rejectionHandled",i):yp("rejectionhandled",i,o.value)})},Ze=function(o,i,s){return function(h){o(i,h,s)}},$e=function(o,i,s){o.done||(o.done=!0,s&&(o=s),o.value=i,o.state=2,fk(o,!0))},gk=function(o,i,s){if(!o.done){o.done=!0,s&&(o=s);try{if(o.facade===i)throw up("Promise can't be resolved itself");var h=xp(i);h?sp(function(){var f={done:!1};try{h.call(i,Ze(gk,f,o),Ze($e,f,o))}catch(_){$e(f,_,o)}}):(o.value=i,o.state=1,fk(o,!1))}catch(f){$e({done:!1},f,o)}}};if(fg){Cb=function(o){hc(this,Cb,"Promise"),Bb(o),hk.call(this);var i=tp(this);try{o(Ze(gk,i),Ze($e,i))}catch(s){$e(i,s)}},Dh=Cb.prototype;var hk=function(o){yx(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};hk.prototype=Xe(Dh,{then:function(o,i){var s=zx(this),h=Ye(od(this,Cb));return h.ok=typeof o!="function"||o,h.fail=typeof i=="function"&&i,h.domain=Oc?ek.domain:void 0,s.parent=!0,s.reactions.push(h),s.state!=0&&fk(s,!1),h.promise},catch:function(o){return this.then(void 0,o)}});var Fx=function(){var o=new hk,i=tp(o);this.promise=o,this.resolve=Ze(gk,i),this.reject=Ze($e,i)};if(ak.f=Ye=function(o){return o===Cb||o===Gx?new Fx(o):Ax(o)},typeof Nc=="function"&&Xd!==Object.prototype){var Hx=Xd.then;wp||(Ea(Xd,"then",function(o,i){var s=this;return new Cb(function(h,f){Hx.call(s,h,f)}).then(o,i)},{unsafe:!0}),Ea(Xd,"catch",Dh.catch,{unsafe:!0}));try{delete Xd.constructor}catch{}Ya&&Ya(Xd,Dh)}}M({global:!0,wrap:!0,forced:fg},{Promise:Cb}),gc(Cb,"Promise",!1),ag("Promise");var Gx=Rb("Promise");M({target:"Promise",stat:!0,forced:fg},{reject:function(o){var i=Ye(this);return i.reject.call(void 0,o),i.promise}}),M({target:"Promise",stat:!0,forced:fg},{resolve:function(o){return bk(this,o)}}),M({target:"Promise",stat:!0,forced:Cx},{all:function(o){var i=this,s=Ye(i),h=s.resolve,f=s.reject,_=ck(function(){var w=Bb(i.resolve),j=[],F=0,K=1;yh(o,function(_e){var _o=F++,ca=!1;j.push(void 0),K++,w.call(i,_e).then(function(_c){ca||(ca=!0,j[_o]=_c,--K||h(j))},f)}),--K||h(j)});return _.error&&f(_.value),s.promise},race:function(o){var i=this,s=Ye(i),h=s.reject,f=ck(function(){var _=Bb(i.resolve);yh(o,function(w){_.call(i,w).then(s.resolve,h)})});return f.error&&h(f.value),s.promise}});var Ix=Math.floor,Jx="".replace,Kx=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Lx=/\$([$&'`]|\d{1,2})/g,Mx=function(o,i,s,h,f,_){var w=s+o.length,j=h.length,F=Lx;return f!==void 0&&(f=Va(f),F=Kx),Jx.call(_,F,function(K,_e){switch(_e.charAt(0)){case"$":return"$";case"&":return o;case"`":return i.slice(0,s);case"'":return i.slice(w);case"<":K=f[_e.slice(1,-1)];break;default:var _o=+_e;if(_o===0)return K;if(_o>j)return(_o=Ix(_o/10))===0?K:_o<=j?h[_o-1]===void 0?_e.charAt(1):h[_o-1]+_e.charAt(1):K;K=h[_o-1]}return K===void 0?"":K})},Nx=Math.max,Ox=Math.min,Px=function(o){return o===void 0?o:String(o)};rh("replace",2,function(o,i,s,h){var f=h.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=h.REPLACE_KEEPS_$0,w=f?"$":"$0";return[function(j,F){var K=mb(this),_e=j==null?void 0:j[o];return _e!==void 0?_e.call(j,K,F):i.call(String(K),j,F)},function(j,F){if(!f&&_||typeof F=="string"&&F.indexOf(w)===-1){var K=s(i,j,this,F);if(K.done)return K.value}var _e=sa(j);j=String(this),(K=typeof F=="function")||(F=String(F));var _o=_e.global;if(_o){var ca=_e.unicode;_e.lastIndex=0}for(var _c=[];;){var ch=Se(_e,j);if(ch===null||(_c.push(ch),!_o))break;String(ch[0])===""&&(_e.lastIndex=Gj(j,va(_e.lastIndex),ca))}for(ca="",_o=_e=0;_o<_c.length;_o++){ch=_c[_o];for(var Nf=String(ch[0]),bh=Nx(Ox(fc(ch.index),j.length),0),_g=[],_v=1;_v<ch.length;_v++)_g.push(Px(ch[_v]));ch=ch.groups,K?(_g=[Nf].concat(_g,bh,j),ch!==void 0&&_g.push(ch),ch=String(F.apply(void 0,_g))):ch=Mx(Nf,j,bh,_g,ch,F),bh>=_e&&(ca+=j.slice(_e,bh)+ch,_e=bh+Nf.length)}return ca+j.slice(_e)}]});var Qx=Yf("slice"),Rx=qa("species"),Sx=[].slice,Tx=Math.max;M({target:"Array",proto:!0,forced:!Qx},{slice:function(o,i){var s=tb(this),h=va(s.length);if(o=Ab(o,h),i=Ab(i===void 0?h:i,h),qd(s)){var f=s.constructor;if(typeof f!="function"||f!==Array&&!qd(f.prototype)?ha(f)&&(f=f[Rx])===null&&(f=void 0):f=void 0,f===Array||f===void 0)return Sx.call(s,o,i)}for(f=new(f===void 0?Array:f)(Tx(i-o,0)),h=0;o<i;o++,h++)o in s&&Ve(f,h,s[o]);return f.length=h,f}});var Ux=La.set,Vx=La.getterFor("Array Iterator"),sd=Qj(Array,"Array",function(o,i){Ux(this,{type:"Array Iterator",target:tb(o),index:0,kind:i})},function(){var o=Vx(this),i=o.target,s=o.kind,h=o.index++;return!i||h>=i.length?(o.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:h,done:!1}:s=="values"?{value:i[h],done:!1}:{value:[h,i[h]],done:!1}},"values");Ue.Arguments=Ue.Array,Vd("keys"),Vd("values"),Vd("entries");var zp=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined",af=function(o){if(o===void 0)return 0;o=fc(o);var i=va(o);if(o!==i)throw RangeError("Wrong length or index");return i},Wx=Math.abs,Pc=Math.pow,Xx=Math.floor,Yx=Math.log,Zx=Math.LN2,ik=function(o){var i=Va(this),s=va(i.length),h=arguments.length,f=Ab(1<h?arguments[1]:void 0,s);for(s=(h=2<h?arguments[2]:void 0)===void 0?s:Ab(h,s);s>f;)i[f++]=o;return i},$x=Rd.f,ay=Wa.f,bf=La.get,Ap=La.set,ic=C.ArrayBuffer,Db=ic,jc=C.DataView,Eh=jc&&jc.prototype,Bp=Object.prototype,Fh=C.RangeError,Cp=function(o,i,s){var h,f=Array(s),_=(1<<(s=8*s-i-1))-1,w=_>>1,j=i===23?Pc(2,-24)-Pc(2,-77):0,F=0>o||o===0&&0>1/o?1:0,K=0;if((o=Wx(o))!=o||1/0===o){o=o!=o?1:0;var _e=_}else _e=Xx(Yx(o)/Zx),1>o*(h=Pc(2,-_e))&&(_e--,h*=2),2<=(o=1<=_e+w?o+j/h:o+j*Pc(2,1-w))*h&&(_e++,h/=2),_e+w>=_?(o=0,_e=_):1<=_e+w?(o=(o*h-1)*Pc(2,i),_e+=w):(o=o*Pc(2,w-1)*Pc(2,i),_e=0);for(;8<=i;f[K++]=255&o,o/=256,i-=8);for(_e=_e<<i|o,s+=i;0<s;f[K++]=255&_e,_e/=256,s-=8);return f[--K]|=128*F,f},Dp=function(o,i){var s=o.length,h=8*s-i-1,f=(1<<h)-1,_=f>>1;h-=7,--s;var w=o[s--],j=127&w;for(w>>=7;0<h;j=256*j+o[s],s--,h-=8);var F=j&(1<<-h)-1;for(j>>=-h,h+=i;0<h;F=256*F+o[s],s--,h-=8);if(j===0)j=1-_;else{if(j===f)return F?NaN:w?-1/0:1/0;F+=Pc(2,i),j-=_}return(w?-1:1)*F*Pc(2,j-i)},Ep=function(o){return[255&o]},Fp=function(o){return[255&o,o>>8&255]},Gp=function(o){return[255&o,o>>8&255,o>>16&255,o>>24&255]},Hp=function(o){return o[3]<<24|o[2]<<16|o[1]<<8|o[0]},by=function(o){return Cp(o,23,4)},cy=function(o){return Cp(o,52,8)},Gh=function(o,i){ay(o.prototype,i,{get:function(){return bf(this)[i]}})},td=function(o,i,s,h){s=af(s);var f=bf(o);if(s+i>f.byteLength)throw Fh("Wrong index");return o=bf(f.buffer).bytes,s+=f.byteOffset,i=o.slice(s,s+i),h?i:i.reverse()},ud=function(o,i,s,h,f,_){s=af(s);var w=bf(o);if(s+i>w.byteLength)throw Fh("Wrong index");for(o=bf(w.buffer).bytes,s+=w.byteOffset,h=h(+f),f=0;f<i;f++)o[s+f]=h[_?f:i-f-1]};if(zp){if(!R(function(){ic(1)})||!R(function(){new ic(-1)})||R(function(){return new ic,new ic(1.5),new ic(NaN),ic.name!="ArrayBuffer"})){Db=function(o){return hc(this,Db),new ic(af(o))};for(var dy=Db.prototype=ic.prototype,Ip=$x(ic),Jp=0,jk;Ip.length>Jp;)(jk=Ip[Jp++])in Db||Sa(Db,jk,ic[jk]);dy.constructor=Db}Ya&&ac(Eh)!==Bp&&Ya(Eh,Bp);var Hh=new jc(new Db(2)),Kp=Eh.setInt8;Hh.setInt8(0,2147483648),Hh.setInt8(1,2147483649),!Hh.getInt8(0)&&Hh.getInt8(1)||Xe(Eh,{setInt8:function(o,i){Kp.call(this,o,i<<24>>24)},setUint8:function(o,i){Kp.call(this,o,i<<24>>24)}},{unsafe:!0})}else Db=function(o){hc(this,Db,"ArrayBuffer"),o=af(o),Ap(this,{bytes:ik.call(Array(o),0),byteLength:o}),fa||(this.byteLength=o)},jc=function(o,i,s){hc(this,jc,"DataView"),hc(o,Db,"DataView");var h=bf(o).byteLength;if(0>(i=fc(i))||i>h)throw Fh("Wrong offset");if(i+(s=s===void 0?h-i:va(s))>h)throw Fh("Wrong length");Ap(this,{buffer:o,byteLength:s,byteOffset:i}),fa||(this.buffer=o,this.byteLength=s,this.byteOffset=i)},fa&&(Gh(Db,"byteLength"),Gh(jc,"buffer"),Gh(jc,"byteLength"),Gh(jc,"byteOffset")),Xe(jc.prototype,{getInt8:function(o){return td(this,1,o)[0]<<24>>24},getUint8:function(o){return td(this,1,o)[0]},getInt16:function(o){var i=td(this,2,o,1<arguments.length?arguments[1]:void 0);return(i[1]<<8|i[0])<<16>>16},getUint16:function(o){var i=td(this,2,o,1<arguments.length?arguments[1]:void 0);return i[1]<<8|i[0]},getInt32:function(o){return Hp(td(this,4,o,1<arguments.length?arguments[1]:void 0))},getUint32:function(o){return Hp(td(this,4,o,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(o){return Dp(td(this,4,o,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(o){return Dp(td(this,8,o,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(o,i){ud(this,1,o,Ep,i)},setUint8:function(o,i){ud(this,1,o,Ep,i)},setInt16:function(o,i){ud(this,2,o,Fp,i,2<arguments.length?arguments[2]:void 0)},setUint16:function(o,i){ud(this,2,o,Fp,i,2<arguments.length?arguments[2]:void 0)},setInt32:function(o,i){ud(this,4,o,Gp,i,2<arguments.length?arguments[2]:void 0)},setUint32:function(o,i){ud(this,4,o,Gp,i,2<arguments.length?arguments[2]:void 0)},setFloat32:function(o,i){ud(this,4,o,by,i,2<arguments.length?arguments[2]:void 0)},setFloat64:function(o,i){ud(this,8,o,cy,i,2<arguments.length?arguments[2]:void 0)}});gc(Db,"ArrayBuffer"),gc(jc,"DataView");var gg={ArrayBuffer:Db,DataView:jc},kk=gg.ArrayBuffer,Lp=gg.DataView,Mp=kk.prototype.slice,ey=R(function(){return!new kk(2).slice(1,void 0).byteLength});M({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ey},{slice:function(o,i){if(Mp!==void 0&&i===void 0)return Mp.call(sa(this),o);var s=sa(this).byteLength;o=Ab(o,s),i=Ab(i===void 0?s:i,s),s=new(od(this,kk))(va(i-o));for(var h=new Lp(this),f=new Lp(s),_=0;o<i;)f.setUint8(_++,h.getUint8(o++));return s}});var fy=Wa.f,Ih=C.Int8Array,lk=Ih&&Ih.prototype,Np=C.Uint8ClampedArray,Op=Np&&Np.prototype,xc=Ih&&ac(Ih),kc=lk&&ac(lk),Pp=Object.prototype,Qp=Pp.isPrototypeOf,Rp=qa("toStringTag"),mk=Oe("TYPED_ARRAY_TAG"),Qc=zp&&!!Ya&&We(C.opera)!=="Opera",Sp=!1,Eb,yc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gy={BigInt64Array:8,BigUint64Array:8},Jh=function(o){return!!ha(o)&&(o=We(o),Q(yc,o)||Q(gy,o))};for(Eb in yc)C[Eb]||(Qc=!1);if((!Qc||typeof xc!="function"||xc===Function.prototype)&&(xc=function(){throw TypeError("Incorrect invocation")},Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb],xc);if((!Qc||!kc||kc===Pp)&&(kc=xc.prototype,Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb].prototype,kc);if(Qc&&ac(Op)!==kc&&Ya(Op,kc),fa&&!Q(kc,Rp))for(Eb in Sp=!0,fy(kc,Rp,{get:function(){return ha(this)?this[mk]:void 0}}),yc)C[Eb]&&Sa(C[Eb],mk,Eb);var hg=Qc,Tp=Sp&&mk,Fa=function(o){if(Jh(o))return o;throw TypeError("Target is not a typed array")},cf=function(o){if(Ya){if(Qp.call(xc,o))return o}else for(var i in yc)if(Q(yc,Eb)){var s=C[i];if(s&&(o===s||Qp.call(s,o)))return o}throw TypeError("Target is not a typed array constructor")},Ba=function(o,i,s){if(fa){if(s)for(var h in yc){var f=C[h];if(f&&Q(f.prototype,o))try{delete f.prototype[o]}catch{}}kc[o]&&!s||Ea(kc,o,s?i:Qc&&lk[o]||i)}},Up=function(o,i,s){var h,f;if(fa){if(Ya){if(s){for(h in yc)if((f=C[h])&&Q(f,o))try{delete f[o]}catch{}}if(xc[o]&&!s)return;try{return Ea(xc,o,s?i:Qc&&xc[o]||i)}catch{}}for(h in yc)!(f=C[h])||f[o]&&!s||Ea(f,o,i)}},Vp=xc,ig=kc,hy=C.ArrayBuffer,Yd=C.Int8Array,nk=!hg||!R(function(){Yd(1)})||!R(function(){new Yd(-1)})||!uh(function(o){new Yd,new Yd(null),new Yd(1.5),new Yd(o)},!0)||R(function(){return new Yd(new hy(2),1,void 0).length!==1}),Kh=function(o,i){if(0>(o=fc(o)))throw RangeError("The argument can't be less than 0");if(o%i)throw RangeError("Wrong offset");return o},ok=function(o){var i=Va(o),s=arguments.length,h=1<s?arguments[1]:void 0,f=h!==void 0,_=Zf(i);if(_!=null&&!Kj(_)){var w=_.call(i),j=w.next;for(i=[];!(_=j.call(w)).done;)i.push(_.value)}for(f&&2<s&&(h=pd(h,arguments[2],2)),_=va(i.length),w=new(cf(this))(_),s=0;_>s;s++)w[s]=f?h(i[s],s):i[s];return w},Lh=function(o,i,s){var h,f;return Ya&&typeof(h=i.constructor)=="function"&&h!==s&&ha(f=h.prototype)&&f!==s.prototype&&Ya(o,f),o},jg=cb(function(o){var i=Rd.f,s=La.get,h=La.set,f=Wa.f,_=Jb.f,w=Math.round,j=C.RangeError,F=gg.ArrayBuffer,K=gg.DataView,_e=function(bh,_g){var _v=0,h0=_g.length;for(bh=new(cf(bh))(h0);h0>_v;)bh[_v]=_g[_v++];return bh},_o=function(bh,_g){f(bh,_g,{get:function(){return s(this)[_g]}})},ca=function(bh){var _g;return bh instanceof F||(_g=We(bh))=="ArrayBuffer"||_g=="SharedArrayBuffer"},_c=function(bh,_g){return Jh(bh)&&typeof _g!="symbol"&&_g in bh&&String(+_g)==String(_g)},ch=function(bh,_g){return _c(bh,_g=tc(_g,!0))?sc(2,bh[_g]):_(bh,_g)},Nf=function(bh,_g,_v){return!(_c(bh,_g=tc(_g,!0))&&ha(_v)&&Q(_v,"value"))||Q(_v,"get")||Q(_v,"set")||_v.configurable||Q(_v,"writable")&&!_v.writable||Q(_v,"enumerable")&&!_v.enumerable?f(bh,_g,_v):(bh[_g]=_v.value,bh)};fa?(hg||(Jb.f=ch,Wa.f=Nf,_o(ig,"buffer"),_o(ig,"byteOffset"),_o(ig,"byteLength"),_o(ig,"length")),M({target:"Object",stat:!0,forced:!hg},{getOwnPropertyDescriptor:ch,defineProperty:Nf}),o.exports=function(bh,_g,_v){var h0=bh.match(/\d+$/)[0]/8,A0=bh+(_v?"Clamped":"")+"Array",M0="get"+bh,R0="set"+bh,k0=C[A0],G0=k0;bh=G0&&G0.prototype;var pI={},u0=function(C0,v0){f(C0,v0,{get:function(){var T0=s(this);return T0.view[M0](v0*h0+T0.byteOffset,!0)},set:function(T0){var Qv=s(this);_v&&(T0=0>(T0=w(T0))?0:255<T0?255:255&T0),Qv.view[R0](v0*h0+Qv.byteOffset,T0,!0)},enumerable:!0})};hg?nk&&(G0=_g(function(C0,v0,T0,Qv){return hc(C0,G0,A0),Lh(ha(v0)?ca(v0)?Qv!==void 0?new k0(v0,Kh(T0,h0),Qv):T0!==void 0?new k0(v0,Kh(T0,h0)):new k0(v0):Jh(v0)?_e(G0,v0):ok.call(G0,v0):new k0(af(v0)),C0,G0)}),Ya&&Ya(G0,Vp),Sd(i(k0),function(C0){C0 in G0||Sa(G0,C0,k0[C0])}),G0.prototype=bh):(G0=_g(function(C0,v0,T0,Qv){hc(C0,G0,A0);var r0=0,a0=0;if(ha(v0)){if(!ca(v0))return Jh(v0)?_e(G0,v0):ok.call(G0,v0);var I0=v0;if(a0=Kh(T0,h0),v0=v0.byteLength,Qv===void 0){if(v0%h0||0>(Qv=v0-a0))throw j("Wrong length")}else if((Qv=va(Qv)*h0)+a0>v0)throw j("Wrong length");v0=Qv/h0}else v0=af(v0),I0=new F(Qv=v0*h0);for(h(C0,{buffer:I0,byteOffset:a0,byteLength:Qv,length:v0,view:new K(I0)});r0<v0;)u0(C0,r0++)}),Ya&&Ya(G0,Vp),bh=G0.prototype=Sb(ig)),bh.constructor!==G0&&Sa(bh,"constructor",G0),Tp&&Sa(bh,Tp,A0),pI[A0]=G0,M({global:!0,forced:G0!=k0,sham:!hg},pI),"BYTES_PER_ELEMENT"in G0||Sa(G0,"BYTES_PER_ELEMENT",h0),"BYTES_PER_ELEMENT"in bh||Sa(bh,"BYTES_PER_ELEMENT",h0),ag(A0)}):o.exports=function(){}});jg("Uint8",function(o){return function(i,s,h){return o(this,i,s,h)}});var iy=Math.min,jy=[].copyWithin||function(o,i){var s=Va(this),h=va(s.length),f=Ab(o,h),_=Ab(i,h),w=2<arguments.length?arguments[2]:void 0;for(h=iy((w===void 0?h:Ab(w,h))-_,h-f),w=1,_<f&&f<_+h&&(w=-1,_+=h-1,f+=h-1);0<h--;)_ in s?s[f]=s[_]:delete s[f],f+=w,_+=w;return s};Ba("copyWithin",function(o,i){return jy.call(Fa(this),o,i,2<arguments.length?arguments[2]:void 0)}),Ba("every",function(o){return Sw(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("fill",function(o){return ik.apply(Fa(this),arguments)}),Ba("filter",function(o){var i=Ko(Fa(this),o,1<arguments.length?arguments[1]:void 0),s=od(this,this.constructor),h=0,f=i.length;for(s=new(cf(s))(f);f>h;)s[h]=i[h++];return s}),Ba("find",function(o){return Lo(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("findIndex",function(o){return Mo(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("forEach",function(o){Sd(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("includes",function(o){return so(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("indexOf",function(o){return zj(Fa(this),o,1<arguments.length?arguments[1]:void 0)});var Wp=qa("iterator"),Xp=C.Uint8Array,ky=sd.values,ly=sd.keys,my=sd.entries,pk=Xp&&Xp.prototype[Wp],Yp=!!pk&&(pk.name=="values"||pk.name==null),Zp=function(){return ky.call(Fa(this))};Ba("entries",function(){return my.call(Fa(this))}),Ba("keys",function(){return ly.call(Fa(this))}),Ba("values",Zp,!Yp),Ba(Wp,Zp,!Yp);var ny=[].join;Ba("join",function(o){return ny.apply(Fa(this),arguments)});var oy=Math.min,qk=[].lastIndexOf,$p=!!qk&&0>1/[1].lastIndexOf(1,-0),py=Te("lastIndexOf"),qy=$p||!py?function(o){if($p)return qk.apply(this,arguments)||0;var i=tb(this),s=va(i.length),h=s-1;for(1<arguments.length&&(h=oy(h,fc(arguments[1]))),0>h&&(h=s+h);0<=h;h--)if(h in i&&i[h]===o)return h||0;return-1}:qk;Ba("lastIndexOf",function(o){return qy.apply(Fa(this),arguments)}),Ba("map",function(o){return Jo(Fa(this),o,1<arguments.length?arguments[1]:void 0,function(i,s){return new(cf(od(i,i.constructor)))(s)})});var aq=function(o){return function(i,s,h,f){Bb(s),i=Va(i);var _=Tf(i),w=va(i.length),j=o?w-1:0,F=o?-1:1;if(2>h)for(;;){if(j in _){f=_[j],j+=F;break}if(j+=F,o?0>j:w<=j)throw TypeError("Reduce of empty array with no initial value")}for(;o?0<=j:w>j;j+=F)j in _&&(f=s(f,_[j],j,i));return f}},bq=aq(!1),ry=aq(!0);Ba("reduce",function(o){return bq(Fa(this),o,arguments.length,1<arguments.length?arguments[1]:void 0)}),Ba("reduceRight",function(o){return ry(Fa(this),o,arguments.length,1<arguments.length?arguments[1]:void 0)});var sy=Math.floor;Ba("reverse",function(){for(var o,i=Fa(this).length,s=sy(i/2),h=0;h<s;)o=this[h],this[h++]=this[--i],this[i]=o;return this});var ty=R(function(){new Int8Array(1).set({})});Ba("set",function(o){Fa(this);var i=Kh(1<arguments.length?arguments[1]:void 0,1),s=this.length,h=Va(o),f=va(h.length),_=0;if(f+i>s)throw RangeError("Wrong length");for(;_<f;)this[i+_]=h[_++]},ty);var uy=[].slice,vy=R(function(){new Int8Array(1).slice()});Ba("slice",function(o,i){o=uy.call(Fa(this),o,i);var s=od(this,this.constructor);i=0;var h=o.length;for(s=new(cf(s))(h);h>i;)s[i]=o[i++];return s},vy),Ba("some",function(o){return Rw(Fa(this),o,1<arguments.length?arguments[1]:void 0)});var wy=[].sort;Ba("sort",function(o){return wy.call(Fa(this),o)}),Ba("subarray",function(o,i){var s=Fa(this),h=s.length;return o=Ab(o,h),new(od(s,s.constructor))(s.buffer,s.byteOffset+o*s.BYTES_PER_ELEMENT,va((i===void 0?h:Ab(i,h))-o))});var Mh=C.Int8Array,cq=[].toLocaleString,xy=[].slice,yy=!!Mh&&R(function(){cq.call(new Mh(1))}),zy=R(function(){return[1,2].toLocaleString()!=new Mh([1,2]).toLocaleString()})||!R(function(){Mh.prototype.toLocaleString.call([1,2])});Ba("toLocaleString",function(){return cq.apply(yy?xy.call(Fa(this)):Fa(this),arguments)},zy);var dq=C.Uint8Array,Ay=dq&&dq.prototype||{},Nh=[].toString,By=[].join;R(function(){Nh.call({})})&&(Nh=function(){return By.call(this)}),Ba("toString",Nh,Ay.toString!=Nh);var eq=gg.ArrayBuffer;M({global:!0,forced:C.ArrayBuffer!==eq},{ArrayBuffer:eq}),ag("ArrayBuffer");var Cy=Wa.f,rk=Function.prototype,Dy=rk.toString,Ey=/^\s*function ([^ (]*)/;!fa||"name"in rk||Cy(rk,"name",{configurable:!0,get:function(){try{return Dy.call(this).match(Ey)[1]}catch{return""}}});var fq=RegExp.prototype,gq=fq.toString,Fy=R(function(){return gq.call({source:"a",flags:"b"})!="/a/b"}),Gy=gq.name!="toString";(Fy||Gy)&&Ea(RegExp.prototype,"toString",function(){var o=sa(this),i=String(o.source),s=o.flags;return"/"+i+"/"+(o=String(s===void 0&&o instanceof RegExp&&!("flags"in fq)?Aj.call(o):s))},{unsafe:!0});var Hy=Yf("splice"),Iy=Math.max,Jy=Math.min;M({target:"Array",proto:!0,forced:!Hy},{splice:function(o,i){var s,h,f=Va(this),_=va(f.length),w=Ab(o,_),j=arguments.length;if(j===0?j=s=0:j===1?(j=0,s=_-w):(j-=2,s=Jy(Iy(fc(i),0),_-w)),9007199254740991<_+j-s)throw TypeError("Maximum allowed length exceeded");var F=th(f,s);for(h=0;h<s;h++){var K=w+h;K in f&&Ve(F,h,f[K])}if(F.length=s,j<s){for(h=w;h<_-s;h++){var _e=h+j;(K=h+s)in f?f[_e]=f[K]:delete f[_e]}for(h=_;h>_-s+j;h--)delete f[h-1]}else if(j>s)for(h=_-s;h>w;h--)_e=h+j-1,(K=h+s-1)in f?f[_e]=f[K]:delete f[_e];for(h=0;h<j;h++)f[h+w]=arguments[h+2];return f.length=_-s+j,F}});var sk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tk=qa("iterator"),hq=qa("toStringTag"),uk=sd.values,Oh;for(Oh in sk){var iq=C[Oh],Rc=iq&&iq.prototype;if(Rc){if(Rc[tk]!==uk)try{Sa(Rc,tk,uk)}catch{Rc[tk]=uk}if(Rc[hq]||Sa(Rc,hq,Oh),sk[Oh]){for(var df in sd)if(Rc[df]!==sd[df])try{Sa(Rc,df,sd[df])}catch{Rc[df]=sd[df]}}}}var jq=Object.is||function(o,i){return o===i?o!==0||1/o==1/i:o!=o&&i!=i};rh("search",1,function(o,i,s){return[function(h){var f=mb(this),_=h==null?void 0:h[o];return _!==void 0?_.call(h,f):new RegExp(h)[o](String(f))},function(h){var f=s(i,h,this);if(f.done)return f.value;h=sa(h);var _=String(this);return f=h.lastIndex,jq(f,0)||(h.lastIndex=0),_=Se(h,_),jq(h.lastIndex,f)||(h.lastIndex=f),_===null?-1:_.index}]}),cb(function(o){(function(i,s){o.exports?o.exports=s(i):s(i)})(typeof self!="undefined"?self:Ka,function(i){function s(u0){return btoa(u0).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function h(u0){return u0=(u0+="===").slice(0,-u0.length%4),atob(u0.replace(/-/g,"+").replace(/_/g,"/"))}function f(u0){for(var C0=new Uint8Array(u0.length),v0=0;v0<u0.length;v0++)C0[v0]=u0.charCodeAt(v0);return C0}function _(u0){return u0 instanceof ArrayBuffer&&(u0=new Uint8Array(u0)),String.fromCharCode.apply(String,u0)}function w(u0){var C0={name:(u0.name||u0||"").toUpperCase().replace("V","v")};switch(C0.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":u0.length&&(C0.length=u0.length);break;case"HMAC":u0.hash&&(C0.hash=w(u0.hash)),u0.length&&(C0.length=u0.length);break;case"RSAES-PKCS1-v1_5":u0.publicExponent&&(C0.publicExponent=new Uint8Array(u0.publicExponent)),u0.modulusLength&&(C0.modulusLength=u0.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":u0.hash&&(C0.hash=w(u0.hash)),u0.publicExponent&&(C0.publicExponent=new Uint8Array(u0.publicExponent)),u0.modulusLength&&(C0.modulusLength=u0.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return C0}function j(u0){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[u0.name][(u0.hash||{}).name||u0.length||""]}function F(u0){(u0 instanceof ArrayBuffer||u0 instanceof Uint8Array)&&(u0=JSON.parse(decodeURIComponent(escape(_(u0)))));var C0={kty:u0.kty,alg:u0.alg,ext:u0.ext||u0.extractable};switch(C0.kty){case"oct":C0.k=u0.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(v0){v0 in u0&&(C0[v0]=u0[v0])});break;default:throw new TypeError("Unsupported key type")}return C0}function K(u0){return u0=F(u0),M0&&(u0.extractable=u0.ext,delete u0.ext),f(unescape(encodeURIComponent(JSON.stringify(u0)))).buffer}function _e(u0){var C0=_o(u0),v0=!1;switch(2<C0.length&&(v0=!0,C0.shift()),u0={ext:!0},C0[0][0]){case"1.2.840.113549.1.1.1":var T0="n e d p q dp dq qi".split(" ");for(C0=_o(C0[1]),v0&&C0.shift(),v0=0;v0<C0.length;v0++)C0[v0][0]||(C0[v0]=C0[v0].subarray(1)),u0[T0[v0]]=s(_(C0[v0]));u0.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return u0}function _o(u0,C0){if(u0 instanceof ArrayBuffer&&(u0=new Uint8Array(u0)),C0||(C0={pos:0,end:u0.length}),2>C0.end-C0.pos||C0.end>u0.length)throw new RangeError("Malformed DER");var v0=u0[C0.pos++],T0=u0[C0.pos++];if(128<=T0){if(T0&=127,C0.end-C0.pos<T0)throw new RangeError("Malformed DER");for(var Qv=0;T0--;)Qv<<=8,Qv|=u0[C0.pos++];T0=Qv}if(C0.end-C0.pos<T0)throw new RangeError("Malformed DER");switch(v0){case 2:v0=u0.subarray(C0.pos,C0.pos+=T0);break;case 3:if(u0[C0.pos++])throw Error("Unsupported bit string");T0--;case 4:v0=new Uint8Array(u0.subarray(C0.pos,C0.pos+=T0)).buffer;break;case 5:v0=null;break;case 6:if(!((u0=btoa(_(u0.subarray(C0.pos,C0.pos+=T0))))in k0))throw Error("Unsupported OBJECT ID "+u0);v0=k0[u0];break;case 48:for(v0=[],T0=C0.pos+T0;C0.pos<T0;)v0.push(_o(u0,C0));break;default:throw Error("Unsupported DER tag 0x"+v0.toString(16))}return v0}function ca(u0,C0){C0||(C0=[]);var v0=C0.length+2;if(C0.push(0,0),u0 instanceof Uint8Array)for(var T0=2,Qv=u0.length,r0=0;r0<Qv;r0++)C0.push(u0[r0]);else if(u0 instanceof ArrayBuffer)for(T0=4,Qv=u0.byteLength,u0=new Uint8Array(u0),r0=0;r0<Qv;r0++)C0.push(u0[r0]);else if(u0===null)T0=5,Qv=0;else if(typeof u0=="string"&&u0 in G0)for(T0=6,Qv=(u0=f(atob(G0[u0]))).length,r0=0;r0<Qv;r0++)C0.push(u0[r0]);else if(u0 instanceof Array){for(r0=0;r0<u0.length;r0++)ca(u0[r0],C0);T0=48,Qv=C0.length-v0}else{if(!(V(u0)==="object"&&u0.tag===3&&u0.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+u0);for(T0=3,Qv=(u0=new Uint8Array(u0.value)).byteLength,C0.push(0),r0=0;r0<Qv;r0++)C0.push(u0[r0]);Qv++}if(128<=Qv){for(r0=Qv,Qv=4,C0.splice(v0,0,r0>>24&255,r0>>16&255,r0>>8&255,255&r0);1<Qv&&!(r0>>24);)r0<<=8,Qv--;4>Qv&&C0.splice(v0,4-Qv),Qv|=128}return C0.splice(v0-2,2,T0,Qv),C0}function _c(u0,C0,v0,T0){Object.defineProperties(this,{_key:{value:u0},type:{value:u0.type,enumerable:!0},extractable:{value:v0===void 0?u0.extractable:v0,enumerable:!0},algorithm:{value:C0===void 0?u0.algorithm:C0,enumerable:!0},usages:{value:T0===void 0?u0.usages:T0,enumerable:!0}})}function ch(u0){return u0==="verify"||u0==="encrypt"||u0==="wrapKey"}function Nf(u0){return u0==="sign"||u0==="decrypt"||u0==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var bh=i.crypto||i.msCrypto;if(bh){var _g=bh.subtle||bh.webkitSubtle;if(_g){var _v=i.Crypto||bh.constructor||Object,h0=i.SubtleCrypto||_g.constructor||Object;i.CryptoKey||i.Key;var A0=-1<i.navigator.userAgent.indexOf("Edge/"),M0=!!i.msCrypto&&!A0,R0=!bh.subtle&&!!bh.webkitSubtle;if(M0||R0){var k0={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},G0={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(u0){var C0=_g[u0];_g[u0]=function(v0,T0,Qv){var r0=[].slice.call(arguments);switch(u0){case"generateKey":var a0=w(v0),I0=T0,O0=Qv;break;case"importKey":a0=w(Qv),I0=r0[3],O0=r0[4],v0==="jwk"&&((T0=F(T0)).alg||(T0.alg=j(a0)),T0.key_ops||(T0.key_ops=T0.kty!=="oct"?"d"in T0?O0.filter(Nf):O0.filter(ch):O0.slice()),r0[1]=K(T0));break;case"unwrapKey":a0=r0[4],I0=r0[5],O0=r0[6],r0[2]=Qv._key}if(u0==="generateKey"&&a0.name==="HMAC"&&a0.hash)return a0.length=a0.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[a0.hash.name],_g.importKey("raw",bh.getRandomValues(new Uint8Array(a0.length+7>>3)),a0,I0,O0);if(R0&&u0==="generateKey"&&a0.name==="RSASSA-PKCS1-v1_5"&&(!a0.modulusLength||2048<=a0.modulusLength))return(v0=w(v0)).name="RSAES-PKCS1-v1_5",delete v0.hash,_g.generateKey(v0,!0,["encrypt","decrypt"]).then(function(U0){return Promise.all([_g.exportKey("jwk",U0.publicKey),_g.exportKey("jwk",U0.privateKey)])}).then(function(U0){return U0[0].alg=U0[1].alg=j(a0),U0[0].key_ops=O0.filter(ch),U0[1].key_ops=O0.filter(Nf),Promise.all([_g.importKey("jwk",U0[0],a0,!0,U0[0].key_ops),_g.importKey("jwk",U0[1],a0,I0,U0[1].key_ops)])}).then(function(U0){return{publicKey:U0[0],privateKey:U0[1]}});if((R0||M0&&(a0.hash||{}).name==="SHA-1")&&u0==="importKey"&&v0==="jwk"&&a0.name==="HMAC"&&T0.kty==="oct")return _g.importKey("raw",f(h(T0.k)),Qv,r0[3],r0[4]);if(R0&&u0==="importKey"&&(v0==="spki"||v0==="pkcs8"))return _g.importKey("jwk",_e(T0),Qv,r0[3],r0[4]);if(M0&&u0==="unwrapKey")return _g.decrypt(r0[3],Qv,T0).then(function(U0){return _g.importKey(v0,U0,r0[4],r0[5],r0[6])});try{var nI=C0.apply(_g,r0)}catch(U0){return Promise.reject(U0)}return M0&&(nI=new Promise(function(U0,_I){nI.onabort=nI.onerror=function(dI){_I(dI)},nI.oncomplete=function(dI){U0(dI.target.result)}})),nI=nI.then(function(U0){return a0.name!=="HMAC"||a0.length||(a0.length=8*U0.algorithm.length),a0.name.search("RSA")==0&&(a0.modulusLength||(a0.modulusLength=(U0.publicKey||U0).algorithm.modulusLength),a0.publicExponent||(a0.publicExponent=(U0.publicKey||U0).algorithm.publicExponent)),U0.publicKey&&U0.privateKey?{publicKey:new _c(U0.publicKey,a0,I0,O0.filter(ch)),privateKey:new _c(U0.privateKey,a0,I0,O0.filter(Nf))}:new _c(U0,a0,I0,O0)})}}),["exportKey","wrapKey"].forEach(function(u0){var C0=_g[u0];_g[u0]=function(v0,T0,Qv){var r0=[].slice.call(arguments);switch(u0){case"exportKey":r0[1]=T0._key;break;case"wrapKey":r0[1]=T0._key,r0[2]=Qv._key}if((R0||M0&&(T0.algorithm.hash||{}).name==="SHA-1")&&u0==="exportKey"&&v0==="jwk"&&T0.algorithm.name==="HMAC"&&(r0[0]="raw"),!R0||u0!=="exportKey"||v0!=="spki"&&v0!=="pkcs8"||(r0[0]="jwk"),M0&&u0==="wrapKey")return _g.exportKey(v0,T0).then(function(I0){return v0==="jwk"&&(I0=f(unescape(encodeURIComponent(JSON.stringify(F(I0)))))),_g.encrypt(r0[3],Qv,I0)});try{var a0=C0.apply(_g,r0)}catch(I0){return Promise.reject(I0)}return M0&&(a0=new Promise(function(I0,O0){a0.onabort=a0.onerror=function(nI){O0(nI)},a0.oncomplete=function(nI){I0(nI.target.result)}})),u0==="exportKey"&&v0==="jwk"&&(a0=a0.then(function(I0){return(R0||M0&&(T0.algorithm.hash||{}).name==="SHA-1")&&T0.algorithm.name==="HMAC"?{kty:"oct",alg:j(T0.algorithm),key_ops:T0.usages.slice(),ext:!0,k:s(_(I0))}:((I0=F(I0)).alg||(I0.alg=j(T0.algorithm)),I0.key_ops||(I0.key_ops=T0.type==="public"?T0.usages.filter(ch):T0.type==="private"?T0.usages.filter(Nf):T0.usages.slice()),I0)})),!R0||u0!=="exportKey"||v0!=="spki"&&v0!=="pkcs8"||(a0=a0.then(function(I0){var O0=[["",null]],nI=!1;switch((I0=F(I0)).kty){case"RSA":for(var U0="n e d p q dp dq qi".split(" "),_I=[],dI=0;dI<U0.length&&U0[dI]in I0;dI++){var QI=_I[dI]=f(h(I0[U0[dI]]));128&QI[0]&&(_I[dI]=new Uint8Array(QI.length+1),_I[dI].set(QI,1))}2<_I.length&&(nI=!0,_I.unshift(new Uint8Array([0]))),O0[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return O0.push(new Uint8Array(ca(_I)).buffer),nI?O0.unshift(new Uint8Array([0])):O0[1]={tag:3,value:O0[1]},new Uint8Array(ca(O0)).buffer})),a0}}),["encrypt","decrypt","sign","verify"].forEach(function(u0){var C0=_g[u0];_g[u0]=function(v0,T0,Qv,r0){if(M0&&(!Qv.byteLength||r0&&!r0.byteLength))throw Error("Empty input is not allowed");var a0=[].slice.call(arguments),I0=w(v0);if(!M0||u0!=="sign"&&u0!=="verify"||v0!=="RSASSA-PKCS1-v1_5"&&v0!=="HMAC"||(a0[0]={name:v0}),M0&&T0.algorithm.hash&&(a0[0].hash=a0[0].hash||T0.algorithm.hash),M0&&u0==="decrypt"&&I0.name==="AES-GCM"){var O0=v0.tagLength>>3;a0[2]=(Qv.buffer||Qv).slice(0,Qv.byteLength-O0),v0.tag=(Qv.buffer||Qv).slice(Qv.byteLength-O0)}M0&&I0.name==="AES-GCM"&&a0[0].tagLength===void 0&&(a0[0].tagLength=128),a0[1]=T0._key;try{var nI=C0.apply(_g,a0)}catch(U0){return Promise.reject(U0)}return M0&&(nI=new Promise(function(U0,_I){nI.onabort=nI.onerror=function(dI){_I(dI)},nI.oncomplete=function(dI){if(dI=dI.target.result,u0==="encrypt"&&dI instanceof AesGcmEncryptResult){var QI=dI.ciphertext,qI=dI.tag;(dI=new Uint8Array(QI.byteLength+qI.byteLength)).set(new Uint8Array(QI),0),dI.set(new Uint8Array(qI),QI.byteLength),dI=dI.buffer}U0(dI)}})),nI}}),M0){var pI=_g.digest;_g.digest=function(u0,C0){if(!C0.byteLength)throw Error("Empty input is not allowed");try{var v0=pI.call(_g,u0,C0)}catch(T0){return Promise.reject(T0)}return v0=new Promise(function(T0,Qv){v0.onabort=v0.onerror=function(r0){Qv(r0)},v0.oncomplete=function(r0){T0(r0.target.result)}})},i.crypto=Object.create(bh,{getRandomValues:{value:function(u0){return bh.getRandomValues(u0)}},subtle:{value:_g}}),i.CryptoKey=_c}R0&&(bh.subtle=_g,i.Crypto=_v,i.SubtleCrypto=h0,i.CryptoKey=_c)}}}})}),function(o){o.console||(o.console={}),o=o.console;for(var i,s=function(){},h=["memory"],f="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");i=h.pop();)o[i]||(o[i]={});for(;i=f.pop();)o[i]||(o[i]=s)}(typeof window=="undefined"?Ka:window),M({target:"Object",stat:!0},{setPrototypeOf:Ya});var Ky=R(function(){ac(1)});M({target:"Object",stat:!0,forced:Ky,sham:!Ro},{getPrototypeOf:function(o){return ac(Va(o))}});var kq=[].slice,vk={},Ly=Function.bind||function(o){var i=Bb(this),s=kq.call(arguments,1),h=function(){var f=s.concat(kq.call(arguments));if(this instanceof h){var _=f.length;if(!(_ in vk)){for(var w=[],j=0;j<_;j++)w[j]="a["+j+"]";vk[_]=Function("C,a","return new C("+w.join(",")+")")}f=vk[_](i,f)}else f=i.apply(o,f);return f};return ha(i.prototype)&&(h.prototype=i.prototype),h},wk=Rb("Reflect","construct"),lq=R(function(){function o(){}return!(wk(function(){},[],o)instanceof o)}),mq=!R(function(){wk(function(){})}),nq=lq||mq;M({target:"Reflect",stat:!0,forced:nq,sham:nq},{construct:function(o,i){Bb(o),sa(i);var s=3>arguments.length?o:Bb(arguments[2]);if(mq&&!lq)return wk(o,i,s);if(o==s){switch(i.length){case 0:return new o;case 1:return new o(i[0]);case 2:return new o(i[0],i[1]);case 3:return new o(i[0],i[1],i[2]);case 4:return new o(i[0],i[1],i[2],i[3])}return(s=[null]).push.apply(s,i),new(Ly.apply(o,s))}s=s.prototype,s=Sb(ha(s)?s:Object.prototype);var h=Function.apply.call(o,s,i);return ha(h)?h:s}}),M({target:"Reflect",stat:!0},{get:ym});var oq=Jb.f,My=R(function(){oq(1)});M({target:"Object",stat:!0,forced:!fa||My,sham:!fa},{getOwnPropertyDescriptor:function(o,i){return oq(tb(o),i)}});var pq=Rd.f,Ny={}.toString,qq=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xk=function(o){if(qq&&Ny.call(o)=="[object Window]")try{var i=pq(o)}catch{i=qq.slice()}else i=pq(tb(o));return i},rq={f:qa},Oy=Wa.f,Ph=function(o){var i=C.Symbol||(C.Symbol={});Q(i,o)||Oy(i,o,{value:rq.f(o)})},ub=nh("hidden"),sq=qa("toPrimitive"),Py=La.set,tq=La.getterFor("Symbol"),Tb=Object.prototype,vb=C.Symbol,kg=Rb("JSON","stringify"),uq=Jb.f,vd=Wa.f,vq=xk,Qy=Sf,Sc=ld("symbols"),lg=ld("op-symbols"),yk=ld("string-to-symbol-registry"),zk=ld("symbol-to-string-registry"),Ry=ld("wks"),Ak=C.QObject,Bk=!Ak||!Ak.prototype||!Ak.prototype.findChild,Ck=fa&&R(function(){return Sb(vd({},"a",{get:function(){return vd(this,"a",{value:7}).a}})).a!=7})?function(o,i,s){var h=uq(Tb,i);h&&delete Tb[i],vd(o,i,s),h&&o!==Tb&&vd(Tb,i,h)}:vd,Dk=function(o,i){var s=Sc[o]=Sb(vb.prototype);return Py(s,{type:"Symbol",tag:o,description:i}),fa||(s.description=i),s},Ek=Bo?function(o){return typeof o=="symbol"}:function(o){return Object(o)instanceof vb},Qh=function(o,i,s){return o===Tb&&Qh(lg,i,s),sa(o),i=tc(i,!0),sa(s),Q(Sc,i)?(s.enumerable?(Q(o,ub)&&o[ub][i]&&(o[ub][i]=!1),s=Sb(s,{enumerable:sc(0,!1)})):(Q(o,ub)||vd(o,ub,sc(1,{})),o[ub][i]=!0),Ck(o,i,s)):vd(o,i,s)},wq=function(o,i){sa(o);var s=tb(i);return i=Mc(s).concat(Fk(s)),Sd(i,function(h){fa&&!Gk.call(s,h)||Qh(o,h,s[h])}),o},Gk=function(o){o=tc(o,!0);var i=Qy.call(this,o);return!(this===Tb&&Q(Sc,o)&&!Q(lg,o))&&(!(i||!Q(this,o)||!Q(Sc,o)||Q(this,ub)&&this[ub][o])||i)},xq=function(o,i){if(o=tb(o),i=tc(i,!0),o!==Tb||!Q(Sc,i)||Q(lg,i)){var s=uq(o,i);return!s||!Q(Sc,i)||Q(o,ub)&&o[ub][i]||(s.enumerable=!0),s}},yq=function(o){o=vq(tb(o));var i=[];return Sd(o,function(s){Q(Sc,s)||Q(Pe,s)||i.push(s)}),i},Fk=function(o){var i=o===Tb;o=vq(i?lg:tb(o));var s=[];return Sd(o,function(h){!Q(Sc,h)||i&&!Q(Tb,h)||s.push(Sc[h])}),s};if(wc||(vb=function(){if(this instanceof vb)throw TypeError("Symbol is not a constructor");var o=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,i=Oe(o),s=function(h){this===Tb&&s.call(lg,h),Q(this,ub)&&Q(this[ub],i)&&(this[ub][i]=!1),Ck(this,i,sc(1,h))};return fa&&Bk&&Ck(Tb,i,{configurable:!0,set:s}),Dk(i,o)},Ea(vb.prototype,"toString",function(){return tq(this).tag}),Ea(vb,"withoutSetter",function(o){return Dk(Oe(o),o)}),Sf=Gk,Wa.f=Qh,Jb.f=xq,Rd.f=xk=yq,Uf.f=Fk,rq.f=function(o){return Dk(qa(o),o)},fa&&(vd(vb.prototype,"description",{configurable:!0,get:function(){return tq(this).description}}),Ea(Tb,"propertyIsEnumerable",Gk,{unsafe:!0}))),M({global:!0,wrap:!0,forced:!wc,sham:!wc},{Symbol:vb}),Sd(Mc(Ry),function(o){Ph(o)}),M({target:"Symbol",stat:!0,forced:!wc},{for:function(o){if(o=String(o),Q(yk,o))return yk[o];var i=vb(o);return yk[o]=i,zk[i]=o,i},keyFor:function(o){if(!Ek(o))throw TypeError(o+" is not a symbol");if(Q(zk,o))return zk[o]},useSetter:function(){Bk=!0},useSimple:function(){Bk=!1}}),M({target:"Object",stat:!0,forced:!wc,sham:!fa},{create:function(o,i){return i===void 0?Sb(o):wq(Sb(o),i)},defineProperty:Qh,defineProperties:wq,getOwnPropertyDescriptor:xq}),M({target:"Object",stat:!0,forced:!wc},{getOwnPropertyNames:yq,getOwnPropertySymbols:Fk}),M({target:"Object",stat:!0,forced:R(function(){Uf.f(1)})},{getOwnPropertySymbols:function(o){return Uf.f(Va(o))}}),kg){var Sy=!wc||R(function(){var o=vb();return kg([o])!="[null]"||kg({a:o})!="{}"||kg(Object(o))!="{}"});M({target:"JSON",stat:!0,forced:Sy},{stringify:function(o,i,s){for(var h,f=[o],_=1;arguments.length>_;)f.push(arguments[_++]);if(h=i,(ha(i)||o!==void 0)&&!Ek(o))return qd(i)||(i=function(w,j){if(typeof h=="function"&&(j=h.call(this,w,j)),!Ek(j))return j}),f[1]=i,kg.apply(null,f)}})}vb.prototype[sq]||Sa(vb.prototype,sq,vb.prototype.valueOf),gc(vb,"Symbol"),Pe[ub]=!0;var Ty=Wa.f,Tc=C.Symbol;if(fa&&typeof Tc=="function"&&(!("description"in Tc.prototype)||Tc().description!==void 0)){var zq={},mg=function(){var o=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),i=this instanceof mg?new Tc(o):o===void 0?Tc():Tc(o);return o===""&&(zq[i]=!0),i};vo(mg,Tc);var Hk=mg.prototype=Tc.prototype;Hk.constructor=mg;var Uy=Hk.toString,Vy=String(Tc("test"))=="Symbol(test)",Wy=/^Symbol\((.*)\)[^)]+$/;Ty(Hk,"description",{configurable:!0,get:function(){var o=ha(this)?this.valueOf():this,i=Uy.call(o);return Q(zq,o)?"":(o=Vy?i.slice(7,-1):i.replace(Wy,"$1"))===""?void 0:o}}),M({global:!0,forced:!0},{Symbol:mg})}Ph("toStringTag"),gc(C.JSON,"JSON",!0),gc(Math,"Math",!0),function(){function o(ca,_c){if(!(ca instanceof _c))throw new TypeError("Cannot call a class as a function")}function i(ca,_c){for(var ch=0;ch<_c.length;ch++){var Nf=_c[ch];Nf.enumerable=Nf.enumerable||!1,Nf.configurable=!0,"value"in Nf&&(Nf.writable=!0),Object.defineProperty(ca,Nf.key,Nf)}}function s(ca,_c,ch){return _c&&i(ca.prototype,_c),ch&&i(ca,ch),ca}function h(ca,_c){if(typeof _c!="function"&&_c!==null)throw new TypeError("Super expression must either be null or a function");ca.prototype=Object.create(_c&&_c.prototype,{constructor:{value:ca,writable:!0,configurable:!0}}),_c&&_(ca,_c)}function f(ca){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(_c){return _c.__proto__||Object.getPrototypeOf(_c)})(ca)}function _(ca,_c){return(_=Object.setPrototypeOf||function(ch,Nf){return ch.__proto__=Nf,ch})(ca,_c)}function w(ca){if(ca===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ca}function j(ca){var _c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var ch=f(ca);if(_c){var Nf=f(this).constructor;ch=Reflect.construct(ch,arguments,Nf)}else ch=ch.apply(this,arguments);return ch=!ch||V(ch)!=="object"&&typeof ch!="function"?w(this):ch}}function F(ca,_c,ch){return(F=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(Nf,bh,_g){for(;!Object.prototype.hasOwnProperty.call(Nf,bh)&&(Nf=f(Nf))!==null;);if(Nf)return(bh=Object.getOwnPropertyDescriptor(Nf,bh)).get?bh.get.call(_g):bh.value})(ca,_c,ch||ca)}var K=function(){function ca(){o(this,ca),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return s(ca,[{key:"addEventListener",value:function(_c,ch,Nf){_c in this.listeners||(this.listeners[_c]=[]),this.listeners[_c].push({callback:ch,options:Nf})}},{key:"removeEventListener",value:function(_c,ch){if(_c in this.listeners){for(var Nf=0,bh=(_c=this.listeners[_c]).length;Nf<bh;Nf++)if(_c[Nf].callback===ch){_c.splice(Nf,1);break}}}},{key:"dispatchEvent",value:function(_c){if(_c.type in this.listeners){for(var ch=this.listeners[_c.type].slice(),Nf=0,bh=ch.length;Nf<bh;Nf++){var _g=ch[Nf];try{_g.callback.call(this,_c)}catch(_v){Promise.resolve().then(function(){throw _v})}_g.options&&_g.options.once&&this.removeEventListener(_c.type,_g.callback)}return!_c.defaultPrevented}}}]),ca}(),_e=function(ca){function _c(){o(this,_c);var Nf=ch.call(this);return Nf.listeners||K.call(w(Nf)),Object.defineProperty(w(Nf),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(w(Nf),"onabort",{value:null,writable:!0,configurable:!0}),Nf}h(_c,ca);var ch=j(_c);return s(_c,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(Nf){Nf.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,Nf)),F(f(_c.prototype),"dispatchEvent",this).call(this,Nf)}}]),_c}(K),_o=function(){function ca(){o(this,ca),Object.defineProperty(this,"signal",{value:new _e,writable:!0,configurable:!0})}return s(ca,[{key:"abort",value:function(){try{var _c=new Event("abort")}catch{typeof document!="undefined"?document.createEvent?(_c=document.createEvent("Event")).initEvent("abort",!1,!1):(_c=document.createEventObject()).type="abort":_c={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(_c)}},{key:"toString",value:function(){return"[object AbortController]"}}]),ca}();typeof Symbol!="undefined"&&Symbol.toStringTag&&(_o.prototype[Symbol.toStringTag]="AbortController",_e.prototype[Symbol.toStringTag]="AbortSignal"),function(ca){if(ca.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var _c=!0}else _c=typeof ca.Request=="function"&&!ca.Request.prototype.hasOwnProperty("signal")||!ca.AbortController;_c&&(ca.AbortController=_o,ca.AbortSignal=_e)}(typeof self!="undefined"?self:Ka)}();var Xy=Math.floor,Yy=Math.log,Zy=Math.LOG2E;M({target:"Math",stat:!0},{clz32:function(o){return(o>>>=0)?31-Xy(Yy(o+.5)*Zy):32}});var $y=Math.log,az=Math.LN2,mu=Math.clz32||function(o){return 31-$y(o>>>0)/az|0},Gd=String.fromCharCode,Aq={}.toString,Ik=window.Uint8Array,Jk=Ik||Array,bz=Aq.call((window.ArrayBuffer||Jk).prototype),Kk;zm.prototype.decode=function(o){if(o=o&&o.buffer||o,Aq.call(o)!==bz)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var i="",s=0,h=0|(o=Ik?new Jk(o):o).length;s<h;s=s+32768|0)i+=Gd.apply(0,o[Ik?"slice":"subarray"](s,s+32768|0));return i.replace(/[\xc0-\xff][\x80-\xbf]*/g,lu)},window.TextDecoder||(window.TextDecoder=zm),Am.prototype.encode=function(o){for(var i=0|(o=o===void 0?"":(""+o).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,nu)).length,s=new Jk(i),h=0;h<i;h=h+1|0)s[h]=o.charCodeAt(h);return s},window.TextEncoder||(window.TextEncoder=Am),function(o){var i,s,h,f,_,w,j,F,K,_e,_o;(function(ca){ca.LOGIN="LOGIN",ca.LOGIN_SUCCESS="LOGIN_SUCCESS",ca.LOGIN_FAILURE="LOGIN_FAILURE",ca.LOGIN_TIMEOUT="LOGIN_TIMEOUT",ca.INTERRUPTED="INTERRUPTED",ca.LOGOUT="LOGOUT",ca.BANNED_BY_SERVER="BANNED_BY_SERVER",ca.REMOTE_LOGIN="REMOTE_LOGIN"})(i||(i={})),o.ConnectionChangeReason=i,function(ca){ca.DISCONNECTED="DISCONNECTED",ca.CONNECTING="CONNECTING",ca.CONNECTED="CONNECTED",ca.RECONNECTING="RECONNECTING",ca.ABORTED="ABORTED"}(s||(s={})),o.ConnectionState=s,function(ca){ca.IDLE="IDLE",ca.SENT_TO_REMOTE="SENT_TO_REMOTE",ca.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",ca.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",ca.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",ca.CANCELED="CANCELED",ca.FAILURE="FAILURE"}(h||(h={})),o.LocalInvitationState=h,function(ca){ca.INVITATION_RECEIVED="INVITATION_RECEIVED",ca.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",ca.REFUSED="REFUSED",ca.ACCEPTED="ACCEPTED",ca.CANCELED="CANCELED",ca.FAILURE="FAILURE"}(f||(f={})),o.RemoteInvitationState=f,function(ca){ca.UNKNOWN="UNKNOWN",ca.PEER_NO_RESPONSE="PEER_NO_RESPONSE",ca.INVITATION_EXPIRE="INVITATION_EXPIRE",ca.PEER_OFFLINE="PEER_OFFLINE",ca.NOT_LOGGEDIN="NOT_LOGGEDIN"}(_||(_={})),o.LocalInvitationFailureReason=_,function(ca){ca.UNKNOWN="UNKNOWN",ca.PEER_OFFLINE="PEER_OFFLINE",ca.ACCEPT_FAILURE="ACCEPT_FAILURE",ca.INVITATION_EXPIRE="INVITATION_EXPIRE"}(w||(w={})),o.RemoteInvitationFailureReason=w,function(ca){ca.ONLINE="ONLINE",ca.UNREACHABLE="UNREACHABLE",ca.OFFLINE="OFFLINE"}(j||(j={})),o.PeerOnlineState=j,(F||(F={})).ONLINE_STATUS="ONLINE_STATUS",o.PeerSubscriptionOption=F,function(ca){ca.TEXT="TEXT",ca.RAW="RAW",ca.IMAGE="IMAGE",ca.FILE="FILE"}(K||(K={})),o.MessageType=K,function(ca){ca.CN="CN",ca.NA="NA",ca.EU="EU",ca.AS="AS",ca.JP="JP",ca.IN="IN",ca.GLOB="GLOB",ca.OC="OC",ca.SA="SA",ca.AF="AF",ca.OVS="OVS"}(_e||(_e={})),o.LegacyAreaCode=_e,function(ca){ca.GLOBAL="GLOBAL",ca.INDIA="INDIA",ca.JAPAN="JAPAN",ca.ASIA="ASIA",ca.EUROPE="EUROPE",ca.CHINA="CHINA",ca.NORTH_AMERICA="NORTH_AMERICA"}(_o||(_o={})),o.AreaCode=_o}(Kk||(Kk={}));var S=Kk;M({target:"Array",proto:!0},{includes:function(o){return so(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("includes");var Lk=function(o){if(Fj(o))throw TypeError("The method doesn't accept regular expressions");return o},cz=qa("match"),Mk=function(o){var i=/./;try{"/./"[o](i)}catch{try{return i[cz]=!1,"/./"[o](i)}catch{}}return!1};M({target:"String",proto:!0,forced:!Mk("includes")},{includes:function(o){return!!~String(mb(this)).indexOf(Lk(o),1<arguments.length?arguments[1]:void 0)}});var lc={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0,ENABLE_EDGE_AUTO_FALLBACK:!0};Ph("iterator"),Ph("asyncIterator");var Nk=Te("forEach")?[].forEach:function(o){return Sd(this,o,1<arguments.length?arguments[1]:void 0)},Bq;for(Bq in sk){var Cq=C[Bq],Rh=Cq&&Cq.prototype;if(Rh&&Rh.forEach!==Nk)try{Sa(Rh,"forEach",Nk)}catch{Rh.forEach=Nk}}var dz=[].reverse,Dq=[1,2];M({target:"Array",proto:!0,forced:String(Dq)===String(Dq.reverse())},{reverse:function(){return qd(this)&&(this.length=this.length),dz.call(this)}});var x=cb(function(o){o=function(i){function s(Qv,r0,a0){return Object.defineProperty(Qv,r0,{value:a0,enumerable:!0,configurable:!0,writable:!0}),Qv[r0]}function h(Qv,r0,a0,I0){return r0=Object.create((r0&&r0.prototype instanceof _?r0:_).prototype),I0=new _c(I0||[]),r0._invoke=function(O0,nI,U0){var _I=k0;return function(dI,QI){if(_I===pI)throw Error("Generator is already running");if(_I===u0){if(dI==="throw")throw QI;return Nf()}for(U0.method=dI,U0.arg=QI;;){if((dI=U0.delegate)&&(dI=_e(dI,U0))){if(dI===C0)continue;return dI}if(U0.method==="next")U0.sent=U0._sent=U0.arg;else if(U0.method==="throw"){if(_I===k0)throw _I=u0,U0.arg;U0.dispatchException(U0.arg)}else U0.method==="return"&&U0.abrupt("return",U0.arg);if(_I=pI,(dI=f(O0,nI,U0)).type==="normal"){if(_I=U0.done?u0:G0,dI.arg===C0)continue;return{value:dI.arg,done:U0.done}}dI.type==="throw"&&(_I=u0,U0.method="throw",U0.arg=dI.arg)}}}(Qv,a0,I0),r0}function f(Qv,r0,a0){try{return{type:"normal",arg:Qv.call(r0,a0)}}catch(I0){return{type:"throw",arg:I0}}}function _(){}function w(){}function j(){}function F(Qv){["next","throw","return"].forEach(function(r0){s(Qv,r0,function(a0){return this._invoke(r0,a0)})})}function K(Qv,r0){function a0(O0,nI,U0,_I){if((O0=f(Qv[O0],Qv,nI)).type!=="throw"){var dI=O0.arg;return(O0=dI.value)&&V(O0)==="object"&&_v.call(O0,"__await")?r0.resolve(O0.__await).then(function(QI){a0("next",QI,U0,_I)},function(QI){a0("throw",QI,U0,_I)}):r0.resolve(O0).then(function(QI){dI.value=QI,U0(dI)},function(QI){return a0("throw",QI,U0,_I)})}_I(O0.arg)}var I0;this._invoke=function(O0,nI){function U0(){return new r0(function(_I,dI){a0(O0,nI,_I,dI)})}return I0=I0?I0.then(U0,U0):U0()}}function _e(Qv,r0){var a0=Qv.iterator[r0.method];if(a0===bh){if(r0.delegate=null,r0.method==="throw"){if(Qv.iterator.return&&(r0.method="return",r0.arg=bh,_e(Qv,r0),r0.method==="throw"))return C0;r0.method="throw",r0.arg=new TypeError("The iterator does not provide a 'throw' method")}return C0}return(a0=f(a0,Qv.iterator,r0.arg)).type==="throw"?(r0.method="throw",r0.arg=a0.arg,r0.delegate=null,C0):(a0=a0.arg)?a0.done?(r0[Qv.resultName]=a0.value,r0.next=Qv.nextLoc,r0.method!=="return"&&(r0.method="next",r0.arg=bh),r0.delegate=null,C0):a0:(r0.method="throw",r0.arg=new TypeError("iterator result is not an object"),r0.delegate=null,C0)}function _o(Qv){var r0={tryLoc:Qv[0]};1 in Qv&&(r0.catchLoc=Qv[1]),2 in Qv&&(r0.finallyLoc=Qv[2],r0.afterLoc=Qv[3]),this.tryEntries.push(r0)}function ca(Qv){var r0=Qv.completion||{};r0.type="normal",delete r0.arg,Qv.completion=r0}function _c(Qv){this.tryEntries=[{tryLoc:"root"}],Qv.forEach(_o,this),this.reset(!0)}function ch(Qv){if(Qv){var r0=Qv[A0];if(r0)return r0.call(Qv);if(typeof Qv.next=="function")return Qv;if(!isNaN(Qv.length)){var a0=-1;return(r0=function I0(){for(;++a0<Qv.length;)if(_v.call(Qv,a0))return I0.value=Qv[a0],I0.done=!1,I0;return I0.value=bh,I0.done=!0,I0}).next=r0}}return{next:Nf}}function Nf(){return{value:bh,done:!0}}var bh,_g=Object.prototype,_v=_g.hasOwnProperty,h0=typeof Symbol=="function"?Symbol:{},A0=h0.iterator||"@@iterator",M0=h0.asyncIterator||"@@asyncIterator",R0=h0.toStringTag||"@@toStringTag";try{s({},"")}catch{s=function(r0,a0,I0){return r0[a0]=I0}}i.wrap=h;var k0="suspendedStart",G0="suspendedYield",pI="executing",u0="completed",C0={};s(h0={},A0,function(){return this});var v0=Object.getPrototypeOf;(v0=v0&&v0(v0(ch([]))))&&v0!==_g&&_v.call(v0,A0)&&(h0=v0);var T0=j.prototype=_.prototype=Object.create(h0);return w.prototype=j,s(T0,"constructor",j),s(j,"constructor",w),w.displayName=s(j,R0,"GeneratorFunction"),i.isGeneratorFunction=function(Qv){return!!(Qv=typeof Qv=="function"&&Qv.constructor)&&(Qv===w||(Qv.displayName||Qv.name)==="GeneratorFunction")},i.mark=function(Qv){return Object.setPrototypeOf?Object.setPrototypeOf(Qv,j):(Qv.__proto__=j,s(Qv,R0,"GeneratorFunction")),Qv.prototype=Object.create(T0),Qv},i.awrap=function(Qv){return{__await:Qv}},F(K.prototype),s(K.prototype,M0,function(){return this}),i.AsyncIterator=K,i.async=function(Qv,r0,a0,I0,O0){O0===void 0&&(O0=Promise);var nI=new K(h(Qv,r0,a0,I0),O0);return i.isGeneratorFunction(r0)?nI:nI.next().then(function(U0){return U0.done?U0.value:nI.next()})},F(T0),s(T0,R0,"Generator"),s(T0,A0,function(){return this}),s(T0,"toString",function(){return"[object Generator]"}),i.keys=function(Qv){var r0,a0=[];for(r0 in Qv)a0.push(r0);return a0.reverse(),function I0(){for(;a0.length;){var O0=a0.pop();if(O0 in Qv)return I0.value=O0,I0.done=!1,I0}return I0.done=!0,I0}},i.values=ch,_c.prototype={constructor:_c,reset:function(Qv){if(this.next=this.prev=0,this.sent=this._sent=bh,this.done=!1,this.delegate=null,this.method="next",this.arg=bh,this.tryEntries.forEach(ca),!Qv)for(var r0 in this)r0.charAt(0)==="t"&&_v.call(this,r0)&&!isNaN(+r0.slice(1))&&(this[r0]=bh)},stop:function(){this.done=!0;var Qv=this.tryEntries[0].completion;if(Qv.type==="throw")throw Qv.arg;return this.rval},dispatchException:function(Qv){function r0(dI,QI){return nI.type="throw",nI.arg=Qv,a0.next=dI,QI&&(a0.method="next",a0.arg=bh),!!QI}if(this.done)throw Qv;for(var a0=this,I0=this.tryEntries.length-1;0<=I0;--I0){var O0=this.tryEntries[I0],nI=O0.completion;if(O0.tryLoc==="root")return r0("end");if(O0.tryLoc<=this.prev){var U0=_v.call(O0,"catchLoc"),_I=_v.call(O0,"finallyLoc");if(U0&&_I){if(this.prev<O0.catchLoc)return r0(O0.catchLoc,!0);if(this.prev<O0.finallyLoc)return r0(O0.finallyLoc)}else if(U0){if(this.prev<O0.catchLoc)return r0(O0.catchLoc,!0)}else{if(!_I)throw Error("try statement without catch or finally");if(this.prev<O0.finallyLoc)return r0(O0.finallyLoc)}}}},abrupt:function(Qv,r0){for(var a0=this.tryEntries.length-1;0<=a0;--a0){var I0=this.tryEntries[a0];if(I0.tryLoc<=this.prev&&_v.call(I0,"finallyLoc")&&this.prev<I0.finallyLoc){var O0=I0;break}}return O0&&(Qv==="break"||Qv==="continue")&&O0.tryLoc<=r0&&r0<=O0.finallyLoc&&(O0=null),(a0=O0?O0.completion:{}).type=Qv,a0.arg=r0,O0?(this.method="next",this.next=O0.finallyLoc,C0):this.complete(a0)},complete:function(Qv,r0){if(Qv.type==="throw")throw Qv.arg;return Qv.type==="break"||Qv.type==="continue"?this.next=Qv.arg:Qv.type==="return"?(this.rval=this.arg=Qv.arg,this.method="return",this.next="end"):Qv.type==="normal"&&r0&&(this.next=r0),C0},finish:function(Qv){for(var r0=this.tryEntries.length-1;0<=r0;--r0){var a0=this.tryEntries[r0];if(a0.finallyLoc===Qv)return this.complete(a0.completion,a0.afterLoc),ca(a0),C0}},catch:function(Qv){for(var r0=this.tryEntries.length-1;0<=r0;--r0){var a0=this.tryEntries[r0];if(a0.tryLoc===Qv){if((Qv=a0.completion).type==="throw"){var I0=Qv.arg;ca(a0)}return I0}}throw Error("illegal catch attempt")},delegateYield:function(Qv,r0,a0){return this.delegate={iterator:ch(Qv),resultName:r0,nextLoc:a0},this.method==="next"&&(this.arg=bh),C0}},i}(o.exports);try{regeneratorRuntime=o}catch{(typeof globalThis=="undefined"?"undefined":V(globalThis))==="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}}),Eq=!R(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ok=cb(function(o){var i=Wa.f,s=Oe("meta"),h=0,f=Object.isExtensible||function(){return!0},_=function(j){i(j,s,{value:{objectID:"O"+ ++h,weakData:{}}})},w=o.exports={REQUIRED:!1,fastKey:function(j,F){if(!ha(j))return typeof j=="symbol"?j:(typeof j=="string"?"S":"P")+j;if(!Q(j,s)){if(!f(j))return"F";if(!F)return"E";_(j)}return j[s].objectID},getWeakData:function(j,F){if(!Q(j,s)){if(!f(j))return!0;if(!F)return!1;_(j)}return j[s].weakData},onFreeze:function(j){return Eq&&w.REQUIRED&&f(j)&&!Q(j,s)&&_(j),j}};Pe[s]=!0}),Fq=function(o,i,s){var h=o.indexOf("Map")!==-1,f=o.indexOf("Weak")!==-1,_=h?"set":"add",w=C[o],j=w&&w.prototype,F=w,K={},_e=function(bh){var _g=j[bh];Ea(j,bh,bh=="add"?function(_v){return _g.call(this,_v===0?0:_v),this}:bh=="delete"?function(_v){return!(f&&!ha(_v))&&_g.call(this,_v===0?0:_v)}:bh=="get"?function(_v){return f&&!ha(_v)?void 0:_g.call(this,_v===0?0:_v)}:bh=="has"?function(_v){return!(f&&!ha(_v))&&_g.call(this,_v===0?0:_v)}:function(_v,h0){return _g.call(this,_v===0?0:_v,h0),this})};if(uc(o,typeof w!="function"||!(f||j.forEach&&!R(function(){new w().entries().next()}))))F=s.getConstructor(i,o,h,_),Ok.REQUIRED=!0;else if(uc(o,!0)){var _o=new F,ca=_o[_](f?{}:-0,1)!=_o,_c=R(function(){_o.has(1)}),ch=uh(function(bh){new w(bh)}),Nf=!f&&R(function(){for(var bh=new w,_g=5;_g--;)bh[_](_g,_g);return!bh.has(-0)});ch||((F=i(function(bh,_g){return hc(bh,F,o),bh=Lh(new w,bh,F),_g!=null&&yh(_g,bh[_],{that:bh,AS_ENTRIES:h}),bh})).prototype=j,j.constructor=F),(_c||Nf)&&(_e("delete"),_e("has"),h&&_e("get")),(Nf||ca)&&_e(_),f&&j.clear&&delete j.clear}return K[o]=F,M({global:!0,forced:F!=w},K),gc(F,o),f||s.setStrong(F,o,h),F},ez=Wa.f,Gq=Ok.fastKey,Hq=La.set,Pk=La.getterFor,Iq={getConstructor:function(o,i,s,h){var f=o(function(F,K){hc(F,f,i),Hq(F,{type:i,index:Sb(null),first:void 0,last:void 0,size:0}),fa||(F.size=0),K!=null&&yh(K,F[h],{that:F,AS_ENTRIES:s})}),_=Pk(i),w=function(F,K,_e){var _o,ca=_(F),_c=j(F,K);return _c?_c.value=_e:(ca.last=_c={index:_o=Gq(K,!0),key:K,value:_e,previous:K=ca.last,next:void 0,removed:!1},ca.first||(ca.first=_c),K&&(K.next=_c),fa?ca.size++:F.size++,_o!=="F"&&(ca.index[_o]=_c)),F},j=function(F,K){F=_(F);var _e=Gq(K);if(_e!=="F")return F.index[_e];for(F=F.first;F;F=F.next)if(F.key==K)return F};return Xe(f.prototype,{clear:function(){for(var F=_(this),K=F.index,_e=F.first;_e;)_e.removed=!0,_e.previous&&(_e.previous=_e.previous.next=void 0),delete K[_e.index],_e=_e.next;F.first=F.last=void 0,fa?F.size=0:this.size=0},delete:function(F){var K=_(this);if(F=j(this,F)){var _e=F.next,_o=F.previous;delete K.index[F.index],F.removed=!0,_o&&(_o.next=_e),_e&&(_e.previous=_o),K.first==F&&(K.first=_e),K.last==F&&(K.last=_o),fa?K.size--:this.size--}return!!F},forEach:function(F){for(var K,_e=_(this),_o=pd(F,1<arguments.length?arguments[1]:void 0,3);K=K?K.next:_e.first;)for(_o(K.value,K.key,this);K&&K.removed;)K=K.previous},has:function(F){return!!j(this,F)}}),Xe(f.prototype,s?{get:function(F){return(F=j(this,F))&&F.value},set:function(F,K){return w(this,F===0?0:F,K)}}:{add:function(F){return w(this,F=F===0?0:F,F)}}),fa&&ez(f.prototype,"size",{get:function(){return _(this).size}}),f},setStrong:function(o,i,s){var h=i+" Iterator",f=Pk(i),_=Pk(h);Qj(o,i,function(w,j){Hq(this,{type:h,target:w,state:f(w),kind:j,last:void 0})},function(){for(var w=_(this),j=w.kind,F=w.last;F&&F.removed;)F=F.previous;return w.target&&(w.last=F=F?F.next:w.state.first)?j=="keys"?{value:F.key,done:!1}:j=="values"?{value:F.value,done:!1}:{value:[F.key,F.value],done:!1}:(w.target=void 0,{value:void 0,done:!0})},s?"entries":"values",!s,!0),ag(i)}};Fq("Set",function(o){return function(){return o(this,arguments.length?arguments[0]:void 0)}},Iq);var fz=Rd.f,gz=Jb.f,hz=Wa.f,wd=C.Number,Sh=wd.prototype,iz=ec(Sb(Sh))=="Number",Jq=function(o){var i,s=tc(o,!1);if(typeof s=="string"&&2<s.length){if((o=(s=Ij(s)).charCodeAt(0))===43||o===45){if((o=s.charCodeAt(2))===88||o===120)return NaN}else if(o===48){switch(s.charCodeAt(1)){case 66:case 98:o=2;var h=49;break;case 79:case 111:o=8,h=55;break;default:return+s}var f=(s=s.slice(2)).length;for(i=0;i<f;i++){var _=s.charCodeAt(i);if(48>_||_>h)return NaN}return parseInt(s,o)}}return+s};if(uc("Number",!wd(" 0o1")||!wd("0b1")||wd("+0x1"))){for(var Zd=function(o){var i=1>arguments.length?0:o,s=this;return s instanceof Zd&&(iz?R(function(){Sh.valueOf.call(s)}):ec(s)!="Number")?Lh(new wd(Jq(i)),s,Zd):Jq(i)},Kq=fa?fz(wd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),Qk=0,Th;Kq.length>Qk;Qk++)Q(wd,Th=Kq[Qk])&&!Q(Zd,Th)&&hz(Zd,Th,gz(wd,Th));Zd.prototype=Sh,Sh.constructor=Zd,Ea(C,"Number",Zd)}var Lq=qa("isConcatSpreadable"),jz=51<=nd||!R(function(){var o=[];return o[Lq]=!1,o.concat()[0]!==o}),kz=Yf("concat");M({target:"Array",proto:!0,forced:!jz||!kz},{concat:function(o){var i,s=Va(this),h=th(s,0),f=0,_=-1;for(i=arguments.length;_<i;_++){var w=_===-1?s:arguments[_],j=w;if(ha(j)){var F=j[Lq];j=F!==void 0?!!F:qd(j)}else j=!1;if(j){if(9007199254740991<f+(F=va(w.length)))throw TypeError("Maximum allowed index exceeded");for(j=0;j<F;j++,f++)j in w&&Ve(h,f,w[j])}else{if(9007199254740991<=f)throw TypeError("Maximum allowed index exceeded");Ve(h,f++,w)}}return h.length=f,h}});var Rk=Rb("Reflect","apply"),lz=Function.apply,mz=!R(function(){Rk(function(){})});M({target:"Reflect",stat:!0,forced:mz},{apply:function(o,i,s){return Bb(o),sa(s),Rk?Rk(o,i,s):lz.call(o,i,s)}}),M({target:"Reflect",stat:!0},{ownKeys:uo});var nz=xk,oz=R(function(){return!Object.getOwnPropertyNames(1)});M({target:"Object",stat:!0,forced:oz},{getOwnPropertyNames:nz});var ef=(typeof Reflect=="undefined"?"undefined":V(Reflect))==="object"?Reflect:null,Mq=ef&&typeof ef.apply=="function"?ef.apply:function(o,i,s){return Function.prototype.apply.call(o,i,s)},pz=ef&&typeof ef.ownKeys=="function"?ef.ownKeys:Object.getOwnPropertySymbols?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:function(o){return Object.getOwnPropertyNames(o)},Nq=Number.isNaN||function(o){return o!=o};ia.EventEmitter=ia,ia.prototype._events=void 0,ia.prototype._eventsCount=0,ia.prototype._maxListeners=void 0;var Oq=10;Object.defineProperty(ia,"defaultMaxListeners",{enumerable:!0,get:function(){return Oq},set:function(o){if(typeof o!="number"||0>o||Nq(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");Oq=o}}),ia.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ia.prototype.setMaxListeners=function(o){if(typeof o!="number"||0>o||Nq(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this},ia.prototype.getMaxListeners=function(){return this._maxListeners===void 0?ia.defaultMaxListeners:this._maxListeners},ia.prototype.emit=function(o){for(var i=[],s=1;s<arguments.length;s++)i.push(arguments[s]);s=o==="error";var h=this._events;if(h!==void 0)s=s&&h.error===void 0;else if(!s)return!1;if(s){var f;throw 0<i.length&&(f=i[0]),f instanceof Error?f:((i=Error("Unhandled error."+(f?" ("+f.message+")":""))).context=f,i)}if((s=h[o])===void 0)return!1;if(typeof s=="function")Mq(s,this,i);else for(h=Em(s,f=s.length),s=0;s<f;++s)Mq(h[s],this,i);return!0},ia.prototype.addListener=function(o,i){return Bm(this,o,i,!1)},ia.prototype.on=ia.prototype.addListener,ia.prototype.prependListener=function(o,i){return Bm(this,o,i,!0)},ia.prototype.once=function(o,i){return Kg(i),this.on(o,Cm(this,o,i)),this},ia.prototype.prependOnceListener=function(o,i){return Kg(i),this.prependListener(o,Cm(this,o,i)),this},ia.prototype.removeListener=function(o,i){var s;Kg(i);var h=this._events;if(h===void 0)return this;var f=h[o];if(f===void 0)return this;if(f===i||f.listener===i)--this._eventsCount==0?this._events=Object.create(null):(delete h[o],h.removeListener&&this.emit("removeListener",o,f.listener||i));else if(typeof f!="function"){var _=-1;for(s=f.length-1;0<=s;s--)if(f[s]===i||f[s].listener===i){var w=f[s].listener;_=s;break}if(0>_)return this;if(_===0)f.shift();else{for(;_+1<f.length;_++)f[_]=f[_+1];f.pop()}f.length===1&&(h[o]=f[0]),h.removeListener!==void 0&&this.emit("removeListener",o,w||i)}return this},ia.prototype.off=ia.prototype.removeListener,ia.prototype.removeAllListeners=function(o){var i=this._events;if(i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[o]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[o]),this;if(arguments.length===0){var s=Object.keys(i);for(i=0;i<s.length;++i){var h=s[i];h!=="removeListener"&&this.removeAllListeners(h)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(s=i[o])=="function")this.removeListener(o,s);else if(s!==void 0)for(i=s.length-1;0<=i;i--)this.removeListener(o,s[i]);return this},ia.prototype.listeners=function(o){return Dm(this,o,!0)},ia.prototype.rawListeners=function(o){return Dm(this,o,!1)},ia.listenerCount=function(o,i){return typeof o.listenerCount=="function"?o.listenerCount(i):Fm.call(o,i)},ia.prototype.listenerCount=Fm,ia.prototype.eventNames=function(){return 0<this._eventsCount?pz(this._events):[]},ia.once=function(o,i){return new Promise(function(s,h){function f(w){o.removeListener(i,_),h(w)}function _(){typeof o.removeListener=="function"&&o.removeListener("error",f),s([].slice.call(arguments))}Gm(o,i,_,{once:!0}),i!=="error"&&pu(o,f,{once:!0})})};var ff=Object.assign,Pq=Object.defineProperty,ng=!ff||R(function(){if(fa&&ff({b:1},ff(Pq({},"a",{enumerable:!0,get:function(){Pq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var o={},i={},s=Symbol();return o[s]=7,"abcdefghijklmnopqrst".split("").forEach(function(h){i[h]=h}),ff({},o)[s]!=7||Mc(ff({},i)).join("")!="abcdefghijklmnopqrst"})?function(o,i){for(var s=Va(o),h=arguments.length,f=1,_=Uf.f,w=Sf;h>f;)for(var j,F=Tf(arguments[f++]),K=_?Mc(F).concat(_(F)):Mc(F),_e=K.length,_o=0;_e>_o;)j=K[_o++],(!fa||w.call(F,j))&&(s[j]=F[j]);return s}:ff;M({target:"Object",stat:!0,forced:Object.assign!==ng},{assign:ng}),Fq("Map",function(o){return function(){return o(this,arguments.length?arguments[0]:void 0)}},Iq);var qz=Math.log,rz=Math.LN2;M({target:"Math",stat:!0},{log2:function(o){return qz(o)/rz}});var sz=Wa.f,tz=Rd.f,uz=La.enforce,vz=qa("match"),zc=C.RegExp,Sk=zc.prototype,og=/a/g,Tk=/a/g,Uk=new zc(og)!==og;if(fa&&uc("RegExp",!Uk||vc||R(function(){return Tk[vz]=!1,zc(og)!=og||zc(Tk)==Tk||zc(og,"i")!="/a/i"}))){for(var Uc=function(o,i){var s,h=this instanceof Uc,f=Fj(o),_=i===void 0;return!h&&f&&o.constructor===Uc&&_||(Uk?f&&!_&&(o=o.source):o instanceof Uc&&(_&&(i=Aj.call(o)),o=o.source),vc&&(s=!!i&&-1<i.indexOf("y"))&&(i=i.replace(/y/g,"")),o=Lh(Uk?new zc(o,i):zc(o,i),h?this:Sk,Uc),vc&&s&&(uz(o).sticky=!0)),o},wz=function(o){o in Uc||sz(Uc,o,{configurable:!0,get:function(){return zc[o]},set:function(i){zc[o]=i}})},Qq=tz(zc),Rq=0;Qq.length>Rq;)wz(Qq[Rq++]);Sk.constructor=Uc,Uc.prototype=Sk,Ea(C,"RegExp",Uc)}ag("RegExp"),jg("Float32",function(o){return function(i,s,h){return o(this,i,s,h)}}),jg("Float64",function(o){return function(i,s,h){return o(this,i,s,h)}}),jg("Uint32",function(o){return function(i,s,h){return o(this,i,s,h)}}),jg("Uint16",function(o){return function(i,s,h){return o(this,i,s,h)}});var Vk=function(o,i){return o===i?0:o==null?i==null?0:-1:i==null?o==null?0:1:typeof o.compare=="function"?o.compare(i):typeof i.compare=="function"?-i.compare(o):o<i?-1:o>i?1:0},Wk=[],Sq=Wk.sort,xz=R(function(){Wk.sort(void 0)}),yz=R(function(){Wk.sort(null)}),zz=Te("sort");M({target:"Array",proto:!0,forced:xz||!yz||!zz},{sort:function(o){return o===void 0?Sq.call(Va(this)):Sq.call(Va(this),Bb(o))}});var Tq=Object.getPrototypeOf({}),pg=function(o,i){var s;return o===i||(o==null?o==i:V(o.equiv)==="function"?o.equiv(i):i==null?o==i:V(i.equiv)==="function"?i.equiv(o):V(o)!=="string"&&V(i)!=="string"&&((s=Object.getPrototypeOf(o))!=null&&s!==Tq||(s=Object.getPrototypeOf(i))!=null&&s!==Tq?V(o)!=="function"&&o.length!==void 0&&V(i)!=="function"&&i.length!==void 0?Bz(o,i):o instanceof Set&&i instanceof Set?Cz(o,i):o instanceof Map&&i instanceof Map?Dz(o,i):o instanceof Date&&i instanceof Date?o.getTime()===i.getTime():o instanceof RegExp&&i instanceof RegExp?o.toString()===i.toString():o!=o&&i!=i:Az(o,i)))},Bz=function(o,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg,h=o.length;if(h===i.length)for(;0<=--h&&s(o[h],i[h]););return 0>h},Cz=function(o,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;return o.size===i.size&&s(G(o.keys()).sort(),G(i.keys()).sort())},Dz=function(o,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;return o.size===i.size&&s(G(o).sort(),G(i).sort())},Az=function(o,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;if(Object.keys(o).length!==Object.keys(i).length)return!1;for(var h in o)if(!i.hasOwnProperty(h)||!s(o[h],i[h]))return!1;return!0},Uq=function(o){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(s){return s!==void 0?": "+s:""};return function(s){function h(_){return X(this,h),f.call(this,o(_)+i(_))}ja(h,s);var f=ka(h);return h}(xf(Error))},Ez=Uq(function(){return"illegal argument(s)"}),Uh=function(o){throw new Ez(o)},Xk=Uq(function(){return"index out of bounds"}),Vq=1/4294967295,Fz=function(){function o(){X(this,o)}return Ia(o,[{key:"float",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*Vq*i}},{key:"norm",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*Vq-.5)*i}},{key:"minmax",value:function(i,s){return this.float()*(s-i)+i}}]),o}(),Yk=Math.random,Gz=new(function(o){function i(){return X(this,i),s.apply(this,arguments)}ja(i,o);var s=ka(i);return Ia(i,[{key:"int",value:function(){return 4294967296*Yk()>>>0}},{key:"float",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return Yk()*h}},{key:"norm",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(Yk()-.5)*h}}]),i}(Fz)),zi=Symbol(),Jm=function(){},Hz=Ok.onFreeze,Zk=Object.freeze,Iz=R(function(){Zk(1)});M({target:"Object",stat:!0,forced:Iz,sham:!Eq},{freeze:function(o){return Zk&&ha(o)?Zk(Hz(o)):o}});var Jz=Te("reduce"),Kz=!Oc&&79<nd&&83>nd;M({target:"Array",proto:!0,forced:!Jz||Kz},{reduce:function(o){return bq(this,o,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Im=function(o){return o!=null&&typeof o.xform=="function"?o.xform():o},Lg=function(){function o(i){X(this,o),this.value=i}return Ia(o,[{key:"deref",value:function(){return this.value}}]),o}(),Ai=function(o){return o instanceof Lg?o.deref():o},ru=function(o,i){return[o,function(s){return s},i]},Lz=x.mark(function(o,i){var s,h,f,_,w,j;return x.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:s=Im(o)(qu()),h=s[1],f=s[2],_=0;case 4:if(!(_<i.length)){F.next=15;break}if(w=i[_],!((j=f([],w))instanceof Lg)){F.next=10;break}return F.delegateYield(Ai(h(j.deref())),"t0",9);case 9:return F.abrupt("return");case 10:if(!j.length){F.next=12;break}return F.delegateYield(j,"t1",12);case 12:_++,F.next=4;break;case 15:return F.delegateYield(Ai(h([])),"t2",16);case 16:case"end":return F.stop()}},Lz)}),su=x.mark(Hm),tu=function(o,i){return[o[0],o[1],i]},Wq=!0;"findIndex"in[]&&Array(1).findIndex(function(){Wq=!1}),M({target:"Array",proto:!0,forced:Wq},{findIndex:function(o){return Mo(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("findIndex"),M({target:"Array",proto:!0},{fill:ik}),Vd("fill");var Mz=function(){function o(i){X(this,o),this._length=0,i&&this.into(i)}return Ia(o,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new o(this)}},{key:"empty",value:function(){return new o}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var i,s=this.head;s;)i=s.next,delete s.value,delete s.prev,delete s.next,s=i;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(i){var s=this._length;if(s<i._length)return-1;if(s>i._length)return 1;if(s===0)return 0;s=this.head,i=i.head;for(var h=0;s&&h==0;)h=Vk(s.value,i.value),s=s.next,i=i.next;return h}},{key:"equiv",value:function(i){if(!(i instanceof o||i!=null&&typeof i!="function"&&i.length!==void 0)||this._length!==i.length)return!1;if(!this._length||this===i)return!0;for(var s=this.head,h=0;h<i.length;h++){if(!pg(s.value,i[h]))return!1;s=s.next}return!0}},{key:Symbol.iterator,value:x.mark(function i(){var s;return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:s=this.head;case 1:if(!s){h.next=7;break}return h.next=4,s.value;case 4:s=s.next,h.next=1;break;case 7:case"end":return h.stop()}},i,this)})},{key:"seq",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(i>=s||0>i)){i=this.nthCell(i);var h=this.nthCell(s-1);return s=function f(_){return{first:function(){return _.value},next:function(){return _!==h&&_.next?f(_.next):void 0}}},i?s(i):void 0}}},{key:"cycle",value:x.mark(function i(){return x.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.delegateYield(this,"t0",2);case 2:s.next=0;break;case 4:case"end":return s.stop()}},i,this)})},{key:"$reduce",value:function(i,s){for(var h=this.head;h&&!(s instanceof Lg);)s=i(s,h.value),h=h.next;return s}},{key:"drop",value:function(){var i=this.head;if(i)return(this.head=i.next)?delete this.head.prev:delete this.tail,this._length--,i.value}},{key:"cons",value:function(i){return i={value:i,next:this.head},this.head?this.head.prev=i:this.tail=i,this.head=i,this._length++,this}},{key:"insertBefore",value:function(i,s){return i||Uh("cell is undefined"),s={value:s,next:i,prev:i.prev},i.prev?i.prev.next=s:this.head=s,i.prev=s,this._length++,this}},{key:"insertAfter",value:function(i,s){return i||Uh("cell is undefined"),s={value:s,next:i.next,prev:i},i.next?i.next.prev=s:this.tail=s,i.next=s,this._length++,this}},{key:"insertBeforeNth",value:function(i,s){if(0>i&&(i+=this._length),0>=i)return this.cons(s);if(0>i||i>=this._length)throw new Xk(i);return this.insertBefore(this.nthCellUnsafe(i),s)}},{key:"insertAfterNth",value:function(i,s){if(0>i&&(i+=this._length),i>=this._length-1)return this.push(s);if(0>i||i>=this._length)throw new Xk(i);return this.insertAfter(this.nthCellUnsafe(i),s)}},{key:"insertSorted",value:function(i,s){s=s||Vk;for(var h=this.head;h;){if(0>=s(i,h.value))return this.insertBefore(h,i);h=h.next}return this.push(i)}},{key:"find",value:function(i){for(var s=this.head;s;){if(s.value===i)return s;s=s.next}}},{key:"findWith",value:function(i){for(var s=this.head;s;){if(i(s.value))return s;s=s.next}}},{key:"concat",value:function(){for(var i=this.copy(),s=arguments.length,h=Array(s),f=0;f<s;f++)h[f]=arguments[f];for(s=0;s<h.length;s++)i.into(h[s]);return i}},{key:"into",value:function(i){for(var s=0;s<i.length;s++)this.push(i[s])}},{key:"slice",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;i=0>i?i+this._length:i,s=0>s?s+this._length:s,(0>i||0>s)&&Uh("invalid indices: ${from} / ${to}");for(var h=new o,f=this.nthCell(i);f&&++i<=s;)h.push(f.value),f=f.next;return h}},{key:"splice",value:function(i){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,h=2<arguments.length?arguments[2]:void 0;if(typeof i=="number"){if(0>i&&(i+=this._length),0>i||i>=this._length)throw new Xk(i);var f=this.nthCellUnsafe(i)}else f=i;var _=new o;if(0<s)for(;f&&0<s--;)this.remove(f),_.push(f.value),f=f.next;else f&&(f=f.next);if(h)if(f)for(s=0;s<h.length;s++)this.insertBefore(f,h[s]);else for(f=0;f<h.length;f++)this.push(h[f]);return _}},{key:"remove",value:function(i){return i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this._length--,this}},{key:"swap",value:function(i,s){if(i!==s){var h=i.value;i.value=s.value,s.value=h}return this}},{key:"push",value:function(i){return this.tail?(i={value:i,prev:this.tail},this.tail=this.tail.next=i,this._length++,this):this.cons(i)}},{key:"pop",value:function(){var i=this.tail;if(i)return(this.tail=i.prev)?delete this.tail.next:delete this.head,this._length--,i.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(i){return this.head?(this.head.value=i,this):this.cons(i)}},{key:"setTail",value:function(i){return this.tail?(this.tail.value=i,this):this.push(i)}},{key:"setNth",value:function(i,s){var h=this.nthCell(i);return!h&&Uh("index out of bounds: ".concat(i)),h.value=s,this}},{key:"nth",value:function(i,s){return(i=this.nthCell(i))?i.value:s}},{key:"nthCell",value:function(i){if(0>i&&(i+=this._length),!(0>i||i>=this._length))return this.nthCellUnsafe(i)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var i=this.peek();return this.pop(),this.cons(i)}}},{key:"map",value:function(i){for(var s=new o,h=this.head;h;)s.push(i(h.value)),h=h.next;return s}},{key:"filter",value:function(i){for(var s=new o,h=this.head;h;)i(h.value)&&s.push(h.value),h=h.next;return s}},{key:"reduce",value:function(i,s){for(var h=this.head;h;)s=i(s,h.value),h=h.next;return s}},{key:"shuffle",value:function(i){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Gz;if(2>this._length)return this;for(i=i!=null?i:Math.ceil(1.5*Math.log2(this._length));0<i;i--)for(var h=this.head;h;){var f=h.next;.5>s.float()?this.asHead(h):this.asTail(h),h=f}return this}},{key:"sort",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Vk;if(!this._length)return this;for(var s=1;;){var h=this.head;this.tail=this.head=void 0;for(var f=0;h;){f++;for(var _=h,w=0,j=0;j<s&&(w++,_=_.next);j++);for(j=s;0<w||0<j&&_;){if(w===0){var F=_;_=_.next,j--}else _&&j!==0?0>=i(h.value,_.value)?(F=h,h=h.next,w--):(F=_,_=_.next,j--):(F=h,h=h.next,w--);this.tail?this.tail.next=F:this.head=F,F.prev=this.tail,this.tail=F}h=_}if(this.tail.next=void 0,1>=f)return this;s*=2}}},{key:"reverse",value:function(){for(var i=this.head,s=this.tail,h=(this._length>>>1)+(1&this._length);i&&s&&0<h;){var f=i.value;i.value=s.value,s.value=f,i=i.next,s=s.prev,h--}return this}},{key:"asHead",value:function(i){return i===this.head||(this.remove(i),this.head.prev=i,i.next=this.head,i.prev=void 0,this.head=i,this._length++),this}},{key:"asTail",value:function(i){return i===this.tail||(this.remove(i),this.tail.next=i,i.prev=this.tail,i.next=void 0,this.tail=i,this._length++),this}},{key:"toString",value:function(){for(var i=[],s=this.head;s;)i.push(String(s.value)),s=s.next;return i.join(", ")}},{key:"toJSON",value:function(){return G(this)}},{key:"nthCellUnsafe",value:function(i){if(i<=this._length>>1)var s=this.head,h="next";else s=this.tail,h="prev",i=this._length-i-1;for(;0<i--&&s;)s=s[h];return s}}]),o}(),Ac=function(){function o(i,s){X(this,o),s=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},s),this.map=s.map(),this.items=new Mz,this._size=0,this.opts=s,i&&this.into(i)}return Ia(o,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return Mg(function(i){return[i.k,i]},this.items)}},{key:"keys",value:function(){return Mg(function(i){return i.k},this.items)}},{key:"values",value:function(){return Mg(function(i){return i.v},this.items)}},{key:"copy",value:function(){var i=this.empty();i.items=this.items.copy();for(var s=i.items.head;s;)i.map.set(s.value.k,s),s=s.next;return i}},{key:"empty",value:function(){return new o(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var i=this.opts.release;if(i){for(var s;s=this.items.drop();)i(s.k,s.v);return!0}return this.items.release()}},{key:"has",value:function(i){return this.map.has(i)}},{key:"get",value:function(i,s){return(i=this.map.get(i))?this.resetEntry(i):s}},{key:"set",value:function(i,s){var h=this.opts.ksize(i)+this.opts.vsize(s),f=this.map.get(i);return this._size+=Math.max(0,h-(f?f.value.s:0)),this.ensureSize()&&this.doSetEntry(f,i,s,h),s}},{key:"into",value:function(i){for(var s=0;s<i.length;s++){var h=i[s];this.set(h[0],h[1])}return this}},{key:"getSet",value:function(i,s){var h=this,f=this.map.get(i);return f?Promise.resolve(this.resetEntry(f)):s().then(function(_){return h.set(i,_)})}},{key:"delete",value:function(i){return!!(i=this.map.get(i))&&(this.removeEntry(i),!0)}},{key:"resetEntry",value:function(i){return this.items.asTail(i),i.value.v}},{key:"ensureSize",value:function(){for(var i=this.opts.release,s=this.opts.maxsize,h=this.opts.maxlen;this._size>s||this.length>=h;){var f=this.items.drop();if(!f)return!1;this.map.delete(f.k),i&&i(f.k,f.v),this._size-=f.s}return!0}},{key:"removeEntry",value:function(i){var s=i.value;this.map.delete(s.k),this.items.remove(i),this.opts.release&&this.opts.release(s.k,s.v),this._size-=s.s}},{key:"doSetEntry",value:function(i,s,h,f){i?(i.value.v=h,i.value.s=f,this.items.asTail(i)):(this.items.push({k:s,v:h,s:f}),this.map.set(s,this.items.tail))}}]),o}(),Nz=function(o){function i(h,f){return X(this,i),f=Object.assign({ttl:36e5},f),s.call(this,h,f)}ja(i,o);var s=ka(i);return Ia(i,[{key:"empty",value:function(){return new i(null,this.opts)}},{key:"has",value:function(h){return this.get(h)!==void 0}},{key:"get",value:function(h,f){if(h=this.map.get(h)){if(h.value.t>=Date.now())return this.resetEntry(h);this.removeEntry(h)}return f}},{key:"set",value:function(h,f){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,w=this.opts.ksize(h)+this.opts.vsize(f),j=this.map.get(h);return this._size+=Math.max(0,w-(j?j.value.s:0)),this.ensureSize()&&(_=Date.now()+_,j?(j.value.v=f,j.value.s=w,j.value.t=_,this.items.asTail(j)):(this.items.push({k:h,v:f,s:w,t:_}),this.map.set(h,this.items.tail))),f}},{key:"getSet",value:function(h,f){var _=this,w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,j=this.get(h);return j?Promise.resolve(j):f().then(function(F){return _.set(h,F,w)})}},{key:"prune",value:function(){for(var h=Date.now(),f=this.items.head;f;)f.value.t<h&&this.removeEntry(f),f=f.next}},{key:"ensureSize",value:function(){for(var h=this.opts.maxsize,f=this.opts.maxlen,_=Date.now(),w=this.items.head;w&&(this._size>h||this.length>=f);)w.value.t<_&&this.removeEntry(w),w=w.next;return xi(Fd(i.prototype),"ensureSize",this).call(this)}}]),i}(Ac),Xq=V(Ka)=="object"&&Ka&&Ka.Object===Object&&Ka,Oz=(typeof self=="undefined"?"undefined":V(self))=="object"&&self&&self.Object===Object&&self,Fb=Xq||Oz||Function("return this")(),Ub=Fb.Symbol,Yq=Object.prototype,Pz=Yq.hasOwnProperty,Qz=Yq.toString,qg=Ub?Ub.toStringTag:void 0,Rz=Object.prototype.toString,Zq=Ub?Ub.toStringTag:void 0,$d=function(o){if(o==null)o=o===void 0?"[object Undefined]":"[object Null]";else if(Zq&&Zq in Object(o)){var i=Pz.call(o,qg),s=o[qg];try{o[qg]=void 0;var h=!0}catch{}var f=Qz.call(o);h&&(i?o[qg]=s:delete o[qg]),o=f}else o=Rz.call(o);return o},ob=function(o){var i=V(o);return o!=null&&(i=="object"||i=="function")},Wi=function(o){return!!ob(o)&&((o=$d(o))=="[object Function]"||o=="[object GeneratorFunction]"||o=="[object AsyncFunction]"||o=="[object Proxy]")},$k=Fb["__core-js_shared__"],$q=function(){var o=/[^.]+$/.exec($k&&$k.keys&&$k.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Sz=Function.prototype.toString,ae=function(o){if(o!=null){try{return Sz.call(o)}catch{}return o+""}return""},Tz=/^\[object .+?Constructor\]$/,Uz=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=function(o,i){return o=o==null?void 0:o[i],!ob(o)||$q&&$q in o||!(Wi(o)?Uz:Tz).test(ae(o))?void 0:o},rg=be(Object,"create"),Vz=Object.prototype.hasOwnProperty,Wz=Object.prototype.hasOwnProperty;Id.prototype.clear=function(){this.__data__=rg?rg(null):{},this.size=0},Id.prototype.delete=function(o){return o=this.has(o)&&delete this.__data__[o],this.size-=o?1:0,o},Id.prototype.get=function(o){var i=this.__data__;return rg?(o=i[o])==="__lodash_hash_undefined__"?void 0:o:Vz.call(i,o)?i[o]:void 0},Id.prototype.has=function(o){var i=this.__data__;return rg?i[o]!==void 0:Wz.call(i,o)},Id.prototype.set=function(o,i){var s=this.__data__;return this.size+=this.has(o)?0:1,s[o]=rg&&i===void 0?"__lodash_hash_undefined__":i,this};var sg=function(o,i){return o===i||o!=o&&i!=i},Vh=function(o,i){for(var s=o.length;s--;)if(sg(o[s][0],i))return s;return-1},Xz=Array.prototype.splice;qe.prototype.clear=function(){this.__data__=[],this.size=0},qe.prototype.delete=function(o){var i=this.__data__;return!(0>(o=Vh(i,o)))&&(o==i.length-1?i.pop():Xz.call(i,o,1),--this.size,!0)},qe.prototype.get=function(o){var i=this.__data__;return 0>(o=Vh(i,o))?void 0:i[o][1]},qe.prototype.has=function(o){return-1<Vh(this.__data__,o)},qe.prototype.set=function(o,i){var s=this.__data__,h=Vh(s,o);return 0>h?(++this.size,s.push([o,i])):s[h][1]=i,this};var Og=qe,tg=be(Fb,"Map"),Wh=function(o,i){o=o.__data__;var s=V(i);return(s=="string"||s=="number"||s=="symbol"||s=="boolean"?i!=="__proto__":i===null)?o[typeof i=="string"?"string":"hash"]:o.map};re.prototype.clear=function(){this.size=0,this.__data__={hash:new Id,map:new(tg||Og),string:new Id}},re.prototype.delete=function(o){return o=Wh(this,o).delete(o),this.size-=o?1:0,o},re.prototype.get=function(o){return Wh(this,o).get(o)},re.prototype.has=function(o){return Wh(this,o).has(o)},re.prototype.set=function(o,i){var s=Wh(this,o),h=s.size;return s.set(o,i),this.size+=s.size==h?0:1,this};var Ng=re;zf.prototype.add=zf.prototype.push=function(o){return this.__data__.set(o,"__lodash_hash_undefined__"),this},zf.prototype.has=function(o){return this.__data__.has(o)};var ar=function(o,i,s,h){var f=o.length;for(s+=h?1:-1;h?s--:++s<f;)if(i(o[s],s,o))return s;return-1},Yz=function(o){return o!=o},Zz=function(o,i){var s;if(s=!(o==null||!o.length)){if(i==i)t:{s=-1;for(var h=o.length;++s<h;)if(o[s]===i){o=s;break t}o=-1}else o=ar(o,Yz,0);s=-1<o}return s},$z=function(o,i,s){for(var h=-1,f=o==null?0:o.length;++h<f;)if(s(i,o[h]))return!0;return!1},aA=function(o,i){return o.has(i)},gf=be(Fb,"Set"),bA=function(){},al=function(o){var i=-1,s=Array(o.size);return o.forEach(function(h){s[++i]=h}),s},cA=1/0,dA=gf&&1/al(new gf([,-0]))[1]==cA?function(o){return new gf(o)}:bA,bl=function(o,i,s){var h=-1,f=Zz,_=o.length,w=!0,j=[],F=j;if(s)w=!1,f=$z;else if(200<=_){if(f=i?null:dA(o))return al(f);w=!1,f=aA,F=new zf}else F=i?[]:j;t:for(;++h<_;){var K=o[h],_e=i?i(K):K;if(K=s||K!==0?K:0,w&&_e==_e){for(var _o=F.length;_o--;)if(F[_o]===_e)continue t;i&&F.push(_e),j.push(K)}else f(F,_e,s)||(F!==j&&F.push(_e),j.push(K))}return j},br=function(o){for(var i=-1,s=o==null?0:o.length,h={};++i<s;){var f=o[i];h[f[0]]=f[1]}return h},ve=function(o,i){for(var s=-1,h=o==null?0:o.length,f=Array(h);++s<h;)f[s]=i(o[s],s,o);return f};se.prototype.clear=function(){this.__data__=new Og,this.size=0},se.prototype.delete=function(o){var i=this.__data__;return o=i.delete(o),this.size=i.size,o},se.prototype.get=function(o){return this.__data__.get(o)},se.prototype.has=function(o){return this.__data__.has(o)},se.prototype.set=function(o,i){var s=this.__data__;if(s instanceof Og){var h=s.__data__;if(!tg||199>h.length)return h.push([o,i]),this.size=++s.size,this;s=this.__data__=new Ng(h)}return s.set(o,i),this.size=s.size,this};var ue=se,Cu=function(o,i){for(var s=-1,h=o==null?0:o.length;++s<h&&i(o[s],s,o)!==!1;);return o},Xh=function(){try{var o=be(Object,"defineProperty");return o({},"",{}),o}catch{}}(),ug=function(o,i,s){i=="__proto__"&&Xh?Xh(o,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):o[i]=s},eA=Object.prototype.hasOwnProperty,Om=function(o,i,s){var h=o[i];eA.call(o,i)&&sg(h,s)&&(s!==void 0||i in o)||ug(o,i,s)},Fe=function(o,i,s,h){var f=!s;s||(s={});for(var _=-1,w=i.length;++_<w;){var j=i[_],F=h?h(s[j],o[j],j,s,o):void 0;F===void 0&&(F=o[j]),f?ug(s,j,F):Om(s,j,F)}return s},oc=function(o){return o!=null&&V(o)=="object"},cr=function(o){return oc(o)&&$d(o)=="[object Arguments]"},dr=Object.prototype,fA=dr.hasOwnProperty,gA=dr.propertyIsEnumerable,Jf=cr(function(){return arguments}())?cr:function(o){return oc(o)&&fA.call(o,"callee")&&!gA.call(o,"callee")},Za=Array.isArray,hA=function(){return!1},Bf=cb(function(o,i){var s=(i=i&&!i.nodeType&&i)&&o&&!o.nodeType&&o;i=s&&s.exports===i?Fb.Buffer:void 0,o.exports=(i?i.isBuffer:void 0)||hA}),iA=/^(?:0|[1-9]\d*)$/,cl=function(o,i){var s=V(o);return!!(i=i==null?9007199254740991:i)&&(s=="number"||s!="symbol"&&iA.test(o))&&-1<o&&o%1==0&&o<i},dl=function(o){return typeof o=="number"&&-1<o&&o%1==0&&9007199254740991>=o},Ga={};Ga["[object Float32Array]"]=Ga["[object Float64Array]"]=Ga["[object Int8Array]"]=Ga["[object Int16Array]"]=Ga["[object Int32Array]"]=Ga["[object Uint8Array]"]=Ga["[object Uint8ClampedArray]"]=Ga["[object Uint16Array]"]=Ga["[object Uint32Array]"]=!0,Ga["[object Arguments]"]=Ga["[object Array]"]=Ga["[object ArrayBuffer]"]=Ga["[object Boolean]"]=Ga["[object DataView]"]=Ga["[object Date]"]=Ga["[object Error]"]=Ga["[object Function]"]=Ga["[object Map]"]=Ga["[object Number]"]=Ga["[object Object]"]=Ga["[object RegExp]"]=Ga["[object Set]"]=Ga["[object String]"]=Ga["[object WeakMap]"]=!1;var jA=function(o){return oc(o)&&dl(o.length)&&!!Ga[$d(o)]},Yh=function(o){return function(i){return o(i)}},hf=cb(function(o,i){var s=i&&!i.nodeType&&i;s=(i=s&&o&&!o.nodeType&&o)&&i.exports===s&&Xq.process;t:{try{var h=i&&i.require&&i.require("util").types;if(h){var f=h;break t}f=s&&s.binding&&s.binding("util");break t}catch{}f=void 0}o.exports=f}),er=hf&&hf.isTypedArray,Gi=er?Yh(er):jA,kA=Object.prototype.hasOwnProperty,fr=function(o,i){var s=Za(o),h=!s&&Jf(o),f=!s&&!h&&Bf(o),_=!s&&!h&&!f&&Gi(o);if(s=s||h||f||_){h=o.length;for(var w=String,j=-1,F=Array(h);++j<h;)F[j]=w(j);h=F}else h=[];for(var K in w=h.length,o)!i&&!kA.call(o,K)||s&&(K=="length"||f&&(K=="offset"||K=="parent")||_&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||cl(K,w))||h.push(K);return h},lA=Object.prototype,el=function(o){var i=o&&o.constructor;return o===(typeof i=="function"&&i.prototype||lA)},gr=function(o,i){return function(s){return o(i(s))}},mA=gr(Object.keys,Object),nA=Object.prototype.hasOwnProperty,Nd=function(o){return o!=null&&dl(o.length)&&!Wi(o)},Jd=function(o){if(Nd(o))o=fr(o);else if(el(o)){var i,s=[];for(i in Object(o))nA.call(o,i)&&i!="constructor"&&s.push(i);o=s}else o=mA(o);return o},yu=function(o,i){return o&&Fe(i,Jd(i),o)},oA=Object.prototype.hasOwnProperty,Cf=function(o){if(Nd(o))o=fr(o,!0);else if(ob(o)){var i=el(o),s=[];for(h in o)(h!="constructor"||!i&&oA.call(o,h))&&s.push(h);o=s}else{var h=[];if(o!=null)for(i in Object(o))h.push(i);o=h}return o},wu=function(o,i){return o&&Fe(i,Cf(i),o)},Lm=cb(function(o,i){var s=(i=i&&!i.nodeType&&i)&&o&&!o.nodeType&&o,h=(i=s&&s.exports===i?Fb.Buffer:void 0)?i.allocUnsafe:void 0;o.exports=function(f,_){return _?f.slice():(_=f.length,_=h?h(_):new f.constructor(_),f.copy(_),_)}}),Bi=function(o,i){var s=-1,h=o.length;for(i||(i=Array(h));++s<h;)i[s]=o[s];return i},pA=function(o,i){for(var s=-1,h=o==null?0:o.length,f=0,_=[];++s<h;){var w=o[s];i(w,s,o)&&(_[f++]=w)}return _},hr=function(){return[]},qA=Object.prototype.propertyIsEnumerable,ir=Object.getOwnPropertySymbols,fl=ir?function(o){return o==null?[]:(o=Object(o),pA(ir(o),function(i){return qA.call(o,i)}))}:hr,xu=function(o,i){return Fe(o,fl(o),i)},Fi=function(o,i){for(var s=-1,h=i.length,f=o.length;++s<h;)o[f+s]=i[s];return o},gl=gr(Object.getPrototypeOf,Object),jr=Object.getOwnPropertySymbols?function(o){for(var i=[];o;)Fi(i,fl(o)),o=gl(o);return i}:hr,vu=function(o,i){return Fe(o,jr(o),i)},kr=function(o,i,s){return i=i(o),Za(o)?i:Fi(i,s(o))},Ci=function(o){return kr(o,Jd,fl)},Nm=function(o){return kr(o,Cf,jr)},hl=be(Fb,"DataView"),il=be(Fb,"Promise"),jl=be(Fb,"WeakMap"),rA=ae(hl),sA=ae(tg),tA=ae(il),uA=ae(gf),vA=ae(jl),ce=$d;(hl&&ce(new hl(new ArrayBuffer(1)))!="[object DataView]"||tg&&ce(new tg)!="[object Map]"||il&&ce(il.resolve())!="[object Promise]"||gf&&ce(new gf)!="[object Set]"||jl&&ce(new jl)!="[object WeakMap]")&&(ce=function(o){var i=$d(o);if(o=(o=i=="[object Object]"?o.constructor:void 0)?ae(o):"")switch(o){case rA:return"[object DataView]";case sA:return"[object Map]";case tA:return"[object Promise]";case uA:return"[object Set]";case vA:return"[object WeakMap]"}return i});var Af=ce,wA=Object.prototype.hasOwnProperty,uu=function(o){var i=o.length,s=new o.constructor(i);return i&&typeof o[0]=="string"&&wA.call(o,"index")&&(s.index=o.index,s.input=o.input),s},Zh=Fb.Uint8Array,kl=function(o){var i=new o.constructor(o.byteLength);return new Zh(i).set(new Zh(o)),i},xA=/\w*$/,lr=Ub?Ub.prototype:void 0,mr=lr?lr.valueOf:void 0,An=function(o,i){return i=i?kl(o.buffer):o.buffer,new o.constructor(i,o.byteOffset,o.length)},zu=function(o,i,s){var h=o.constructor;switch(i){case"[object ArrayBuffer]":return kl(o);case"[object Boolean]":case"[object Date]":return new h(+o);case"[object DataView]":return i=s?kl(o.buffer):o.buffer,new o.constructor(i,o.byteOffset,o.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return An(o,s);case"[object Map]":return new h;case"[object Number]":case"[object String]":return new h(o);case"[object RegExp]":return(i=new o.constructor(o.source,xA.exec(o))).lastIndex=o.lastIndex,i;case"[object Set]":return new h;case"[object Symbol]":return mr?Object(mr.call(o)):{}}},nr=Object.create,yA=function(){function o(){}return function(i){return ob(i)?nr?nr(i):(o.prototype=i,i=new o,o.prototype=void 0,i):{}}}(),Mm=function(o){return typeof o.constructor!="function"||el(o)?{}:yA(gl(o))},zA=function(o){return oc(o)&&Af(o)=="[object Map]"},or=hf&&hf.isMap,Bu=or?Yh(or):zA,AA=function(o){return oc(o)&&Af(o)=="[object Set]"},pr=hf&&hf.isSet,Au=pr?Yh(pr):AA,xa={};xa["[object Arguments]"]=xa["[object Array]"]=xa["[object ArrayBuffer]"]=xa["[object DataView]"]=xa["[object Boolean]"]=xa["[object Date]"]=xa["[object Float32Array]"]=xa["[object Float64Array]"]=xa["[object Int8Array]"]=xa["[object Int16Array]"]=xa["[object Int32Array]"]=xa["[object Map]"]=xa["[object Number]"]=xa["[object Object]"]=xa["[object RegExp]"]=xa["[object Set]"]=xa["[object String]"]=xa["[object Symbol]"]=xa["[object Uint8Array]"]=xa["[object Uint8ClampedArray]"]=xa["[object Uint16Array]"]=xa["[object Uint32Array]"]=!0,xa["[object Error]"]=xa["[object Function]"]=xa["[object WeakMap]"]=!1;var we=function(o){return V(o)=="symbol"||oc(o)&&$d(o)=="[object Symbol]"},BA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CA=/^\w*$/,ll=function(o,i){if(Za(o))return!1;var s=V(o);return!(s!="number"&&s!="symbol"&&s!="boolean"&&o!=null&&!we(o))||CA.test(o)||!BA.test(o)||i!=null&&o in Object(i)};Di.Cache=Ng;var DA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,EA=/\\(\\)?/g,FA=function(o){var i=(o=Di(o,function(s){return i.size===500&&i.clear(),s})).cache;return o}(function(o){var i=[];return o.charCodeAt(0)===46&&i.push(""),o.replace(DA,function(s,h,f,_){i.push(f?_.replace(EA,"$1"):h||s)}),i}),Du=1/0,qr=Ub?Ub.prototype:void 0,Qm=qr?qr.toString:void 0,$h=function(o,i){return Za(o)?o:ll(o,i)?[o]:FA(o==null?"":Pm(o))},GA=1/0,vg=function(o){if(typeof o=="string"||we(o))return o;var i=o+"";return i=="0"&&1/o==-GA?"-0":i},ai=function(o,i){for(var s=0,h=(i=$h(i,o)).length;o!=null&&s<h;)o=o[vg(i[s++])];return s&&s==h?o:void 0},HA=function(o,i){if(!(2>(i=$h(i,o)).length)){var s=i,h=0,f=-1,_=-1,w=s.length;for(0>h&&(h=-h>w?0:w+h),0>(f=f>w?w:f)&&(f+=w),w=h>f?0:f-h>>>0,h>>>=0,f=Array(w);++_<w;)f[_]=s[_+h];o=ai(o,f)}return(s=o==null)||(s=i==null?0:i.length,s=delete o[vg(s?i[s-1]:void 0)]),s},rr=Function.prototype.toString,IA=Object.prototype.hasOwnProperty,JA=rr.call(Object),Bn=function(o){return!(!oc(o)||$d(o)!="[object Object]")&&((o=gl(o))===null||typeof(o=IA.call(o,"constructor")&&o.constructor)=="function"&&o instanceof o&&rr.call(o)==JA)},KA=function(o){return Bn(o)?void 0:o},sr=Ub?Ub.isConcatSpreadable:void 0,Eu=function(o){return Za(o)||Jf(o)||!!(sr&&o&&o[sr])},LA=function(o){return o!=null&&o.length?Ei(o,1):[]},MA=function(o,i,s){switch(s.length){case 0:return o.call(i);case 1:return o.call(i,s[0]);case 2:return o.call(i,s[0],s[1]);case 3:return o.call(i,s[0],s[1],s[2])}return o.apply(i,s)},tr=Math.max,ur=function(o,i,s){return i=tr(i===void 0?o.length-1:i,0),function(){for(var h=arguments,f=-1,_=tr(h.length-i,0),w=Array(_);++f<_;)w[f]=h[i+f];for(f=-1,_=Array(i+1);++f<i;)_[f]=h[f];return _[i]=s(w),MA(o,this,_)}},NA=function(o){return function(){return o}},bi=function(o){return o},OA=Date.now,vr=function(o){var i=0,s=0;return function(){var h=OA(),f=16-(h-s);if(s=h,0<f){if(800<=++i)return arguments[0]}else i=0;return o.apply(void 0,arguments)}}(Xh?function(o,i){return Xh(o,"toString",{configurable:!0,enumerable:!1,value:NA(i),writable:!0})}:bi),ml=function(o){return vr(ur(o,void 0,LA),o+"")}(function(o,i){var s={};if(o==null)return s;var h=!1;i=ve(i,function(_){return _=$h(_,o),h||(h=1<_.length),_}),Fe(o,Nm(o),s),h&&(s=te(s,7,KA));for(var f=i.length;f--;)HA(s,i[f]);return s}),PA=function(o,i,s,h){for(var f=-1,_=o==null?0:o.length;++f<_;){var w=o[f];i(h,w,s(w),o)}return h},zn=function(o,i,s){for(var h=-1,f=Object(o),_=(s=s(o)).length;_--;){var w=s[++h];if(i(f[w],w,f)===!1)break}return o},wr=function(o,i){return o&&zn(o,i,Jd)},nl=function(o,i){return function(s,h){if(s==null)return s;if(!Nd(s))return o(s,h);for(var f=s.length,_=-1,w=Object(s);++_<f&&h(w[_],_,w)!==!1;);return s}}(wr),QA=function(o,i,s,h){return nl(o,function(f,_,w){i(h,f,s(f),w)}),h},xr=function(o,i){for(var s=-1,h=o==null?0:o.length;++s<h;)if(i(o[s],s,o))return!0;return!1},Rm=function(o,i,s,h,f,_){var w=1&s,j=o.length,F=i.length;if(j!=F&&!(w&&F>j))return!1;F=_.get(o);var K=_.get(i);if(F&&K)return F==i&&K==o;F=-1,K=!0;var _e=2&s?new zf:void 0;for(_.set(o,i),_.set(i,o);++F<j;){var _o=o[F],ca=i[F];if(h)var _c=w?h(ca,_o,F,i,o,_):h(_o,ca,F,o,i,_);if(_c!==void 0){if(_c)continue;K=!1;break}if(_e){if(!xr(i,function(ch,Nf){if(!_e.has(Nf)&&(_o===ch||f(_o,ch,s,h,_)))return _e.push(Nf)})){K=!1;break}}else if(_o!==ca&&!f(_o,ca,s,h,_)){K=!1;break}}return _.delete(o),_.delete(i),K},RA=function(o){var i=-1,s=Array(o.size);return o.forEach(function(h,f){s[++i]=[f,h]}),s},yr=Ub?Ub.prototype:void 0,ol=yr?yr.valueOf:void 0,Fu=function(o,i,s,h,f,_,w){switch(s){case"[object DataView]":if(o.byteLength!=i.byteLength||o.byteOffset!=i.byteOffset)break;o=o.buffer,i=i.buffer;case"[object ArrayBuffer]":if(o.byteLength!=i.byteLength||!_(new Zh(o),new Zh(i)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return sg(+o,+i);case"[object Error]":return o.name==i.name&&o.message==i.message;case"[object RegExp]":case"[object String]":return o==i+"";case"[object Map]":var j=RA;case"[object Set]":if(j||(j=al),o.size!=i.size&&!(1&h))break;return(s=w.get(o))?s==i:(h|=2,w.set(o,i),i=Rm(j(o),j(i),h,f,_,w),w.delete(o),i);case"[object Symbol]":if(ol)return ol.call(o)==ol.call(i)}return!1},Gu=Object.prototype.hasOwnProperty,Sm=Object.prototype.hasOwnProperty,SA=function(o,i,s,h){var f=s.length,_=f,w=!h;if(o==null)return!_;for(o=Object(o);f--;){var j=s[f];if(w&&j[2]?j[1]!==o[j[0]]:!(j[0]in o))return!1}for(;++f<_;){var F=(j=s[f])[0],K=o[F],_e=j[1];if(w&&j[2]){if(K===void 0&&!(F in o))return!1}else{if(j=new ue,h)var _o=h(K,_e,F,o,i,j);if(_o===void 0?!xe(_e,K,3,h,j):!_o)return!1}}return!0},TA=function(o){for(var i=Jd(o),s=i.length;s--;){var h=i[s],f=o[h];i[s]=[h,f,f==f&&!ob(f)]}return i},zr=function(o,i){return function(s){return s!=null&&s[o]===i&&(i!==void 0||o in Object(s))}},UA=function(o){var i=TA(o);return i.length==1&&i[0][2]?zr(i[0][0],i[0][1]):function(s){return s===o||SA(s,o,i)}},VA=function(o,i){return ll(o)&&i==i&&!ob(i)?zr(vg(o),i):function(s){var h=s==null?void 0:ai(s,o);if((h=h===void 0?void 0:h)===void 0&&h===i){if(h=s!=null){for(var f=-1,_=(h=$h(h=o,s)).length,w=!1;++f<_;){var j=vg(h[f]);if(!(w=s!=null&&s!=null&&j in Object(s)))break;s=s[j]}w||++f!=_?h=w:h=!!(_=s==null?0:s.length)&&dl(_)&&cl(j,_)&&(Za(s)||Jf(s))}j=h}else j=xe(i,h,3);return j}},WA=function(o){return function(i){return i==null?void 0:i[o]}},XA=function(o){return function(i){return ai(i,o)}},jf=function(o){return typeof o=="function"?o:o==null?bi:V(o)=="object"?Za(o)?VA(o[0],o[1]):UA(o):ll(o)?WA(vg(o)):XA(o)},pl=function(o,i){return function(s,h){var f={};return(Za(s)?PA:QA)(s,o,jf(h),f)}}(function(o,i,s){ug(o,s,i)}),Bc=function(o,i){var s={};return i=jf(i),wr(o,function(h,f,_){ug(s,f,i(h,f,_))}),s};M({target:"String",proto:!0,forced:R(function(){var o="".sub('"');return o!==o.toLowerCase()||3<o.split('"').length})},{sub:function(){return"<sub>"+String(mb(this))+"</sub>"}});var U=ya,Vb=null;try{Vb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(o){}ya.prototype.__isLong__,Object.defineProperty(ya.prototype,"__isLong__",{value:!0}),ya.isLong=pb;var Um={},Tm={};ya.fromInt=Kd,ya.fromNumber=Kb,ya.fromBits=za;var Pg=Math.pow;ya.fromString=Hi,ya.fromValue=bc;var ye=4294967296,Vm=ye*ye,Xm=Vm/2,Ar=Kd(16777216),Lb=Kd(0);ya.ZERO=Lb;var Ld=Kd(0,!0);ya.UZERO=Ld;var kf=Kd(1);ya.ONE=kf;var Br=Kd(1,!0);ya.UONE=Br;var ql=Kd(-1);ya.NEG_ONE=ql;var Ym=za(-1,2147483647,!1);ya.MAX_VALUE=Ym;var Wm=za(-1,-1,!0);ya.MAX_UNSIGNED_VALUE=Wm;var qb=za(0,-2147483648,!1);ya.MIN_VALUE=qb;var z=ya.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*ye+(this.low>>>0):this.high*ye+(this.low>>>0)},z.toString=function(o){if(2>(o=o||10)||36<o)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(qb)){var i=Kb(o),s=this.div(i);return i=s.mul(i).sub(this),s.toString(o)+i.toInt().toString(o)}return"-"+this.neg().toString(o)}s=Kb(Pg(o,6),this.unsigned),i=this;for(var h="";;){var f=i.div(s),_=(i.sub(f.mul(s)).toInt()>>>0).toString(o);if((i=f).isZero())return _+h;for(;6>_.length;)_="0"+_;h=""+_+h}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qb)?64:this.neg().getNumBitsAbs();for(var o=this.high!=0?this.high:this.low,i=31;0<i&&(o&1<<i)==0;i--);return this.high!=0?i+33:i+1},z.isZero=function(){return this.high===0&&this.low===0},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&0>this.high},z.isPositive=function(){return this.unsigned||0<=this.high},z.isOdd=function(){return(1&this.low)==1},z.isEven=function(){return(1&this.low)==0},z.equals=function(o){return pb(o)||(o=bc(o)),(this.unsigned===o.unsigned||this.high>>>31!=1||o.high>>>31!=1)&&this.high===o.high&&this.low===o.low},z.eq=z.equals,z.notEquals=function(o){return!this.eq(o)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(o){return 0>this.comp(o)},z.lt=z.lessThan,z.lessThanOrEqual=function(o){return 0>=this.comp(o)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(o){return 0<this.comp(o)},z.gt=z.greaterThan,z.greaterThanOrEqual=function(o){return 0<=this.comp(o)},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(o){if(pb(o)||(o=bc(o)),this.eq(o))return 0;var i=this.isNegative(),s=o.isNegative();return i&&!s?-1:!i&&s?1:this.unsigned?o.high>>>0>this.high>>>0||o.high===this.high&&o.low>>>0>this.low>>>0?-1:1:this.sub(o).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(qb)?qb:this.not().add(kf)},z.neg=z.negate,z.add=function(o){pb(o)||(o=bc(o));var i=this.high>>>16,s=65535&this.high,h=this.low>>>16,f=o.high>>>16,_=65535&o.high,w=o.low>>>16;return h=(w=((o=(65535&this.low)+(65535&o.low))>>>16)+(h+w))>>>16,za((65535&w)<<16|65535&o,(i=((h+=s+_)>>>16)+(i+f)&65535)<<16|65535&h,this.unsigned)},z.subtract=function(o){return pb(o)||(o=bc(o)),this.add(o.neg())},z.sub=z.subtract,z.multiply=function(o){if(this.isZero())return Lb;if(pb(o)||(o=bc(o)),Vb){var i=Vb.mul(this.low,this.high,o.low,o.high);return za(i,Vb.get_high(),this.unsigned)}if(o.isZero())return Lb;if(this.eq(qb))return o.isOdd()?qb:Lb;if(o.eq(qb))return this.isOdd()?qb:Lb;if(this.isNegative())return o.isNegative()?this.neg().mul(o.neg()):this.neg().mul(o).neg();if(o.isNegative())return this.mul(o.neg()).neg();if(this.lt(Ar)&&o.lt(Ar))return Kb(this.toNumber()*o.toNumber(),this.unsigned);i=this.high>>>16;var s=65535&this.high,h=this.low>>>16,f=65535&this.low,_=o.high>>>16,w=65535&o.high,j=o.low>>>16,F=f*(o=65535&o.low),K=(F>>>16)+h*o,_e=K>>>16;_e+=(K=(65535&K)+f*j)>>>16;var _o=(_e+=s*o)>>>16;return za((65535&K)<<16|65535&F,(_o=(_o+=(_e=(65535&_e)+h*j)>>>16)+((_e=(65535&_e)+f*w)>>>16)+(i*o+s*j+h*w+f*_)&65535)<<16|65535&_e,this.unsigned)},z.mul=z.multiply,z.divide=function(o){if(pb(o)||(o=bc(o)),o.isZero())throw Error("division by zero");if(Vb)return this.unsigned||this.high!==-2147483648||o.low!==-1||o.high!==-1?za(o=(this.unsigned?Vb.div_u:Vb.div_s)(this.low,this.high,o.low,o.high),Vb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ld:Lb;if(this.unsigned){if(o.unsigned||(o=o.toUnsigned()),o.gt(this))return Ld;if(o.gt(this.shru(1)))return Br;var i=Ld}else{if(this.eq(qb)){if(o.eq(kf)||o.eq(ql))return qb;if(o.eq(qb))return kf;var s=this.shr(1).div(o).shl(1);if(s.eq(Lb))return o.isNegative()?kf:ql;var h=this.sub(o.mul(s));return s.add(h.div(o))}if(o.eq(qb))return this.unsigned?Ld:Lb;if(this.isNegative())return o.isNegative()?this.neg().div(o.neg()):this.neg().div(o).neg();if(o.isNegative())return this.div(o.neg()).neg();i=Lb}for(h=this;h.gte(o);){s=Math.max(1,Math.floor(h.toNumber()/o.toNumber()));var f=Math.ceil(Math.log(s)/Math.LN2);f=48>=f?1:Pg(2,f-48);for(var _=Kb(s),w=_.mul(o);w.isNegative()||w.gt(h);)w=(_=Kb(s-=f,this.unsigned)).mul(o);_.isZero()&&(_=kf),i=i.add(_),h=h.sub(w)}return i},z.div=z.divide,z.modulo=function(o){return pb(o)||(o=bc(o)),Vb?za(o=(this.unsigned?Vb.rem_u:Vb.rem_s)(this.low,this.high,o.low,o.high),Vb.get_high(),this.unsigned):this.sub(this.div(o).mul(o))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return za(~this.low,~this.high,this.unsigned)},z.and=function(o){return pb(o)||(o=bc(o)),za(this.low&o.low,this.high&o.high,this.unsigned)},z.or=function(o){return pb(o)||(o=bc(o)),za(this.low|o.low,this.high|o.high,this.unsigned)},z.xor=function(o){return pb(o)||(o=bc(o)),za(this.low^o.low,this.high^o.high,this.unsigned)},z.shiftLeft=function(o){return pb(o)&&(o=o.toInt()),(o&=63)==0?this:32>o?za(this.low<<o,this.high<<o|this.low>>>32-o,this.unsigned):za(0,this.low<<o-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(o){return pb(o)&&(o=o.toInt()),(o&=63)==0?this:32>o?za(this.low>>>o|this.high<<32-o,this.high>>o,this.unsigned):za(this.high>>o-32,0<=this.high?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(o){if(pb(o)&&(o=o.toInt()),(o&=63)===0)return this;var i=this.high;return 32>o?za(this.low>>>o|i<<32-o,i>>>o,this.unsigned):za(o===32?i:i>>>o-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.toSigned=function(){return this.unsigned?za(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:za(this.low,this.high,!0)},z.toBytes=function(o){return o?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var o=this.high,i=this.low;return[255&i,i>>>8&255,i>>>16&255,i>>>24,255&o,o>>>8&255,o>>>16&255,o>>>24]},z.toBytesBE=function(){var o=this.high,i=this.low;return[o>>>24,o>>>16&255,o>>>8&255,255&o,i>>>24,i>>>16&255,i>>>8&255,255&i]},ya.fromBytes=function(o,i,s){return s?ya.fromBytesLE(o,i):ya.fromBytesBE(o,i)},ya.fromBytesLE=function(o,i){return new ya(o[0]|o[1]<<8|o[2]<<16|o[3]<<24,o[4]|o[5]<<8|o[6]<<16|o[7]<<24,i)},ya.fromBytesBE=function(o,i){return new ya(o[4]<<24|o[5]<<16|o[6]<<8|o[7],o[0]<<24|o[1]<<16|o[2]<<8|o[3],i)};var Ii=function(o,i){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])})(o,i)},rl=!1,Mb={Promise:void 0,set useDeprecatedSynchronousErrorHandling(o){o?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):rl&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),rl=o},get useDeprecatedSynchronousErrorHandling(){return rl}},ci={closed:!0,next:function(o){},error:function(o){if(Mb.useDeprecatedSynchronousErrorHandling)throw o;Ae(o)},complete:function(){}},Nb=Array.isArray||function(o){return o&&typeof o.length=="number"},Df=function(){function o(i){return Error.call(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(s,h){return h+1+") "+s.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i,this}return o.prototype=Object.create(Error.prototype),o}(),Ta=function(){function o(i){this.closed=!1,this._subscriptions=this._parentOrParents=null,i&&(this._ctorUnsubscribe=!0,this._unsubscribe=i)}return o.prototype.unsubscribe=function(){if(!this.closed){var i=this._parentOrParents,s=this._ctorUnsubscribe,h=this._unsubscribe,f=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,i instanceof o)i.remove(this);else if(i!==null)for(var _=0;_<i.length;++_)i[_].remove(this);if(ze(h)){s&&(this._unsubscribe=void 0);try{h.call(this)}catch(j){var w=j instanceof Df?Zm(j.errors):[j]}}if(Nb(f)){for(_=-1,i=f.length;++_<i;)if(Ji(s=f[_]))try{s.unsubscribe()}catch(j){w=w||[],j instanceof Df?w=w.concat(Zm(j.errors)):w.push(j)}}if(w)throw new Df(w)}},o.prototype.add=function(i){var s=i;if(!i)return o.EMPTY;switch(V(i)){case"function":s=new o(i);case"object":if(s===this||s.closed||typeof s.unsubscribe!="function")return s;if(this.closed)return s.unsubscribe(),s;s instanceof o||(i=s,(s=new o)._subscriptions=[i]);break;default:throw Error("unrecognized teardown "+i+" added to Subscription.")}if((i=s._parentOrParents)===null)s._parentOrParents=this;else if(i instanceof o){if(i===this)return s;s._parentOrParents=[i,this]}else{if(i.indexOf(this)!==-1)return s;i.push(this)}return(i=this._subscriptions)===null?this._subscriptions=[s]:i.push(s),s},o.prototype.remove=function(i){var s=this._subscriptions;s&&(i=s.indexOf(i))!==-1&&s.splice(i,1)},o.EMPTY=function(i){return i.closed=!0,i}(new o),o}(),di=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ma=function(o){function i(s,h,f){var _=o.call(this)||this;switch(_.syncErrorValue=null,_.syncErrorThrown=!1,_.syncErrorThrowable=!1,_.isStopped=!1,arguments.length){case 0:_.destination=ci;break;case 1:if(!s){_.destination=ci;break}if(V(s)==="object"){s instanceof i?(_.syncErrorThrowable=s.syncErrorThrowable,_.destination=s,s.add(_)):(_.syncErrorThrowable=!0,_.destination=new Cr(_,s));break}default:_.syncErrorThrowable=!0,_.destination=new Cr(_,s,h,f)}return _}return O(i,o),i.prototype[di]=function(){return this},i.create=function(s,h,f){return(s=new i(s,h,f)).syncErrorThrowable=!1,s},i.prototype.next=function(s){this.isStopped||this._next(s)},i.prototype.error=function(s){this.isStopped||(this.isStopped=!0,this._error(s))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},i.prototype._next=function(s){this.destination.next(s)},i.prototype._error=function(s){this.destination.error(s),this.unsubscribe()},i.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},i.prototype._unsubscribeAndRecycle=function(){var s=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=s,this},i}(Ta),Cr=function(o){function i(s,h,f,_){var w=o.call(this)||this;if(w._parentSubscriber=s,s=w,ze(h))var j=h;else h&&(j=h.next,f=h.error,_=h.complete,h!==ci&&(ze((s=Object.create(h)).unsubscribe)&&w.add(s.unsubscribe.bind(s)),s.unsubscribe=w.unsubscribe.bind(w)));return w._context=s,w._next=j,w._error=f,w._complete=_,w}return O(i,o),i.prototype.next=function(s){if(!this.isStopped&&this._next){var h=this._parentSubscriber;Mb.useDeprecatedSynchronousErrorHandling&&h.syncErrorThrowable?this.__tryOrSetError(h,this._next,s)&&this.unsubscribe():this.__tryOrUnsub(this._next,s)}},i.prototype.error=function(s){if(!this.isStopped){var h=this._parentSubscriber,f=Mb.useDeprecatedSynchronousErrorHandling;if(this._error)f&&h.syncErrorThrowable?this.__tryOrSetError(h,this._error,s):this.__tryOrUnsub(this._error,s),this.unsubscribe();else if(h.syncErrorThrowable)f?(h.syncErrorValue=s,h.syncErrorThrown=!0):Ae(s),this.unsubscribe();else{if(this.unsubscribe(),f)throw s;Ae(s)}}},i.prototype.complete=function(){var s=this;if(!this.isStopped){var h=this._parentSubscriber;if(this._complete){var f=function(){return s._complete.call(s._context)};Mb.useDeprecatedSynchronousErrorHandling&&h.syncErrorThrowable?this.__tryOrSetError(h,f):this.__tryOrUnsub(f)}this.unsubscribe()}},i.prototype.__tryOrUnsub=function(s,h){try{s.call(this._context,h)}catch(f){if(this.unsubscribe(),Mb.useDeprecatedSynchronousErrorHandling)throw f;Ae(f)}},i.prototype.__tryOrSetError=function(s,h,f){if(!Mb.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{h.call(this._context,f)}catch(_){return Mb.useDeprecatedSynchronousErrorHandling?(s.syncErrorValue=_,s.syncErrorThrown=!0):Ae(_),!0}return!1},i.prototype._unsubscribe=function(){var s=this._parentSubscriber;this._parentSubscriber=this._context=null,s.unsubscribe()},i}(ma),Be=typeof Symbol=="function"&&Symbol.observable||"@@observable",Y=function(){function o(i){this._isScalar=!1,i&&(this._subscribe=i)}return o.prototype.lift=function(i){var s=new o;return s.source=this,s.operator=i,s},o.prototype.subscribe=function(i,s,h){var f=this.operator;t:{if(i){if(i instanceof ma)break t;if(i[di]){i=i[di]();break t}}i=i||s||h?new ma(i,s,h):new ma(ci)}if(f?i.add(f.call(i,this.source)):i.add(this.source||Mb.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),Mb.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},o.prototype._trySubscribe=function(i){try{return this._subscribe(i)}catch(s){Mb.useDeprecatedSynchronousErrorHandling&&(i.syncErrorThrown=!0,i.syncErrorValue=s),Ki(i)?i.error(s):console.warn(s)}},o.prototype.forEach=function(i,s){var h=this;return new(s=an(s))(function(f,_){var w=h.subscribe(function(j){try{i(j)}catch(F){_(F),w&&w.unsubscribe()}},_,f)})},o.prototype._subscribe=function(i){var s=this.source;return s&&s.subscribe(i)},o.prototype[Be]=function(){return this},o.prototype.pipe=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return i.length===0?this:$m(i)(this)},o.prototype.toPromise=function(i){var s=this;return new(i=an(i))(function(h,f){var _;s.subscribe(function(w){return _=w},function(w){return f(w)},function(){return h(_)})})},o.create=function(i){return new o(i)},o}(),xd=function(){function o(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return o.prototype=Object.create(Error.prototype),o}(),Dr=function(o){function i(s,h){var f=o.call(this)||this;return f.subject=s,f.subscriber=h,f.closed=!1,f}return O(i,o),i.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var s=this.subject,h=s.observers;this.subject=null,!h||h.length===0||s.isStopped||s.closed||(s=h.indexOf(this.subscriber))!==-1&&h.splice(s,1)}},i}(Ta),Er=function(o){function i(s){var h=o.call(this,s)||this;return h.destination=s,h}return O(i,o),i}(ma),Ua=function(o){function i(){var s=o.call(this)||this;return s.observers=[],s.closed=!1,s.isStopped=!1,s.hasError=!1,s.thrownError=null,s}return O(i,o),i.prototype[di]=function(){return new Er(this)},i.prototype.lift=function(s){var h=new Fr(this,this);return h.operator=s,h},i.prototype.next=function(s){if(this.closed)throw new xd;if(!this.isStopped){var h=this.observers,f=h.length;h=h.slice();for(var _=0;_<f;_++)h[_].next(s)}},i.prototype.error=function(s){if(this.closed)throw new xd;this.hasError=!0,this.thrownError=s,this.isStopped=!0;var h=this.observers,f=h.length;h=h.slice();for(var _=0;_<f;_++)h[_].error(s);this.observers.length=0},i.prototype.complete=function(){if(this.closed)throw new xd;this.isStopped=!0;var s=this.observers,h=s.length;s=s.slice();for(var f=0;f<h;f++)s[f].complete();this.observers.length=0},i.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},i.prototype._trySubscribe=function(s){if(this.closed)throw new xd;return o.prototype._trySubscribe.call(this,s)},i.prototype._subscribe=function(s){if(this.closed)throw new xd;return this.hasError?(s.error(this.thrownError),Ta.EMPTY):this.isStopped?(s.complete(),Ta.EMPTY):(this.observers.push(s),new Dr(this,s))},i.prototype.asObservable=function(){var s=new Y;return s.source=this,s},i.create=function(s,h){return new Fr(s,h)},i}(Y),Fr=function(o){function i(s,h){var f=o.call(this)||this;return f.destination=s,f.source=h,f}return O(i,o),i.prototype.next=function(s){var h=this.destination;h&&h.next&&h.next(s)},i.prototype.error=function(s){var h=this.destination;h&&h.error&&this.destination.error(s)},i.prototype.complete=function(){var s=this.destination;s&&s.complete&&this.destination.complete()},i.prototype._subscribe=function(s){return this.source?this.source.subscribe(s):Ta.EMPTY},i}(Ua),Hu=function(){function o(i){this.connectable=i}return o.prototype.call=function(i,s){var h=this.connectable;return h._refCount++,i=new YA(i,h),s=s.subscribe(i),i.closed||(i.connection=h.connect()),s},o}(),YA=function(o){function i(s,h){return(s=o.call(this,s)||this).connectable=h,s}return O(i,o),i.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var h=s._refCount;0>=h?this.connection=null:(s._refCount=h-1,1<h?this.connection=null:(h=this.connection,s=s._connection,this.connection=null,!s||h&&s!==h||s.unsubscribe()))}else this.connection=null},i}(ma),Gr=function(o){function i(s,h){var f=o.call(this)||this;return f.source=s,f.subjectFactory=h,f._refCount=0,f._isComplete=!1,f}return O(i,o),i.prototype._subscribe=function(s){return this.getSubject().subscribe(s)},i.prototype.getSubject=function(){var s=this._subject;return s&&!s.isStopped||(this._subject=this.subjectFactory()),this._subject},i.prototype.connect=function(){var s=this._connection;return s||(this._isComplete=!1,(s=this._connection=new Ta).add(this.source.subscribe(new ZA(this.getSubject(),this))),s.closed&&(this._connection=null,s=Ta.EMPTY)),s},i.prototype.refCount=function(){return bn()(this)},i}(Y),uv=function(){var o=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:o._subscribe},_isComplete:{value:o._isComplete,writable:!0},getSubject:{value:o.getSubject},connect:{value:o.connect},refCount:{value:o.refCount}}}(),ZA=function(o){function i(s,h){return(s=o.call(this,s)||this).connectable=h,s}return O(i,o),i.prototype._error=function(s){this._unsubscribe(),o.prototype._error.call(this,s)},i.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),o.prototype._complete.call(this)},i.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var h=s._connection;s._refCount=0,s._subject=null,s._connection=null,h&&h.unsubscribe()}},i}(Er);(function(o){function i(s,h){return(s=o.call(this,s)||this).connectable=h,s}O(i,o),i.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var h=s._refCount;0>=h?this.connection=null:(s._refCount=h-1,1<h?this.connection=null:(h=this.connection,s=s._connection,this.connection=null,!s||h&&s!==h||s.unsubscribe()))}else this.connection=null}})(ma),function(o){function i(s,h,f,_,w){return(s=o.call(this,s)||this).keySelector=h,s.elementSelector=f,s.durationSelector=_,s.subjectSelector=w,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}O(i,o),i.prototype._next=function(s){try{var h=this.keySelector(s)}catch(f){return void this.error(f)}this._group(s,h)},i.prototype._group=function(s,h){var f=this.groups;f||(f=this.groups=new Map);var _=f.get(h);if(this.elementSelector)try{var w=this.elementSelector(s)}catch(j){this.error(j)}else w=s;if(!_&&(_=this.subjectSelector?this.subjectSelector():new Ua,f.set(h,_),s=new sl(h,_,this),this.destination.next(s),this.durationSelector)){s=void 0;try{s=this.durationSelector(new sl(h,_))}catch(j){return void this.error(j)}this.add(s.subscribe(new $A(h,_,this)))}_.closed||_.next(w)},i.prototype._error=function(s){var h=this.groups;h&&(h.forEach(function(f,_){f.error(s)}),h.clear()),this.destination.error(s)},i.prototype._complete=function(){var s=this.groups;s&&(s.forEach(function(h,f){h.complete()}),s.clear()),this.destination.complete()},i.prototype.removeGroup=function(s){this.groups.delete(s)},i.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&o.prototype.unsubscribe.call(this))}}(ma);var $A=function(o){function i(s,h,f){var _=o.call(this,h)||this;return _.key=s,_.group=h,_.parent=f,_}return O(i,o),i.prototype._next=function(s){this.complete()},i.prototype._unsubscribe=function(){var s=this.parent,h=this.key;this.key=this.parent=null,s&&s.removeGroup(h)},i}(ma),sl=function(o){function i(s,h,f){var _=o.call(this)||this;return _.key=s,_.groupSubject=h,_.refCountSubscription=f,_}return O(i,o),i.prototype._subscribe=function(s){var h=new Ta,f=this.refCountSubscription,_=this.groupSubject;return f&&!f.closed&&h.add(new aB(f)),h.add(_.subscribe(s)),h},i}(Y),aB=function(o){function i(s){var h=o.call(this)||this;return h.parent=s,s.count++,h}return O(i,o),i.prototype.unsubscribe=function(){var s=this.parent;s.closed||this.closed||(o.prototype.unsubscribe.call(this),--s.count,s.count===0&&s.attemptedToUnsubscribe&&s.unsubscribe())},i}(Ta),bB=function(o){function i(s){var h=o.call(this)||this;return h._value=s,h}return O(i,o),Object.defineProperty(i.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),i.prototype._subscribe=function(s){var h=o.prototype._subscribe.call(this,s);return h&&!h.closed&&s.next(this._value),h},i.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new xd;return this._value},i.prototype.next=function(s){o.prototype.next.call(this,this._value=s)},i}(Ua),wg=function(o){function i(s,h){var f=o.call(this,s,h)||this;return f.scheduler=s,f.work=h,f.pending=!1,f}return O(i,o),i.prototype.schedule=function(s,h){if(h===void 0&&(h=0),this.closed)return this;this.state=s,s=this.id;var f=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(f,s,h)),this.pending=!0,this.delay=h,this.id=this.id||this.requestAsyncId(f,this.id,h),this},i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),setInterval(s.flush.bind(s,this),f)},i.prototype.recycleAsyncId=function(s,h,f){if(f===void 0&&(f=0),f!==null&&this.delay===f&&this.pending===!1)return h;clearInterval(h)},i.prototype.execute=function(s,h){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(s=this._execute(s,h))?s:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},i.prototype._execute=function(s,h){h=!1;var f=void 0;try{this.work(s)}catch(_){h=!0,f=!!_&&_||Error(_)}if(h)return this.unsubscribe(),f},i.prototype._unsubscribe=function(){var s=this.id,h=this.scheduler,f=h.actions,_=f.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,_!==-1&&f.splice(_,1),s!=null&&(this.id=this.recycleAsyncId(h,s,null)),this.delay=null},i}(function(o){function i(s,h){return o.call(this)||this}return O(i,o),i.prototype.schedule=function(s,h){return this},i}(Ta)),cB=function(o){function i(s,h){var f=o.call(this,s,h)||this;return f.scheduler=s,f.work=h,f}return O(i,o),i.prototype.schedule=function(s,h){return h===void 0&&(h=0),0<h?o.prototype.schedule.call(this,s,h):(this.delay=h,this.state=s,this.scheduler.flush(this),this)},i.prototype.execute=function(s,h){return 0<h||this.closed?o.prototype.execute.call(this,s,h):this._execute(s,h)},i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),f!==null&&0<f||f===null&&0<this.delay?o.prototype.requestAsyncId.call(this,s,h,f):s.flush(this)},i}(wg),tl=function(){function o(i,s){s===void 0&&(s=o.now),this.SchedulerAction=i,this.now=s}return o.prototype.schedule=function(i,s,h){return s===void 0&&(s=0),new this.SchedulerAction(this,i).schedule(h,s)},o.now=function(){return Date.now()},o}(),xg=function(o){function i(s,h){h===void 0&&(h=tl.now);var f=o.call(this,s,function(){return i.delegate&&i.delegate!==f?i.delegate.now():h()})||this;return f.actions=[],f.active=!1,f.scheduled=void 0,f}return O(i,o),i.prototype.schedule=function(s,h,f){return h===void 0&&(h=0),i.delegate&&i.delegate!==this?i.delegate.schedule(s,h,f):o.prototype.schedule.call(this,s,h,f)},i.prototype.flush=function(s){var h=this.actions;if(this.active)h.push(s);else{var f;this.active=!0;do if(f=s.execute(s.state,s.delay))break;while(s=h.shift());if(this.active=!1,f){for(;s=h.shift();)s.unsubscribe();throw f}}},i}(tl),yg=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i}(xg))(cB),yb=new Y(function(o){return o.complete()}),cn=function(o){return function(i){for(var s=0,h=o.length;s<h&&!i.closed;s++)i.next(o[s]);i.complete()}},ul;(function(o){o.NEXT="N",o.ERROR="E",o.COMPLETE="C"})(ul||(ul={}));var lf=function(){function o(i,s,h){this.kind=i,this.value=s,this.error=h,this.hasValue=i==="N"}return o.prototype.observe=function(i){switch(this.kind){case"N":return i.next&&i.next(this.value);case"E":return i.error&&i.error(this.error);case"C":return i.complete&&i.complete()}},o.prototype.do=function(i,s,h){switch(this.kind){case"N":return i&&i(this.value);case"E":return s&&s(this.error);case"C":return h&&h()}},o.prototype.accept=function(i,s,h){return i&&typeof i.next=="function"?this.observe(i):this.do(i,s,h)},o.prototype.toObservable=function(){switch(this.kind){case"N":return eb(this.value);case"E":return Z(this.error);case"C":return Ef()}throw Error("unexpected notification kind value")},o.createNext=function(i){return i!==void 0?new o("N",i):o.undefinedValueNotification},o.createError=function(i){return new o("E",void 0,i)},o.createComplete=function(){return o.completeNotification},o.completeNotification=new o("C"),o.undefinedValueNotification=new o("N",void 0),o}(),Lu=function(){function o(i,s){s===void 0&&(s=0),this.scheduler=i,this.delay=s}return o.prototype.call=function(i,s){return s.subscribe(new Hr(i,this.scheduler,this.delay))},o}(),Hr=function(o){function i(s,h,f){return f===void 0&&(f=0),(s=o.call(this,s)||this).scheduler=h,s.delay=f,s}return O(i,o),i.dispatch=function(s){s.notification.observe(s.destination),this.unsubscribe()},i.prototype.scheduleMessage=function(s){this.destination.add(this.scheduler.schedule(i.dispatch,this.delay,new dB(s,this.destination)))},i.prototype._next=function(s){this.scheduleMessage(lf.createNext(s))},i.prototype._error=function(s){this.scheduleMessage(lf.createError(s)),this.unsubscribe()},i.prototype._complete=function(){this.scheduleMessage(lf.createComplete()),this.unsubscribe()},i}(ma),dB=function(o,i){this.notification=o,this.destination=i},Ee=function(o){function i(s,h,f){s===void 0&&(s=Number.POSITIVE_INFINITY),h===void 0&&(h=Number.POSITIVE_INFINITY);var _=o.call(this)||this;return _.scheduler=f,_._events=[],_._infiniteTimeWindow=!1,_._bufferSize=1>s?1:s,_._windowTime=1>h?1:h,h===Number.POSITIVE_INFINITY?(_._infiniteTimeWindow=!0,_.next=_.nextInfiniteTimeWindow):_.next=_.nextTimeWindow,_}return O(i,o),i.prototype.nextInfiniteTimeWindow=function(s){if(!this.isStopped){var h=this._events;h.push(s),h.length>this._bufferSize&&h.shift()}o.prototype.next.call(this,s)},i.prototype.nextTimeWindow=function(s){this.isStopped||(this._events.push(new eB(this._getNow(),s)),this._trimBufferThenGetEvents()),o.prototype.next.call(this,s)},i.prototype._subscribe=function(s){var h=this._infiniteTimeWindow,f=h?this._events:this._trimBufferThenGetEvents(),_=this.scheduler,w=f.length;if(this.closed)throw new xd;if(this.isStopped||this.hasError)var j=Ta.EMPTY;else this.observers.push(s),j=new Dr(this,s);if(_&&s.add(s=new Hr(s,_)),h)for(h=0;h<w&&!s.closed;h++)s.next(f[h]);else for(h=0;h<w&&!s.closed;h++)s.next(f[h].value);return this.hasError?s.error(this.thrownError):this.isStopped&&s.complete(),j},i.prototype._getNow=function(){return(this.scheduler||yg).now()},i.prototype._trimBufferThenGetEvents=function(){for(var s=this._getNow(),h=this._bufferSize,f=this._windowTime,_=this._events,w=_.length,j=0;j<w&&!(s-_[j].time<f);)j++;return w>h&&(j=Math.max(j,w-h)),0<j&&_.splice(0,j),_},i}(Ua),eB=function(o,i){this.time=o,this.value=i},Gf=function(o){function i(){var s=o!==null&&o.apply(this,arguments)||this;return s.value=null,s.hasNext=!1,s.hasCompleted=!1,s}return O(i,o),i.prototype._subscribe=function(s){return this.hasError?(s.error(this.thrownError),Ta.EMPTY):this.hasCompleted&&this.hasNext?(s.next(this.value),s.complete(),Ta.EMPTY):o.prototype._subscribe.call(this,s)},i.prototype.next=function(s){this.hasCompleted||(this.value=s,this.hasNext=!0)},i.prototype.error=function(s){this.hasCompleted||o.prototype.error.call(this,s)},i.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&o.prototype.next.call(this,this.value),o.prototype.complete.call(this)},i}(Ua),fB=1,gB=Promise.resolve(),Ni={},Ir={setImmediate:function(o){var i=fB++;return Ni[i]=!0,gB.then(function(){return dn(i)&&o()}),i},clearImmediate:function(o){dn(o)}},hB=function(o){function i(s,h){var f=o.call(this,s,h)||this;return f.scheduler=s,f.work=h,f}return O(i,o),i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),f!==null&&0<f?o.prototype.requestAsyncId.call(this,s,h,f):(s.actions.push(this),s.scheduled||(s.scheduled=Ir.setImmediate(s.flush.bind(s,null))))},i.prototype.recycleAsyncId=function(s,h,f){if(f===void 0&&(f=0),f!==null&&0<f||f===null&&0<this.delay)return o.prototype.recycleAsyncId.call(this,s,h,f);s.actions.length===0&&(Ir.clearImmediate(h),s.scheduled=void 0)},i}(wg),Xi=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.flush=function(s){this.active=!0,this.scheduled=void 0;var h,f=this.actions,_=-1,w=f.length;s=s||f.shift();do if(h=s.execute(s.state,s.delay))break;while(++_<w&&(s=f.shift()));if(this.active=!1,h){for(;++_<w&&(s=f.shift());)s.unsubscribe();throw h}},i}(xg))(hB),iB=Xi,vl=new xg(wg),id=vl,jB=function(o){function i(s,h){var f=o.call(this,s,h)||this;return f.scheduler=s,f.work=h,f}return O(i,o),i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),f!==null&&0<f?o.prototype.requestAsyncId.call(this,s,h,f):(s.actions.push(this),s.scheduled||(s.scheduled=requestAnimationFrame(function(){return s.flush(null)})))},i.prototype.recycleAsyncId=function(s,h,f){if(f===void 0&&(f=0),f!==null&&0<f||f===null&&0<this.delay)return o.prototype.recycleAsyncId.call(this,s,h,f);s.actions.length===0&&(cancelAnimationFrame(h),s.scheduled=void 0)},i}(wg),Jr=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.flush=function(s){this.active=!0,this.scheduled=void 0;var h,f=this.actions,_=-1,w=f.length;s=s||f.shift();do if(h=s.execute(s.state,s.delay))break;while(++_<w&&(s=f.shift()));if(this.active=!1,h){for(;++_<w&&(s=f.shift());)s.unsubscribe();throw h}},i}(xg))(jB),kB=function(o){function i(s,h){s===void 0&&(s=Kr),h===void 0&&(h=Number.POSITIVE_INFINITY);var f=o.call(this,s,function(){return f.frame})||this;return f.maxFrames=h,f.frame=0,f.index=-1,f}return O(i,o),i.prototype.flush=function(){for(var s,h,f=this.actions,_=this.maxFrames;(h=f[0])&&h.delay<=_&&(f.shift(),this.frame=h.delay,!(s=h.execute(h.state,h.delay))););if(s){for(;h=f.shift();)h.unsubscribe();throw s}},i.frameTimeFactor=10,i}(xg),Kr=function(o){function i(s,h,f){f===void 0&&(f=s.index+=1);var _=o.call(this,s,h)||this;return _.scheduler=s,_.work=h,_.index=f,_.active=!0,_.index=s.index=f,_}return O(i,o),i.prototype.schedule=function(s,h){if(h===void 0&&(h=0),!this.id)return o.prototype.schedule.call(this,s,h);this.active=!1;var f=new i(this.scheduler,this.work);return this.add(f),f.schedule(s,h)},i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),this.delay=s.frame+f,(s=s.actions).push(this),s.sort(i.sortActions),!0},i.prototype.recycleAsyncId=function(s,h,f){},i.prototype._execute=function(s,h){if(this.active===!0)return o.prototype._execute.call(this,s,h)},i.sortActions=function(s,h){return s.delay===h.delay?s.index===h.index?0:s.index>h.index?1:-1:s.delay>h.delay?1:-1},i}(wg),wl=function(){function o(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return o.prototype=Object.create(Error.prototype),o}(),Sg=function(){function o(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return o.prototype=Object.create(Error.prototype),o}(),sb=function(){function o(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return o.prototype=Object.create(Error.prototype),o}(),Mu=function(){function o(i,s){this.project=i,this.thisArg=s}return o.prototype.call=function(i,s){return s.subscribe(new lB(i,this.project,this.thisArg))},o}(),lB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).project=h,s.count=0,s.thisArg=f||s,s}return O(i,o),i.prototype._next=function(s){try{var h=this.project.call(this.thisArg,s,this.count++)}catch(f){return void this.destination.error(f)}this.destination.next(h)},i}(ma),xl=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.notifyNext=function(s,h,f,_,w){this.destination.next(h)},i.prototype.notifyError=function(s,h){this.destination.error(s)},i.prototype.notifyComplete=function(s){this.destination.complete()},i}(ma),Ru=function(o){function i(s,h,f){var _=o.call(this)||this;return _.parent=s,_.outerValue=h,_.outerIndex=f,_.index=0,_}return O(i,o),i.prototype._next=function(s){this.parent.notifyNext(this.outerValue,s,this.outerIndex,this.index++,this)},i.prototype._error=function(s){this.parent.notifyError(s,this),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},i}(ma),mB=function(o){return function(i){return o.then(function(s){i.closed||(i.next(s),i.complete())},function(s){return i.error(s)}).then(null,Ae),i}},gd=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",nB=function(o){return function(i){for(var s=o[gd]();;){var h=void 0;try{h=s.next()}catch(f){return i.error(f),i}if(h.done){i.complete();break}if(i.next(h.value),i.closed)break}return typeof s.return=="function"&&i.add(function(){s.return&&s.return()}),i}},oB=function(o){return function(i){var s=o[Be]();if(typeof s.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return s.subscribe(i)}},kn=function(o){return o&&typeof o.length=="number"&&typeof o!="function"},Hf=function(o){if(o&&typeof o[Be]=="function")return oB(o);if(kn(o))return cn(o);if(hn(o))return mB(o);if(o&&typeof o[gd]=="function")return nB(o);throw o=Ji(o)?"an invalid object":"'"+o+"'",new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Lr={},qB=function(){function o(i){this.resultSelector=i}return o.prototype.call=function(i,s){return s.subscribe(new pB(i,this.resultSelector))},o}(),pB=function(o){function i(s,h){return(s=o.call(this,s)||this).resultSelector=h,s.active=0,s.values=[],s.observables=[],s}return O(i,o),i.prototype._next=function(s){this.values.push(Lr),this.observables.push(s)},i.prototype._complete=function(){var s=this.observables,h=s.length;if(h===0)this.destination.complete();else{this.toRespond=this.active=h;for(var f=0;f<h;f++)this.add(Oi(this,s[f],void 0,f))}},i.prototype.notifyComplete=function(s){--this.active==0&&this.destination.complete()},i.prototype.notifyNext=function(s,h,f){var _=(s=this.values)[f];_=this.toRespond?_===Lr?--this.toRespond:this.toRespond:0,s[f]=h,_===0&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))},i.prototype._tryResultSelector=function(s){try{var h=this.resultSelector.apply(this,s)}catch(f){return void this.destination.error(f)}this.destination.next(h)},i}(xl),Cc=function(o){function i(s){var h=o.call(this)||this;return h.parent=s,h}return O(i,o),i.prototype._next=function(s){this.parent.notifyNext(s)},i.prototype._error=function(s){this.parent.notifyError(s),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},i}(ma);(function(o){function i(s,h,f){var _=o.call(this)||this;return _.parent=s,_.outerValue=h,_.outerIndex=f,_}O(i,o),i.prototype._next=function(s){this.parent.notifyNext(this.outerValue,s,this.outerIndex,this)},i.prototype._error=function(s){this.parent.notifyError(s),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(ma);var Dc=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.notifyNext=function(s){this.destination.next(s)},i.prototype.notifyError=function(s){this.destination.error(s)},i.prototype.notifyComplete=function(){this.destination.complete()},i}(ma);(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}O(i,o),i.prototype.notifyNext=function(s,h,f,_){this.destination.next(h)},i.prototype.notifyError=function(s){this.destination.error(s)},i.prototype.notifyComplete=function(s){this.destination.complete()}})(ma);var Vu=function(){function o(i,s){s===void 0&&(s=Number.POSITIVE_INFINITY),this.project=i,this.concurrent=s}return o.prototype.call=function(i,s){return s.subscribe(new rB(i,this.project,this.concurrent))},o}(),rB=function(o){function i(s,h,f){return f===void 0&&(f=Number.POSITIVE_INFINITY),(s=o.call(this,s)||this).project=h,s.concurrent=f,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return O(i,o),i.prototype._next=function(s){this.active<this.concurrent?this._tryNext(s):this.buffer.push(s)},i.prototype._tryNext=function(s){var h=this.index++;try{var f=this.project(s,h)}catch(_){return void this.destination.error(_)}this.active++,this._innerSub(f)},i.prototype._innerSub=function(s){var h=new Cc(this),f=this.destination;f.add(h),(s=qc(s,h))!==h&&f.add(s)},i.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},i.prototype.notifyNext=function(s){this.destination.next(s)},i.prototype.notifyComplete=function(){var s=this.buffer;this.active--,0<s.length?this._next(s.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},i}(Dc),yl=C.parseFloat,Mr=-1/0!=1/yl(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF-0`)?function(o){o=Ij(String(o));var i=yl(o);return i===0&&o.charAt(0)=="-"?-0:i}:yl;M({global:!0,forced:parseFloat!=Mr},{parseFloat:Mr});var zl=new Y(pc),$u=function(){function o(i,s){this.predicate=i,this.thisArg=s}return o.prototype.call=function(i,s){return s.subscribe(new sB(i,this.predicate,this.thisArg))},o}(),sB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).predicate=h,s.thisArg=f,s.count=0,s}return O(i,o),i.prototype._next=function(s){try{var h=this.predicate.call(this.thisArg,s,this.count++)}catch(f){return void this.destination.error(f)}h&&this.destination.next(s)},i}(ma),av=function(){function o(){}return o.prototype.call=function(i,s){return s.subscribe(new tB(i))},o}(),tB=function(o){function i(s){return(s=o.call(this,s)||this).hasFirst=!1,s.observables=[],s.subscriptions=[],s}return O(i,o),i.prototype._next=function(s){this.observables.push(s)},i.prototype._complete=function(){var s=this.observables,h=s.length;if(h===0)this.destination.complete();else{for(var f=0;f<h&&!this.hasFirst;f++){var _=Oi(this,s[f],void 0,f);this.subscriptions&&this.subscriptions.push(_),this.add(_)}this.observables=null}},i.prototype.notifyNext=function(s,h,f){if(!this.hasFirst){for(this.hasFirst=!0,s=0;s<this.subscriptions.length;s++)if(s!==f){var _=this.subscriptions[s];_.unsubscribe(),this.remove(_)}this.subscriptions=null}this.destination.next(h)},i}(xl),dv=function(){function o(i){this.resultSelector=i}return o.prototype.call=function(i,s){return s.subscribe(new uB(i,this.resultSelector))},o}(),uB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).resultSelector=h,s.iterators=[],s.active=0,s.resultSelector=typeof h=="function"?h:void 0,s}return O(i,o),i.prototype._next=function(s){var h=this.iterators;Nb(s)?h.push(new vB(s)):typeof s[gd]=="function"?h.push(new wB(s[gd]())):h.push(new xB(this.destination,this,s))},i.prototype._complete=function(){var s=this.iterators,h=s.length;if(this.unsubscribe(),h===0)this.destination.complete();else{this.active=h;for(var f=0;f<h;f++){var _=s[f];_.stillUnsubscribed?this.destination.add(_.subscribe()):this.active--}}},i.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},i.prototype.checkIterators=function(){for(var s=this.iterators,h=s.length,f=this.destination,_=0;_<h;_++){var w=s[_];if(typeof w.hasValue=="function"&&!w.hasValue())return}var j=!1,F=[];for(_=0;_<h;_++){var K=(w=s[_]).next();if(w.hasCompleted()&&(j=!0),K.done)return void f.complete();F.push(K.value)}this.resultSelector?this._tryresultSelector(F):f.next(F),j&&f.complete()},i.prototype._tryresultSelector=function(s){try{var h=this.resultSelector.apply(this,s)}catch(f){return void this.destination.error(f)}this.destination.next(h)},i}(ma),wB=function(){function o(i){this.iterator=i,this.nextResult=i.next()}return o.prototype.hasValue=function(){return!0},o.prototype.next=function(){var i=this.nextResult;return this.nextResult=this.iterator.next(),i},o.prototype.hasCompleted=function(){var i=this.nextResult;return!(!i||!i.done)},o}(),vB=function(){function o(i){this.array=i,this.length=this.index=0,this.length=i.length}return o.prototype[gd]=function(){return this},o.prototype.next=function(i){i=this.index++;var s=this.array;return i<this.length?{value:s[i],done:!1}:{value:null,done:!0}},o.prototype.hasValue=function(){return this.array.length>this.index},o.prototype.hasCompleted=function(){return this.array.length===this.index},o}(),xB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).parent=h,s.observable=f,s.stillUnsubscribed=!0,s.buffer=[],s.isComplete=!1,s}return O(i,o),i.prototype[gd]=function(){return this},i.prototype.next=function(){var s=this.buffer;return s.length===0&&this.isComplete?{value:null,done:!0}:{value:s.shift(),done:!1}},i.prototype.hasValue=function(){return 0<this.buffer.length},i.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},i.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},i.prototype.notifyNext=function(s){this.buffer.push(s),this.parent.checkIterators()},i.prototype.subscribe=function(){return qc(this.observable,new Cc(this))},i}(Dc),yB=Object.freeze({__proto__:null,Observable:Y,ConnectableObservable:Gr,GroupedObservable:sl,observable:Be,Subject:Ua,BehaviorSubject:bB,ReplaySubject:Ee,AsyncSubject:Gf,asap:iB,asapScheduler:Xi,async:id,asyncScheduler:vl,queue:yg,queueScheduler:yg,animationFrame:Jr,animationFrameScheduler:Jr,VirtualTimeScheduler:kB,VirtualAction:Kr,Scheduler:tl,Subscription:Ta,Subscriber:ma,Notification:lf,get NotificationKind(){return ul},pipe:Li,noop:pc,identity:ed,isObservable:function(o){return!!o&&(o instanceof Y||typeof o.lift=="function"&&typeof o.subscribe=="function")},ArgumentOutOfRangeError:wl,EmptyError:Sg,ObjectUnsubscribedError:xd,UnsubscriptionError:Df,TimeoutError:sb,bindCallback:en,bindNodeCallback:fn,combineLatest:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s=i=void 0;return fd(o[o.length-1])&&(s=o.pop()),typeof o[o.length-1]=="function"&&(i=o.pop()),o.length===1&&Nb(o[0])&&(o=o[0]),Ff(o,s).lift(new qB(i))},concat:ln,defer:hd,empty:Ef,forkJoin:mn,from:Ob,fromEvent:jb,fromEventPattern:on,generate:function(o,i,s,h,f){if(arguments.length==1){var _=o.initialState;i=o.condition,s=o.iterate;var w=o.resultSelector||ed;f=o.scheduler}else h===void 0||fd(h)?(_=o,w=ed,f=h):(_=o,w=h);return new Y(function(j){var F=_;if(f)return f.schedule(Wu,0,{subscriber:j,iterate:s,condition:i,resultSelector:w,state:F});for(;;){if(i){var K=void 0;try{K=i(F)}catch(_e){j.error(_e);break}if(!K){j.complete();break}}K=void 0;try{K=w(F)}catch(_e){j.error(_e);break}if(j.next(K),j.closed)break;try{F=s(F)}catch(_e){j.error(_e);break}}})},iif:function(o,i,s){return i===void 0&&(i=yb),s===void 0&&(s=yb),hd(function(){return o()?i:s})},interval:pn,merge:cc,never:function(){return zl},of:eb,onErrorResumeNext:Qi,pairs:function(o,i){return new Y(i?function(s){var h=Object.keys(o),f=new Ta;return f.add(i.schedule(Yu,0,{keys:h,index:0,subscriber:s,subscription:f,obj:o})),f}:function(s){for(var h=Object.keys(o),f=0;f<h.length&&!s.closed;f++){var _=h[f];o.hasOwnProperty(_)&&s.next([_,o[_]])}s.complete()})},partition:function(o,i,s){return[zb(i,s)(new Y(Hf(o))),zb(Zu(i,s))(new Y(Hf(o)))]},race:Da,range:function(o,i,s){return o===void 0&&(o=0),new Y(function(h){i===void 0&&(i=o,o=0);var f=0,_=o;if(s)return s.schedule(bv,0,{index:f,count:i,start:o,subscriber:h});for(;;){if(f++>=i){h.complete();break}if(h.next(_++),h.closed)break}})},throwError:Z,timer:Kc,using:function(o,i){return new Y(function(s){try{var h=o()}catch(w){return void s.error(w)}try{var f=i(h)}catch(w){return void s.error(w)}var _=(f?Ob(f):yb).subscribe(s);return function(){_.unsubscribe(),h&&h.unsubscribe()}})},zip:Ri,scheduled:jn,EMPTY:yb,NEVER:zl,config:Mb}),ev=function(){function o(i){this.selector=i}return o.prototype.call=function(i,s){return s.subscribe(new zB(i,this.selector,this.caught))},o}(),zB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).selector=h,s.caught=f,s}return O(i,o),i.prototype.error=function(s){if(!this.isStopped){var h=void 0;try{h=this.selector(s,this.caught)}catch(f){return void o.prototype.error.call(this,f)}this._unsubscribeAndRecycle(),s=new Cc(this),this.add(s),(h=qc(h,s))!==s&&this.add(h)}},i}(Dc),fv=function(){function o(i){this.defaultValue=i}return o.prototype.call=function(i,s){return s.subscribe(new AB(i,this.defaultValue))},o}(),AB=function(o){function i(s,h){return(s=o.call(this,s)||this).defaultValue=h,s.isEmpty=!0,s}return O(i,o),i.prototype._next=function(s){this.isEmpty=!1,this.destination.next(s)},i.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},i}(ma),gv=function(){function o(i,s){this.delay=i,this.scheduler=s}return o.prototype.call=function(i,s){return s.subscribe(new BB(i,this.delay,this.scheduler))},o}(),BB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).delay=h,s.scheduler=f,s.queue=[],s.active=!1,s.errored=!1,s}return O(i,o),i.dispatch=function(s){for(var h=s.source,f=h.queue,_=s.scheduler,w=s.destination;0<f.length&&0>=f[0].time-_.now();)f.shift().notification.observe(w);0<f.length?(h=Math.max(0,f[0].time-_.now()),this.schedule(s,h)):(this.unsubscribe(),h.active=!1)},i.prototype._schedule=function(s){this.active=!0,this.destination.add(s.schedule(i.dispatch,this.delay,{source:this,destination:this.destination,scheduler:s}))},i.prototype.scheduleNotification=function(s){if(this.errored!==!0){var h=this.scheduler;s=new CB(h.now()+this.delay,s),this.queue.push(s),this.active===!1&&this._schedule(h)}},i.prototype._next=function(s){this.scheduleNotification(lf.createNext(s))},i.prototype._error=function(s){this.errored=!0,this.queue=[],this.destination.error(s),this.unsubscribe()},i.prototype._complete=function(){this.scheduleNotification(lf.createComplete()),this.unsubscribe()},i}(ma),CB=function(o,i){this.time=o,this.notification=i},hv=function(){function o(i,s){this.keySelector=i,this.flushes=s}return o.prototype.call=function(i,s){return s.subscribe(new DB(i,this.keySelector,this.flushes))},o}(),DB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).keySelector=h,s.values=new Set,f&&s.add(qc(f,new Cc(s))),s}return O(i,o),i.prototype.notifyNext=function(){this.values.clear()},i.prototype.notifyError=function(s){this._error(s)},i.prototype._next=function(s){this.keySelector?this._useKeySelector(s):this._finalizeNext(s,s)},i.prototype._useKeySelector=function(s){var h=this.destination;try{var f=this.keySelector(s)}catch(_){return void h.error(_)}this._finalizeNext(f,s)},i.prototype._finalizeNext=function(s,h){var f=this.values;f.has(s)||(f.add(s),this.destination.next(h))},i}(Dc),jv=function(){function o(i){this.errorFactory=i}return o.prototype.call=function(i,s){return s.subscribe(new EB(i,this.errorFactory))},o}(),EB=function(o){function i(s,h){return(s=o.call(this,s)||this).errorFactory=h,s.hasValue=!1,s}return O(i,o),i.prototype._next=function(s){this.hasValue=!0,this.destination.next(s)},i.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var s=void 0;try{s=this.errorFactory()}catch(h){s=h}this.destination.error(s)},i}(ma),kv=function(){function o(i){if(this.total=i,0>this.total)throw new wl}return o.prototype.call=function(i,s){return s.subscribe(new FB(i,this.total))},o}(),FB=function(o){function i(s,h){return(s=o.call(this,s)||this).total=h,s.count=0,s}return O(i,o),i.prototype._next=function(s){var h=this.total,f=++this.count;f<=h&&(this.destination.next(s),f===h&&(this.destination.complete(),this.unsubscribe()))},i}(ma),lv=function(){function o(i){this.project=i}return o.prototype.call=function(i,s){return s.subscribe(new GB(i,this.project))},o}(),GB=function(o){function i(s,h){return(s=o.call(this,s)||this).project=h,s.hasSubscription=!1,s.hasCompleted=!1,s.index=0,s}return O(i,o),i.prototype._next=function(s){this.hasSubscription||this.tryNext(s)},i.prototype.tryNext=function(s){var h=this.index++;try{var f=this.project(s,h)}catch(_){return void this.destination.error(_)}this.hasSubscription=!0,this._innerSub(f)},i.prototype._innerSub=function(s){var h=new Cc(this),f=this.destination;f.add(h),(s=qc(s,h))!==h&&f.add(s)},i.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},i.prototype.notifyNext=function(s){this.destination.next(s)},i.prototype.notifyError=function(s){this.destination.error(s)},i.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},i}(Dc),mv=function(){function o(i){this.callback=i}return o.prototype.call=function(i,s){return s.subscribe(new HB(i,this.callback))},o}(),HB=function(o){function i(s,h){return(s=o.call(this,s)||this).add(new Ta(h)),s}return O(i,o),i}(ma),ov=function(){function o(){}return o.prototype.call=function(i,s){return s.subscribe(new IB(i))},o}(),IB=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype._next=function(s){},i}(ma),pv=function(){function o(i){if(this.total=i,0>this.total)throw new wl}return o.prototype.call=function(i,s){return s.subscribe(new JB(i,this.total))},o}(),JB=function(o){function i(s,h){return(s=o.call(this,s)||this).total=h,s.ring=[],s.count=0,s}return O(i,o),i.prototype._next=function(s){var h=this.ring,f=this.total,_=this.count++;h.length<f?h.push(s):h[_%f]=s},i.prototype._complete=function(){var s=this.destination,h=this.count;if(0<h)for(var f=this.count>=this.total?this.total:this.count,_=this.ring,w=0;w<f;w++){var j=h++%f;s.next(_[j])}s.complete()},i}(ma),qv=function(){function o(i){this.value=i}return o.prototype.call=function(i,s){return s.subscribe(new KB(i,this.value))},o}(),KB=function(o){function i(s,h){return(s=o.call(this,s)||this).value=h,s}return O(i,o),i.prototype._next=function(s){this.destination.next(this.value)},i}(ma),rv=function(){function o(i,s,h){h===void 0&&(h=!1),this.accumulator=i,this.seed=s,this.hasSeed=h}return o.prototype.call=function(i,s){return s.subscribe(new LB(i,this.accumulator,this.seed,this.hasSeed))},o}(),LB=function(o){function i(s,h,f,_){return(s=o.call(this,s)||this).accumulator=h,s._seed=f,s.hasSeed=_,s.index=0,s}return O(i,o),Object.defineProperty(i.prototype,"seed",{get:function(){return this._seed},set:function(s){this.hasSeed=!0,this._seed=s},enumerable:!0,configurable:!0}),i.prototype._next=function(s){if(this.hasSeed)return this._tryNext(s);this.seed=s,this.destination.next(s)},i.prototype._tryNext=function(s){var h=this.index++;try{var f=this.accumulator(this.seed,s,h)}catch(_){this.destination.error(_)}this.seed=f,this.destination.next(f)},i}(ma),tv=function(){function o(i,s){this.subjectFactory=i,this.selector=s}return o.prototype.call=function(i,s){var h=this.selector,f=this.subjectFactory();return(i=h(f).subscribe(i)).add(s.subscribe(f)),i},o}(),vv=function(){function o(i,s){this.notifier=i,this.source=s}return o.prototype.call=function(i,s){return s.subscribe(new MB(i,this.notifier,this.source))},o}(),MB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).notifier=h,s.source=f,s}return O(i,o),i.prototype.error=function(s){if(!this.isStopped){var h=this.errors,f=this.retries,_=this.retriesSubscription;if(f)this.retriesSubscription=this.errors=void 0;else{h=new Ua;try{f=(0,this.notifier)(h)}catch(w){return o.prototype.error.call(this,w)}_=qc(f,new Cc(this))}this._unsubscribeAndRecycle(),this.errors=h,this.retries=f,this.retriesSubscription=_,h.next(s)}},i.prototype._unsubscribe=function(){var s=this.errors,h=this.retriesSubscription;s&&(s.unsubscribe(),this.errors=void 0),h&&(h.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},i.prototype.notifyNext=function(){var s=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=s,this.source.subscribe(this)},i}(Dc),yv=function(){function o(i){this.project=i}return o.prototype.call=function(i,s){return s.subscribe(new NB(i,this.project))},o}(),NB=function(o){function i(s,h){return(s=o.call(this,s)||this).project=h,s.index=0,s}return O(i,o),i.prototype._next=function(s){var h=this.index++;try{var f=this.project(s,h)}catch(_){return void this.destination.error(_)}this._innerSub(f)},i.prototype._innerSub=function(s){var h=this.innerSubscription;h&&h.unsubscribe(),h=new Cc(this);var f=this.destination;f.add(h),this.innerSubscription=qc(s,h),this.innerSubscription!==h&&f.add(this.innerSubscription)},i.prototype._complete=function(){var s=this.innerSubscription;s&&!s.closed||o.prototype._complete.call(this),this.unsubscribe()},i.prototype._unsubscribe=function(){this.innerSubscription=void 0},i.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&o.prototype._complete.call(this)},i.prototype.notifyNext=function(s){this.destination.next(s)},i}(Dc),zv=function(){function o(i){this.notifier=i}return o.prototype.call=function(i,s){i=new OB(i);var h=qc(this.notifier,new Cc(i));return h&&!i.seenValue?(i.add(h),s.subscribe(i)):i},o}(),OB=function(o){function i(s){return(s=o.call(this,s)||this).seenValue=!1,s}return O(i,o),i.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},i.prototype.notifyComplete=function(){},i}(Dc),Bv=function(){function o(i,s){this.predicate=i,this.inclusive=s}return o.prototype.call=function(i,s){return s.subscribe(new PB(i,this.predicate,this.inclusive))},o}(),PB=function(o){function i(s,h,f){return(s=o.call(this,s)||this).predicate=h,s.inclusive=f,s.index=0,s}return O(i,o),i.prototype._next=function(s){var h=this.destination;try{var f=this.predicate(s,this.index++)}catch(_){return void h.error(_)}this.nextOrComplete(s,f)},i.prototype.nextOrComplete=function(s,h){var f=this.destination;h?f.next(s):(this.inclusive&&f.next(s),f.complete())},i}(ma),Cv=function(){function o(i,s,h){this.nextOrObserver=i,this.error=s,this.complete=h}return o.prototype.call=function(i,s){return s.subscribe(new QB(i,this.nextOrObserver,this.error,this.complete))},o}(),QB=function(o){function i(s,h,f,_){return(s=o.call(this,s)||this)._tapNext=pc,s._tapError=pc,s._tapComplete=pc,s._tapError=f||pc,s._tapComplete=_||pc,ze(h)?(s._context=s,s._tapNext=h):h&&(s._context=h,s._tapNext=h.next||pc,s._tapError=h.error||pc,s._tapComplete=h.complete||pc),s}return O(i,o),i.prototype._next=function(s){try{this._tapNext.call(this._context,s)}catch(h){return void this.destination.error(h)}this.destination.next(s)},i.prototype._error=function(s){try{this._tapError.call(this._context,s)}catch(h){return void this.destination.error(h)}this.destination.error(s)},i.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(s){return void this.destination.error(s)}return this.destination.complete()},i}(ma),Ev={leading:!0,trailing:!1};(function(o){function i(s,h,f,_){var w=o.call(this,s)||this;return w.destination=s,w.durationSelector=h,w._leading=f,w._trailing=_,w._hasValue=!1,w}O(i,o),i.prototype._next=function(s){this._hasValue=!0,this._sendValue=s,this._throttled||(this._leading?this.send():this.throttle(s))},i.prototype.send=function(){var s=this._sendValue;this._hasValue&&(this.destination.next(s),this.throttle(s)),this._hasValue=!1,this._sendValue=void 0},i.prototype.throttle=function(s){(s=this.tryDurationSelector(s))&&this.add(this._throttled=qc(s,new Cc(this)))},i.prototype.tryDurationSelector=function(s){try{return this.durationSelector(s)}catch(h){return this.destination.error(h),null}},i.prototype.throttlingDone=function(){var s=this._throttled,h=this._trailing;s&&s.unsubscribe(),this._throttled=void 0,h&&this.send()},i.prototype.notifyNext=function(){this.throttlingDone()},i.prototype.notifyComplete=function(){this.throttlingDone()}})(Dc);for(var Fv=function(){function o(i,s,h,f){this.duration=i,this.scheduler=s,this.leading=h,this.trailing=f}return o.prototype.call=function(i,s){return s.subscribe(new RB(i,this.duration,this.scheduler,this.leading,this.trailing))},o}(),RB=function(o){function i(s,h,f,_,w){return(s=o.call(this,s)||this).duration=h,s.scheduler=f,s.leading=_,s.trailing=w,s._hasTrailingValue=!1,s._trailingValue=null,s}return O(i,o),i.prototype._next=function(s){this.throttled?this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Gv,this.duration,{subscriber:this})),this.leading?this.destination.next(s):this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0))},i.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},i.prototype.clearThrottle=function(){var s=this.throttled;s&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),s.unsubscribe(),this.remove(s),this.throttled=null)},i}(ma),Iv=function(){function o(i,s,h,f){this.waitFor=i,this.absoluteTimeout=s,this.withObservable=h,this.scheduler=f}return o.prototype.call=function(i,s){return s.subscribe(new SB(i,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},o}(),SB=function(o){function i(s,h,f,_,w){return(s=o.call(this,s)||this).absoluteTimeout=h,s.waitFor=f,s.withObservable=_,s.scheduler=w,s.scheduleTimeout(),s}return O(i,o),i.dispatchTimeout=function(s){var h=s.withObservable;s._unsubscribeAndRecycle(),s.add(qc(h,new Cc(s)))},i.prototype.scheduleTimeout=function(){var s=this.action;s?this.action=s.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(i.dispatchTimeout,this.waitFor,this))},i.prototype._next=function(s){this.absoluteTimeout||this.scheduleTimeout(),o.prototype._next.call(this,s)},i.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},i}(Dc),Kv=function(){function o(i,s){this.observables=i,this.project=s}return o.prototype.call=function(i,s){return s.subscribe(new TB(i,this.observables,this.project))},o}(),TB=function(o){function i(s,h,f){(s=o.call(this,s)||this).observables=h,s.project=f,s.toRespond=[],f=h.length,s.values=Array(f);for(var _=0;_<f;_++)s.toRespond.push(_);for(_=0;_<f;_++)s.add(Oi(s,h[_],void 0,_));return s}return O(i,o),i.prototype.notifyNext=function(s,h,f){this.values[f]=h,0<(s=this.toRespond).length&&(f=s.indexOf(f))!==-1&&s.splice(f,1)},i.prototype.notifyComplete=function(){},i.prototype._next=function(s){this.toRespond.length===0&&(s=[s].concat(this.values),this.project?this._tryProject(s):this.destination.next(s))},i.prototype._tryProject=function(s){try{var h=this.project.apply(this,s)}catch(f){return void this.destination.error(f)}this.destination.next(h)},i}(xl),Nr=cb(function(o){var i=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(i){var s=new Uint8Array(16);o.exports=function(){return i(s),s}}else{var h=Array(16);o.exports=function(){for(var f,_=0;16>_;_++)(3&_)==0&&(f=4294967296*Math.random()),h[_]=f>>>((3&_)<<3)&255;return h}}}),db=[],ei=0;256>ei;++ei)db[ei]=(ei+256).toString(16).substr(1);var Or=function(o,i){return i=i||0,[db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]]].join("")},de=function(o,i,s){if(s=i&&s||0,typeof o=="string"&&(i=o==="binary"?Array(16):null,o=null),(o=(o=o||{}).random||(o.rng||Nr)())[6]=15&o[6]|64,o[8]=63&o[8]|128,i)for(var h=0;16>h;++h)i[s+h]=o[h];return i||Or(o)},zg=de(),Ti=!1,xn=new AbortController,Vc,yd,Al,Bl,zd,ee,mc,mf,Wb,Cl,Wc,fe,Xc,Yc,Zc,nf,$c,ad;(function(o){o[o.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",o[o.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",o[o.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",o[o.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",o[o.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",o[o.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",o[o.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Vc||(Vc={})),function(o){o[o.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",o[o.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",o[o.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",o[o.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",o[o.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",o[o.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(yd||(yd={})),function(o){o[o.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Al||(Al={})),function(o){o[o.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Bl||(Bl={})),function(o){o[o.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",o[o.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",o[o.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",o[o.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",o[o.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",o[o.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(zd||(zd={})),function(o){o[o.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",o[o.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",o[o.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",o[o.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",o[o.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(ee||(ee={})),function(o){o[o.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",o[o.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",o[o.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",o[o.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",o[o.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",o[o.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",o[o.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",o[o.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",o[o.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",o[o.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",o[o.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(mc||(mc={})),function(o){o[o.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",o[o.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",o[o.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",o[o.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(mf||(mf={})),function(o){o[o.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",o[o.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",o[o.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",o[o.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",o[o.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",o[o.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",o[o.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",o[o.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",o[o.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",o[o.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",o[o.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Wb||(Wb={})),function(o){o[o.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Cl||(Cl={})),function(o){o[o.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",o[o.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",o[o.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",o[o.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",o[o.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",o[o.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",o[o.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Wc||(Wc={})),function(o){o[o.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(fe||(fe={})),function(o){o[o.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",o[o.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",o[o.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",o[o.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",o[o.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",o[o.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",o[o.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",o[o.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Xc||(Xc={})),function(o){o[o.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Yc||(Yc={})),function(o){o[o.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",o[o.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",o[o.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",o[o.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",o[o.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",o[o.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",o[o.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Zc||(Zc={})),function(o){o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(nf||(nf={})),function(o){o[o.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",o[o.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",o[o.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",o[o.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",o[o.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",o[o.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",o[o.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}($c||($c={})),function(o){o[o.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",o[o.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",o[o.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",o[o.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",o[o.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",o[o.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",o[o.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(ad||(ad={}));var Xb=Vc.ATTRIBUTE_OPERATION_ERR_FAILURE,Oa=Vc.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,Ge=Vc.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Vc.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var Pr=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Yb=Vc.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Zb=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,Ag=yd.CHANNEL_MESSAGE_ERR_FAILURE,Dl=yd.CHANNEL_MESSAGE_ERR_TIMEOUT,Qr=yd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,fi=yd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,UB=yd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,El=yd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,VB=Al.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Rr=Bl.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var Sr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var Tr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,WB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var XB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,YB=zd.GET_MEMBERS_ERR_FAILURE,ZB=zd.GET_MEMBERS_ERR_REJECTED;zd.GET_MEMBERS_ERR_TIMEOUT,zd.GET_MEMBERS_ERR_TOO_OFTEN;var $B=zd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,aC=zd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,Ec=ee.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,bC=ee.INVITATION_API_CALL_ERR_NOT_STARTED,gi=ee.INVITATION_API_CALL_ERR_ALREADY_END,Ur=ee.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,cC=ee.INVITATION_API_CALL_ERR_ALREADY_SENT,Vr=mc.JOIN_CHANNEL_ERR_FAILURE;mc.JOIN_CHANNEL_ERR_REJECTED;var dC=mc.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Wr=mc.JOIN_CHANNEL_TIMEOUT,Xr=mc.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Yr=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED;mc.JOIN_CHANNEL_ERR_TOO_OFTEN;var Zr=mc.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,$r=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,as=mf.LEAVE_CHANNEL_ERR_FAILURE,bs=mf.LEAVE_CHANNEL_ERR_REJECTED,eC=mf.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,fC=mf.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,cs=Wb.LOGIN_ERR_UNKNOWN,Bg=Wb.LOGIN_ERR_REJECTED,hi=Wb.LOGIN_ERR_INVALID_ARGUMENT,ds=Wb.LOGIN_ERR_INVALID_APP_ID,es=Wb.LOGIN_ERR_INVALID_TOKEN,ii=Wb.LOGIN_ERR_TOKEN_EXPIRED;Wb.LOGIN_ERR_NOT_AUTHORIZED;var gC=Wb.LOGIN_ERR_ALREADY_LOGIN,hC=Wb.LOGIN_ERR_TIMEOUT,iC=Wb.LOGIN_ERR_TOO_OFTEN,fs=Cl.LOGOUT_ERR_USER_NOT_LOGGED_IN,gs=Wc.PEER_MESSAGE_ERR_FAILURE,Fl=Wc.PEER_MESSAGE_ERR_TIMEOUT,hs=Wc.PEER_MESSAGE_ERR_TOO_OFTEN,Gl=Wc.PEER_MESSAGE_ERR_INVALID_USERID,Ie=Wc.PEER_MESSAGE_ERR_INVALID_MESSAGE,Hl=Wc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,jC=Wc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,is=fe.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;fe.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var kC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;fe.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var lC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,mC=Xc.RENEW_TOKEN_ERR_FAILURE,nC=Xc.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Xc.RENEW_TOKEN_ERR_REJECTED,Xc.RENEW_TOKEN_ERR_TOO_OFTEN;var oC=Xc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,pC=Xc.RENEW_TOKEN_ERR_INVALID_TOKEN,qC=Xc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,js=Zc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,Cg=Zc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;Zc.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var rC=Zc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;Zc.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var ks=Zc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,Il=Zc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var Dg=$c.UPLOAD_MEDIA_ERR_FAILURE,Of=$c.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,ji=$c.UPLOAD_MEDIA_ERR_TIMEOUT,sC=$c.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,tC=$c.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ls=$c.UPLOAD_MEDIA_ERR_INTERRUPTED,uC=$c.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,Eg=ad.DOWNLOAD_MEDIA_ERR_FAILURE,Jl=ad.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,vC=ad.DOWNLOAD_MEDIA_ERR_TIMEOUT,wC=ad.DOWNLOAD_MEDIA_ERR_NOT_EXIST,xC=ad.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ms=ad.DOWNLOAD_MEDIA_ERR_INTERRUPTED,yC=ad.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,zC=function(o,i){var s;return nl(o,function(h,f,_){return!(s=i(h,f,_))}),!!s},ki=function(o,i,s){if(!ob(s))return!1;var h=V(i);return!!(h=="number"?Nd(s)&&cl(i,s.length):h=="string"&&i in s)&&sg(s[i],o)},Kl=function(o,i,s){var h=Za(o)?xr:zC;return s&&ki(o,i,s)&&(i=void 0),h(o,jf(i))},AC=function(o,i){var s=-1,h=Nd(o)?Array(o.length):[];return nl(o,function(f,_,w){h[++s]=i(f,_,w)}),h},BC=function(o,i){var s=o.length;for(o.sort(i);s--;)o[s]=o[s].value;return o},CC=function(o,i,s){i=i.length?ve(i,function(f){return Za(f)?function(_){return ai(_,f.length===1?f[0]:f)}:f}):[bi];var h=-1;return i=ve(i,Yh(jf)),o=AC(o,function(f,_,w){return{criteria:ve(i,function(j){return j(f)}),index:++h,value:f}}),BC(o,function(f,_){t:{for(var w=-1,j=f.criteria,F=_.criteria,K=j.length,_e=s.length;++w<K;){e:{var _o=j[w],ca=F[w];if(_o!==ca){var _c=_o!==void 0,ch=_o===null,Nf=_o==_o,bh=we(_o),_g=ca!==void 0,_v=ca===null,h0=ca==ca,A0=we(ca);if(!_v&&!A0&&!bh&&_o>ca||bh&&_g&&h0&&!_v&&!A0||ch&&_g&&h0||!_c&&h0||!Nf){_o=1;break e}if(!ch&&!bh&&!A0&&_o<ca||A0&&_c&&Nf&&!ch&&!bh||_v&&_c&&Nf||!_g&&Nf||!h0){_o=-1;break e}}_o=0}if(_o){f=w>=_e?_o:_o*(s[w]=="desc"?-1:1);break t}}f=f.index-_.index}return f})},ns=function(o,i){return vr(ur(o,i,bi),o+"")},os=ns(function(o,i){if(o==null)return[];var s=i.length;return 1<s&&ki(o,i[0],i[1])?i=[]:2<s&&ki(i[0],i[1],i[2])&&(i=[i[0]]),CC(o,Ei(i,1),[])}),ps=function(o){if(o.__esModule)return o;var i=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(o).forEach(function(s){var h=Object.getOwnPropertyDescriptor(o,s);Object.defineProperty(i,s,h.get?h:{enumerable:!0,get:function(){return o[s]}})}),i}(yB),qs=cb(function(o,i){Object.defineProperty(i,"__esModule",{value:!0});var s=[],h=function(f,_){return new WebSocket(f,_)};i.normalClosureMessage="Normal closure",i.default=function(f,_){var w=(_=_===void 0?{protocols:s,makeWebSocket:h}:_).protocols,j=w===void 0?s:w,F=(_=_.makeWebSocket)===void 0?h:_;return new ps.Observable(function(K){var _e,_o=new ps.Subject,ca=F(f,j),_c=!1,ch=!1,Nf=function(bh){if(_e)throw _c=!0,bh=Error("Web socket message factory function called more than once"),K.error(bh),bh;return _e=bh.subscribe(function(_g){ca.send(_g)}),_o};return ca.onopen=function(){ch?(_c=!0,ca.close()):K.next(Nf)},ca.onmessage=function(bh){_o.next(bh.data)},ca.onerror=function(bh){_c=!0,K.error(Error(bh.message))},ca.onclose=function(bh){_c||(_c=!0,ch?(K.complete(),_o.complete()):K.error(Error(bh.code===1e3?i.normalClosureMessage:bh.reason)))},function(){ch=!0,_e&&_e.unsubscribe(),_c||(_c=!0,ca.close())}})}});(function(o){o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")&&o.default})(qs);var Vi=function(o,i,s){(s===void 0||sg(o[i],s))&&(s!==void 0||i in o)||ug(o,i,s)},Ui=function(o,i){if((i!=="constructor"||typeof o[i]!="function")&&i!="__proto__")return o[i]},DC=function(o){return ns(function(i,s){var h=-1,f=s.length,_=1<f?s[f-1]:void 0,w=2<f?s[2]:void 0;for(_=3<o.length&&typeof _=="function"?(f--,_):void 0,w&&ki(s[0],s[1],w)&&(_=3>f?void 0:_,f=1),i=Object(i);++h<f;)(w=s[h])&&o(i,w,h,_);return i})}(function(o,i,s,h){yn(o,i,s,h)}),EC=Math.floor,FC=Math.random,rs=function(o,i){return o+EC(FC()*(i-o+1))},ss=function(o){var i=o.length;return i?o[rs(0,i-1)]:void 0},GC=function(o,i){return ve(i,function(s){return o[s]})},tj=function(o){return o==null?[]:GC(o,Jd(o))},HC=function(o){return ss(tj(o))},fo=function(o){return(Za(o)?ss:HC)(o)},Cn=[],Dn=function(o,i){return new WebSocket(o,i)},IC=Math.floor;M({target:"Number",stat:!0},{isInteger:function(o){return!ha(o)&&isFinite(o)&&IC(o)===o}}),Up("from",ok,nk);var JC=function(o,i){for(var s=Array(arguments.length-1),h=0,f=2,_=!0;f<arguments.length;)s[h++]=arguments[f++];return new Promise(function(w,j){s[h]=function(F){if(_)if(_=!1,F)j(F);else{for(var K=Array(arguments.length-1),_e=0;_e<K.length;)K[_e++]=arguments[_e];w.apply(null,K)}};try{o.apply(i||null,s)}catch(F){_&&(_=!1,j(F))}})},KC=cb(function(o,i){i.length=function(f){var _=f.length;if(!_)return 0;for(var w=0;1<--_%4&&f.charAt(_)==="=";)++w;return Math.ceil(3*f.length)/4-w};var s=Array(64),h=Array(123);for(o=0;64>o;)h[s[o]=26>o?o+65:52>o?o+71:62>o?o-4:o-59|43]=o++;i.encode=function(f,_,w){for(var j,F=null,K=[],_e=0,_o=0;_<w;){var ca=f[_++];switch(_o){case 0:K[_e++]=s[ca>>2],j=(3&ca)<<4,_o=1;break;case 1:K[_e++]=s[j|ca>>4],j=(15&ca)<<2,_o=2;break;case 2:K[_e++]=s[j|ca>>6],K[_e++]=s[63&ca],_o=0}8191<_e&&((F||(F=[])).push(String.fromCharCode.apply(String,K)),_e=0)}return _o&&(K[_e++]=s[j],K[_e++]=61,_o===1&&(K[_e++]=61)),F?(_e&&F.push(String.fromCharCode.apply(String,K.slice(0,_e))),F.join("")):String.fromCharCode.apply(String,K.slice(0,_e))},i.decode=function(f,_,w){for(var j,F=w,K=0,_e=0;_e<f.length;){var _o=f.charCodeAt(_e++);if(_o===61&&1<K)break;if((_o=h[_o])===void 0)throw Error("invalid encoding");switch(K){case 0:j=_o,K=1;break;case 1:_[w++]=j<<2|(48&_o)>>4,j=_o,K=2;break;case 2:_[w++]=(15&j)<<4|(60&_o)>>2,j=_o,K=3;break;case 3:_[w++]=(3&j)<<6|_o,K=0}}if(K===1)throw Error("invalid encoding");return w-F},i.test=function(f){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(f)}});Vg.prototype.on=function(o,i,s){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:i,ctx:s||this}),this},Vg.prototype.off=function(o,i){if(o===void 0)this._listeners={};else if(i===void 0)this._listeners[o]=[];else{o=this._listeners[o];for(var s=0;s<o.length;)o[s].fn===i?o.splice(s,1):++s}return this},Vg.prototype.emit=function(o){var i=this._listeners[o];if(i){for(var s=[],h=1;h<arguments.length;)s.push(arguments[h++]);for(h=0;h<i.length;)i[h].fn.apply(i[h++].ctx,s)}return this};var LC=En(En),MC=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(o){}return null},NC=cb(function(o,i){i.length=function(s){for(var h,f=0,_=0;_<s.length;++_)128>(h=s.charCodeAt(_))?f+=1:2048>h?f+=2:(64512&h)==55296&&(64512&s.charCodeAt(_+1))==56320?(++_,f+=4):f+=3;return f},i.read=function(s,h,f){if(1>f-h)return"";for(var _,w=null,j=[],F=0;h<f;)128>(_=s[h++])?j[F++]=_:191<_&&224>_?j[F++]=(31&_)<<6|63&s[h++]:239<_&&365>_?(_=((7&_)<<18|(63&s[h++])<<12|(63&s[h++])<<6|63&s[h++])-65536,j[F++]=55296+(_>>10),j[F++]=56320+(1023&_)):j[F++]=(15&_)<<12|(63&s[h++])<<6|63&s[h++],8191<F&&((w||(w=[])).push(String.fromCharCode.apply(String,j)),F=0);return w?(F&&w.push(String.fromCharCode.apply(String,j.slice(0,F))),w.join("")):String.fromCharCode.apply(String,j.slice(0,F))},i.write=function(s,h,f){for(var _,w,j=f,F=0;F<s.length;++F)128>(_=s.charCodeAt(F))?h[f++]=_:(2048>_?h[f++]=_>>6|192:((64512&_)==55296&&(64512&(w=s.charCodeAt(F+1)))==56320?(_=65536+((1023&_)<<10)+(1023&w),++F,h[f++]=_>>18|240,h[f++]=_>>12&63|128):h[f++]=_>>12|224,h[f++]=_>>6&63|128),h[f++]=63&_|128);return f-j}}),OC=function(o,i,s){var h=s||8192,f=h>>>1,_=null,w=h;return function(j){return 1>j||j>f?o(j):(w+j>h&&(_=o(h),w=0),j=i.call(_,w,w+=j),7&w&&(w=1+(7|w)),j)}},ge=$a.zero=new $a(0,0);ge.toNumber=function(){return 0},ge.zzEncode=ge.zzDecode=function(){return this},ge.length=function(){return 1};var PC=$a.zeroHash="\0\0\0\0\0\0\0\0";$a.fromNumber=function(o){if(o===0)return ge;var i=0>o;i&&(o=-o);var s=o>>>0;return o=(o-s)/4294967296>>>0,i&&(o=~o>>>0,s=~s>>>0,4294967295<++s&&(s=0,4294967295<++o&&(o=0))),new $a(s,o)},$a.from=function(o){if(typeof o=="number")return $a.fromNumber(o);if(W.isString(o)){if(!W.Long)return $a.fromNumber(parseInt(o,10));o=W.Long.fromString(o)}return o.low||o.high?new $a(o.low>>>0,o.high>>>0):ge},$a.prototype.toNumber=function(o){if(!o&&this.hi>>>31){o=1+~this.lo>>>0;var i=~this.hi>>>0;return o||(i=i+1>>>0),-(o+4294967296*i)}return this.lo+4294967296*this.hi},$a.prototype.toLong=function(o){return W.Long?new W.Long(0|this.lo,0|this.hi,!!o):{low:0|this.lo,high:0|this.hi,unsigned:!!o}};var Ad=String.prototype.charCodeAt;$a.fromHash=function(o){return o===PC?ge:new $a((Ad.call(o,0)|Ad.call(o,1)<<8|Ad.call(o,2)<<16|Ad.call(o,3)<<24)>>>0,(Ad.call(o,4)|Ad.call(o,5)<<8|Ad.call(o,6)<<16|Ad.call(o,7)<<24)>>>0)},$a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},$a.prototype.zzEncode=function(){var o=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^o)>>>0,this.lo=(this.lo<<1^o)>>>0,this},$a.prototype.zzDecode=function(){var o=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^o)>>>0,this.hi=(this.hi>>>1^o)>>>0,this},$a.prototype.length=function(){var o=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s===0?i===0?16384>o?128>o?1:2:2097152>o?3:4:16384>i?128>i?5:6:2097152>i?7:8:128>s?9:10};var W=cb(function(o,i){function s(f,_,w){for(var j=Object.keys(_),F=0;F<j.length;++F)f[j[F]]!==void 0&&w||(f[j[F]]=_[j[F]]);return f}function h(f){function _(w,j){if(!(this instanceof _))return new _(w,j);Object.defineProperty(this,"message",{get:function(){return w}}),Error.captureStackTrace?Error.captureStackTrace(this,_):Object.defineProperty(this,"stack",{value:Error().stack||""}),j&&s(this,j)}return(_.prototype=Object.create(Error.prototype)).constructor=_,Object.defineProperty(_.prototype,"name",{get:function(){return f}}),_.prototype.toString=function(){return this.name+": "+this.message},_}i.asPromise=JC,i.base64=KC,i.EventEmitter=Vg,i.float=LC,i.inquire=MC,i.utf8=NC,i.pool=OC,i.LongBits=$a,i.isNode=!!(Ka!==void 0&&Ka&&Ka.process&&Ka.process.versions&&Ka.process.versions.node),i.global=i.isNode&&Ka||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Ka,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f},i.isString=function(f){return typeof f=="string"||f instanceof String},i.isObject=function(f){return f&&V(f)==="object"},i.isset=i.isSet=function(f,_){var w=f[_];return!(w==null||!f.hasOwnProperty(_))&&(V(w)!=="object"||0<(Array.isArray(w)?w.length:Object.keys(w).length))},i.Buffer=function(){try{var f=i.inquire("buffer").Buffer;return f.prototype.utf8Write?f:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(f){return typeof f=="number"?i.Buffer?i._Buffer_allocUnsafe(f):new i.Array(f):i.Buffer?i._Buffer_from(f):typeof Uint8Array=="undefined"?f:new Uint8Array(f)},i.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(f){return f?i.LongBits.from(f).toHash():i.LongBits.zeroHash},i.longFromHash=function(f,_){return f=i.LongBits.fromHash(f),i.Long?i.Long.fromBits(f.lo,f.hi,_):f.toNumber(!!_)},i.merge=s,i.lcFirst=function(f){return f.charAt(0).toLowerCase()+f.substring(1)},i.newError=h,i.ProtocolError=h("ProtocolError"),i.oneOfGetter=function(f){for(var _={},w=0;w<f.length;++w)_[f[w]]=1;return function(){for(var j=Object.keys(this),F=j.length-1;-1<F;--F)if(_[j[F]]===1&&this[j[F]]!==void 0&&this[j[F]]!==null)return j[F]}},i.oneOfSetter=function(f){return function(_){for(var w=0;w<f.length;++w)f[w]!==_&&delete this[f[w]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var f=i.Buffer;f?(i._Buffer_from=f.from!==Uint8Array.from&&f.from||function(_,w){return new f(_,w)},i._Buffer_allocUnsafe=f.allocUnsafe||function(_){return new f(_)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}),cj=na,Ll,li=W.LongBits,ts=W.base64,us=W.utf8,vs=function(){return W.Buffer?function(){return(na.create=function(){return new Ll})()}:function(){return new na}};na.create=vs(),na.alloc=function(o){return new W.Array(o)},W.Array!==Array&&(na.alloc=W.pool(na.alloc,W.Array.prototype.subarray)),na.prototype._push=function(o,i,s){return this.tail=this.tail.next=new Kf(o,i,s),this.len+=i,this},$i.prototype=Object.create(Kf.prototype),$i.prototype.fn=function(o,i,s){for(;127<o;)i[s++]=127&o|128,o>>>=7;i[s]=o},na.prototype.uint32=function(o){return this.len+=(this.tail=this.tail.next=new $i(128>(o>>>=0)?1:16384>o?2:2097152>o?3:268435456>o?4:5,o)).len,this},na.prototype.int32=function(o){return 0>o?this._push(aj,10,li.fromNumber(o)):this.uint32(o)},na.prototype.sint32=function(o){return this.uint32((o<<1^o>>31)>>>0)},na.prototype.uint64=function(o){return o=li.from(o),this._push(aj,o.length(),o)},na.prototype.int64=na.prototype.uint64,na.prototype.sint64=function(o){return o=li.from(o).zzEncode(),this._push(aj,o.length(),o)},na.prototype.bool=function(o){return this._push(Zi,1,o?1:0)},na.prototype.fixed32=function(o){return this._push(bj,4,o>>>0)},na.prototype.sfixed32=na.prototype.fixed32,na.prototype.fixed64=function(o){return o=li.from(o),this._push(bj,4,o.lo)._push(bj,4,o.hi)},na.prototype.sfixed64=na.prototype.fixed64,na.prototype.float=function(o){return this._push(W.float.writeFloatLE,4,o)},na.prototype.double=function(o){return this._push(W.float.writeDoubleLE,8,o)};var QC=W.Array.prototype.set?function(o,i,s){i.set(o,s)}:function(o,i,s){for(var h=0;h<o.length;++h)i[s+h]=o[h]};na.prototype.bytes=function(o){var i=o.length>>>0;if(!i)return this._push(Zi,1,0);if(W.isString(o)){var s=na.alloc(i=ts.length(o));ts.decode(o,s,0),o=s}return this.uint32(i)._push(QC,i,o)},na.prototype.string=function(o){var i=us.length(o);return i?this.uint32(i)._push(us.write,i,o):this._push(Zi,1,0)},na.prototype.fork=function(){return this.states=new Nv(this),this.head=this.tail=new Kf(Yi,0,0),this.len=0,this},na.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Kf(Yi,0,0),this.len=0),this},na.prototype.ldelim=function(){var o=this.head,i=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=o.next,this.tail=i,this.len+=s),this},na.prototype.finish=function(){for(var o=this.head.next,i=this.constructor.alloc(this.len),s=0;o;)o.fn(o.val,i,s),s+=o.len,o=o.next;return i},na._configure=function(o){Ll=o,na.create=vs(),Ll._configure()},(rc.prototype=Object.create(cj.prototype)).constructor=rc,rc._configure=function(){rc.alloc=W._Buffer_allocUnsafe,rc.writeBytesBuffer=W.Buffer&&W.Buffer.prototype instanceof Uint8Array&&W.Buffer.prototype.set.name==="set"?function(o,i,s){i.set(o,s)}:function(o,i,s){if(o.copy)o.copy(i,s,0,o.length);else for(var h=0;h<o.length;)i[s++]=o[h++]}},rc.prototype.bytes=function(o){W.isString(o)&&(o=W._Buffer_from(o,"base64"));var i=o.length>>>0;return this.uint32(i),i&&this._push(rc.writeBytesBuffer,i,o),this},rc.prototype.string=function(o){var i=W.Buffer.byteLength(o);return this.uint32(i),i&&this._push(Ov,i,o),this},rc._configure();var ej=Qa,Ml,Jn=W.LongBits,RC=W.utf8,ws=typeof Uint8Array!="undefined"?function(o){if(o instanceof Uint8Array||Array.isArray(o))return new Qa(o);throw Error("illegal buffer")}:function(o){if(Array.isArray(o))return new Qa(o);throw Error("illegal buffer")},xs=function(){return W.Buffer?function(o){return(Qa.create=function(i){return W.Buffer.isBuffer(i)?new Ml(i):ws(i)})(o)}:ws};Qa.create=xs(),Qa.prototype._slice=W.Array.prototype.subarray||W.Array.prototype.slice,Qa.prototype.uint32=function(){var o=4294967295;return function(){if(o=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(o=(o|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(o=(o|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(o=(o|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(o=(o|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return o;if((this.pos+=5)>this.len)throw this.pos=this.len,dc(this,10);return o}}(),Qa.prototype.int32=function(){return 0|this.uint32()},Qa.prototype.sint32=function(){var o=this.uint32();return o>>>1^-(1&o)|0},Qa.prototype.bool=function(){return this.uint32()!==0},Qa.prototype.fixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return Wg(this.buf,this.pos+=4)},Qa.prototype.sfixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return 0|Wg(this.buf,this.pos+=4)},Qa.prototype.float=function(){if(this.pos+4>this.len)throw dc(this,4);var o=W.float.readFloatLE(this.buf,this.pos);return this.pos+=4,o},Qa.prototype.double=function(){if(this.pos+8>this.len)throw dc(this,4);var o=W.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,o},Qa.prototype.bytes=function(){var o=this.uint32(),i=this.pos,s=this.pos+o;if(s>this.len)throw dc(this,o);return this.pos+=o,Array.isArray(this.buf)?this.buf.slice(i,s):i===s?new this.buf.constructor(0):this._slice.call(this.buf,i,s)},Qa.prototype.string=function(){var o=this.bytes();return RC.read(o,0,o.length)},Qa.prototype.skip=function(o){if(typeof o=="number"){if(this.pos+o>this.len)throw dc(this,o);this.pos+=o}else do if(this.pos>=this.len)throw dc(this);while(128&this.buf[this.pos++]);return this},Qa.prototype.skipType=function(o){switch(o){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(o=7&this.uint32())!=4;)this.skipType(o);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+o+" at offset "+this.pos)}return this},Qa._configure=function(o){Ml=o,Qa.create=xs(),Ml._configure();var i=W.Long?"toLong":"toNumber";W.merge(Qa.prototype,{int64:function(){return dj.call(this)[i](!1)},uint64:function(){return dj.call(this)[i](!0)},sint64:function(){return dj.call(this).zzDecode()[i](!1)},fixed64:function(){return Kn.call(this)[i](!0)},sfixed64:function(){return Kn.call(this)[i](!1)}})},(Od.prototype=Object.create(ej.prototype)).constructor=Od,Od._configure=function(){W.Buffer&&(Od.prototype._slice=W.Buffer.prototype.slice)},Od.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},Od._configure(),(Lf.prototype=Object.create(W.EventEmitter.prototype)).constructor=Lf,Lf.prototype.rpcCall=function o(i,s,h,f,_){if(!f)throw TypeError("request must be specified");var w=this;if(!_)return W.asPromise(o,w,i,s,h,f);if(w.rpcImpl)try{return w.rpcImpl(i,s[w.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(j,F){if(j)return w.emit("error",j,i),_(j);if(F!==null){if(!(F instanceof h))try{F=h[w.responseDelimited?"decodeDelimited":"decode"](F)}catch(K){return w.emit("error",K,i),_(K)}return w.emit("data",F,i),_(null,F)}w.end(!0)})}catch(j){w.emit("error",j,i),setTimeout(function(){_(j)},0)}else setTimeout(function(){_(Error("already ended"))},0)},Lf.prototype.end=function(o){return this.rpcImpl&&(o||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var SC=cb(function(o,i){i.Service=Lf}),TC={},nc=cb(function(o,i){function s(){h.util._configure(),h.Writer._configure(h.BufferWriter),h.Reader._configure(h.BufferReader)}var h=i;h.build="minimal",h.Writer=cj,h.BufferWriter=rc,h.Reader=ej,h.BufferReader=Od,h.util=W,h.rpc=SC,h.roots=TC,h.configure=s,s()});nc.util.Long=U,nc.configure();var u=nc.Reader,N=nc.Writer,r=nc.util,t=nc.roots.default||(nc.roots.default={}),UC=t.URI=function(){var o={},i=Object.create(o);return i[o[0]="Unknown"]=0,i[o[1]="PingUri"]=1,i[o[2]="PongUri"]=2,i[o[11]="UserJoinUri"]=11,i[o[12]="UserRespUri"]=12,i[o[21]="UserQuitUri"]=21,i[o[22]="UserDropUri"]=22,i[o[31]="GroupEnterUri"]=31,i[o[32]="GroupLeaveUri"]=32,i[o[33]="GroupReplyUri"]=33,i[o[36]="GroupEnterNoticeUri"]=36,i[o[37]="GroupLeaveNoticeUri"]=37,i[o[38]="GroupEventNoticeUri"]=38,i[o[39]="GroupCountNoticeUri"]=39,i[o[41]="UserStatusListUri"]=41,i[o[42]="UserStatusResultUri"]=42,i[o[51]="GroupStatusListUri"]=51,i[o[52]="GroupStatusResultUri"]=52,i[o[55]="GroupAllUsersListUri"]=55,i[o[56]="GroupAllUsersResultUri"]=56,i[o[100]="MessageUri"]=100,i[o[101]="AckUri"]=101,i[o[115]="FileUploadIndexGetUri"]=115,i[o[116]="FileUploadIndexRetUri"]=116,i[o[117]="FileUploadIndexSetUri"]=117,i[o[118]="FileUploadIndexFinUri"]=118,i[o[119]="FileUploadIndexErrUri"]=119,i[o[125]="FileDownloadIndexGetUri"]=125,i[o[126]="FileDownloadIndexRetUri"]=126,i[o[127]="FileDownloadIndexErrUri"]=127,i[o[201]="UserJoinNoticeUri"]=201,i[o[202]="UserQuitNoticeUri"]=202,i[o[203]="UserWaitNoticeUri"]=203,i[o[301]="UserAttributeGetUri"]=301,i[o[302]="UserAttributeRetUri"]=302,i[o[303]="UserAttributeSetUri"]=303,i[o[304]="UserAttributeModUri"]=304,i[o[305]="UserAttributeDelUri"]=305,i[o[307]="UserAttributeRspUri"]=307,i[o[308]="UserAttributeErrUri"]=308,i[o[311]="UserAttributeKeysGetUri"]=311,i[o[312]="UserAttributeKeysRetUri"]=312,i[o[351]="GroupAttributeGetUri"]=351,i[o[352]="GroupAttributeRetUri"]=352,i[o[353]="GroupAttributeSetUri"]=353,i[o[354]="GroupAttributeModUri"]=354,i[o[355]="GroupAttributeDelUri"]=355,i[o[356]="GroupAttributeAltUri"]=356,i[o[357]="GroupAttributeRspUri"]=357,i[o[358]="GroupAttributeErrUri"]=358,i[o[361]="GroupAttributeKeysGetUri"]=361,i[o[362]="GroupAttributeKeysRetUri"]=362,i[o[401]="SubscribeUserStatusUri"]=401,i[o[402]="UnsubscribeUserStatusUri"]=402,i[o[499]="SubscribeResponseUri"]=499,i}(),mi=t.Wrapper=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.uri=0,o.prototype.data=r.newBuffer([]),o.encode=function(i,s){return s||(s=N.create()),i.uri!=null&&Object.hasOwnProperty.call(i,"uri")&&s.uint32(8).int32(i.uri),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&s.uint32(18).bytes(i.data),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.Wrapper;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.uri=i.int32();break;case 2:h.data=i.bytes();break;default:i.skipType(7&f)}}return h},o}(),VC=t.Ping=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&s.uint32(16).uint64(i.ms),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.Ping;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.ms=i.uint64();break;default:i.skipType(7&f)}}return h},o}(),WC=t.Pong=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&s.uint32(16).uint64(i.ms),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.Pong;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.ms=i.uint64();break;default:i.skipType(7&f)}}return h},o}(),XC=t.UserJoin=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.opt=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.ticket="",o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.opt!=null&&Object.hasOwnProperty.call(i,"opt")&&s.uint32(16).uint64(i.opt),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(24).uint64(i.instance),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(34).string(i.account),i.ticket!=null&&Object.hasOwnProperty.call(i,"ticket")&&s.uint32(42).string(i.ticket),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserJoin;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.opt=i.uint64();break;case 3:h.instance=i.uint64();break;case 4:h.account=i.string();break;case 5:h.ticket=i.string();break;default:i.skipType(7&f)}}return h},o}(),YC=t.UserResp=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(24).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserResp;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),ZC=t.UserQuit=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.encode=function(i,s){return s||(s=N.create()),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserQuit;i.pos<s;){var f=i.uint32();i.skipType(7&f)}return h},o}(),$C=t.UserDrop=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(8).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserDrop;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),aD=t.GroupEnter=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupEnter;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;default:i.skipType(7&f)}}return h},o}(),bD=t.GroupLeave=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.account="",o.encode=function(i,s){return s||(s=N.create()),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(10).string(i.account),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupLeave;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.account=i.string();break;default:i.skipType(7&f)}}return h},o}(),cD=t.GroupReply=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(24).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupReply;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),ys=t.GroupLeaveNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.size=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&s.uint32(18).string(i.user),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(26).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(32).uint64(i.instance),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&s.uint32(40).uint32(i.size),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupLeaveNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.user=i.string();break;case 3:h.group=i.string();break;case 4:h.instance=i.uint64();break;case 5:h.size=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),zs=t.GroupEnterNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.size=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&s.uint32(18).string(i.user),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(26).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(32).uint64(i.instance),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&s.uint32(40).uint32(i.size),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupEnterNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.user=i.string();break;case 3:h.group=i.string();break;case 4:h.instance=i.uint64();break;case 5:h.size=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),As=t.Message=function(){function o(i){if(this.MiscMap={},i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.options=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.src="",o.prototype.dst="",o.prototype.payload=r.newBuffer([]),o.prototype.MiscMap=r.emptyObject,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,s){if(s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.dialogue!=null&&Object.hasOwnProperty.call(i,"dialogue")&&s.uint32(16).uint64(i.dialogue),i.sequence!=null&&Object.hasOwnProperty.call(i,"sequence")&&s.uint32(24).uint64(i.sequence),i.options!=null&&Object.hasOwnProperty.call(i,"options")&&s.uint32(32).uint64(i.options),i.src!=null&&Object.hasOwnProperty.call(i,"src")&&s.uint32(42).string(i.src),i.dst!=null&&Object.hasOwnProperty.call(i,"dst")&&s.uint32(50).string(i.dst),i.payload!=null&&Object.hasOwnProperty.call(i,"payload")&&s.uint32(58).bytes(i.payload),i.MiscMap!=null&&Object.hasOwnProperty.call(i,"MiscMap"))for(var h=Object.keys(i.MiscMap),f=0;f<h.length;++f)s.uint32(66).fork().uint32(10).string(h[f]).uint32(18).bytes(i.MiscMap[h[f]]).ldelim();return i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&s.uint32(72).uint64(i.ms),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h,f,_=new t.Message;i.pos<s;)switch(h=i.uint32(),h>>>3){case 1:_.instance=i.uint64();break;case 2:_.dialogue=i.uint64();break;case 3:_.sequence=i.uint64();break;case 4:_.options=i.uint64();break;case 5:_.src=i.string();break;case 6:_.dst=i.string();break;case 7:_.payload=i.bytes();break;case 8:_.MiscMap===r.emptyObject&&(_.MiscMap={});var w=i.uint32()+i.pos;for(h="",f=[];i.pos<w;){var j=i.uint32();switch(j>>>3){case 1:h=i.string();break;case 2:f=i.bytes();break;default:i.skipType(7&j)}}_.MiscMap[h]=f;break;case 9:_.ms=i.uint64();break;default:i.skipType(7&h)}return _},o}(),Bs=t.Ack=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.dialogue!=null&&Object.hasOwnProperty.call(i,"dialogue")&&s.uint32(16).uint64(i.dialogue),i.sequence!=null&&Object.hasOwnProperty.call(i,"sequence")&&s.uint32(24).uint64(i.sequence),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(32).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.Ack;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.instance=i.uint64();break;case 2:h.dialogue=i.uint64();break;case 3:h.sequence=i.uint64();break;case 4:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),dD=t.FileUploadIndexGet=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.hash=r.newBuffer([]),o.prototype.size=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&s.uint32(18).bytes(i.hash),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&s.uint32(24).uint32(i.size),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileUploadIndexGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.hash=i.bytes();break;case 3:h.size=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),eD=t.FileUploadIndexRet=function(){function o(i){if(this.servers=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.unit=0,o.prototype.servers=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&s.uint32(16).uint32(i.unit),i.servers!=null&&i.servers.length){s.uint32(26).fork();for(var h=0;h<i.servers.length;++h)s.uint32(i.servers[h]);s.ldelim()}return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileUploadIndexRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.unit=i.uint32();break;case 3:if(h.servers&&h.servers.length||(h.servers=[]),(7&f)==2)for(f=i.uint32()+i.pos;i.pos<f;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;default:i.skipType(7&f)}}return h},o}(),fD=t.FileUploadIndexSet=function(){function o(i){if(this.servers=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.hash=r.newBuffer([]),o.prototype.unit=0,o.prototype.servers=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&s.uint32(18).bytes(i.hash),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&s.uint32(24).uint32(i.unit),i.servers!=null&&i.servers.length){s.uint32(34).fork();for(var h=0;h<i.servers.length;++h)s.uint32(i.servers[h]);s.ldelim()}return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileUploadIndexSet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.hash=i.bytes();break;case 3:h.unit=i.uint32();break;case 4:if(h.servers&&h.servers.length||(h.servers=[]),(7&f)==2)for(f=i.uint32()+i.pos;i.pos<f;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;default:i.skipType(7&f)}}return h},o}(),gD=t.FileUploadIndexFin=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.zone=0,o.prototype.unit=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&s.uint32(16).uint32(i.zone),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&s.uint32(24).uint32(i.unit),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileUploadIndexFin;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.zone=i.uint32();break;case 3:h.unit=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),hD=t.FileUploadIndexErr=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(16).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileUploadIndexErr;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),iD=t.FileDownloadIndexGet=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.zone=0,o.prototype.hash=r.newBuffer([]),o.prototype.size=0,o.prototype.unit=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&s.uint32(16).uint32(i.zone),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&s.uint32(26).bytes(i.hash),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&s.uint32(32).uint32(i.size),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&s.uint32(40).uint32(i.unit),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileDownloadIndexGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.zone=i.uint32();break;case 3:h.hash=i.bytes();break;case 4:h.size=i.uint32();break;case 5:h.unit=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),jD=t.FileDownloadIndexRet=function(){function o(i){if(this.servers=[],this.backups=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.unit=0,o.prototype.zone=0,o.prototype.servers=r.emptyArray,o.prototype.backups=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&s.uint32(16).uint32(i.unit),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&s.uint32(24).uint32(i.zone),i.servers!=null&&i.servers.length){s.uint32(34).fork();for(var h=0;h<i.servers.length;++h)s.uint32(i.servers[h]);s.ldelim()}if(i.backups!=null&&i.backups.length){for(s.uint32(42).fork(),h=0;h<i.backups.length;++h)s.uint32(i.backups[h]);s.ldelim()}return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileDownloadIndexRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.unit=i.uint32();break;case 3:h.zone=i.uint32();break;case 4:if(h.servers&&h.servers.length||(h.servers=[]),(7&f)==2)for(f=i.uint32()+i.pos;i.pos<f;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;case 5:if(h.backups&&h.backups.length||(h.backups=[]),(7&f)==2)for(f=i.uint32()+i.pos;i.pos<f;)h.backups.push(i.uint32());else h.backups.push(i.uint32());break;default:i.skipType(7&f)}}return h},o}(),kD=t.FileDownloadIndexErr=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(16).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.FileDownloadIndexErr;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),lD=t.GroupAllUsersList=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.pageSize=0,o.prototype.pageNumber=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.pageSize!=null&&Object.hasOwnProperty.call(i,"pageSize")&&s.uint32(24).uint32(i.pageSize),i.pageNumber!=null&&Object.hasOwnProperty.call(i,"pageNumber")&&s.uint32(32).uint32(i.pageNumber),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAllUsersList;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.pageSize=i.uint32();break;case 4:h.pageNumber=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),mD=t.GroupAllUsersResult=function(){function o(i){if(this.memberInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.totalSize=0,o.prototype.pageSize=0,o.prototype.pageNumber=0,o.prototype.memberInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.totalSize!=null&&Object.hasOwnProperty.call(i,"totalSize")&&s.uint32(24).uint32(i.totalSize),i.pageSize!=null&&Object.hasOwnProperty.call(i,"pageSize")&&s.uint32(32).uint32(i.pageSize),i.pageNumber!=null&&Object.hasOwnProperty.call(i,"pageNumber")&&s.uint32(40).uint32(i.pageNumber),i.memberInfos!=null&&i.memberInfos.length)for(var h=0;h<i.memberInfos.length;++h)t.GroupAllUsersResult.MemberInfo.encode(i.memberInfos[h],s.uint32(50).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAllUsersResult;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.totalSize=i.uint32();break;case 4:h.pageSize=i.uint32();break;case 5:h.pageNumber=i.uint32();break;case 6:h.memberInfos&&h.memberInfos.length||(h.memberInfos=[]),h.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.MemberInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.account="",i.prototype.ts=0,i.encode=function(s,h){return h||(h=N.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&h.uint32(10).string(s.account),s.ts!=null&&Object.hasOwnProperty.call(s,"ts")&&h.uint32(16).uint32(s.ts),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupAllUsersResult.MemberInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.account=s.string();break;case 2:f.ts=s.uint32();break;default:s.skipType(7&_)}}return f},i}(),o}(),nD=t.UserStatusList=function(){function o(i){if(this.users=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)s.uint32(18).string(i.users[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserStatusList;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),oD=t.UserStatusResult=function(){function o(i){if(this.userInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.userInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.userInfos!=null&&i.userInfos.length)for(var h=0;h<i.userInfos.length;++h)t.UserStatusResult.UserStatusInfo.encode(i.userInfos[h],s.uint32(18).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserStatusResult;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.userInfos&&h.userInfos.length||(h.userInfos=[]),h.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.UserStatusInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.account="",i.prototype.ts=0,i.encode=function(s,h){return h||(h=N.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&h.uint32(10).string(s.account),s.ts!=null&&Object.hasOwnProperty.call(s,"ts")&&h.uint32(16).uint32(s.ts),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.UserStatusResult.UserStatusInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.account=s.string();break;case 2:f.ts=s.uint32();break;default:s.skipType(7&_)}}return f},i}(),o}(),pD=t.UserAttributeGet=function(){function o(i){if(this.attributes=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributes=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)s.uint32(26).string(i.attributes[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),qD=t.UserAttributeRet=function(){function o(i){if(this.attributeInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeRet.AttributeInfo.encode(i.attributeInfos[h],s.uint32(18).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.UserAttributeRet.AttributeInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;default:s.skipType(7&_)}}return f},i}(),o}(),rD=t.UserAttributeSet=function(){function o(i){if(this.attributeInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeSet.AttributeInfo.encode(i.attributeInfos[h],s.uint32(26).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeSet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.UserAttributeSet.AttributeInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;default:s.skipType(7&_)}}return f},i}(),o}(),sD=t.UserAttributeMod=function(){function o(i){if(this.attributeInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeMod.AttributeInfo.encode(i.attributeInfos[h],s.uint32(26).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeMod;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.UserAttributeMod.AttributeInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;default:s.skipType(7&_)}}return f},i}(),o}(),tD=t.UserAttributeDel=function(){function o(i){if(this.attributes=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributes=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)s.uint32(26).string(i.attributes[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeDel;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),uD=t.UserAttributeErr=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(16).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeErr;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),vD=t.UserAttributeKeysGet=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&s.uint32(18).string(i.account),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeKeysGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;default:i.skipType(7&f)}}return h},o}(),wD=t.UserAttributeKeysRet=function(){function o(i){if(this.keys=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.keys=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.keys!=null&&i.keys.length)for(var h=0;h<i.keys.length;++h)s.uint32(18).string(i.keys[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeKeysRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.keys&&h.keys.length||(h.keys=[]),h.keys.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),xD=t.UserAttributeRsp=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserAttributeRsp;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;default:i.skipType(7&f)}}return h},o}(),yD=t.GroupStatusList=function(){function o(i){if(this.groups=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.groups=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.groups!=null&&i.groups.length)for(var h=0;h<i.groups.length;++h)s.uint32(18).string(i.groups[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupStatusList;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.groups&&h.groups.length||(h.groups=[]),h.groups.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),zD=t.GroupStatusResult=function(){function o(i){if(this.groupInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.groupInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.groupInfos!=null&&i.groupInfos.length)for(var h=0;h<i.groupInfos.length;++h)t.GroupStatusResult.GroupInfo.encode(i.groupInfos[h],s.uint32(18).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupStatusResult;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.groupInfos&&h.groupInfos.length||(h.groupInfos=[]),h.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.GroupInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.group="",i.prototype.memberCount=0,i.encode=function(s,h){return h||(h=N.create()),s.group!=null&&Object.hasOwnProperty.call(s,"group")&&h.uint32(10).string(s.group),s.memberCount!=null&&Object.hasOwnProperty.call(s,"memberCount")&&h.uint32(16).uint32(s.memberCount),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupStatusResult.GroupInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.group=s.string();break;case 2:f.memberCount=s.uint32();break;default:s.skipType(7&_)}}return f},i}(),o}(),AD=t.GroupCountNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.size=0,o.encode=function(i,s){return s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(16).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(26).string(i.group),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&s.uint32(32).uint32(i.size),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupCountNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.group=i.string();break;case 4:h.size=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),BD=t.GroupAttributeGet=function(){function o(i){if(this.attributes=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.attributes=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)s.uint32(26).string(i.attributes[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),CD=t.GroupAttributeRet=function(){function o(i){if(this.attributeMaps=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeMaps=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.attributeMaps!=null&&i.attributeMaps.length)for(var h=0;h<i.attributeMaps.length;++h)t.GroupAttributeRet.AttributeMap.encode(i.attributeMaps[h],s.uint32(18).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.attributeMaps&&h.attributeMaps.length||(h.attributeMaps=[]),h.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeMap=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.prototype.origin="",i.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),s.origin!=null&&Object.hasOwnProperty.call(s,"origin")&&h.uint32(26).string(s.origin),s.ms!=null&&Object.hasOwnProperty.call(s,"ms")&&h.uint32(32).uint64(s.ms),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupAttributeRet.AttributeMap;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;case 3:f.origin=s.string();break;case 4:f.ms=s.uint64();break;default:s.skipType(7&_)}}return f},i}(),o}(),DD=t.GroupAttributeSet=function(){function o(i){if(this.attributeInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&s.uint32(24).bool(i.broadcast),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.GroupAttributeSet.AttributeInfo.encode(i.attributeInfos[h],s.uint32(34).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeSet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupAttributeSet.AttributeInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;default:s.skipType(7&_)}}return f},i}(),o}(),ED=t.GroupAttributeMod=function(){function o(i){if(this.attributeInfos=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&s.uint32(24).bool(i.broadcast),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.GroupAttributeMod.AttributeInfo.encode(i.attributeInfos[h],s.uint32(34).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeMod;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeInfo=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupAttributeMod.AttributeInfo;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;default:s.skipType(7&_)}}return f},i}(),o}(),FD=t.GroupAttributeDel=function(){function o(i){if(this.attributes=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributes=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&s.uint32(24).bool(i.broadcast),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)s.uint32(34).string(i.attributes[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeDel;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),GD=t.GroupAttributeAlt=function(){function o(i){if(this.attributeMaps=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeMaps=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(24).uint64(i.instance),i.attributeMaps!=null&&i.attributeMaps.length)for(var h=0;h<i.attributeMaps.length;++h)t.GroupAttributeAlt.AttributeMap.encode(i.attributeMaps[h],s.uint32(34).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeAlt;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.instance=i.uint64();break;case 4:h.attributeMaps&&h.attributeMaps.length||(h.attributeMaps=[]),h.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.AttributeMap=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.key="",i.prototype.value="",i.prototype.origin="",i.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,i.encode=function(s,h){return h||(h=N.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&h.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&h.uint32(18).string(s.value),s.origin!=null&&Object.hasOwnProperty.call(s,"origin")&&h.uint32(26).string(s.origin),s.ms!=null&&Object.hasOwnProperty.call(s,"ms")&&h.uint32(32).uint64(s.ms),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.GroupAttributeAlt.AttributeMap;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.key=s.string();break;case 2:f.value=s.string();break;case 3:f.origin=s.string();break;case 4:f.ms=s.uint64();break;default:s.skipType(7&_)}}return f},i}(),o}(),HD=t.GroupAttributeRsp=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeRsp;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;default:i.skipType(7&f)}}return h},o}(),ID=t.GroupAttributeErr=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(16).uint32(i.code),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeErr;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&f)}}return h},o}(),JD=t.GroupAttributeKeysGet=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.encode=function(i,s){return s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&s.uint32(18).string(i.group),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeKeysGet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;default:i.skipType(7&f)}}return h},o}(),KD=t.GroupAttributeKeysRet=function(){function o(i){if(this.keys=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.keys=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.keys!=null&&i.keys.length)for(var h=0;h<i.keys.length;++h)s.uint32(18).string(i.keys[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.GroupAttributeKeysRet;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.keys&&h.keys.length||(h.keys=[]),h.keys.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),LD=t.SubscribeUserStatus=function(){function o(i){if(this.users=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)s.uint32(18).string(i.users[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.SubscribeUserStatus;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),MD=t.UnsubscribeUserStatus=function(){function o(i){if(this.users=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)s.uint32(18).string(i.users[h]);return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UnsubscribeUserStatus;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&f)}}return h},o}(),ND=t.UserJoinNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,s){return s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&s.uint32(26).string(i.user),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserJoinNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&f)}}return h},o}(),OD=t.UserQuitNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,s){return s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&s.uint32(26).string(i.user),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserQuitNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&f)}}return h},o}(),PD=t.UserWaitNotice=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,s){return s||(s=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&s.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&s.uint32(26).string(i.user),s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.UserWaitNotice;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&f)}}return h},o}(),QD=t.SubscribeResponse=function(){function o(i){if(this.errors=[],i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.errors=r.emptyArray,o.encode=function(i,s){if(s||(s=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&s.uint32(8).uint64(i.seq),i.errors!=null&&i.errors.length)for(var h=0;h<i.errors.length;++h)t.SubscribeResponse.SubscribeErrorsType.encode(i.errors[h],s.uint32(18).fork()).ldelim();return s},o.decode=function(i,s){i instanceof u||(i=u.create(i)),s=s===void 0?i.len:i.pos+s;for(var h=new t.SubscribeResponse;i.pos<s;){var f=i.uint32();switch(f>>>3){case 1:h.seq=i.uint64();break;case 2:h.errors&&h.errors.length||(h.errors=[]),h.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(i,i.uint32()));break;default:i.skipType(7&f)}}return h},o.SubscribeErrorsType=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.account="",i.prototype.code=0,i.encode=function(s,h){return h||(h=N.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&h.uint32(10).string(s.account),s.code!=null&&Object.hasOwnProperty.call(s,"code")&&h.uint32(16).uint32(s.code),h},i.decode=function(s,h){s instanceof u||(s=u.create(s)),h=h===void 0?s.len:s.pos+h;for(var f=new t.SubscribeResponse.SubscribeErrorsType;s.pos<h;){var _=s.uint32();switch(_>>>3){case 1:f.account=s.string();break;case 2:f.code=s.uint32();break;default:s.skipType(7&_)}}return f},i}(),o}(),RD=Object.freeze({__proto__:null,URI:UC,Wrapper:mi,Ping:VC,Pong:WC,UserJoin:XC,UserResp:YC,UserQuit:ZC,UserDrop:$C,GroupEnter:aD,GroupLeave:bD,GroupReply:cD,GroupLeaveNotice:ys,GroupEnterNotice:zs,Message:As,Ack:Bs,FileUploadIndexGet:dD,FileUploadIndexRet:eD,FileUploadIndexSet:fD,FileUploadIndexFin:gD,FileUploadIndexErr:hD,FileDownloadIndexGet:iD,FileDownloadIndexRet:jD,FileDownloadIndexErr:kD,GroupAllUsersList:lD,GroupAllUsersResult:mD,UserStatusList:nD,UserStatusResult:oD,UserAttributeGet:pD,UserAttributeRet:qD,UserAttributeSet:rD,UserAttributeMod:sD,UserAttributeDel:tD,UserAttributeErr:uD,UserAttributeKeysGet:vD,UserAttributeKeysRet:wD,UserAttributeRsp:xD,GroupStatusList:yD,GroupStatusResult:zD,GroupCountNotice:AD,GroupAttributeGet:BD,GroupAttributeRet:CD,GroupAttributeSet:DD,GroupAttributeMod:ED,GroupAttributeDel:FD,GroupAttributeAlt:GD,GroupAttributeRsp:HD,GroupAttributeErr:ID,GroupAttributeKeysGet:JD,GroupAttributeKeysRet:KD,SubscribeUserStatus:LD,UnsubscribeUserStatus:MD,UserJoinNotice:ND,UserQuitNotice:OD,UserWaitNotice:PD,SubscribeResponse:QD,default:t}),SD=Math.ceil,Cs=function(o){return function(i,s,h){var f=(i=String(mb(i))).length;return h=h===void 0?" ":String(h),(s=va(s))<=f||h==""?i:(s-=f,(f=ap.call(h,SD(s/h.length))).length>s&&(f=f.slice(0,s)),o?i+f:f+i)}},TD=Cs(!1),UD=Cs(!0),Ds=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Re);M({target:"String",proto:!0,forced:Ds},{padEnd:function(o){return UD(this,o,1<arguments.length?arguments[1]:void 0)}});var VD=Sf,Es=function(o){return function(i){i=tb(i);for(var s,h=Mc(i),f=h.length,_=0,w=[];f>_;)s=h[_++],fa&&!VD.call(i,s)||w.push(o?[s,i[s]]:i[s]);return w}},WD=Es(!0),XD=Es(!1);M({target:"Object",stat:!0},{entries:function(o){return WD(o)}});var YD=Jb.f,Fs="".endsWith,ZD=Math.min,Gs=Mk("endsWith"),$D=!Gs&&!!function(){var o=YD(String.prototype,"endsWith");return o&&!o.writable}();M({target:"String",proto:!0,forced:!$D&&!Gs},{endsWith:function(o){var i=String(mb(this));Lk(o);var s=1<arguments.length?arguments[1]:void 0,h=va(i.length);return s=s===void 0?h:ZD(va(s),h),h=String(o),Fs?Fs.call(i,h,s):i.slice(s-h.length,s)===h}}),rh("match",1,function(o,i,s){return[function(h){var f=mb(this),_=h==null?void 0:h[o];return _!==void 0?_.call(h,f):new RegExp(h)[o](String(f))},function(h){var f=s(i,h,this);if(f.done)return f.value;if(h=sa(h),f=String(this),!h.global)return Se(h,f);var _=h.unicode;h.lastIndex=0;for(var w,j=[],F=0;(w=Se(h,f))!==null;)w=String(w[0]),j[F]=w,w===""&&(h.lastIndex=Gj(f,va(h.lastIndex),_)),F++;return F===0?null:j}]});var aE=Jb.f,Hs="".startsWith,bE=Math.min,Is=Mk("startsWith"),cE=!Is&&!!function(){var o=aE(String.prototype,"startsWith");return o&&!o.writable}();M({target:"String",proto:!0,forced:!cE&&!Is},{startsWith:function(o){var i=String(mb(this));Lk(o);var s=va(bE(1<arguments.length?arguments[1]:void 0,i.length)),h=String(o);return Hs?Hs.call(i,h,s):i.slice(s,s+h.length)===h}});var Sn=function(o){var i=/(%?)(%([jds]))/g,s=Array.prototype.slice.call(arguments,1);return s.length&&(o=o.replace(i,function(h,f,_,w){switch(_=s.shift(),w){case"s":_=""+_;break;case"d":_=Number(_);break;case"j":_=JSON.stringify(_)}return f?(s.unshift(_),h):_})),s.length&&(o+=" "+s.join(" ")),""+(o=o.replace(/%{2,2}/g,"%"))},dE=/\s/,eE=function(o){for(var i=o.length;i--&&dE.test(o.charAt(i)););return i},fE=/^\s+/,Js=NaN,gE=/^[-+]0x[0-9a-f]+$/i,hE=/^0b[01]+$/i,iE=/^0o[0-7]+$/i,jE=parseInt,Nl=function(o){if(typeof o=="number")return o;if(we(o))return Js;if(ob(o)&&(o=typeof o.valueOf=="function"?o.valueOf():o,o=ob(o)?o+"":o),typeof o!="string")return o===0?o:+o;o=o&&o.slice(0,eE(o)+1).replace(fE,"");var i=hE.test(o);return i||iE.test(o)?jE(o.slice(2),i?2:8):gE.test(o)?Js:+o},kE=Math.max,lE=Math.min,mE=function(o,i,s){function h(_v){var h0=F,A0=K;return F=K=void 0,_c=_v,_e=o.apply(A0,h0)}function f(_v){var h0=_v-ca;return _v-=_c,ca===void 0||h0>=i||0>h0||Nf&&_v>=_g}function _(){var _v=Fb.Date.now();if(f(_v))return w(_v);var h0=setTimeout,A0=_v-_c;_v=i-(_v-ca),A0=Nf?lE(_v,_g-A0):_v,_o=h0(_,A0)}function w(_v){return _o=void 0,bh&&F?h(_v):(F=K=void 0,_e)}function j(){var _v=Fb.Date.now(),h0=f(_v);if(F=arguments,K=this,ca=_v,h0){if(_o===void 0)return _c=_v=ca,_o=setTimeout(_,i),ch?h(_v):_e;if(Nf)return clearTimeout(_o),_o=setTimeout(_,i),h(ca)}return _o===void 0&&(_o=setTimeout(_,i)),_e}var F,K,_e,_o,ca,_c=0,ch=!1,Nf=!1,bh=!0;if(typeof o!="function")throw new TypeError("Expected a function");if(i=Nl(i)||0,ob(s)){ch=!!s.leading;var _g=(Nf="maxWait"in s)?kE(Nl(s.maxWait)||0,i):_g;bh="trailing"in s?!!s.trailing:bh}return j.cancel=function(){_o!==void 0&&clearTimeout(_o),_c=0,F=ca=K=_o=void 0},j.flush=function(){return _o===void 0?_e:w(Fb.Date.now())},j},Fc=function(o){function i(h,f){return X(this,i),m(n(h=s.call(this,Rn(h,f))),"originalError",void 0),m(n(h),"code",void 0),m(n(h),"serverCode",void 0),typeof f=="number"?h.code=f:typeof f=="string"?h.name=f:f!==void 0&&(f.originalError&&(h.originalError=f.originalError),f.code!==void 0&&(h.code=f.code),f.serverCode!==void 0&&(h.serverCode=f.serverCode)),h}ja(i,o);var s=ka(i);return i}(xf(Error)),Ma=function(o){function i(h,f){return X(this,i),m(n(h=s.call(this,Rn(h,f))),"name","RtmInternalError"),m(n(h),"code",void 0),h.code=f,h}ja(i,o);var s=ka(i);return i}(xf(Error)),ni=function(){return function(o){function i(h){X(this,i);var f=Object.keys(h);return s.call(this,h[f[0]],f[0])}ja(i,o);var s=ka(i);return i}(Ma)},Ha=ni(),gb=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmTimeoutError"),h}ja(i,o);var s=ka(i);return i}(Fc),H=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmInvalidArgumentError"),h}ja(i,o);var s=ka(i);return i}(Fc),L=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmInvalidStatusError"),h}ja(i,o);var s=ka(i);return i}(Fc),Ol=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmInterruptedError"),h}ja(i,o);var s=ka(i);return i}(Fc),lb=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmLimitExceededError"),h}ja(i,o);var s=ka(i);return i}(Fc),nE=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmInvokeTooOftenError"),h}ja(i,o);var s=ka(i);return i}(Fc),da=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmUnavailableError"),m(n(h),"serverCode",void 0),m(n(h),"statusCode",void 0),h}ja(i,o);var s=ka(i);return i}(Fc),of=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmUnauthenticatedError"),m(n(h),"serverCode",void 0),h}ja(i,o);var s=ka(i);return i}(Fc),bd=function(o){function i(){X(this,i);for(var h=arguments.length,f=Array(h),_=0;_<h;_++)f[_]=arguments[_];return m(n(h=s.call.apply(s,[this].concat(f))),"name","RtmUnknownError"),h}ja(i,o);var s=ka(i);return i}(Fc),Xa=function(o){return o instanceof gb||o instanceof sb},ta=function(o){return o instanceof Fc},he=function(o,i,s){return['Executing "%s.%s" timed out after %ds',o,i,s/1e3]},Qn=new Map,oE=function(){var o=new Date;return"".concat(o.toISOString().split("T")[1].replace(/\..+/,""),".").concat(o.getMilliseconds())},Pf=Object.keys,eh=Object.entries.bind(Object),Zg=function(o){return typeof o=="string"?o.endsWith(".")?o:"".concat(o,"."):o},Vn=function(o){for(var i="",s=(o=new Uint8Array(o)).byteLength,h=-1;++h<s;)i+=String.fromCharCode(o[h]);return i=btoa(i),"data:;base64,".concat(i)},pE=R(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});M({target:"Date",proto:!0,forced:pE},{toJSON:function(o){o=Va(this);var i=tc(o);return typeof i!="number"||isFinite(i)?o.toISOString():null}}),M({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Vv=Object.prototype.hasOwnProperty,Ks=function(o,i,s){return JSON.stringify(ao(o),i,s)};Ks.ensureProperties=ao;var qE=function(o,i){i=i||{};var s=V(o);if(s==="string"&&0<o.length)return Wv(o);if(s==="number"&&isFinite(o))return i.long?o=864e5<=(i=Math.abs(o))?gh(o,i,864e5,"day"):36e5<=i?gh(o,i,36e5,"hour"):6e4<=i?gh(o,i,6e4,"minute"):1e3<=i?gh(o,i,1e3,"second"):o+" ms":o=864e5<=(i=Math.abs(o))?Math.round(o/864e5)+"d":36e5<=i?Math.round(o/36e5)+"h":6e4<=i?Math.round(o/6e4)+"m":1e3<=i?Math.round(o/1e3)+"s":o+"ms",o;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))},rE=function(o){function i(f){function _(){for(var F=arguments.length,K=Array(F),_e=0;_e<F;_e++)K[_e]=arguments[_e];if(_.enabled){F=Number(new Date),_.diff=F-(w||F),_.prev=w,w=_.curr=F,K[0]=i.coerce(K[0]),typeof K[0]!="string"&&K.unshift("%O");var _o=0;K[0]=K[0].replace(/%([a-zA-Z%])/g,function(ca,_c){return ca==="%%"?"%":(_o++,typeof(_c=i.formatters[_c])=="function"&&(ca=_c.call(_,K[_o]),K.splice(_o,1),_o--),ca)}),i.formatArgs.call(_,K),(_.log||i.log).apply(_,K)}}var w,j=null;return _.namespace=f,_.useColors=i.useColors(),_.color=i.selectColor(f),_.extend=s,_.destroy=i.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:function(){return j===null?i.enabled(f):j},set:function(F){j=F}}),typeof i.init=="function"&&i.init(_),_}function s(f,_){return(f=i(this.namespace+(_===void 0?":":_)+f)).log=this.log,f}function h(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(f){return f instanceof Error?f.stack||f.message:f},i.disable=function(){var f=[].concat(G(i.names.map(h)),G(i.skips.map(h).map(function(_){return"-"+_}))).join(",");return i.enable(""),f},i.enable=function(f){i.save(f),i.names=[],i.skips=[];var _,w=(typeof f=="string"?f:"").split(/[\s,]+/),j=w.length;for(_=0;_<j;_++)w[_]&&((f=w[_].replace(/\*/g,".*?"))[0]==="-"?i.skips.push(new RegExp("^"+f.substr(1)+"$")):i.names.push(new RegExp("^"+f+"$")))},i.enabled=function(f){if(f[f.length-1]==="*")return!0;var _,w=0;for(_=i.skips.length;w<_;w++)if(i.skips[w].test(f))return!1;for(w=0,_=i.names.length;w<_;w++)if(i.names[w].test(f))return!0;return!1},i.humanize=qE,i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(o).forEach(function(f){i[f]=o[f]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(f){for(var _=0,w=0;w<f.length;w++)_=(_<<5)-_+f.charCodeAt(w),_|=0;return i.colors[Math.abs(_)%i.colors.length]},i.enable(i.load()),i},Ls=cb(function(o,i){i.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),this.useColors){var f="color: "+this.color;h.splice(1,0,f,"color: inherit");var _=0,w=0;h[0].replace(/%[a-zA-Z%]/g,function(j){j!=="%%"&&(_++,j==="%c"&&(w=_))}),h.splice(w,0,f)}},i.save=function(h){try{h?i.storage.setItem("debug",h):i.storage.removeItem("debug")}catch{}},i.load=function(){try{var h=i.storage.getItem("debug")}catch{}return!h&&typeof process!="undefined"&&"env"in process&&(h={}.DEBUG),h},i.useColors=function(){return!(typeof window=="undefined"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator=="undefined"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};t:{try{var s=localStorage;break t}catch{}s=void 0}i.storage=s,i.destroy=function(){var h=!1;return function(){h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),i.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),i.log=console.debug||console.log||function(){},o.exports=rE(i),o.exports.formatters.j=function(h){try{return JSON.stringify(h)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}),Ms=Ls("RTM:DEBUG"),pf;Ms.enabled=!1,function(o){o[o.Uploading=0]="Uploading",o[o.Free=1]="Free"}(pf||(pf={}));var sE=function(){function o(i){X(this,o),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),m(this,"rtmConfig",void 0),this.processId=i.processId,this.sdkVersion=i.sdkVersion,this.rtmConfig=i.rtmConfig,this.uploadRequest=i.uploadRequest,this.uploadState=pf.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ia(o,[{key:"upload",value:function(i){this.LogCache.push(i),this.uploadState===pf.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(i){var s=this;this.uploadState=pf.Uploading,setTimeout(J(x.mark(function h(){var f,_,w;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return f={sdk_version:s.sdkVersion,process_id:s.processId,payload:JSON.stringify(i)},j.prev=1,j.next=4,s.uploadRequest(f,(_=s.rtmConfig.enableCloudProxy)!==null&&_!==void 0&&_);case 4:if(!Ti){j.next=6;break}throw Error("RTM is busy");case 6:j.next=13;break;case 8:return j.prev=8,j.t0=j.catch(1),w=2>s.uploadResendCount++?2e3:1e4,setTimeout(function(){return s.postLog(s.LogsToPost)},w),j.abrupt("return");case 13:if(Ms('The logs uploaded for "process-'.concat(zg,'"')),s.LogCache.length!==0){j.next=17;break}return s.uploadState=pf.Free,j.abrupt("return");case 17:s.uploadResendCount=0,s.LogsToPost=40>s.LogCache.length?s.LogCache.splice(0,s.LogCache.length):s.LogCache.splice(0,40),s.postLog(s.LogsToPost);case 20:case"end":return j.stop()}},h,null,[[1,8]])})),ie.getParameter("LOG_UPLOAD_INTERVAL"))}}]),o}(),Ns=function(o,i,s,h,f,_,w,j){var F=0;for(w=!!w&&pd(w,j,3);F<h;){if(F in s){if(j=w?w(s[F],F,i):s[F],0<_&&qd(j))f=Ns(o,i,j,va(j.length),f,_-1)-1;else{if(9007199254740991<=f)throw TypeError("Exceed the acceptable array length");o[f]=j}f++}F++}return f},tE=Ns;M({target:"Array",proto:!0},{flat:function(){var o=arguments.length?arguments[0]:void 0,i=Va(this),s=va(i.length),h=th(i,0);return h.length=tE(h,i,i,s,0,o===void 0?1:fc(o)),h}}),M({target:"Object",stat:!0},{values:function(o){return XD(o)}});var uE=["CODE"],Gb,Bd,D;(function(o){o.CHINA="CN",o.ASIA="AS",o.NORTH_AMERICA="NA",o.EUROPE="EU",o.JAPAN="JP",o.INDIA="IN",o.OCEANIA="OC",o.SOUTH_AMERICA="SA",o.AFRICA="AF",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL"})(D||(D={}));var vE={CN:D.CHINA,NA:D.NORTH_AMERICA,EU:D.EUROPE,AS:D.ASIA,JP:D.JAPAN,IN:D.INDIA,GLOB:D.GLOBAL,AF:D.AFRICA,OC:D.OVERSEA,OVS:D.OVERSEA,SA:D.SOUTH_AMERICA},hh=Zn((Gb={},m(Gb,D.ASIA,{CODE:D.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.NORTH_AMERICA,{CODE:D.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.EUROPE,{CODE:D.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.JAPAN,{CODE:D.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.INDIA,{CODE:D.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OVERSEA,{CODE:D.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),m(Gb,D.GLOBAL,{CODE:D.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OCEANIA,{CODE:D.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.SOUTH_AMERICA,{CODE:D.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.AFRICA,{CODE:D.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.CHINA,{CODE:D.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),Gb)),Qf=(Bd={},m(Bd,D.ASIA,[D.CHINA,D.JAPAN,D.INDIA]),m(Bd,D.EUROPE,[]),m(Bd,D.NORTH_AMERICA,[]),m(Bd,D.SOUTH_AMERICA,[]),m(Bd,D.OCEANIA,[]),m(Bd,D.AFRICA,[]),Bd),Os=[D.OVERSEA,D.GLOBAL,D.CHINA,D.NORTH_AMERICA,D.EUROPE,D.ASIA,D.JAPAN,D.INDIA,D.OCEANIA,D.SOUTH_AMERICA,D.AFRICA],bo=function(o){return Object.values(Qf).flat().includes(o)},Yv=function(o){var i;return(i=eh(Qf).find(function(s){return(s=ua(s,2))[0],s[1].includes(o)}))===null||i===void 0?void 0:i[0]},wE=function(o){return o.sort(function(i,s){return Os.indexOf(i)-Os.indexOf(s)})},Ke=function(o){var i=new Set;if((o=wE(o).slice(0,3).map(function(s){var h=hh[s];if(h===void 0)throw new Ma("invalid area key");return s=h.CODE,h=yf(h,uE),i.add(s),h})).length===0)throw new Ma("areas cannot be empty");return wa({CODES:i},o.reduce(function(s,h){for(var f=0,_=eh(s);f<_.length;f++){var w=ua(_[f],2),j=w[0];w=w[1],s[j]=Array.from(new Set([].concat(G(h[j]),G(w))))}return s}))},P,Ps=function(){var o=J(x.mark(function i(s,h){var f,_,w,j,F,K=arguments;return x.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(!(2<(_=2<K.length&&K[2]!==void 0?K[2]:0))){_e.next=3;break}return _e.abrupt("return");case 3:return w={withCredentials:!0,body:s,timeout:2e4},j=0<_?(P==null?void 0:P.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(P==null?void 0:P.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",F=h?"https://".concat((f=P==null?void 0:P.PROXY_NGINX[0])!==null&&f!==void 0?f:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(j,"&p=443&d=upload/v1"):"https://".concat(j,"/upload/v1"),_e.next=8,He(F,w).catch(function(_o){return Ps(s,h,_+1)});case 8:case"end":return _e.stop()}},i)}));return function(i,s){return o.apply(this,arguments)}}(),Qs=new sE({processId:"process-".concat(zg),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.5-0-g9cf39592"),uploadRequest:Ps,rtmConfig:{}}),Pl="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Rs="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Ss="serverReceivedTs isOfflineMessage enableHistoricalMessaging enableOfflineMessaging hasPeerReceived messageType enableNotificationToChannelMembers lastUpdateTs".split(" "),xE="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),Le=function(o){if(typeof o=="string")return pa(o);if(Array.isArray(o)&&o.every(function(_){return typeof _=="string"}))return o.map(function(_){return pa(_)});if(!Km(o)){for(var i={},s=0;s<Ss.length;s++){var h=Ss[s];h in o&&(i[h]=o[h])}if(0<Object.keys(i).length)return i;if(5>Object.keys(o).length){for(s=0,o=Object.entries(o);s<o.length;s++){var f=ua(o[s],2);h=f[0],f=f[1],Pl.includes(h)?i[h]="[Hidden Info]":i[pa(h)]=typeof f=="string"?pa(f):"[Sensitive Info]"}return i}return"[Sensitive Info]"}return o},Ts=function(o){return V(o)==="object"?Hd(o)?Yn(te(o,5),Pl,Rs):o.constructor&&o.constructor.name:o},Us=function(o,i){return o instanceof Error?o.message:typeof o!="string"?JSON.stringify(Yn(te(o,5),Pl,Rs)):(i=i.map(function(s){return s instanceof Error?s.message:V(s)==="object"?Ks(Array.isArray(s)?s.map(Ts):Ts(s)):s}),Sn.apply(void 0,[o.replace(/%[%Oo]/g,function(s){return s==="%%"?"%":s==="%o"||s==="%O"?"%s":s})].concat(G(i))))},yE=1,Vs=function(o,i,s){var h=Ls(o);return h.enabled=!0,h.log=s,h.useColors=!1,function(f){for(var _=arguments.length,w=Array(1<_?_-1:0),j=1;j<_;j++)w[j-1]=arguments[j];if(i.enableLogUpload){_=Zg(f);var F=Us(_,w);Qs.upload({log_item_id:"".concat(yE++),log_level:o,payload_str:"[".concat(oE(),"] ").concat(o," - ").concat(256<F.length?F.slice(0,256):F)})}switch(_=function(K){var _e=F||Us(Zg(f),w),_o=lc.LOG_HANDLER;typeof _o=="function"&&_o({level:K,message:_e}),h(_e)},o){case"RTM:INFO":i.logFilter.info&&_("log");break;case"RTM:WARN":i.logFilter.warn&&_("warning");break;case"RTM:ERROR":i.logFilter.error&&_("error");break;case"RTM:TRACK":i.logFilter.track&&_("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":i.logFilter.debug&&_("debug");break;case"RTM:DEBUG":i.logFilter.debug&&_("debug")}}},Ql,Ws=function(o){return function(i){var s=Ql===1||o===void 0?"":"Ins#".concat(o," ");return"".concat(s).concat(i)}},Rl=function(o,i,s){var h=Ws(Ql);return Vs("RTM:".concat(i),s,function(f){return o(h(f))})},wb=function(){return function(o){function i(h,f){var _=2<arguments.length&&arguments[2]!==void 0&&arguments[2];X(this,i);var w=s.call(this);if(m(n(w),"logError",void 0),m(n(w),"invokeTracker",void 0),m(n(w),"resultTracker",void 0),m(n(w),"errorTracker",void 0),m(n(w),"eventTracker",void 0),m(n(w),"info",void 0),m(n(w),"warn",void 0),m(n(w),"log",void 0),m(n(w),"genLogger",void 0),m(n(w),"loggerId",void 0),m(n(w),"logger",void 0),m(n(w),"name",void 0),w.logger=h,w.name=f,w.loggerId=h.loggerId,w.info=h.info,w.warn=h.warn,w.logError=h.logError,w.genLogger=h.genLogger,w.log=h.genLogger("RTM:DEBUG","<".concat(f,"> ")),w.invokeTracker=h.genTracker("Invoke"),w.eventTracker=h.genTracker("Event"),w.resultTracker=h.genTracker("Result"),w.errorTracker=h.genTracker("Error"),_){var j=w.emit.bind(n(w));w.emit=function(){for(var F=arguments.length,K=Array(F),_e=0;_e<F;_e++)K[_e]=arguments[_e];F=K[0],_e=K.slice(1);var _o=xE.includes(F);w.eventTracker.apply(w,["%s: ".concat(0<_e.length?"%s emitted with args: ".concat(_e.map(function(){return"%o"})):"%s emitted"),f,F].concat(G(_o?_e.map(Le):_e)));try{j.apply(void 0,K)}catch(ca){w.logError("Caught in the callback function of the event %s",F,ca)}}}return w}ja(i,o);var s=ka(i);return i}(ia)},zE=function(o){return Rl(console.log.bind(console),"INFO",o)},AE=function(o){return Rl(console.warn.bind(console),"WARN",o)},BE=function(o){return Rl(console.error.bind(console),"ERROR",o)},Xs=function(o,i){return function(s){var h=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",f=Ws(o),_=console.debug.bind(console),w=Vs(s,i,function(j){return _(f(j))});return function(j){for(var F=arguments.length,K=Array(1<F?F-1:0),_e=1;_e<F;_e++)K[_e-1]=arguments[_e];return w.apply(void 0,[h+j].concat(K))}}},CE=function(o,i){return function(s){return Xs(o,i)("RTM:TRACK","[".concat(s,"] "))}},rj=t.URI,$v=mi,DE=yf(RD,["Wrapper"]),co=ml(DE,"URI"),Ys=function(o,i){var s=-1,h=o.length,f=h-1;for(i=i===void 0?h:i;++s<i;){var _=o[h=rs(s,f)];o[h]=o[s],o[s]=_}return o.length=i,o},EE=function(o){return Ys(Bi(o))},FE=function(o){return Ys(tj(o))},qf=function(o){return(Za(o)?EE:FE)(o)},rf={0:9591,1:9593},je=function(o){var i=Pd(null);return"https://".concat(i?null:o,"/api/v1")},GE=eb.apply(void 0,G(qf(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map(je)))),HE=eb.apply(void 0,G(qf(["ap-web-1.agora.io","ap-web-2.agora.io"].map(je)))),IE=eb.apply(void 0,G(qf(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map(je)))),JE=eb.apply(void 0,G(qf(["ap-web-3.agora.io","ap-web-4.agora.io"].map(je)))),Zs=ni(),Sl=function(o){function i(h,f,_,w,j,F){X(this,i);var K=s.call(this,j,fj("Socket-",j.loggerId));if(m(n(K),"isActiveClose",!1),m(n(K),"loggedIn",!1),m(n(K),"useNewDomain",void 0),m(n(K),"receivedPacket",new Ua),m(n(K),"open$",void 0),m(n(K),"input$",new Ua),m(n(K),"userJoin$",new Ua),m(n(K),"attemptsSinceLastError",0),m(n(K),"message$",new Ua),m(n(K),"socket$",void 0),m(n(K),"toClose",new Ua),m(n(K),"toReconnect",new Ua),m(n(K),"sendLogger",void 0),m(n(K),"receiveLogger",void 0),m(n(K),"ip",void 0),m(n(K),"env",void 0),m(n(K),"ticket",void 0),m(n(K),"context",void 0),m(n(K),"getDomain",function(){return eo(K.ip,K.useNewDomain)}),m(n(K),"socketReconnector",function(ca){var _c=function(ch){return K.attemptsSinceLastError+=1,K.warn("The %s of Env %d reconnecting %s",K.name,K.env,ch.message),Kc(3e3)};return ca.pipe(Ja(function(ch){return K.log("socket connection closed"),K.loggedIn=!1,2<=K.attemptsSinceLastError?(K.warn("socket connection failure"),K.emit("connectionFailure"),K.close(),Z(ch)):K.isActiveClose?yb:(K.emit("reconnect"),K.useNewDomain=!K.useNewDomain,Z(ch))}),Ce(function(ch){return ch.pipe(Lc(_c))}))}),K.ip=h,K.env=f,K.ticket=_,K.context=w,K.useNewDomain=F!=null?F:.5<=Math.random(),K.sendLogger=K.genLogger("RTM:MSG:SEND"),K.receiveLogger=K.genLogger("RTM:MSG:RECV"),f!==0&&f!==1)throw new Zs({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});var _e=rf[f];K.log("Opening websocket address %s for the Env %d",K.ip,K.env);var _o=cc(K.input$,K.userJoin$.pipe(Lv(2)),K.message$).pipe(ea(function(ca){return mi.encode(ca).finish()}));return h=cc(Mv("",{protocols:[],makeWebSocket:function(){if(K.context.config.enableCloudProxy||K.context.socketUseProxy){if(K.context.cloudProxyServers.length===0)throw K.logError("No cloud proxy server to connect"),new da;var ca=Pd(null)?JSON.parse(null.replace(/-/g,".")):K.context.cloudProxyServers;ca=Je(ca="wss://".concat(eo(fo(ca),!1),"/"),"sid",K.context.sid),ca=Je(ca,"remote_port",_e.toString()),ca=Je(ca,"remote_ip",K.ip),ca=Je(ca,"token",K.context.key),ca=new WebSocket(ca)}else ca=new WebSocket("wss://".concat(K.getDomain(),":").concat(_e));return ca.binaryType="arraybuffer",ca}}),K.toReconnect),K.socket$=Da(h,zl.pipe(kb(7e3),Ja(function(ca){return Xa(ca)&&K.warn("socket open timed out"),Z(ca)}))).pipe(ea(function(ca){if(ca instanceof Error)throw K.warn("Env_%d: Force reconnect the socket",K.env),ca;return ca(_o).pipe(ea(function(_c){return mi.decode(new Uint8Array(_c))}))}),K.socketReconnector),K.open$=K.socket$.pipe(ba(function(ca){K.log("Websocket opened",K.name),ca.subscribe(function(_c){var ch=_c.data;_c=rj[_c.uri].slice(0,-3),ch=co[_c].decode(ch);var Nf=DC({},ml(ch,"toJSON"),function(h0,A0){return A0 instanceof U?Pn(A0):A0}),bh=!1;if((ch instanceof zs||ch instanceof ys)&&ch.instance.lessThanOrEqual(4294967295)&&(bh=!0),ch instanceof As||ch instanceof Bs){var _g=ch.instance,_v=ch.sequence;(ch.dialogue.lessThanOrEqual(4294967295)||_g.lessThanOrEqual(4294967295)||_v.lessThan(1))&&(bh=!0)}bh?K.warn("Env_%d: Illegal %s, abandoned %o",K.env,_c,Nf):(_c!=="Pong"&&K.receiveLogger("Env_%d: %s %o",K.env,_c,Nf),K.receivedPacket.next([_c,ch]))},function(){})}),If(void 0),rb(K.toClose),De()),K}ja(i,o);var s=ka(i);return Ia(i,[{key:"address",get:function(){return"".concat(this.ip,":").concat(rf[this.env])}},{key:"sendPacket",value:function(h,f){if(h!=="Ping"){var _=Bc(f,function(w){return w instanceof U?Pn(w):w});this.sendLogger("Env_%d: %s %o",this.env,h,_)}f=Zv(h,f),h==="UserJoin"?this.userJoin$.next(f):h==="Message"?this.message$.next(f):this.input$.next(f)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(h){return this.receivedPacket.pipe(zb(function(f){return ua(f,1)[0]===h}),ea(function(f){return ua(f,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Zs({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),i}(wb());M({target:"String",proto:!0,forced:Ds},{padStart:function(o){return TD(this,o,1<arguments.length?arguments[1]:void 0)}});var KE=function(o){var i=Pf(hh);o=Tv(o);for(var s=0;s<i.length;s++){var h=hh[i[s]];if(h!=null&&h.AP_DOMAINS.includes(o)||h!=null&&h.AP_BACKUP_DOMAINS.includes(o)||h!=null&&h.PROXY_AP.includes(o))return[h.CODE]}return[D.CHINA,D.GLOBAL]},LE={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},$s={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},ME=[100,101,102],oi=/web-(\d)/,at=function(o){function i(h,f){var _=2<arguments.length&&arguments[2]!==void 0&&arguments[2];X(this,i);var w=s.call(this,f,"AccessPoint");return m(n(w),"handleUniLbsError",function(j,F){var K=j;if(4<j.toString().length){var _e=j.toString().padStart(8,"0"),_o=parseInt(_e.slice(0,4),10);if(_e=parseInt(_e.slice(4,8),10),_o===201)K=_e;else if(_o===101&&!ME.includes(_e))return Z(Error("service is currently unavailable"))}if(_o=K.toString(),!Object.keys($s).includes(_o))return(j=new da(["Login is rejected by the server. The response code is %d",j],Bg)).serverCode=K,Z(j);switch(_o=$s[_o],K=LE[_o],_o){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(F=new of(K,ds)).serverCode=j,Z(F);case"INVALID_USER_ID":return(F=new of(K,hi)).serverCode=j,Z(F);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(F=new of(K,ii)).serverCode=j,Z(F);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(F=new of(K,es)).serverCode=j,Z(F);case"CANNOT_MEET_AREA_DEMAND":return(F=KE(F)).forEach(function(ca){return w.failedAreas.add(ca)}),w.failedAreas.size===(P===void 0?2:P.CODES.size)?((F=new H(K,Bg)).serverCode=j,Z(F)):Z(Error("ap ".concat(F.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(F=new da(K,Bg)).serverCode=j,Z(F);default:return Z(Nn("ApResErrType",_o))}}),m(n(w),"getApEdgeInfo$",void 0),m(n(w),"getApEdgeInfoEndFirst$",void 0),m(n(w),"apFinish$",new Ua),m(n(w),"retryCount",0),m(n(w),"failedAreas",new Set),m(n(w),"usedUrl",[]),m(n(w),"newDomainUsed",!1),m(n(w),"backupNewDomainUsed",!1),m(n(w),"genUrl",function(){return P===void 0?Ri.apply(void 0,G(qf([GE,HE]))).pipe(Si(function(j){return eb.apply(void 0,G(j))})):eb.apply(void 0,G(P.AP_DOMAINS.slice(0,3).map(je)))}),m(n(w),"genBackupUrl",function(){return P===void 0?Ri.apply(void 0,G(qf([IE,JE]))).pipe(Si(function(j){return eb.apply(void 0,G(j))})):eb.apply(void 0,G(P.AP_BACKUP_DOMAINS.slice(0,3).map(je)))}),m(n(w),"getApUrl$",function(j){var F,K;return w.genUrl().pipe(zb(function(_e){return(!w.newDomainUsed||!_e.includes("sd-rtn.com"))&&(_e.includes("sd-rtn.com")&&(w.newDomainUsed=!0),!Kl(w.usedUrl,function(_o){var ca;return _o===((ca=_e.match(oi))===null||ca===void 0?void 0:ca[1])}))}),ba(function(_e){var _o;P===void 0&&typeof(_e=(_o=_e.match(oi))===null||_o===void 0?void 0:_o[1])=="string"&&w.usedUrl.push(_e)}),Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(F=P==null?void 0:P.CODES.size)!==null&&F!==void 0?F:0):(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:2),Md(function(){return i.runOutOfUrlSymbol}),Ja(function(_e,_o){return w.newDomainUsed=!1,_e===i.runOutOfUrlSymbol?(w.usedUrl=[],_o):Z(_e)}))}),m(n(w),"getBackupApUrl$",function(j){var F,K;return w.genBackupUrl().pipe(zb(function(_e){return(!w.backupNewDomainUsed||!_e.includes("sd-rtn.com"))&&(_e.includes("sd-rtn.com")&&(w.backupNewDomainUsed=!0),!Kl(w.usedUrl,function(_o){var ca;return _o===((ca=_e.match(oi))===null||ca===void 0?void 0:ca[1])}))}),ba(function(_e){var _o;P===void 0&&typeof(_e=(_o=_e.match(oi))===null||_o===void 0?void 0:_o[1])=="string"&&w.usedUrl.push(_e)}),Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(F=P==null?void 0:P.CODES.size)!==null&&F!==void 0?F:0):(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:2),Md(function(){return i.runOutOfUrlSymbol}),Ja(function(_e,_o){return w.backupNewDomainUsed=!1,_e===i.runOutOfUrlSymbol?(w.usedUrl=[],_o):Z(_e)}))}),m(n(w),"getProxyApUrl$",function(j){var F,K;return eb.apply(void 0,G(((P==null?void 0:P.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map(je))).pipe(Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(F=P==null?void 0:P.CODES.size)!==null&&F!==void 0?F:0):(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:2))}),m(n(w),"context",void 0),m(n(w),"fetchCloudProxy",function(j,F){var K=fj("AP-",w.loggerId);w.log("The AccessPoint requests %s(%s)",j,K);var _e=new AbortController;return w.apFinish$.pipe(Pa(1)).subscribe(function(){return _e.abort()}),hd(J(x.mark(function _o(){var ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return ca=Xg(0,Number.MAX_SAFE_INTEGER),w.log("%s request opid: %d",K,ca),_c.abrupt("return",He(j,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:w.context.sid,opid:ca,appid:w.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:F!=null?F:w.context.key,cname:w.context.uid,uid:0,detail:wa({},P===void 0?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(ch){return ch===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):ch}).join(",")})}}]},signal:_e.signal}));case 3:case"end":return _c.stop()}},_o)}))).pipe(Ja(function(_o){return _o.name!=="AbortError"&&(w.logError(_o),w.warn("The AP server %s request failure",j,_o)),yb}),fb(function(){var _o=J(x.mark(function ca(_c){var ch,Nf,bh,_g,_v,h0,A0,M0,R0,k0,G0,pI,u0,C0,v0,T0,Qv,r0,a0;return x.wrap(function(I0){for(;;)switch(I0.prev=I0.next){case 0:if(ch=_c.responseText,Nf=JSON.parse(ch),w.log("The %s response is %o",K,Nf),((bh=Nf.response_body)===void 0||bh.length===0||bh.some(function(O0){var nI;return((nI=O0.buffer)===null||nI===void 0?void 0:nI.code)===void 0||O0.uri!==23}))&&Z(new da("cloud proxy response_body not valid",Bg)),(_g=bh.filter(function(O0){return O0.buffer.code!==0})).length===0){I0.next=14;break}if((_v=_g.find(function(O0){return O0.buffer.flag===128}))===void 0){I0.next=12;break}return I0.abrupt("return",w.handleUniLbsError(_v.buffer.code,j));case 12:return w.logError("cloud proxy error response"),I0.abrupt("return",w.handleUniLbsError(_g[0].buffer.code,j));case 14:for(h0=[],A0=0;A0<bh.length;A0++)if(((k0=bh[A0])==null||(M0=k0.buffer)===null||M0===void 0?void 0:M0.flag)===262144)(G0=k0.buffer)===null||G0===void 0||(pI=G0.edges_services)===null||pI===void 0||(u0=pI.forEach)===null||u0===void 0||u0.call(pI,function(O0){Ln(O0=O0.ip)&&w.context.cloudProxyServers.indexOf(O0)===-1&&(w.log("got cloud proxy server: %s",O0),w.context.cloudProxyServers.push(O0))});else if((k0==null||(R0=k0.buffer)===null||R0===void 0?void 0:R0.flag)===128){for(Qv=function(O0,nI){var U0=nI[O0];h0.some(function(_I){return _I.ip===U0.ip})||h0.push({ip:U0.ip,ticket:k0.buffer.cert})},r0=0,a0=k0.buffer.edges_services;r0<a0.length;r0++)Qv(r0,a0);w.context.rtmArea=(C0=(v0=k0.buffer)===null||v0===void 0||(T0=v0.detail)===null||T0===void 0?void 0:T0[9])!==null&&C0!==void 0?C0:""}return I0.abrupt("return",eb.apply(void 0,G(h0).concat([yg])));case 19:case"end":return I0.stop()}},ca)}));return function(ca){return _o.apply(this,arguments)}}()),Ja(function(_o){return ta(_o)?Z(_o):yb}),Qg(),zb(function(_o){return _o!==void 0&&typeof _o.ip=="string"&&typeof _o.ticket=="string"&&Ln(_o.ip)}))}),m(n(w),"fetchAp",function(j,F){var K=fj("AP-",w.loggerId);w.log("The AccessPoint requests %s(%s)",j,K);var _e=new AbortController;return w.apFinish$.pipe(Pa(1)).subscribe(function(){return _e.abort()}),hd(J(x.mark(function _o(){var ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return ca=Xg(0,Number.MAX_SAFE_INTEGER),w.log("%s request opid: %d",K,ca),_c.abrupt("return",He(j,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:ca,key:F||w.context.key,cname:w.context.uid,detail:wa({},P===void 0?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(ch){return ch===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):ch}).join(",")}),uid:0,sid:w.context.sid},signal:_e.signal}));case 3:case"end":return _c.stop()}},_o)}))).pipe(Ja(function(_o){return _o.name!=="AbortError"&&(w.logError(_o),w.warn("The AP server %s request failure",j,_o)),yb}),fb(function(){var _o=J(x.mark(function ca(_c){var ch,Nf,bh,_g,_v,h0,A0,M0;return x.wrap(function(R0){for(;;)switch(R0.prev=R0.next){case 0:if(ch=_c.responseText,Nf=JSON.parse(ch),w.log("The %s response is %o",K,Nf),_g=(bh=Nf).code,_v=bh.addresses,h0=bh.detail,_g===0){R0.next=6;break}return R0.abrupt("return",w.handleUniLbsError(_g,j));case 6:if(A0=_v,Pd(null)&&(M0=JSON.parse(null.replace(/-/g,".")),A0=M0.map(function(k0){return{ip:k0,ticket:A0[0].ticket}})),A0.length!==0){R0.next=11;break}return R0.abrupt("return",Z(Error("No available edge address to connect")));case 11:return w.context.rtmArea=h0==null?void 0:h0[9],R0.abrupt("return",eb.apply(void 0,G(A0).concat([yg])));case 13:case"end":return R0.stop()}},ca)}));return function(ca){return _o.apply(this,arguments)}}()),Qg(),Ja(function(_o){return ta(_o)?Z(_o):yb}),zb(function(_o){return _o!==void 0&&typeof _o.ip=="string"&&typeof _o.ticket=="string"}))}),w.context=h,w.getApEdgeInfoEndFirst$=function(){var j=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return Kc(0,j||_?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(1),ba(function(){w.retryCount+=1}),fb(function(){return w.context.config.enableCloudProxy||w.context.socketUseProxy?w.getProxyApUrl$(j||_):(4<=w.retryCount&&(w.retryCount=0),3>=w.retryCount?w.getApUrl$(j||_):w.getBackupApUrl$(j||_))}),fb(function(F){return w.context.config.enableCloudProxy||w.context.socketUseProxy?w.fetchCloudProxy(F):w.fetchAp(F)}),Ja(function(F){return F instanceof sb&&w.warn("AP request timeout"),Z(F)}),rn(function(F){return F.ip}),rb(w.apFinish$))},w.getApEdgeInfo$=function(j){return Kc(0,j||_?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(8),ba(function(){w.retryCount+=1}),fb(function(){return w.context.config.enableCloudProxy||w.context.socketUseProxy?w.getProxyApUrl$(j||_):3>=w.retryCount?w.getApUrl$(j||_):w.getBackupApUrl$(j||_)}),fb(function(F){return(w.context.config.enableCloudProxy||w.context.socketUseProxy?w.fetchCloudProxy(F):w.fetchAp(F)).pipe()}),Ja(function(F){return F instanceof sb&&w.warn("AP request timeout"),Z(F)}),rn(function(F){return F.ip}),rb(w.apFinish$))},w}ja(i,o);var s=ka(i);return Ia(i,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),i}(wb());m(at,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var bt=ni(),ct=function(o){function i(h,f,_){X(this,i);var w=s.call(this,f,"Connection");m(n(w),"apClient",void 0),m(n(w),"lastOpenSockets",[new Ee(1),new Ee(1)]),m(n(w),"curOpenSockets",[void 0,void 0]),m(n(w),"ipIterator",0),m(n(w),"loginSocketOpenFailureCount",0),m(n(w),"firstEnv",.5<=Math.random()?1:0),m(n(w),"firstSocketOpener",void 0),m(n(w),"secondSocketOpener",void 0),m(n(w),"firstOpenKeeperSubject",new Ua),m(n(w),"secondOpenKeeperSubject",new Ua),m(n(w),"blacklistedIP",{}),m(n(w),"edgeInfoReplayed",void 0),m(n(w),"firstEnvOpenSocket",void 0),m(n(w),"firstOpenKeeperSub",void 0),m(n(w),"secondOpenKeeperSub",void 0),m(n(w),"context",void 0),m(n(w),"logger",void 0),w.context=h,w.logger=f,w.apClient=new at(w.context,f),w.apClient.apFinish$.subscribe(function(){w.log("Ap client fetch finished")});var j,F=[];return w.edgeInfoReplayed=w.apClient.getApEdgeInfo$(_).pipe(Ce(function(K){return K.pipe(ba(function(_e){if(ta(_e))throw _e}),jd(_?ie.getParameter("RECONNECTING_AP_INTERVAL"):900),rb(Kc(2e4)))}),zb(function(K){var _e;return!Kl(F,K)&&1>=((_e=w.blacklistedIP[K.ip])!==null&&_e!==void 0?_e:0)}),Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),ba(function(K){F.push(K),w.log("An edge info got %o",K)}),ba({error:function(K){w.emit("connectionInitFailure",K)}}),Tg(function(){w.apClient.clearUp()}),vn()),w.firstEnvOpenSocket=w.edgeInfoReplayed.pipe(fb(function(K){if(K===void 0)return Z(Error("Invalid edge info"));var _e=new Sl(K.ip,w.firstEnv,K.ticket,w.context,f,j);if(w.firstEnv=w.firstEnv===1?0:1,_e.once("connectionFailure",function(){return w.onSocketConnectionFailure(_e)}),!_&&lc.ENABLE_EDGE_AUTO_FALLBACK&&!w.context.config.enableCloudProxy){var _o,ca=Date.now();_e.on("reconnect",function(){var _c;w.loginSocketOpenFailureCount+=1,(_c=_o)!==null&&_c!==void 0||(_o=Date.now()-ca),500>_o&&1<w.loginSocketOpenFailureCount&&(w.context.socketUseProxy=!0)})}return j=!_e.useNewDomain,_e.open$.pipe(If(_e))}),ba(function(K){w.log("The websocket of ENV_%d opened to %s:%d",K.env,K.ip,rf[K.env]),w.curOpenSockets[K.env]=K,w.lastOpenSockets[K.env].next(K),w.firstEnv=K.env,w.openSecondSocket(K.env,K.ip,K.useNewDomain)}),Pa(1),De()),w.firstSocketOpener=w.firstEnvOpenSocket.pipe(fb(function(K){return K.open$.pipe(ba(function(){w.log("The websocket of first ENV_%d re-opened to %s:%d",K.env,K.ip,rf[K.env]),w.curOpenSockets[K.env]=K,w.lastOpenSockets[K.env].next(K)}))})),h=w.firstOpenKeeperSubject.pipe(Lc(ed)),w.firstOpenKeeperSub=h.subscribe({error:w.logError}),w}ja(i,o);var s=ka(i);return Ia(i,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(h,f){if(![0,1].includes(h))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});var _=h===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var w=this.curOpenSockets[h];this.curOpenSockets[h]=void 0,w&&(w.isActiveClose=!0,setTimeout(function(){w.close()},f)),_!==void 0&&setTimeout(function(){_==null||_.unsubscribe()},f)}},{key:"waitClosing",value:function(h){var f=this;return h.isActiveClose=!0,h.open$.pipe(nv(),Ja(function(_){return _.message===qs.normalClosureMessage?yb:Z(_)}),kb(5e3),Ja(function(_){return _ instanceof sb?(f.warn("Force closing the ENV_%d connection",h.env),yb):Z(_)}))}},{key:"onSocketConnectionFailure",value:function(h){var f=[0,1].filter(function(_){return _!==h.env})[0];(f=this.curOpenSockets[f])&&f.loggedIn?this.reopenSocketWithApRequest(h.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(h,f,_){var w=this,j=h===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(un(function(F,K){return[].concat(G(F),[K])},[]),ea(function(F){return os(F,function(K){return On(f,K.ip)}).slice(-1)[0]}),Pa(1),fb(function(F){if(F===void 0)return Z(Error("Invalid edge info"));var K=new Sl(F.ip,j,F.ticket,w.context,w.logger,_);return K.on("connectionFailure",function(){return w.onSocketConnectionFailure(K)}),K.open$.pipe(ba(function(){w.lastOpenSockets[j].next(K),w.curOpenSockets[j]=K}))}),De()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Lc(ed)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(h){var f=this,_=[0,1].filter(function(F){return F!==h})[0];if((_=this.curOpenSockets[_])!==void 0){var w,j=_.ip;_=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Ce(function(F){return F.pipe(ba(function(K){if(K.code===ii)f.emit("tokenExpired"),f.apClient.apFinish$.next(void 0);else if(ta(K))throw K}),jd(ie.getParameter("RECONNECTING_AP_INTERVAL")),rb(Kc(15e3)))}),ba(function(F){f.log("An edge info got %o",F)}),Tg(function(){f.apClient.clearUp()})).pipe(un(function(F,K){return[].concat(G(F),[K])},[]),ea(function(F){return(F=os(F,function(K){return On(j,K.ip)})).length-1>=f.ipIterator?F.slice(-f.ipIterator++-1)[0]:(f.ipIterator=0,F.slice(-1)[0])}),Md(),fb(function(F){if(F===void 0)return Z(Error("Invalid edge info"));var K=new Sl(F.ip,h,F.ticket,f.context,f.logger,w);return K.on("connectionFailure",function(){return f.onSocketConnectionFailure(K)}),w=!K.useNewDomain,K.open$.pipe(If(K))}),ba(function(F){f.log("The websocket of ENV_%d re-opened to %s:%d using ap",F.env,F.ip,rf[F.env]),f.curOpenSockets[h]=F,f.lastOpenSockets[h].next(F)}),fb(function(F){return F.open$.pipe(ba(function(){f.log("The websocket of ENV_%d re-opened to %s:%d",F.env,F.ip,rf[F.env]),f.curOpenSockets[h]=F,f.lastOpenSockets[h].next(F)}))}),De()),h===this.firstEnv?this.firstOpenKeeperSubject.next(_):this.secondOpenKeeperSubject.next(_)}}}]),i}(wb()),cd=nc.Writer,oa=nc.util,Gc=nc.roots.default||(nc.roots.default={}),NE=Gc.Session=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.appId="",o.prototype.ver="",o.prototype.buildno=0,o.prototype.installId="",o.prototype.os=0,o.prototype.did="",o.prototype.index=null,o.prototype.token="",o.prototype.version=0,o.prototype.subVersion=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.appId!=null&&Object.hasOwnProperty.call(i,"appId")&&s.uint32(42).string(i.appId),i.ver!=null&&Object.hasOwnProperty.call(i,"ver")&&s.uint32(50).string(i.ver),i.buildno!=null&&Object.hasOwnProperty.call(i,"buildno")&&s.uint32(56).int32(i.buildno),i.installId!=null&&Object.hasOwnProperty.call(i,"installId")&&s.uint32(66).string(i.installId),i.os!=null&&Object.hasOwnProperty.call(i,"os")&&s.uint32(128).int32(i.os),i.did!=null&&Object.hasOwnProperty.call(i,"did")&&s.uint32(138).string(i.did),i.index!=null&&Object.hasOwnProperty.call(i,"index")&&Gc.Session.CommonIndex.encode(i.index,s.uint32(162).fork()).ldelim(),i.token!=null&&Object.hasOwnProperty.call(i,"token")&&s.uint32(170).string(i.token),i.version!=null&&Object.hasOwnProperty.call(i,"version")&&s.uint32(176).int32(i.version),i.subVersion!=null&&Object.hasOwnProperty.call(i,"subVersion")&&s.uint32(184).int32(i.subVersion),s},o.CommonIndex=function(){function i(s){if(s)for(var h=Object.keys(s),f=0;f<h.length;++f)s[h[f]]!=null&&(this[h[f]]=s[h[f]])}return i.prototype.index1="",i.prototype.index2="",i.prototype.index3="",i.encode=function(s,h){return h||(h=cd.create()),s.index1!=null&&Object.hasOwnProperty.call(s,"index1")&&h.uint32(10).string(s.index1),s.index2!=null&&Object.hasOwnProperty.call(s,"index2")&&h.uint32(18).string(s.index2),s.index3!=null&&Object.hasOwnProperty.call(s,"index3")&&h.uint32(26).string(s.index3),h},i}(),o}(),OE=Gc.Link=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.ec=0,o.prototype.sc=0,o.prototype.destServerIp="",o.prototype.ackedServerIp="",o.prototype.responseTime=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.ec!=null&&Object.hasOwnProperty.call(i,"ec")&&s.uint32(40).int32(i.ec),i.sc!=null&&Object.hasOwnProperty.call(i,"sc")&&s.uint32(48).int32(i.sc),i.destServerIp!=null&&Object.hasOwnProperty.call(i,"destServerIp")&&s.uint32(58).string(i.destServerIp),i.ackedServerIp!=null&&Object.hasOwnProperty.call(i,"ackedServerIp")&&s.uint32(66).string(i.ackedServerIp),i.responseTime!=null&&Object.hasOwnProperty.call(i,"responseTime")&&s.uint32(72).int32(i.responseTime),s},o}(),PE=Gc.Logout=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),s},o}(),QE=Gc.KickedOff=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.linkId=0,o.prototype.code=0,o.prototype.server="",o.prototype.serverCode=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.linkId!=null&&Object.hasOwnProperty.call(i,"linkId")&&s.uint32(48).int32(i.linkId),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&s.uint32(56).int32(i.code),i.server!=null&&Object.hasOwnProperty.call(i,"server")&&s.uint32(66).string(i.server),i.serverCode!=null&&Object.hasOwnProperty.call(i,"serverCode")&&s.uint32(72).int32(i.serverCode),s},o}(),RE=Gc.ChnJoin=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&s.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&s.uint32(56).int32(i.errCode),s},o}(),SE=Gc.ChnJoinRes=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.prototype.serverErrCode=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&s.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&s.uint32(56).int32(i.errCode),i.serverErrCode!=null&&Object.hasOwnProperty.call(i,"serverErrCode")&&s.uint32(64).int32(i.serverErrCode),s},o}(),TE=Gc.ChnLeave=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&s.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&s.uint32(56).int32(i.errCode),s},o}(),UE=Gc.ConnectionStateChange=function(){function o(i){if(i)for(var s=Object.keys(i),h=0;h<s.length;++h)i[s[h]]!=null&&(this[s[h]]=i[s[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.oldState=0,o.prototype.newState=0,o.prototype.reason=0,o.prototype.reconnId=0,o.encode=function(i,s){return s||(s=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&s.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&s.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&s.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&s.uint32(32).int64(i.elapse),i.oldState!=null&&Object.hasOwnProperty.call(i,"oldState")&&s.uint32(40).int32(i.oldState),i.newState!=null&&Object.hasOwnProperty.call(i,"newState")&&s.uint32(48).int32(i.newState),i.reason!=null&&Object.hasOwnProperty.call(i,"reason")&&s.uint32(56).int32(i.reason),i.reconnId!=null&&Object.hasOwnProperty.call(i,"reconnId")&&s.uint32(64).int32(i.reconnId),s},o}(),aw=Object.freeze({__proto__:null,Session:NE,Link:OE,Logout:PE,KickedOff:QE,ChnJoin:RE,ChnJoinRes:SE,ChnLeave:TE,ConnectionStateChange:UE,default:Gc}),bw=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),VE=function(o){function i(h,f,_){return X(this,i),m(n(_=s.call(this,_,"Context")),"_token",void 0),m(n(_),"config",void 0),m(n(_),"_uid",void 0),m(n(_),"_sid",void 0),m(n(_),"_area","CN"),m(n(_),"_socketUseProxy",!1),m(n(_),"appId",void 0),m(n(_),"enableCloudProxy",!1),m(n(_),"cloudProxyServers",[]),_.appId=h,_.config=f,_}ja(i,o);var s=ka(i);return Ia(i,[{key:"socketUseProxy",get:function(){return this._socketUseProxy&&lc.ENABLE_EDGE_AUTO_FALLBACK},set:function(h){this.log("socketUseProxy is set to %s",h),this._socketUseProxy=h}},{key:"token",set:function(h){this._token=typeof h=="string"&&h?h:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new Ma("Cannot get illegal uid")},set:function(h){if(this.log("The user ID is set to %s",pa(h)),!Aa(h))throw new Ma;this._uid=h}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new Ma("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new Ma("Cannot get illegal sid")},set:function(h){if(this.log("sid is set to %s",h),typeof h!="string"||!h)throw new Ma;this._sid=h}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new Ma("Cannot get illegal area")},set:function(h){this.log("area is set to %s",h),typeof h=="string"&&h?this._area=h:this.warn("set area failed")}}]),i}(wb()),WE=!!Nc&&R(function(){Nc.prototype.finally.call({then:function(){}},function(){})});if(M({target:"Promise",proto:!0,real:!0,forced:WE},{finally:function(o){var i=od(this,Rb("Promise")),s=typeof o=="function";return this.then(s?function(h){return bk(i,o()).then(function(){return h})}:o,s?function(h){return bk(i,o()).then(function(){throw h})}:o)}}),typeof Nc=="function"){var dt=Rb("Promise").prototype.finally;Nc.prototype.finally!==dt&&Ea(Nc.prototype,"finally",dt,{unsafe:!0})}var XE=function(){var o=J(x.mark(function i(s){return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=Uint8Array,h.next=3,crypto.subtle.digest("SHA-256",s);case 3:return h.t1=h.sent,h.abrupt("return",new h.t0(h.t1));case 5:case"end":return h.stop()}},i)}));return function(i){return o.apply(this,arguments)}}(),et=function(o){return Array.from(o).map(function(i){return i.toString(16).padStart(2,"0")}).join("")},YE=function(o){if(typeof o!="string")throw new TypeError("Expected input to be a string");if(o.length%2!=0)throw new RangeError("Expected string to be an even number of characters");for(var i=new Uint8Array(o.length/2),s=0;s<o.length;s+=2)i[s/2]=parseInt(o.substring(s,s+2),16);return i},ft=function(o){return btoa(String.fromCharCode.apply(String,G(o))).replace(/={1,2}$/,"")},gt=function(){var o=J(x.mark(function i(s){var h;return x.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,crypto.subtle.digest("SHA-1",s);case 3:h=f.sent,f.next=9;break;case 6:f.prev=6,f.t0=f.catch(0),h=sha1.arrayBuffer(s);case 9:return f.abrupt("return",ft(new Uint8Array(h)));case 10:case"end":return f.stop()}},i,null,[[0,6]])}));return function(i){return o.apply(this,arguments)}}(),ht=function(o,i,s,h){h[i]=!0,s.has(o)?s.get(o).add(i):s.set(o,new Set([i]))},ZE=function(o){switch(o){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},it=function(o){function i(h,f,_,w){X(this,i);var j=s.call(this,_,"ChunkDownloadManager");if(m(n(j),"abortController",new AbortController),m(n(j),"downloadedSize",0),m(n(j),"successCount",0),m(n(j),"timer",void 0),m(n(j),"chunks",[]),m(n(j),"retUnit",void 0),m(n(j),"singleThread",!1),m(n(j),"initialized",!1),m(n(j),"ee",void 0),m(n(j),"chunkCount",void 0),m(n(j),"aborted",!1),m(n(j),"serverToIndices",new Map),m(n(j),"backupToIndices",new Map),m(n(j),"indexToBackupServers",[]),m(n(j),"busyBackupServers",new Map),m(n(j),"downloadingChunks",new Set),m(n(j),"metaInfo",void 0),m(n(j),"transHandler",void 0),j.metaInfo=h,j.transHandler=f,j.ee=w===void 0?new ia:w,_=h.size,h=h.unit,_===0)throw new Ma("size cannot be 0");return f.cancelSignal!==void 0&&f.cancelSignal.addEventListener("abort",function(){j.abortController.abort()},{once:!0}),j.abortController.signal.addEventListener("abort",function(){j.aborted=!0},{once:!0}),j.chunkCount=Math.ceil(_/(32768*h)),j}ja(i,o);var s=ka(i);return Ia(i,[{key:"setInfoByResponse",value:function(h){var f=this,_=h.serverList,w=h.backupList;if(h=h.unit,_.length<this.chunkCount&&w.length<this.chunkCount)throw new Ma("servers is not enough");this.updateProgress(0),this.initialized=!0;var j=Array(this.chunkCount).fill(!1);if(_.forEach(function(F,K){return F.forEach(function(_e){return ht(_e,K,f.serverToIndices,j)})}),w.forEach(function(F,K){return F.forEach(function(_e){return ht(_e,K,f.backupToIndices,j)})}),j.some(function(){return!1}))throw new da("Not enough servers to download",Eg);this.indexToBackupServers=w.map(function(F){return new Set(F)}),this.retUnit=h}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):this.serverToIndices.size===1&&Array.from(this.serverToIndices.keys())[0]===0?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new da("not enough servers to download",Eg))}},{key:"updateProgress",value:function(h){var f=this,_=this.downloadedSize+h;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new bd("Invalid download size",Eg))):(this.downloadedSize=_,this.timer!==void 0&&h!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&this.successCount!==this.chunkCount&&(this.timer=setTimeout(function(){f.ee.emit("timedOut"),f.abortController.abort()},12e4)),this.initialized&&h===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var h=0,f=0,_=this.chunks;f<_.length;f++)h+=_[f].byteLength;if(h!==this.metaInfo.size)throw new Ma("invalid chunks total size");h=new Uint8Array(h),_=f=0;for(var w=this.chunks;_<w.length;_++){var j=w[_];h.set(new Uint8Array(j),f),f+=j.byteLength}return f=Array.from(h.subarray(0,4)).map(function(F){return F.toString(16)}).join("").toUpperCase(),Uv(h.buffer,ZE(f))}},{key:"getDownloadUrl",value:function(h){var f=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(h).split(".").join("-"),".edge.").concat(Pd(null)?null:f,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var h=J(x.mark(function f(_){var w,j=this,F=arguments;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return w=1<F.length&&F[1]!==void 0&&F[1],K.next=3,Promise.all(Array.from(_.entries()).map(function(_e){return _e=ua(_e,2),j.postDownloadRequest(_e[0],Array.from(_e[1]),w).catch(function(_o){_o.statusCode===404?(j.ee.emit("notExist"),j.abortController.abort()):_o.name!=="AbortError"&&(Xa(_o)?j.singleThread?(j.abortController.abort(),j.ee.emit("timedOut")):(j.warn("%d download timed out after %d, retrying use single thread",_o.index,j.singleThread?6e4:3e4),j.abortController.abort(),j.singleThread=!0,j.ee.emit("multiTimeOut")):(j.ee.emit("error",_o),j.abortController.abort()))})}));case 3:case"end":return K.stop()}},f)}));return function(f){return h.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var h=J(x.mark(function f(_,w,j){var F,K,_e,_o,ca,_c,ch,Nf,bh,_g=this;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:if(bh=function(){return(bh=J(x.mark(function h0(A0){var M0,R0,k0,G0,pI,u0,C0,v0,T0;return x.wrap(function(Qv){for(;;)switch(Qv.prev=Qv.next){case 0:if(Qv.prev=0,A0!==void 0||_!==0){Qv.next=5;break}throw new Ma("Invalid serverIp");case 5:M0=A0===void 0?ch.getDownloadUrl(_):A0;case 6:return ch.downloadingChunks.add(F),Qv.next=9,_c(M0);case 9:return R0=Qv.sent,k0=R0.responseData,ch.downloadingChunks.delete(F),Qv.abrupt("return",k0);case 15:if(Qv.prev=15,Qv.t0=Qv.catch(0),ch.downloadingChunks.delete(F),w.unshift(F),ch.metaInfo.useNewDomain=!1,Qv.t0.name!=="AbortError"){Qv.next=22;break}throw Qv.t0;case 22:if(!Xa(Qv.t0)){Qv.next=25;break}throw Qv.t0.index=F,Qv.t0;case 25:if(G0=_o,_o+=1,!(2>G0)){Qv.next=30;break}return Qv.t0 instanceof Ma||ch.warn("%o, %d download failed, retrying",Qv.t0,F),Qv.abrupt("return",Nf());case 30:if(Qv.t0.statusCode!==504){Qv.next=34;break}throw(pI=new gb("download server timed out",{originalError:Qv.t0,serverCode:504})).index=F,pI;case 34:if(!j||G0!==2||ca[0]===0){Qv.next=45;break}return Qv.t0 instanceof Ma||ch.warn("%d download failed, using backup: %d, %o",F,ca[0],Qv.t0),Qv.next=38,ch.busyBackupServers.get(ca[0]);case 38:return u0=Nf(ch.getDownloadUrl(ca[0])),ch.busyBackupServers.set(ca[0],u0),Qv.next=42,u0;case 42:return C0=Qv.sent,ch.busyBackupServers.delete(ca[0]),Qv.abrupt("return",C0);case 45:if(!(j&&2<G0&&ca[1]!==void 0&&ca[1]!==0)){Qv.next=56;break}return ch.warn("%d download failed, using backup 1: %d",F,ca[1]),Qv.next=49,ch.busyBackupServers.get(ca[1]);case 49:return v0=Nf(ch.getDownloadUrl(ca[1])),ch.busyBackupServers.set(ca[1],v0),Qv.next=53,v0;case 53:return T0=Qv.sent,ch.busyBackupServers.delete(ca[1]),Qv.abrupt("return",T0);case 56:throw Qv.t0.index=F,Qv.t0;case 58:case"end":return Qv.stop()}},h0,null,[[0,15]])}))).apply(this,arguments)},Nf=function(h0){return bh.apply(this,arguments)},!this.aborted){_v.next=4;break}throw new Ma("download already aborted");case 4:if((F=w.shift())!==void 0){_v.next=8;break}return this.log("%s download finished",_),_v.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){_v.next=10;break}return _v.abrupt("return");case 10:if(!this.downloadingChunks.has(F)){_v.next=13;break}return this.log("%s already downloading, return",F),_v.abrupt("return");case 13:if(this.chunks[F]===void 0){_v.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",F),_v.next=18,this.postDownloadRequest(_,w,j);case 18:return _v.abrupt("return");case 19:return K=new FormData,_e={hash:cw(this.metaInfo.hashHexStr),unit:this.retUnit===void 0?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:F},K.append("parameter",JSON.stringify(_e)),_o=0,ca=Array.from(this.indexToBackupServers[F]),_c=function(h0){return He(h0,{body:K,signal:_g.abortController.signal,timeout:_g.singleThread?12e4:3e4},{useBinaryResponse:!0})},ch=this,_v.next=28,Nf().then(function(h0){return _g.chunks[F]!==void 0?_g.log("chunk %d download duplicated",F):(_g.chunks[F]=h0,_g.log("chunk %d downloaded",F),_g.successCount+=1,_g.updateProgress(_g.chunks[F].byteLength)),_g.successCount===_g.chunkCount&&(_g.log("chunks all download"),_g.ee.emit("finished")),_g.singleThread?(_g.downloadChunks(),Promise.resolve()):_g.postDownloadRequest(_,w,j)});case 28:case"end":return _v.stop()}},f,this)}));return function(f,_,w){return h.apply(this,arguments)}}()}]),i}(wb()),jt=function(o){function i(h,f,_,w){X(this,i);var j=s.call(this,_,"ChunkUploadManager");if(m(n(j),"chunkCount",0),m(n(j),"chunks",[]),m(n(j),"uploadedChunks",[]),m(n(j),"totalFailures",0),m(n(j),"timer",void 0),m(n(j),"initState","uninitialized"),m(n(j),"ee",void 0),m(n(j),"unit",0),m(n(j),"uploadedSize",0),m(n(j),"singleThread",!1),m(n(j),"abortController",new AbortController),m(n(j),"servers",[]),m(n(j),"aborted",!1),m(n(j),"metaInfo",void 0),m(n(j),"transHandler",void 0),j.metaInfo=h,j.transHandler=f,j.ee=w===void 0?new ia:w,h.file.length===0)throw new H("file not found or is empty",Of);return f.cancelSignal!==void 0&&f.cancelSignal.addEventListener("abort",function(){j.abortController.abort()},{once:!0}),j.abortController.signal.addEventListener("abort",function(){j.aborted=!0},{once:!0}),j}ja(i,o);var s=ka(i);return Ia(i,[{key:"initChunks",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o=this;return x.wrap(function(ca){for(;;)switch(ca.prev=ca.next){case 0:if(this.initState!=="initialized"&&this.initState!=="initializing"){ca.next=2;break}throw new Ma("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=_,w=this.sliceFile(_,this.metaInfo.file),this.chunkCount=w.length,j=[],F=function(_c,ch){var Nf=(_c=ua(ch[_c],2))[0],bh=_c[1];_c=gt(bh).then(function(_g){_o.chunks[Nf]={payload:bh,sha1:_g,uploadedTo:void 0,index:Nf,processed:!1}}),j.push(_c)},K=0,_e=Array.from(w.entries());K<_e.length;K++)F(K,_e);return ca.next=11,Promise.all(j);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return ca.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var h=this;if(!this.aborted){for(var f=this.chunks.filter(function(j){return!j.processed}),_=function(j){var F=f[j],K=h.servers.filter(function(_o){return!_o.isUploading}).sort(function(_o,ca){return _o.successCount-ca.successCount}).sort(function(_o,ca){return _o.failureCount-ca.failureCount})[0];if(K===void 0||1<K.failureCount)return h.log("Upload server not available, waiting"),h.ee.emit("serverUsedUp"),gj(1e3).then(function(){h.totalFailures>2*h.chunkCount&&h.ee.emit("error"),h.totalFailures+=1,K!==void 0&&(K.failureCount=0),h.uploadToServers()}).catch(function(){}),"break";F.processed=!0,K.isUploading=!0,h.log("uploading chunk %d to server %s",F.index,$g(K.ip));var _e=h.getUploadUrl(K.ip);return J(x.mark(function _o(){var ca;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return _c.prev=0,_c.next=3,h.postChunk(F.payload,_e,F.index);case 3:ca=h.chunks.findIndex(function(ch){return ch===F}),F.uploadedTo=K.ip,h.chunks.splice(ca,1),h.uploadedChunks.push(F),K.successCount+=1,K.isUploading=!1,h.updateProgress(F.payload.byteLength),h.log("upload chunk %d successfully",F.index),_c.next=31;break;case 13:if(_c.prev=13,_c.t0=_c.catch(0),K.isUploading=!1,F.processed=!1,_c.t0.statusCode!==504&&!Xa(_c.t0)){_c.next=27;break}if(h.singleThread){_c.next=24;break}return h.warn("%d upload timed out after %d, retrying use single thread",F.index,h.singleThread?12e4:3e4),h.abortController.abort(),h.singleThread=!0,h.ee.emit("multiTimeOut"),_c.abrupt("return");case 24:return h.ee.emit("timedOut"),h.abortController.abort(),_c.abrupt("return");case 27:return h.metaInfo.useNewDomain=!1,K.failureCount+=1,_c.next=31,gj(1e3);case 31:h.uploadedChunks.length===h.chunkCount?(h.log("chunks uploaded"),h.ee.emit("finished")):(h.singleThread||h.chunks.filter(function(ch){return!ch.processed}).length===1)&&h.uploadToServers();case 32:case"end":return _c.stop()}},_o,null,[[0,13]])}))(),h.singleThread?"break":void 0},w=0;w<f.length&&_(w)!=="break";w++);f.length===0&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var h=!0,f=[],_=G(this.uploadedChunks).sort(function(F,K){return F.index-K.index}),w=0;for(_=Array.from(_.values());w<_.length;w++){var j=_[w].uploadedTo;if(j===void 0){h=!1;break}f.push(j)}if(!h)throw new Ma("some chunks not uploaded, cannot get upload server ips");return f}},{key:"addServers",value:function(h){var f=this;h.forEach(function(_){var w=f.servers.findIndex(function(j){return j.ip===_});w!==-1?f.servers[w].failureCount=0:(f.log("server %s added",$g(_)),f.servers.push({successCount:0,isUploading:!1,ip:_,failureCount:0}))})}},{key:"updateProgress",value:function(h){var f=this,_=h!==void 0?this.uploadedSize+h:this.metaInfo.file.length;_>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new bd("Invalid upload size",Dg))):(this.uploadedSize=_,this.timer!==void 0&&h!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&h!==void 0&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout(function(){f.ee.emit("timedOut"),f.abortController.abort()},12e4)),this.initState==="initialized"&&h===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(h,f){var _=0,w=[],j=f.length;for(h*=32768;_<j;)w.push(f.slice(_,_+h)),_+=h;return this.log("chunks split into %d",w.length),w}},{key:"postChunk",value:function(){var h=J(x.mark(function f(_,w,j){var F,K,_e,_o,ca,_c,ch,Nf;return x.wrap(function(bh){for(;;)switch(bh.prev=bh.next){case 0:if(!this.aborted){bh.next=2;break}throw new Ma("upload already aborted");case 2:if(this.unit!==void 0){bh.next=4;break}throw new Ma("unit is undefined");case 4:return F=this.metaInfo,K=F.ticket,_e=F.instance,_o=F.loginOpt,ca=F.hashStr,bh.t0=j,bh.t1=ca,bh.next=9,gt(_);case 9:return bh.t2=bh.sent,bh.t3=this.unit,bh.t4=K,bh.t5=_e,bh.t6=_o,_c={index:bh.t0,hash:bh.t1,sha1:bh.t2,unit:bh.t3,ticket:bh.t4,instance:bh.t5,loginOpt:bh.t6},(ch=new FormData).append("parameter",JSON.stringify(_c)),ch.append("payload",new Blob([_])),bh.next=20,He(w,{headers:{Accept:"application/json"},body:ch,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(Nf=bh.sent,Nf.status===201){bh.next=24;break}throw new da("uploading chunk ".concat(j," failed"));case 24:case"end":return bh.stop()}},f,this)}));return function(f,_,w){return h.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(h){var f=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(h).split(".").join("-"),".edge.").concat(Pd(null)?null:f,":9601/api/v1/chuck/upload")}}]),i}(wb()),kt=function(o){function i(h){X(this,i);var f=s.call(this,h,"MediaTaskManager");return m(n(f),"isProcessing",!1),m(n(f),"authInfo",void 0),m(n(f),"taskFinishers",{}),m(n(f),"mediaTasks",new Map),m(n(f),"ongoingTask",void 0),f.on("connectionStateChanged",function(_){if(_===S.ConnectionState.ABORTED||_===S.ConnectionState.DISCONNECTED){f.ongoingTask!==void 0&&f.cancelTask(f.ongoingTask),_=0;for(var w=Array.from(f.mediaTasks.entries());_<w.length;_++){var j=ua(w[_],2)[1];f.cancelTask(j)}f.mediaTasks.clear(),f.taskFinishers={}}else _===S.ConnectionState.RECONNECTING?f.ongoingTask!==void 0&&f.ongoingTask.manager.abortController.abort():_===S.ConnectionState.CONNECTED&&f.ongoingTask!==void 0&&f.ongoingTask.manager.ee.emit("reconnected")}),f}ja(i,o);var s=ka(i);return Ia(i,[{key:"setAuthInfo",value:function(h){this.authInfo=h}},{key:"waitMediaTask",value:function(h){var f=this;return new Promise(function(_,w){f.taskFinishers[h]={resolve:_,reject:w},f.isProcessing||f.processMediaTask()}).finally(function(){f.ongoingTask!==void 0&&f.ongoingTask.manager.timer!==void 0&&clearTimeout(f.ongoingTask.manager.timer),delete f.taskFinishers[h],f.mediaTasks.size!==0?f.processMediaTask():f.isProcessing=!1})}},{key:"addUploadTask",value:function(h,f,_,w){var j=h.file;if(h=h.hash,this.authInfo===void 0)throw new Ma("session not found");if(this.mediaTasks.size>=i.MAX_PENDING_TASK_COUNT-1)throw new lb("Upload media failed, exceed max pending jobs",tC);return w=new jt({hashStr:ft(h),file:j,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),useNewDomain:this.authInfo.useNewDomain},w,this.logger),j=de(),this.mediaTasks.set(j,{type:"UPLOAD",manager:w,hash:h,setter:_,fetcher:f,taskId:j}),j}},{key:"addDownloadTask",value:function(h,f,_){var w=h.hashHexStr,j=h.size,F=h.unit;if(h=h.zone,this.authInfo===void 0)throw new Ma("session not found");if(this.mediaTasks.size>=i.MAX_PENDING_TASK_COUNT-1)throw new lb("Download media failed, exceed max pending jobs",xC);return _=new it({hashHexStr:w,ticket:this.authInfo.ticket,useNewDomain:this.authInfo.useNewDomain,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:j,zone:h,unit:F},_,this.logger),w=de(),this.mediaTasks.set(w,{type:"DOWNLOAD",manager:_,fetcher:f,taskId:w}),w}},{key:"doDownloadTaskImpl",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch,Nf=this,bh=arguments;return x.wrap(function(_g){for(;;)switch(_g.prev=_g.next){case 0:return j=2<bh.length&&bh[2]!==void 0&&bh[2],K=F=_.manager,j&&(F=new it(K.metaInfo,K.transHandler,this.logger,K.ee)),_e=_.fetcher,_g.next=7,_e();case 7:if(_o=_g.sent,ca=_o.serverList,_c=_o.backupList,ch=_o.unit,!j||ch===K.retUnit){_g.next=13;break}throw new da("download unit is different, reject to continue",Eg);case 13:j&&(_.manager=F,F.downloadedSize=K.downloadedSize,F.successCount=K.successCount,F.timer=K.timer,F.chunks=K.chunks,F.initialized=K.initialized,F.singleThread=K.singleThread,F.updateProgress(0)),F.ee.once("reconnected",function(){F.ee.removeAllListeners(),Nf.doDownloadTaskImpl(_,w,!0).catch(function(_v){w.reject(_v)})}),F.ee.once("multiTimeOut",function(){F.ee.removeAllListeners(),Nf.doDownloadTaskImpl(_,w,!0).catch(function(_v){w.reject(_v)})}),F.ee.once("error",function(_v){F.ee.removeAllListeners(),w.reject(new da(["download file file, index %d",_v.index],{code:Eg,originalError:_v}))}),F.ee.once("notExist",function(){F.abortController.abort(),F.ee.removeAllListeners(),w.reject(new da("download file not found",wC))}),F.ee.once("timedOut",function(){F.ee.removeAllListeners(),F.abortController.abort(),w.reject(new gb("download timed out",vC))}),F.transHandler.cancelSignal!==void 0&&F.transHandler.cancelSignal.addEventListener("abort",function(){w.reject(new Ol("Downloading canceled",ms))},{once:!0}),F.ee.once("finished",function(){w.resolve({type:"DOWNLOAD",payload:F.getPayload()})}),F.setInfoByResponse({serverList:ca,backupList:_c,unit:ch}),F.downloadChunks();case 23:case"end":return _g.stop()}},f,this)}));return function(f,_){return h.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(h,f){var _=this,w=2<arguments.length&&arguments[2]!==void 0&&arguments[2],j=h.taskId;return w||(this.mediaTasks.delete(j),this.ongoingTask=h),new Promise(function(F,K){_.doDownloadTaskImpl(h,f,w).then(F).catch(K)})}},{key:"doUploadTaskImpl",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch,Nf,bh=this,_g=arguments;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return j=2<_g.length&&_g[2]!==void 0&&_g[2],K=F=_.manager,j&&(F=new jt(K.metaInfo,K.transHandler,this.logger,K.ee)),_e=_.fetcher,_o=new Ua,_c=new Promise(function(h0,A0){var M0=_e(),R0=M0.ret,k0=M0.err,G0=M0.timeout;M0.fin.pipe(rb(_o)).subscribe({next:function(pI){w.resolve({type:"UPLOAD",retUnit:pI.unit,zone:pI.zone})},complete:function(){h0({hasExist:!0}),_o.next(),_o.complete()}}),R0.pipe(rb(_o),fb(function(){var pI=J(x.mark(function u0(C0){var v0,T0;return x.wrap(function(Qv){for(;;)switch(Qv.prev=Qv.next){case 0:if(v0=C0.servers,T0=C0.unit,j&&K.unit!==T0?w.reject(new da("upload unit is different, reject to continue",Dg)):j&&(_.manager=F,F.chunkCount=K.chunkCount,F.chunks=K.chunks,F.totalFailures=K.totalFailures,F.uploadedChunks=K.uploadedChunks,F.timer=K.timer,F.initState=K.initState,F.unit=K.unit,F.uploadedSize=K.uploadedSize,F.singleThread=K.singleThread,F.updateProgress(0)),F.addServers(v0),F.initState!=="uninitialized"){Qv.next=7;break}return ca=F.initChunks(T0),Qv.next=7,ca;case 7:case"end":return Qv.stop()}},u0)}));return function(u0){return pI.apply(this,arguments)}}())).subscribe({complete:function(){return h0({hasExist:!1})},error:A0}),M0=function(pI){F.initState!=="uninitialized"&&ca?h0(ca.then(function(){return{hasExist:!1}})):A0(pI)},k0.pipe(rb(_o)).subscribe({error:M0}),G0.pipe(rb(_o)).subscribe({error:M0})}),_v.next=9,_c;case 9:if(ch=_v.sent,!ch.hasExist){_v.next=15;break}return F.updateProgress(),this.log("file already exists, skipping upload"),_v.abrupt("return");case 15:_o.next(),_o.complete(),this.log("chunks initialization promise resolved"),Nf=jb(F.ee,"serverUsedUp").pipe(Av(function(){return F.chunkCount!==F.uploadedChunks.length}),Dv(5e3,void 0,{leading:!1}),sn(function(){return _e().ret})).subscribe(function(h0){F.addServers(h0.servers)}),F.ee.once("reconnected",function(){F.ee.removeAllListeners(),bh.doUploadTask(_,w,!0).catch(function(h0){w.reject(h0)})}),F.ee.once("multiTimeOut",function(){F.ee.removeAllListeners(),bh.doUploadTask(_,w,!0).catch(function(h0){w.reject(h0)})}),F.ee.once("timedOut",function(){Nf.unsubscribe(),F.ee.removeAllListeners(),F.abortController.abort(),w.reject(new gb("upload timed out",ji))}),F.ee.once("error",function(h0){Nf.unsubscribe(),F.ee.removeAllListeners(),F.abortController.abort(),w.reject(h0||new da("upload error",Dg))}),F.transHandler.cancelSignal!==void 0&&F.transHandler.cancelSignal.addEventListener("abort",function(){w.reject(new Ol("Uploading canceled",ls))},{once:!0}),F.ee.once("finished",J(x.mark(function h0(){var A0,M0,R0;return x.wrap(function(k0){for(;;)switch(k0.prev=k0.next){case 0:return Nf.unsubscribe(),k0.next=3,_.setter(F.unit,F.getUploadServerIPs());case 3:A0=k0.sent,M0=A0.zone,R0=A0.unit,F.ee.removeAllListeners(),w.resolve({type:"UPLOAD",retUnit:R0,zone:M0});case 8:case"end":return k0.stop()}},h0)}))),F.uploadToServers();case 26:case"end":return _v.stop()}},f,this)}));return function(f,_){return h.apply(this,arguments)}}()},{key:"doUploadTask",value:function(h,f){var _=this,w=2<arguments.length&&arguments[2]!==void 0&&arguments[2],j=h.taskId;return w||(this.mediaTasks.delete(j),this.ongoingTask=h),new Promise(function(F,K){_.doUploadTaskImpl(h,f,w).then(F).catch(K)})}},{key:"processMediaTask",value:function(){var h=J(x.mark(function f(){var _,w,j;return x.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(this.mediaTasks.size!==0){F.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,_=this.mediaTasks.keys().next().value,(w=this.taskFinishers[_])!==void 0){F.next=7;break}throw Error("top task not found");case 7:if((j=this.mediaTasks.get(_))!==void 0){F.next=10;break}throw new Ma("task invalid");case 10:if(j.type!=="UPLOAD"){F.next=15;break}return F.next=13,this.doUploadTask(j,w).catch(function(K){j.manager.ee.removeAllListeners(),w.reject(K)});case 13:F.next=18;break;case 15:if(j.type!=="DOWNLOAD"){F.next=18;break}return F.next=18,this.doDownloadTask(j,w).catch(function(K){j.manager.ee.removeAllListeners(),w.reject(K)});case 18:case"end":return F.stop()}},f,this)}));return function(){return h.apply(this,arguments)}}()},{key:"cancelTask",value:function(h){var f=h.type==="DOWNLOAD"?ms:ls;h.manager.ee.removeAllListeners(),h.manager.abortController.abort(),this.taskFinishers[h.taskId]!==void 0&&this.taskFinishers[h.taskId].reject(new Ol("User logged out or kicked off, media task canceled",f))}}]),i}(wb());m(kt,"MAX_PENDING_TASK_COUNT",9),Up("of",function(){for(var o=0,i=arguments.length,s=new(cf(this))(i);i>o;)s[o]=arguments[o++];return s},nk);var lt=1/0,$E=Math.max,ew=function(o,i,s){var h=Object(o);if(!Nd(o)){var f=jf(i);o=Jd(o),i=function(_){return f(h[_],_,h)}}return-1<(i=function(_,w,j){var F=_==null?0:_.length;if(!F)return-1;if(j==null)j=0;else{var K=(j=j?(j=Nl(j))===lt||j===-lt?17976931348623157e292*(0>j?-1:1):j==j?j:0:j===0?j:0)%1;j=j==j?K?j-K:j:0}return 0>j&&(j=$E(F+j,0)),ar(_,jf(w),j)}(o,i,s))?h[f?o[i]:i]:void 0},dw=function(o,i){return o&&o.length?bl(o,void 0,typeof i=="function"?i:void 0):[]},mt=function(){function o(){X(this,o),m(this,"size",0),m(this,"fields",new Map)}return Ia(o,[{key:"define",value:function(i,s,h){if(this.size+=h,64<this.size)throw new RangeError("the struct over 64 bits is not supported");jh(s={val:0,isNumber:s==="number",isBoolean:s==="boolean",oneof:s==="number"||s==="boolean"?void 0:s,len:h}),this.fields.set(i,s)}},{key:"set",value:function(i,s){if(!(i=this.fields.get(i)))throw Error("field not found");var h=i.oneof;if(!U.isLong(s)&&typeof s!="number")if(typeof s=="boolean")s=s?1:0;else{if(h===void 0)throw Error("invalid field type");if((s=h[s])===void 0)throw Error("field type not found")}jh(i,s),i.val=s}},{key:"toNumber",value:function(){for(var i=0,s=0,h=0,f=Array.from(this.fields);h<f.length;h++){var _=ua(f[h],2)[1],w=_.len;(_=_.val)!==void 0&&(i+=U.fromValue(_).shiftLeft(s).toNumber(),s+=w)}return i}},{key:"toLong",value:function(){for(var i=U.fromNumber(0,!0),s=0,h=0,f=Array.from(this.fields);h<f.length;h++){var _=ua(f[h],2)[1],w=_.len;(_=_.val)!==void 0&&(i=U.fromValue(_).shiftLeft(s).add(i),s+=w)}return i}},{key:"assert",value:function(i,s){function h(w){if(!U.isLong(w)&&typeof w!="number")if(typeof w=="boolean")w=w?1:0;else{if(_===void 0)throw Error("invalid field type");if((w=_[w])===void 0)throw Error("field type not found")}return jh(f,w),ih(w,f.val)}var f=this.fields.get(i);if(!f)throw Error("field not found");var _=f.oneof;if(!Array.isArray(s))return h(s);if(s.length===1)return h(s[0]);if(s.every(function(w){return typeof w=="string"})&&_!==void 0)return s.some(function(w){return h(w)});throw Error("invalid valueTypes")}},{key:"from",value:function(i){i=U.fromValue(i);for(var s=0,h=0,f=Array.from(this.fields);h<f.length;h++){var _=ua(f[h],2)[1],w=_.len,j=U.fromNumber(Math.pow(2,w)-1,!0).shiftLeft(s);jh(_,j=i.and(j).shiftRightUnsigned(s)),_.val=j,s+=w}}},{key:"typeOf",value:function(i){if((i=this.fields.get(i))!==void 0){var s=i.oneof;if(i=i.val,s!==void 0){var h=0;for(s=Object.entries(s);h<s.length;h++){var f=ua(s[h],2),_=f[0];if(ih(i,f[1]))return _}}}throw new TypeError("can only get type of oneof type")}}]),o}(),nt=function(o){function i(h){X(this,i);var f=s.call(this);return f.define("Rejoin","boolean",1),f.define("Unused","number",31),f.define("Platform","number",8),f.define("Version","number",12),f.define("Subversion","number",12),f.set("Platform",7),f.set("Version",4),f.set("Subversion",15),f.set("Rejoin",h),f}ja(i,o);var s=ka(i);return i}(mt),aF=wa(wa(wa(wa({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),ot={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},bF=wa(wa({},aF),ot),cF={Uncompressed:0,Zlib:1},ke=function(o){function i(h){X(this,i);var f=s.call(this);if(f.define("MessageType",bF,8),f.define("BroadcastJumps","number",2),f.define("ToCache","boolean",1),f.define("FromCache","boolean",1),f.define("CompressionMethod",cF,2),f.define("IterationNumber","number",4),f.define("BufferedMessage","boolean",1),f.define("ToArchive","boolean",1),f.define("FromArchive","boolean",1),typeof h=="number"||U.isLong(h))f.from(h);else if(h!==void 0){var _=0;for(h=eh(h);_<h.length;_++){var w=ua(h[_],2);f.set(w[0],w[1])}}return f}ja(i,o);var s=ka(i);return Ia(i,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(h){var f=this;return h!==void 0?this.assert("MessageType",h):Pf(ot).some(function(_){return f.assert("MessageType",_)})}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),i}(mt),dF=function(o){function i(h){return X(this,i),m(n(h=s.call(this,h,"ChatManager")),"dialogueLru",new Nz(void 0,{maxlen:1e4,ttl:1e4})),h}ja(i,o);var s=ka(i);return Ia(i,[{key:"getChatInfo",value:function(h){var f=this.dialogueLru.get(h);if(this.dialogueLru.prune(),f){var _=f.dialogue,w={dialogue:_,sequence:f=f.sequence.add(1)};return this.dialogueLru.set(h,{dialogue:_,sequence:f}),w}return _={dialogue:Yg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(h,_),_}}]),i}(wb()),v={};V(module)=="object"&&(module.exports=v),v.parse=function(o,i){var s,h=v.bin.readUshort,f=v.bin.readUint,_={};for(s=(o=new Uint8Array(o)).length-4;f(o,s)!=101010256;)s--;var w=h(o,s=s+4+4);h(o,s+=2),f(o,s+=2),s=f(o,s+=4);for(var j=0;j<w;j++){f(o,s),s+=4,s+=4,s+=4,f(o,s+=4);var F=f(o,s+=4),K=f(o,s+=4),_e=h(o,s+=4),_o=h(o,s+2),ca=h(o,s+4);s+=6;var _c=f(o,s+=8);s+=4,s+=_e+_o+ca,v._readLocal(o,_c,_,F,K,i)}return _},v._readLocal=function(o,i,s,h,f,_){var w=v.bin.readUshort,j=v.bin.readUint;j(o,i),w(o,i+=4),w(o,i+=2);var F=w(o,i+=2);j(o,i+=2),j(o,i+=4),j=w(o,i=i+4+8);var K=w(o,i+=2);if(i+=2,w=v.bin.readUTF8(o,i,j),i=i+j+K,_)s[w]={size:f,csize:h};else if(o=new Uint8Array(o.buffer,i),F==0)s[w]=new Uint8Array(o.buffer.slice(i,i+h));else{if(F!=8)throw"unknown compression method: "+F;i=new Uint8Array(f),v.inflateRaw(o,i),s[w]=i}},v.inflateRaw=function(o,i){return v.F.inflate(o,i)},v.inflate=function(o,i){return o[0],o[1],v.inflateRaw(new Uint8Array(o.buffer,o.byteOffset+2,o.length-2),i)},v.deflate=function(o,i){i==null&&(i={level:6});var s=0,h=new Uint8Array(50+Math.floor(1.1*o.length));return h[s]=120,h[s+1]=156,s=v.F.deflateRaw(o,h,s+2,i.level),o=v.adler(o,0,o.length),h[s+0]=o>>>24&255,h[s+1]=o>>>16&255,h[s+2]=o>>>8&255,h[s+3]=o>>>0&255,new Uint8Array(h.buffer,0,s+4)},v.deflateRaw=function(o,i){i==null&&(i={level:6});var s=new Uint8Array(50+Math.floor(1.1*o.length)),h=v.F.deflateRaw(o,s,h,i.level);return new Uint8Array(s.buffer,0,h)},v.encode=function(o,i){i==null&&(i=!1);var s,h=0,f=v.bin.writeUint,_=v.bin.writeUshort,w={};for(s in o){var j=!v._noNeed(s)&&!i,F=o[s],K=v.crc.crc(F,0,F.length);w[s]={cpr:j,usize:F.length,crc:K,file:j?v.deflateRaw(F):F}}for(s in w)h+=w[s].file.length+30+46+2*v.bin.sizeUTF8(s);for(s in o=new Uint8Array(h+22),i=0,F=[],w)K=w[s],F.push(i),i=v._writeHeader(o,i,s,K,0);for(s in h=0,j=i,w)K=w[s],F.push(i),i=v._writeHeader(o,i,s,K,1,F[h++]);return w=i-j,f(o,i,101010256),_(o,i=i+4+4,h),_(o,i+=2,h),f(o,i+=2,w),f(o,i+4,j),o.buffer},v._noNeed=function(o){return o=o.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(o)!=-1},v._writeHeader=function(o,i,s,h,f,_){var w=v.bin.writeUint,j=v.bin.writeUshort,F=h.file;return w(o,i,f==0?67324752:33639248),i+=4,f==1&&(i+=2),j(o,i,20),j(o,i+=2,0),j(o,i+=2,h.cpr?8:0),w(o,i+=2,0),w(o,i+=4,h.crc),w(o,i+=4,F.length),w(o,i+=4,h.usize),j(o,i+=4,v.bin.sizeUTF8(s)),j(o,i+=2,0),i+=2,f==1&&(w(o,i=i+2+2+6,_),i+=4),i+=s=v.bin.writeUTF8(o,i,s),f==0&&(o.set(F,i),i+=F.length),i},v.crc={table:function(){for(var o=new Uint32Array(256),i=0;256>i;i++){for(var s=i,h=0;8>h;h++)s=1&s?3988292384^s>>>1:s>>>1;o[i]=s}return o}(),update:function(o,i,s,h){for(var f=0;f<h;f++)o=v.crc.table[255&(o^i[s+f])]^o>>>8;return o},crc:function(o,i,s){return 4294967295^v.crc.update(4294967295,o,i,s)}},v.adler=function(o,i,s){var h=1,f=0,_=i;for(i+=s;_<i;){for(s=Math.min(_+5552,i);_<s;)f+=h+=o[_++];h%=65521,f%=65521}return f<<16|h},v.bin={readUshort:function(o,i){return o[i]|o[i+1]<<8},writeUshort:function(o,i,s){o[i]=255&s,o[i+1]=s>>8&255},readUint:function(o,i){return 16777216*o[i+3]+(o[i+2]<<16|o[i+1]<<8|o[i])},writeUint:function(o,i,s){o[i]=255&s,o[i+1]=s>>8&255,o[i+2]=s>>16&255,o[i+3]=s>>24&255},readASCII:function(o,i,s){for(var h="",f=0;f<s;f++)h+=String.fromCharCode(o[i+f]);return h},writeASCII:function(o,i,s){for(var h=0;h<s.length;h++)o[i+h]=s.charCodeAt(h)},pad:function(o){return 2>o.length?"0"+o:o},readUTF8:function(o,i,s){for(var h,f="",_=0;_<s;_++)f+="%"+v.bin.pad(o[i+_].toString(16));try{h=decodeURIComponent(f)}catch{return v.bin.readASCII(o,i,s)}return h},writeUTF8:function(o,i,s){for(var h=s.length,f=0,_=0;_<h;_++){var w=s.charCodeAt(_);if((4294967168&w)==0)o[i+f]=w,f++;else if((4294965248&w)==0)o[i+f]=192|w>>6,o[i+f+1]=128|w>>0&63,f+=2;else if((4294901760&w)==0)o[i+f]=224|w>>12,o[i+f+1]=128|w>>6&63,o[i+f+2]=128|w>>0&63,f+=3;else{if((4292870144&w)!=0)throw"e";o[i+f]=240|w>>18,o[i+f+1]=128|w>>12&63,o[i+f+2]=128|w>>6&63,o[i+f+3]=128|w>>0&63,f+=4}}return f},sizeUTF8:function(o){for(var i=o.length,s=0,h=0;h<i;h++){var f=o.charCodeAt(h);if((4294967168&f)==0)s++;else if((4294965248&f)==0)s+=2;else if((4294901760&f)==0)s+=3;else{if((4292870144&f)!=0)throw"e";s+=4}}return s}},v.F={},v.F.deflateRaw=function(o,i,s,h){var f=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][h],_=v.F.U,w=v.F._goodIndex;v.F._hash;var j=v.F._putsE,F=0;s<<=3;var K=0,_e=o.length;if(h==0){for(;F<_e;){var _o=Math.min(65535,_e-F);j(i,s,F+_o==_e?1:0),s=v.F._copyExact(o,F,_o,i,s+8),F+=_o}return s>>>3}j=_.lits,h=_.strt;var ca=_.prev,_c=0,ch=0,Nf=0,bh=0,_g=0;for(2<_e&&(h[_g=v.F._hash(o,0)]=0),F=0;F<_e;F++){if(_o=_g,F+1<_e-2){_g=v.F._hash(o,F+1);var _v=F+1&32767;ca[_v]=h[_g],h[_g]=_v}if(K<=F){if((14e3<_c||26697<ch)&&100<_e-F&&(K<F&&(j[_c]=F-K,_c+=2,K=F),s=v.F._writeBlock(F==_e-1||K==_e?1:0,j,_c,bh,o,Nf,F-Nf,i,s),_c=ch=bh=0,Nf=F),_v=0,F<_e-2&&(_v=v.F._bestMatch(o,F,ca,_o,Math.min(f[2],_e-F),f[3])),_v!=0){_o=_v>>>16,_v&=65535;var h0=w(_o,_.of0);_.lhst[257+h0]++;var A0=w(_v,_.df0);_.dhst[A0]++,bh+=_.exb[h0]+_.dxb[A0],j[_c]=_o<<23|F-K,j[_c+1]=_v<<16|h0<<8|A0,_c+=2,K=F+_o}else _.lhst[o[F]]++;ch++}}for(Nf==F&&o.length!=0||(K<F&&(j[_c]=F-K,_c+=2),s=v.F._writeBlock(1,j,_c,bh,o,Nf,F-Nf,i,s));(7&s)!=0;)s++;return s>>>3},v.F._bestMatch=function(o,i,s,h,f,_){var w=32767&i,j=s[w],F=w-j+32768&32767;if(j==w||h!=v.F._hash(o,i-F))return 0;for(var K=h=0,_e=Math.min(32767,i);F<=_e&&--_!=0&&j!=w;){if((h==0||o[i+h]==o[i+h-F])&&(w=v.F._howLong(o,i,F))>h){if(K=F,(h=w)>=f)break;F+2<w&&(w=F+2);for(var _o=0,ca=0;ca<w-2;ca++){var _c=i-F+ca+32768&32767,ch=_c-s[_c]+32768&32767;ch>_o&&(_o=ch,j=_c)}}F+=(w=j)-(j=s[w])+32768&32767}return h<<16|K},v.F._howLong=function(o,i,s){if(o[i]!=o[i-s]||o[i+1]!=o[i+1-s]||o[i+2]!=o[i+2-s])return 0;var h=i,f=Math.min(o.length,i+258);for(i+=3;i<f&&o[i]==o[i-s];)i++;return i-h},v.F._hash=function(o,i){return(o[i]<<8|o[i+1])+(o[i+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(o,i,s,h,f,_,w,j,F){var K=v.F.U,_e=v.F._putsF,_o=v.F._putsE;K.lhst[256]++;var ca=v.F.getTrees(),_c=ca[0],ch=ca[1],Nf=ca[2],bh=ca[3],_g=ca[4],_v=ca[5],h0=ca[6];ca=ca[7];var A0=32+((F+3&7)==0?0:8-(F+3&7))+(w<<3),M0=h+v.F.contSize(K.fltree,K.lhst)+v.F.contSize(K.fdtree,K.dhst);h=h+v.F.contSize(K.ltree,K.lhst)+v.F.contSize(K.dtree,K.dhst),h+=14+3*_v+v.F.contSize(K.itree,K.ihst)+(2*K.ihst[16]+3*K.ihst[17]+7*K.ihst[18]);for(var R0=0;286>R0;R0++)K.lhst[R0]=0;for(R0=0;30>R0;R0++)K.dhst[R0]=0;for(R0=0;19>R0;R0++)K.ihst[R0]=0;if(A0=A0<M0&&A0<h?0:M0<h?1:2,_e(j,F,o),_e(j,F+1,A0),F+=3,A0==0){for(;(7&F)!=0;)F++;F=v.F._copyExact(f,_,w,j,F)}else{if(A0==1)var k0=K.fltree,G0=K.fdtree;if(A0==2){for(v.F.makeCodes(K.ltree,_c),v.F.revCodes(K.ltree,_c),v.F.makeCodes(K.dtree,ch),v.F.revCodes(K.dtree,ch),v.F.makeCodes(K.itree,Nf),v.F.revCodes(K.itree,Nf),k0=K.ltree,G0=K.dtree,_o(j,F,bh-257),_o(j,F+=5,_g-1),_o(j,F+=5,_v-4),F+=4,o=0;o<_v;o++)_o(j,F+3*o,K.itree[1+(K.ordr[o]<<1)]);F=v.F._codeTiny(h0,K.itree,j,F+3*_v),F=v.F._codeTiny(ca,K.itree,j,F)}for(_v=0;_v<s;_v+=2){for(h0=(o=i[_v])>>>23,o=_+(8388607&o);_<o;)F=v.F._writeLit(f[_++],k0,j,F);h0!=0&&(o=(_c=i[_v+1])>>16,w=_c>>8&255,_c&=255,_o(j,F=v.F._writeLit(257+w,k0,j,F),h0-K.of0[w]),F+=K.exb[w],_e(j,F=v.F._writeLit(_c,G0,j,F),o-K.df0[_c]),F+=K.dxb[_c],_+=h0)}F=v.F._writeLit(256,k0,j,F)}return F},v.F._copyExact=function(o,i,s,h,f){var _=f>>>3;return h[_]=s,h[_+1]=s>>>8,h[_+2]=255-h[_],h[_+3]=255-h[_+1],_+=4,h.set(new Uint8Array(o.buffer,i,s),_),f+(s+4<<3)},v.F.getTrees=function(){for(var o=v.F.U,i=v.F._hufTree(o.lhst,o.ltree,15),s=v.F._hufTree(o.dhst,o.dtree,15),h=[],f=v.F._lenCodes(o.ltree,h),_=[],w=v.F._lenCodes(o.dtree,_),j=0;j<h.length;j+=2)o.ihst[h[j]]++;for(j=0;j<_.length;j+=2)o.ihst[_[j]]++;j=v.F._hufTree(o.ihst,o.itree,7);for(var F=19;4<F&&o.itree[1+(o.ordr[F-1]<<1)]==0;)F--;return[i,s,j,f,w,F,h,_]},v.F.getSecond=function(o){for(var i=[],s=0;s<o.length;s+=2)i.push(o[s+1]);return i},v.F.nonZero=function(o){for(var i="",s=0;s<o.length;s+=2)o[s+1]!=0&&(i+=(s>>1)+",");return i},v.F.contSize=function(o,i){for(var s=0,h=0;h<i.length;h++)s+=i[h]*o[1+(h<<1)];return s},v.F._codeTiny=function(o,i,s,h){for(var f=0;f<o.length;f+=2){var _=o[f],w=o[f+1];h=v.F._writeLit(_,i,s,h);var j=_==16?2:_==17?3:7;15<_&&(v.F._putsE(s,h,w,j),h+=j)}return h},v.F._lenCodes=function(o,i){for(var s=o.length;s!=2&&o[s-1]==0;)s-=2;for(var h=0;h<s;h+=2){var f=o[h+1],_=h+3<s?o[h+3]:-1,w=h+5<s?o[h+5]:-1,j=h==0?-1:o[h-1];if(f==0&&_==f&&w==f){for(_=h+5;_+2<s&&o[_+2]==f;)_+=2;11>(f=Math.min(_+1-h>>>1,138))?i.push(17,f-3):i.push(18,f-11),h+=2*f-2}else if(f==j&&_==f&&w==f){for(_=h+5;_+2<s&&o[_+2]==f;)_+=2;f=Math.min(_+1-h>>>1,6),i.push(16,f-3),h+=2*f-2}else i.push(f,0)}return s>>>1},v.F._hufTree=function(o,i,s){var h=[],f=o.length,_=i.length,w=0;for(w=0;w<_;w+=2)i[w]=0,i[w+1]=0;for(w=0;w<f;w++)o[w]!=0&&h.push({lit:w,f:o[w]});if(o=h.length,f=h.slice(0),o==0)return 0;if(o==1)return i[1+((s=h[0].lit)<<1)]=1,i[1+((s==0?1:0)<<1)]=1;h.sort(function(_e,_o){return _e.f-_o.f}),w=h[0],_=h[1];var j=0,F=1,K=2;for(h[0]={lit:-1,f:w.f+_.f,l:w,r:_,d:0};F!=o-1;)w=j!=F&&(K==o||h[j].f<h[K].f)?h[j++]:h[K++],_=j!=F&&(K==o||h[j].f<h[K].f)?h[j++]:h[K++],h[F++]={lit:-1,f:w.f+_.f,l:w,r:_};for((h=v.F.setDepth(h[F-1],0))>s&&(v.F.restrictDepth(f,s,h),h=s),w=0;w<o;w++)i[1+(f[w].lit<<1)]=f[w].d;return h},v.F.setDepth=function(o,i){return o.lit!=-1?o.d=i:Math.max(v.F.setDepth(o.l,i+1),v.F.setDepth(o.r,i+1))},v.F.restrictDepth=function(o,i,s){var h=0,f=1<<s-i,_=0;for(o.sort(function(j,F){return F.d==j.d?j.f-F.f:F.d-j.d}),h=0;h<o.length&&o[h].d>i;h++){var w=o[h].d;o[h].d=i,_+=f-(1<<s-w)}for(_>>>=s-i;0<_;)(w=o[h].d)<i?(o[h].d++,_-=1<<i-w-1):h++;for(;0<=h;h--)o[h].d==i&&0>_&&(o[h].d--,_++);_!=0&&console.log("debt left")},v.F._goodIndex=function(o,i){var s=0;return i[16|s]<=o&&(s|=16),i[8|s]<=o&&(s|=8),i[4|s]<=o&&(s|=4),i[2|s]<=o&&(s|=2),i[1|s]<=o&&(s|=1),s},v.F._writeLit=function(o,i,s,h){return v.F._putsF(s,h,i[o<<1]),h+i[1+(o<<1)]},v.F.inflate=function(o,i){var s=Uint8Array;if(o[0]==3&&o[1]==0)return i||new s(0);var h=v.F,f=h._bitsF,_=h._bitsE,w=h._decodeTiny,j=h.makeCodes,F=h.codes2map,K=h._get17,_e=h.U,_o=i==null;_o&&(i=new s(o.length>>>2<<3));for(var ca,_c,ch,Nf,bh=0,_g=0,_v=_c=0,h0=0;bh==0;)if(bh=f(o,h0,1),ca=f(o,h0+1,2),h0+=3,ca==0)(7&h0)!=0&&(h0+=8-(7&h0)),ca=o[(h0=4+(h0>>>3))-4]|o[h0-3]<<8,_o&&(i=v.F._check(i,_v+ca)),i.set(new s(o.buffer,o.byteOffset+h0,ca),_v),h0=h0+ca<<3,_v+=ca;else{if(_o&&(i=v.F._check(i,_v+131072)),ca==1&&(ch=_e.flmap,Nf=_e.fdmap,_g=511,_c=31),ca==2){for(_c=_(o,h0,5)+257,ca=_(o,h0+5,5)+1,ch=_(o,h0+10,4)+4,h0+=14,Nf=0;38>Nf;Nf+=2)_e.itree[Nf]=0,_e.itree[Nf+1]=0;for(_g=1,Nf=0;Nf<ch;Nf++){var A0=_(o,h0+3*Nf,3);_e.itree[1+(_e.ordr[Nf]<<1)]=A0,A0>_g&&(_g=A0)}h0+=3*ch,j(_e.itree,_g),F(_e.itree,_g,_e.imap),ch=_e.lmap,Nf=_e.dmap,h0=w(_e.imap,(1<<_g)-1,_c+ca,o,h0,_e.ttree),_g=(1<<(A0=h._copyOut(_e.ttree,0,_c,_e.ltree)))-1,_c=(1<<(ca=h._copyOut(_e.ttree,_c,ca,_e.dtree)))-1,j(_e.ltree,A0),F(_e.ltree,A0,ch),j(_e.dtree,ca),F(_e.dtree,ca,Nf)}for(;;)if(h0+=15&(ca=ch[K(o,h0)&_g]),(A0=ca>>>4)>>>8==0)i[_v++]=A0;else{if(A0==256)break;ca=_v+A0-254,264<A0&&(ca=_v+((A0=_e.ldef[A0-257])>>>3)+_(o,h0,7&A0),h0+=7&A0),h0+=15&(A0=Nf[K(o,h0)&_c]);var M0=((A0=_e.ddef[A0>>>4])>>>4)+f(o,h0,15&A0);for(h0+=15&A0,_o&&(i=v.F._check(i,_v+131072));_v<ca;)i[_v]=i[_v++-M0],i[_v]=i[_v++-M0],i[_v]=i[_v++-M0],i[_v]=i[_v++-M0];_v=ca}}return i.length==_v?i:i.slice(0,_v)},v.F._check=function(o,i){var s=o.length;return i<=s?o:((i=new Uint8Array(Math.max(s<<1,i))).set(o,0),i)},v.F._decodeTiny=function(o,i,s,h,f,_){for(var w=v.F._bitsE,j=v.F._get17,F=0;F<s;){var K=o[j(h,f)&i];f+=15&K;var _e=K>>>4;if(15>=_e)_[F]=_e,F++;else{var _o=K=0;for(_e==16?(_o=3+w(h,f,2),f+=2,K=_[F-1]):_e==17?(_o=3+w(h,f,3),f+=3):_e==18&&(_o=11+w(h,f,7),f+=7),_e=F+_o;F<_e;)_[F]=K,F++}}return f},v.F._copyOut=function(o,i,s,h){for(var f=0,_=0,w=h.length>>>1;_<s;){var j=o[_+i];h[_<<1]=0,h[1+(_<<1)]=j,j>f&&(f=j),_++}for(;_<w;)h[_<<1]=0,h[1+(_<<1)]=0,_++;return f},v.F.makeCodes=function(o,i){var s,h,f=v.F.U,_=o.length,w=f.bl_count;for(s=0;s<=i;s++)w[s]=0;for(s=1;s<_;s+=2)w[o[s]]++;for(f=f.next_code,s=0,w[0]=0,h=1;h<=i;h++)s=s+w[h-1]<<1,f[h]=s;for(i=0;i<_;i+=2)(w=o[i+1])!=0&&(o[i]=f[w],f[w]++)},v.F.codes2map=function(o,i,s){for(var h=o.length,f=v.F.U.rev15,_=0;_<h;_+=2)if(o[_+1]!=0){var w=o[_+1],j=_>>1<<4|w,F=i-w;for(F=(w=o[_]<<F)+(1<<F);w!=F;)s[f[w]>>>15-i]=j,w++}},v.F.revCodes=function(o,i){for(var s=v.F.U.rev15,h=15-i,f=0;f<o.length;f+=2)o[f]=s[o[f]<<i-o[f+1]]>>>h},v.F._putsE=function(o,i,s){s<<=7&i,o[i>>>=3]|=s,o[i+1]|=s>>>8},v.F._putsF=function(o,i,s){s<<=7&i,o[i>>>=3]|=s,o[i+1]|=s>>>8,o[i+2]|=s>>>16},v.F._bitsE=function(o,i,s){return(o[i>>>3]|o[1+(i>>>3)]<<8)>>>(7&i)&(1<<s)-1},v.F._bitsF=function(o,i,s){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16)>>>(7&i)&(1<<s)-1},v.F._get17=function(o,i){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16)>>>(7&i)},v.F._get25=function(o,i){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16|o[3+(i>>>3)]<<24)>>>(7&i)},v.F.U=function(){var o=Uint16Array,i=Uint32Array;return{next_code:new o(16),bl_count:new o(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new o(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new i(32),flmap:new o(512),fltree:[],fdmap:new o(32),fdtree:[],lmap:new o(32768),ltree:[],ttree:[],dmap:new o(32768),dtree:[],imap:new o(512),itree:[],rev15:new o(32768),lhst:new i(286),dhst:new i(30),ihst:new i(19),lits:new i(15e3),strt:new o(65536),prev:new o(32768)}}(),function(){function o(f,_,w){for(;_--!=0;)f.push(0,w)}for(var i=v.F.U,s=0;32768>s;s++){var h=s;h=(4278255360&(h=(4042322160&(h=(3435973836&(h=(2863311530&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8,i.rev15[s]=(h>>>16|h<<16)>>>17}for(s=0;32>s;s++)i.ldef[s]=i.of0[s]<<3|i.exb[s],i.ddef[s]=i.df0[s]<<4|i.dxb[s];o(i.fltree,144,8),o(i.fltree,112,9),o(i.fltree,24,7),o(i.fltree,8,8),v.F.makeCodes(i.fltree,9),v.F.codes2map(i.fltree,9,i.flmap),v.F.revCodes(i.fltree,9),o(i.fdtree,32,5),v.F.makeCodes(i.fdtree,5),v.F.codes2map(i.fdtree,5,i.fdmap),v.F.revCodes(i.fdtree,5),o(i.itree,19,0),o(i.ltree,286,0),o(i.dtree,30,0),o(i.ttree,320,0)}();var eF=Array.isArray||function(o){return o&&typeof o.length=="number"},fF=Object.defineProperty({isArray:eF},"__esModule",{value:!0}),gF=Object.defineProperty({isObject:function(o){return o!==null&&V(o)==="object"}},"__esModule",{value:!0}),hF=Object.defineProperty({isFunction:function(o){return typeof o=="function"}},"__esModule",{value:!0}),iF=function(){function o(i){return Error.call(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(s,h){return h+1+") "+s.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i,this}return o.prototype=Object.create(Error.prototype),o}(),kh=Object.defineProperty({UnsubscriptionError:iF},"__esModule",{value:!0}),jF=function(){function o(i){this.closed=!1,this._subscriptions=this._parentOrParents=null,i&&(this._ctorUnsubscribe=!0,this._unsubscribe=i)}return o.prototype.unsubscribe=function(){if(!this.closed){var i=this._parentOrParents,s=this._ctorUnsubscribe,h=this._unsubscribe,f=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,i instanceof o)i.remove(this);else if(i!==null)for(var _=0;_<i.length;++_)i[_].remove(this);if(hF.isFunction(h)){s&&(this._unsubscribe=void 0);try{h.call(this)}catch(j){var w=j instanceof kh.UnsubscriptionError?go(j.errors):[j]}}if(fF.isArray(f)){for(_=-1,i=f.length;++_<i;)if(s=f[_],gF.isObject(s))try{s.unsubscribe()}catch(j){w=w||[],j instanceof kh.UnsubscriptionError?w=w.concat(go(j.errors)):w.push(j)}}if(w)throw new kh.UnsubscriptionError(w)}},o.prototype.add=function(i){var s=i;if(!i)return o.EMPTY;switch(V(i)){case"function":s=new o(i);case"object":if(s===this||s.closed||typeof s.unsubscribe!="function")return s;if(this.closed)return s.unsubscribe(),s;s instanceof o||(i=s,(s=new o)._subscriptions=[i]);break;default:throw Error("unrecognized teardown "+i+" added to Subscription.")}if((i=s._parentOrParents)===null)s._parentOrParents=this;else if(i instanceof o){if(i===this)return s;s._parentOrParents=[i,this]}else{if(i.indexOf(this)!==-1)return s;i.push(this)}return(i=this._subscriptions)===null?this._subscriptions=[s]:i.push(s),s},o.prototype.remove=function(i){var s=this._subscriptions;s&&(i=s.indexOf(i))!==-1&&s.splice(i,1)},o.EMPTY=function(i){return i.closed=!0,i}(new o),o}(),kF=Object.defineProperty({Subscription:jF},"__esModule",{value:!0}),lF=Ka&&Ka.__extends||function(){var o=function(i,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var _ in f)f.hasOwnProperty(_)&&(h[_]=f[_])})(i,s)};return function(i,s){function h(){this.constructor=i}o(i,s),i.prototype=s===null?Object.create(s):(h.prototype=s.prototype,new h)}}(),mF=function(o){function i(s,h){return o.call(this)||this}return lF(i,o),i.prototype.schedule=function(s,h){return this},i}(kF.Subscription),nF=Object.defineProperty({Action:mF},"__esModule",{value:!0}),oF=Ka&&Ka.__extends||function(){var o=function(i,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var _ in f)f.hasOwnProperty(_)&&(h[_]=f[_])})(i,s)};return function(i,s){function h(){this.constructor=i}o(i,s),i.prototype=s===null?Object.create(s):(h.prototype=s.prototype,new h)}}(),pt=function(o){function i(s,h){var f=o.call(this,s,h)||this;return f.scheduler=s,f.work=h,f.pending=!1,f}return oF(i,o),i.prototype.schedule=function(s,h){if(h===void 0&&(h=0),this.closed)return this;this.state=s,s=this.id;var f=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(f,s,h)),this.pending=!0,this.delay=h,this.id=this.id||this.requestAsyncId(f,this.id,h),this},i.prototype.requestAsyncId=function(s,h,f){return f===void 0&&(f=0),setInterval(s.flush.bind(s,this),f)},i.prototype.recycleAsyncId=function(s,h,f){if(f===void 0&&(f=0),f!==null&&this.delay===f&&this.pending===!1)return h;clearInterval(h)},i.prototype.execute=function(s,h){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(s=this._execute(s,h))?s:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},i.prototype._execute=function(s,h){h=!1;var f=void 0;try{this.work(s)}catch(_){h=!0,f=!!_&&_||Error(_)}if(h)return this.unsubscribe(),f},i.prototype._unsubscribe=function(){var s=this.id,h=this.scheduler,f=h.actions,_=f.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,_!==-1&&f.splice(_,1),s!=null&&(this.id=this.recycleAsyncId(h,s,null)),this.delay=null},i}(nF.Action),pF=function(){function o(i,s){s===void 0&&(s=o.now),this.SchedulerAction=i,this.now=s}return o.prototype.schedule=function(i,s,h){return s===void 0&&(s=0),new this.SchedulerAction(this,i).schedule(h,s)},o.now=function(){return Date.now()},o}(),qt=Object.defineProperty({Scheduler:pF},"__esModule",{value:!0}),qF=Ka&&Ka.__extends||function(){var o=function(i,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var _ in f)f.hasOwnProperty(_)&&(h[_]=f[_])})(i,s)};return function(i,s){function h(){this.constructor=i}o(i,s),i.prototype=s===null?Object.create(s):(h.prototype=s.prototype,new h)}}(),rt=function(o){function i(s,h){h===void 0&&(h=qt.Scheduler.now);var f=o.call(this,s,function(){return i.delegate&&i.delegate!==f?i.delegate.now():h()})||this;return f.actions=[],f.active=!1,f.scheduled=void 0,f}return qF(i,o),i.prototype.schedule=function(s,h,f){return h===void 0&&(h=0),i.delegate&&i.delegate!==this?i.delegate.schedule(s,h,f):o.prototype.schedule.call(this,s,h,f)},i.prototype.flush=function(s){var h=this.actions;if(this.active)h.push(s);else{var f;this.active=!0;do if(f=s.execute(s.state,s.delay))break;while(s=h.shift());if(this.active=!1,f){for(;s=h.shift();)s.unsubscribe();throw f}}},i}(qt.Scheduler),rF=qa("iterator"),Tl=!R(function(){var o=new URL("b?a=1&b=2&c=3","http://a"),i=o.searchParams,s="";return o.pathname="c%20d",i.forEach(function(h,f){i.delete("b"),s+=f+h}),!i.sort||o.href!=="http://a/c%20d?a=1&c=3"||i.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!i[rF]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||s!=="a1c3"||new URL("http://x",void 0).host!=="x"}),sF=/[^\0-\u007E]/,tF=/[.\u3002\uFF0E\uFF61]/g,sf=Math.floor,Ul=String.fromCharCode,st=function(o){return o+22+75*(26>o)},uF=function(o){for(var i=[],s=[],h=0,f=o.length;h<f;){var _=o.charCodeAt(h++);if(55296<=_&&56319>=_&&h<f){var w=o.charCodeAt(h++);(64512&w)==56320?s.push(((1023&_)<<10)+(1023&w)+65536):(s.push(_),h--)}else s.push(_)}s=(o=s).length,h=128;var j=0,F=72;for(f=0;f<o.length;f++){var K=o[f];128>K&&i.push(Ul(K))}for((w=_=i.length)&&i.push("-");w<s;){var _e=2147483647;for(f=0;f<o.length;f++)(K=o[f])>=h&&K<_e&&(_e=K);var _o=w+1;if(_e-h>sf((2147483647-j)/_o))throw RangeError("Overflow: input needs wider integers to process");for(j+=(_e-h)*_o,h=_e,f=0;f<o.length;f++){if((K=o[f])<h&&2147483647<++j)throw RangeError("Overflow: input needs wider integers to process");if(K==h){var ca=j;for(K=36;!(ca<(_e=K<=F?1:K>=F+26?26:K-F));K+=36){ca-=_e;var _c=36-_e;i.push(Ul(st(_e+ca%_c))),ca=sf(ca/_c)}for(i.push(Ul(st(ca))),F=_o,K=0,j=w==_?sf(j/700):j>>1,j+=sf(j/F);455<j;K+=36)j=sf(j/35);F=sf(K+36*j/(j+38)),j=0,++w}}++j,++h}return i.join("")},tt=function(o){var i=Zf(o);if(typeof i!="function")throw TypeError(String(o)+" is not iterable");return sa(i.call(o))},ut=Rb("fetch"),Vl=Rb("Headers"),vF=qa("iterator"),vt=La.set,Hb=La.getterFor("URLSearchParams"),wF=La.getterFor("URLSearchParamsIterator"),xF=/\+/g,wt=Array(4),yF=function(o){return wt[o-1]||(wt[o-1]=RegExp("((?:%[\\da-f]{2}){"+o+"})","gi"))},zF=function(o){try{return decodeURIComponent(o)}catch{return o}},xt=function(o){o=o.replace(xF," ");var i=4;try{return decodeURIComponent(o)}catch{for(;i;)o=o.replace(yF(i--),zF);return o}},yt=/[!'()~]|%20/g,AF={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},zt=function(o){return AF[o]},At=function(o,i){if(i){i=i.split("&");for(var s,h=0;h<i.length;)(s=i[h++]).length&&(s=s.split("="),o.push({key:xt(s.shift()),value:xt(s.join("="))}))}},BF=function(o){this.entries.length=0,At(this.entries,o)},tf=function(o,i){if(o<i)throw TypeError("Not enough arguments")},Wl=Zo(function(o,i){vt(this,{type:"URLSearchParamsIterator",iterator:tt(Hb(o).entries),kind:i})},"Iterator",function(){var o=wF(this),i=o.kind,s=(o=o.iterator.next()).value;return o.done||(o.value=i==="keys"?s.key:i==="values"?s.value:[s.key,s.value]),o}),Fg=function(){hc(this,Fg,"URLSearchParams");var o,i,s,h=0<arguments.length?arguments[0]:void 0,f=[];if(vt(this,{type:"URLSearchParams",entries:f,updateURL:function(){},updateSearchParams:BF}),h!==void 0)if(ha(h)){var _=Zf(h);if(typeof _=="function")for(h=_.call(h),_=h.next;!(o=_.call(h)).done;){var w=(o=tt(sa(o.value))).next;if((i=w.call(o)).done||(s=w.call(o)).done||!w.call(o).done)throw TypeError("Expected sequence with length 2");f.push({key:i.value+"",value:s.value+""})}else for(o in h)Q(h,o)&&f.push({key:o,value:h[o]+""})}else At(f,typeof h=="string"?h.charAt(0)==="?"?h.slice(1):h:h+"")},pi=Fg.prototype;Xe(pi,{append:function(o,i){tf(arguments.length,2);var s=Hb(this);s.entries.push({key:o+"",value:i+""}),s.updateURL()},delete:function(o){tf(arguments.length,1);for(var i=Hb(this),s=i.entries,h=o+"",f=0;f<s.length;)s[f].key===h?s.splice(f,1):f++;i.updateURL()},get:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,s=o+"",h=0;h<i.length;h++)if(i[h].key===s)return i[h].value;return null},getAll:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,s=o+"",h=[],f=0;f<i.length;f++)i[f].key===s&&h.push(i[f].value);return h},has:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,s=o+"",h=0;h<i.length;)if(i[h++].key===s)return!0;return!1},set:function(o,i){tf(arguments.length,1);for(var s,h=Hb(this),f=h.entries,_=!1,w=o+"",j=i+"",F=0;F<f.length;F++)(s=f[F]).key===w&&(_?f.splice(F--,1):(_=!0,s.value=j));_||f.push({key:w,value:j}),h.updateURL()},sort:function(){var o,i,s=Hb(this),h=s.entries,f=h.slice();for(i=h.length=0;i<f.length;i++){var _=f[i];for(o=0;o<i;o++)if(h[o].key>_.key){h.splice(o,0,_);break}o===i&&h.push(_)}s.updateURL()},forEach:function(o){for(var i,s=Hb(this).entries,h=pd(o,1<arguments.length?arguments[1]:void 0,3),f=0;f<s.length;)h((i=s[f++]).value,i.key,this)},keys:function(){return new Wl(this,"keys")},values:function(){return new Wl(this,"values")},entries:function(){return new Wl(this,"entries")}},{enumerable:!0}),Ea(pi,vF,pi.entries),Ea(pi,"toString",function(){for(var o,i=Hb(this).entries,s=[],h=0;h<i.length;)o=i[h++],s.push(encodeURIComponent(o.key).replace(yt,zt)+"="+encodeURIComponent(o.value).replace(yt,zt));return s.join("&")},{enumerable:!0}),gc(Fg,"URLSearchParams"),M({global:!0,forced:!Tl},{URLSearchParams:Fg}),Tl||typeof ut!="function"||typeof Vl!="function"||M({global:!0,enumerable:!0,forced:!0},{fetch:function(o){var i=[o];if(1<arguments.length){var s=arguments[1];if(ha(s)){var h=s.body;if(We(h)==="URLSearchParams"){var f=s.headers?new Vl(s.headers):new Vl;f.has("content-type")||f.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),s=Sb(s,{body:sc(0,String(h)),headers:sc(0,f)})}}i.push(s)}return ut.apply(this,i)}});var Gg=C.URL,CF=Fg,DF=La.set,Na=La.getterFor("URL"),EF=Math.floor,Bt=Math.pow,Ct=/[A-Za-z]/,FF=/[\d+-.A-Za-z]/,Xl=/\d/,GF=/^(0x|0X)/,HF=/^[0-7]+$/,IF=/^\d+$/,Dt=/^[\dA-Fa-f]+$/,JF=/[\0\t\n\r #%/:?@[\\]]/,KF=/[\0\t\n\r #/:?@[\\]]/,LF=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,MF=/[\t\n\r]/g,Yl=function(o,i){var s;if(i.charAt(0)=="["){if(i.charAt(i.length-1)!="]")return"Invalid host";var h=NF(i.slice(1,-1));if(!h)return"Invalid host"}else if(bb(o)){for(h=[],i=i.toLowerCase().replace(tF,".").split("."),s=0;s<i.length;s++){var f=i[s];h.push(sF.test(f)?"xn--"+uF(f):f)}if(i=h.join("."),JF.test(i)||(h=OF(i))===null)return"Invalid host"}else{if(KF.test(i))return"Invalid host";for(h="",i=Td(i),s=0;s<i.length;s++)h+=Cd(i[s],qi)}o.host=h},OF=function(o){var i,s=o.split(".");s.length&&s[s.length-1]==""&&s.pop();var h=s.length;if(4<h)return o;var f=[];for(i=0;i<h;i++){var _=s[i];if(_=="")return o;var w=10;if(1<_.length&&_.charAt(0)=="0"&&(w=GF.test(_)?16:8,_=_.slice(w==8?1:2)),_==="")_=0;else{if(!(w==10?IF:w==8?HF:Dt).test(_))return o;_=parseInt(_,w)}f.push(_)}for(i=0;i<h;i++)if(_=f[i],i==h-1){if(_>=Bt(256,5-h))return null}else if(255<_)return null;for(o=f.pop(),i=0;i<f.length;i++)o+=f[i]*Bt(256,3-i);return o},NF=function(o){var i,s,h=[0,0,0,0,0,0,0,0],f=0,_=null,w=0,j=function(){return o.charAt(w)};if(j()==":"){if(o.charAt(1)!=":")return;w+=2,_=++f}for(;j();){if(f==8)return;if(j()==":"){if(_!==null)return;w++,_=++f}else{for(i=s=0;4>s&&Dt.test(j());)i=16*i+parseInt(j(),16),w++,s++;if(j()=="."){if(s==0||(w-=s,6<f))return;for(i=0;j();){if(s=null,0<i){if(!(j()=="."&&4>i))return;w++}if(!Xl.test(j()))return;for(;Xl.test(j());){var F=parseInt(j(),10);if(s===null)s=F;else{if(s==0)return;s=10*s+F}if(255<s)return;w++}h[f]=256*h[f]+s,++i!=2&&i!=4||f++}if(i!=4)return;break}if(j()==":"){if(w++,!j())return}else if(j())return;h[f++]=i}}if(_!==null)for(j=f-_,f=7;f!=0&&0<j;)i=h[f],h[f--]=h[_+j-1],h[_+--j]=i;else if(f!=8)return;return h},Hg=function(o){var i,s;if(typeof o=="number"){var h=[];for(i=0;4>i;i++)h.unshift(o%256),o=EF(o/256);return h.join(".")}if(typeof o=="object"){h="",i=null;for(var f=1,_=null,w=0,j=0;8>j;j++)o[j]!==0?(w>f&&(i=_,f=w),_=null,w=0):(_===null&&(_=j),++w);for(w>f&&(i=_),f=i,i=0;8>i;i++)s&&o[i]===0||(s&&(s=!1),f===i?(h+=i?":":"::",s=!0):(h+=o[i].toString(16),7>i&&(h+=":")));return"["+h+"]"}return o},qi={},Et=ng({},qi,{" ":1,'"':1,"<":1,">":1,"`":1}),Ft=ng({},Et,{"#":1,"?":1,"{":1,"}":1}),Zl=ng({},Ft,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Cd=function(o,i){var s=Kw(o,0);return 32<s&&127>s&&!Q(i,o)?o:encodeURIComponent(o)},ri={ftp:21,file:null,http:80,https:443,ws:80,wss:443},bb=function(o){return Q(ri,o.scheme)},$l=function(o){return!o.host||o.cannotBeABaseURL||o.scheme=="file"},Ig=function(o,i){var s;return o.length==2&&Ct.test(o.charAt(0))&&((s=o.charAt(1))==":"||!i&&s=="|")},Gt=function(o){var i;return 1<o.length&&Ig(o.slice(0,2))&&(o.length==2||(i=o.charAt(2))==="/"||i==="\\"||i==="?"||i==="#")},Ht=function(o){var i=o.path,s=i.length;!s||o.scheme=="file"&&s==1&&Ig(i[0],!0)||i.pop()},am={},It={},bm={},Jt={},Kt={},cm={},Lt={},Mt={},si={},ti={},dm={},em={},fm={},gm={},Nt={},hm={},Jg={},Hc={},Ot={},le={},dd={},Ic=function(o,i,s,h){var f=s||am,_=0,w="",j=!1,F=!1,K=!1;for(s||(o.scheme="",o.username="",o.password="",o.host=null,o.port=null,o.path=[],o.query=null,o.fragment=null,o.cannotBeABaseURL=!1,i=i.replace(LF,"")),i=i.replace(MF,""),i=Td(i);_<=i.length;){var _e=i[_];switch(f){case am:if(!_e||!Ct.test(_e)){if(s)return"Invalid scheme";f=bm;continue}w+=_e.toLowerCase(),f=It;break;case It:if(_e&&(FF.test(_e)||_e=="+"||_e=="-"||_e=="."))w+=_e.toLowerCase();else{if(_e!=":"){if(s)return"Invalid scheme";w="",f=bm,_=0;continue}if(s&&(bb(o)!=Q(ri,w)||w=="file"&&(o.username!=""||o.password!=""||o.port!==null)||o.scheme=="file"&&!o.host))return;if(o.scheme=w,s)return void(bb(o)&&ri[o.scheme]==o.port&&(o.port=null));w="",o.scheme=="file"?f=gm:bb(o)&&h&&h.scheme==o.scheme?f=Jt:bb(o)?f=Mt:i[_+1]=="/"?(f=Kt,_++):(o.cannotBeABaseURL=!0,o.path.push(""),f=Ot)}break;case bm:if(!h||h.cannotBeABaseURL&&_e!="#")return"Invalid scheme";if(h.cannotBeABaseURL&&_e=="#"){o.scheme=h.scheme,o.path=h.path.slice(),o.query=h.query,o.fragment="",o.cannotBeABaseURL=!0,f=dd;break}f=h.scheme=="file"?gm:cm;continue;case Jt:if(_e!="/"||i[_+1]!="/"){f=cm;continue}f=si,_++;break;case Kt:if(_e=="/"){f=ti;break}f=Hc;continue;case cm:if(o.scheme=h.scheme,_e==null)o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query=h.query;else if(_e=="/"||_e=="\\"&&bb(o))f=Lt;else if(_e=="?")o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query="",f=le;else{if(_e!="#"){o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.path.pop(),f=Hc;continue}o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query=h.query,o.fragment="",f=dd}break;case Lt:if(!bb(o)||_e!="/"&&_e!="\\"){if(_e!="/"){o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,f=Hc;continue}f=ti}else f=si;break;case Mt:if(f=si,_e!="/"||w.charAt(_+1)!="/")continue;_++;break;case si:if(_e!="/"&&_e!="\\"){f=ti;continue}break;case ti:if(_e=="@"){for(j&&(w="%40"+w),j=!0,w=Td(w),_e=0;_e<w.length;_e++){var _o=w[_e];_o!=":"||K?(_o=Cd(_o,Zl),K?o.password+=_o:o.username+=_o):K=!0}w=""}else if(_e==null||_e=="/"||_e=="?"||_e=="#"||_e=="\\"&&bb(o)){if(j&&w=="")return"Invalid authority";_-=Td(w).length+1,w="",f=dm}else w+=_e;break;case dm:case em:if(s&&o.scheme=="file"){f=hm;continue}if(_e!=":"||F){if(_e==null||_e=="/"||_e=="?"||_e=="#"||_e=="\\"&&bb(o)){if(bb(o)&&w=="")return"Invalid host";if(s&&w==""&&(o.username!=""||o.password!=""||o.port!==null))return;if(f=Yl(o,w))return f;if(w="",f=Jg,s)return;continue}_e=="["?F=!0:_e=="]"&&(F=!1),w+=_e}else{if(w=="")return"Invalid host";if(f=Yl(o,w))return f;if(w="",f=fm,s==em)return}break;case fm:if(!Xl.test(_e)){if(_e==null||_e=="/"||_e=="?"||_e=="#"||_e=="\\"&&bb(o)||s){if(w!=""){if(65535<(f=parseInt(w,10)))return"Invalid port";o.port=bb(o)&&f===ri[o.scheme]?null:f,w=""}if(s)return;f=Jg;continue}return"Invalid port"}w+=_e;break;case gm:if(o.scheme="file",_e=="/"||_e=="\\")f=Nt;else{if(!h||h.scheme!="file"){f=Hc;continue}if(_e==null)o.host=h.host,o.path=h.path.slice(),o.query=h.query;else if(_e=="?")o.host=h.host,o.path=h.path.slice(),o.query="",f=le;else{if(_e!="#"){Gt(i.slice(_).join(""))||(o.host=h.host,o.path=h.path.slice(),Ht(o)),f=Hc;continue}o.host=h.host,o.path=h.path.slice(),o.query=h.query,o.fragment="",f=dd}}break;case Nt:if(_e=="/"||_e=="\\"){f=hm;break}h&&h.scheme=="file"&&!Gt(i.slice(_).join(""))&&(Ig(h.path[0],!0)?o.path.push(h.path[0]):o.host=h.host),f=Hc;continue;case hm:if(_e==null||_e=="/"||_e=="\\"||_e=="?"||_e=="#"){if(!s&&Ig(w))f=Hc;else{if(w==""){if(o.host="",s)return}else{if(f=Yl(o,w))return f;if(o.host=="localhost"&&(o.host=""),s)return;w=""}f=Jg}continue}w+=_e;break;case Jg:if(bb(o)){if(f=Hc,_e!="/"&&_e!="\\")continue}else if(s||_e!="?")if(s||_e!="#"){if(_e!=null&&(f=Hc,_e!="/"))continue}else o.fragment="",f=dd;else o.query="",f=le;break;case Hc:if(_e==null||_e=="/"||_e=="\\"&&bb(o)||!s&&(_e=="?"||_e=="#")){if((_o=(_o=w).toLowerCase())===".."||_o==="%2e."||_o===".%2e"||_o==="%2e%2e"?(Ht(o),_e=="/"||_e=="\\"&&bb(o)||o.path.push("")):w==="."||w.toLowerCase()==="%2e"?_e=="/"||_e=="\\"&&bb(o)||o.path.push(""):(o.scheme=="file"&&!o.path.length&&Ig(w)&&(o.host&&(o.host=""),w=w.charAt(0)+":"),o.path.push(w)),w="",o.scheme=="file"&&(_e==null||_e=="?"||_e=="#"))for(;1<o.path.length&&o.path[0]==="";)o.path.shift();_e=="?"?(o.query="",f=le):_e=="#"&&(o.fragment="",f=dd)}else w+=Cd(_e,Ft);break;case Ot:_e=="?"?(o.query="",f=le):_e=="#"?(o.fragment="",f=dd):_e!=null&&(o.path[0]+=Cd(_e,qi));break;case le:s||_e!="#"?_e!=null&&(_e=="'"&&bb(o)?o.query+="%27":o.query=_e=="#"?o.query+"%23":o.query+Cd(_e,qi)):(o.fragment="",f=dd);break;case dd:_e!=null&&(o.fragment+=Cd(_e,Et))}_++}},Dd=function(o){var i=hc(this,Dd,"URL"),s=1<arguments.length?arguments[1]:void 0,h=String(o),f=DF(i,{type:"URL"});if(s!==void 0){if(s instanceof Dd)var _=Na(s);else if(s=Ic(_={},String(s)))throw TypeError(s)}if(s=Ic(f,h,null,_))throw TypeError(s);var w=f.searchParams=new CF;(h=Hb(w)).updateSearchParams(f.query),h.updateURL=function(){f.query=String(w)||null},fa||(i.href=ui.call(i),i.origin=Pt.call(i),i.protocol=Qt.call(i),i.username=Rt.call(i),i.password=St.call(i),i.host=Tt.call(i),i.hostname=Ut.call(i),i.port=Vt.call(i),i.pathname=Wt.call(i),i.search=Xt.call(i),i.searchParams=Yt.call(i),i.hash=Zt.call(i))},im=Dd.prototype,ui=function(){var o=Na(this),i=o.scheme,s=o.username,h=o.password,f=o.host,_=o.port,w=o.path,j=o.query,F=o.fragment,K=i+":";return f!==null?(K+="//",o.username==""&&o.password==""||(K+=s+(h?":"+h:"")+"@"),K+=Hg(f),_!==null&&(K+=":"+_)):i=="file"&&(K+="//"),K+=o.cannotBeABaseURL?w[0]:w.length?"/"+w.join("/"):"",j!==null&&(K+="?"+j),F!==null&&(K+="#"+F),K},Pt=function(){var o=Na(this),i=o.scheme,s=o.port;if(i=="blob")try{return new Dd(i.path[0]).origin}catch{return"null"}return i!="file"&&bb(o)?i+"://"+Hg(o.host)+(s!==null?":"+s:""):"null"},Qt=function(){return Na(this).scheme+":"},Rt=function(){return Na(this).username},St=function(){return Na(this).password},Tt=function(){var o=Na(this),i=o.host;return o=o.port,i===null?"":o===null?Hg(i):Hg(i)+":"+o},Ut=function(){var o=Na(this).host;return o===null?"":Hg(o)},Vt=function(){var o=Na(this).port;return o===null?"":String(o)},Wt=function(){var o=Na(this),i=o.path;return o.cannotBeABaseURL?i[0]:i.length?"/"+i.join("/"):""},Xt=function(){var o=Na(this).query;return o?"?"+o:""},Yt=function(){return Na(this).searchParams},Zt=function(){var o=Na(this).fragment;return o?"#"+o:""},$b=function(o,i){return{get:o,set:i,configurable:!0,enumerable:!0}};if(fa&&Wo(im,{href:$b(ui,function(o){var i=Na(this);if(o=Ic(i,String(o)))throw TypeError(o);Hb(i.searchParams).updateSearchParams(i.query)}),origin:$b(Pt),protocol:$b(Qt,function(o){var i=Na(this);Ic(i,String(o)+":",am)}),username:$b(Rt,function(o){var i=Na(this);if(o=Td(String(o)),!$l(i)){i.username="";for(var s=0;s<o.length;s++)i.username+=Cd(o[s],Zl)}}),password:$b(St,function(o){var i=Na(this);if(o=Td(String(o)),!$l(i)){i.password="";for(var s=0;s<o.length;s++)i.password+=Cd(o[s],Zl)}}),host:$b(Tt,function(o){var i=Na(this);i.cannotBeABaseURL||Ic(i,String(o),dm)}),hostname:$b(Ut,function(o){var i=Na(this);i.cannotBeABaseURL||Ic(i,String(o),em)}),port:$b(Vt,function(o){var i=Na(this);$l(i)||((o=String(o))==""?i.port=null:Ic(i,o,fm))}),pathname:$b(Wt,function(o){var i=Na(this);i.cannotBeABaseURL||(i.path=[],Ic(i,o+"",Jg))}),search:$b(Xt,function(o){var i=Na(this);(o=String(o))==""?i.query=null:(o.charAt(0)=="?"&&(o=o.slice(1)),i.query="",Ic(i,o,le)),Hb(i.searchParams).updateSearchParams(i.query)}),searchParams:$b(Yt),hash:$b(Zt,function(o){var i=Na(this);(o=String(o))==""?i.fragment=null:(o.charAt(0)=="#"&&(o=o.slice(1)),i.fragment="",Ic(i,o,dd))})}),Ea(im,"toJSON",function(){return ui.call(this)},{enumerable:!0}),Ea(im,"toString",function(){return ui.call(this)},{enumerable:!0}),Gg){var $t=Gg.createObjectURL,au=Gg.revokeObjectURL;$t&&Ea(Dd,"createObjectURL",function(o){return $t.apply(Gg,arguments)}),au&&Ea(Dd,"revokeObjectURL",function(o){return au.apply(Gg,arguments)})}gc(Dd,"URL"),M({global:!0,forced:!Tl,sham:!fa},{URL:Dd});var PF=new Blob(["var fakeIdToId = {};onmessage = function (event) {	var data = event.data,		name = data.name,		fakeId = data.fakeId,		time;	if(data.hasOwnProperty('time')) {		time = data.time;	}	switch (name) {		case 'setInterval':			fakeIdToId[fakeId] = setInterval(function () {				postMessage({fakeId: fakeId});			}, time);			break;		case 'clearInterval':			if (fakeIdToId.hasOwnProperty (fakeId)) {				clearInterval(fakeIdToId[fakeId]);				delete fakeIdToId[fakeId];			}			break;	}}"]),QF=window.URL.createObjectURL(PF),Me={},Rf=0,uj=new Worker(QF);uj.onmessage=function(o){if(o=o.data.fakeId,Me.hasOwnProperty(o)){var i=Me[o];o=i.callback,i=i.parameters,o.apply(window,i)}};var RF=function(o){function i(){return X(this,i),s.apply(this,arguments)}ja(i,o);var s=ka(i);return Ia(i,[{key:"requestAsyncId",value:function(h,f){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return fw(h.flush.bind(h,this),_)}},{key:"recycleAsyncId",value:function(h,f){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(_!==null&&this.delay===_&&this.pending===!1)return f;Me.hasOwnProperty(f)&&(delete Me[f],uj.postMessage({name:"clearInterval",fakeId:f}))}}]),i}(pt),SF=new rt(RF),TF=["backups","servers"],UF=["backups","servers"],VF=["group"],jm=v.inflate,bu=v.deflate,cu=function(o){function i(h,f,_,w){X(this,i);var j=s.call(this,w,"Session");return m(n(j),"chatManager",void 0),m(n(j),"usedChannelIds",[]),m(n(j),"msgDedupLru",new Ac(void 0,{maxlen:200})),m(n(j),"startTime",Date.now()),m(n(j),"seq",U.fromNumber(1,!0)),m(n(j),"userJoinOptions",new nt(!1)),m(n(j),"seqSentStatuses",[!1,!1]),m(n(j),"dialogueSequenceLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"loggedOut",!1),m(n(j),"messageSentTimes",[]),m(n(j),"curLoginSockets",[void 0,void 0]),m(n(j),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(j),"lastLoginSockets",[new Ee(1),new Ee(1)]),m(n(j),"dialPendingMsgSubjectMap",new Map),m(n(j),"context",void 0),m(n(j),"connection",void 0),m(n(j),"instanceId",void 0),m(n(j),"lastPingTime",void 0),m(n(j),"registerSocketsFailureListener",function(){j.connection.once("socketsFailure",function(){j.log("socketsFailure, creating a new connection"),hd(function(){return j.connection.removeAllListeners(),j.connection=new ct(j.context,j.logger,!0),j.loginHandler(15e3,!0)}).pipe(Ce(function(F){return F.pipe(jd(ie.getParameter("RECONNECTING_AP_INTERVAL")))}),rb(j.connection.apClient.apFinish$)).subscribe(function(){j.log("new connection connected")})}),j.connection.listenerCount("tokenExpired")===0&&j.connection.on("tokenExpired",function(){j.emit("tokenExpired")})}),j.context=h,j.connection=f,j.instanceId=_,j.chatManager=new dF(w),j.lastPingTime=[0,0],j.setMaxListeners(512),j.log("The instanceId is %s",j.instanceId.toString()),j}ja(i,o);var s=ka(i);return Ia(i,[{key:"fetchFileUploadIndexGet",value:function(h){var f=h.hash,_=h.size;if((h=this.getLoginSockets()).length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return h.forEach(function(j){j.sendPacket("FileUploadIndexGet",{seq:w,hash:f,size:_})}),{ret:Da.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexRet").pipe(aa(function(F){return w.eq(F.seq)}))}))),fin:Da.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexFin").pipe(aa(function(F){return w.eq(F.seq)}))}))),err:cc.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw new da(["The media message upload failure, code %d",F.code],Dg)}))}))),timeout:i.genTimeoutError(ji)}}},{key:"requestFileUploadIndexSet",value:function(h){var f=h.hash,_=h.unit,w=h.servers;if((h=this.getLoginSockets()).length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return h.forEach(function(F){F.sendPacket("FileUploadIndexSet",{seq:j,servers:w,hash:f,unit:_})}),Da.apply(void 0,[i.genTimeoutError(ji)].concat(G(h.map(function(F){return F.fromReceived("FileUploadIndexErr").pipe(aa(function(K){return j.eq(K.seq)}),ea(function(K){throw new da(["FileUploadIndexSet failure, code %d",K.code],Dg)}))})),G(h.map(function(F){return F.fromReceived("FileUploadIndexFin").pipe(aa(function(K){return j.eq(K.seq)}))}))))}},{key:"requestFileDownloadIndexGet",value:function(h){var f=h.size,_=h.zone,w=h.unit,j=h.hash,F=this.getLoginSockets();if(F.length===0)throw new L("Client is not logged in");var K=this.incGetSeq();return F.forEach(function(_e){_e.sendPacket("FileDownloadIndexGet",{seq:K,size:f,zone:_,unit:w,hash:j})}),h=Da.apply(void 0,G(F.map(function(_e){return _e.fromReceived("FileDownloadIndexRet").pipe(aa(function(_o){return K.eq(_o.seq)}))}))).pipe(ea(function(_e){var _o=_e.backups,ca=_e.servers;return _e=yf(_e,TF),wa({backupList:_o.map(function(_c){return[_c]}),serverList:ca.map(function(_c){return[_c]})},_e)}),jd(500)),F=mn(F.map(function(_e){return _e.fromReceived("FileDownloadIndexRet").pipe(aa(function(_o){return K.eq(_o.seq)}))})),Da(h,F.pipe(ea(function(_e){return _e.reduce(function(_o,ca){var _c=_o.backupList,ch=_o.serverList;_o=ca.backups;var Nf=ca.servers;return ca=yf(ca,UF),wa({backupList:_o.map(function(bh,_g){return[bh].concat(G(_c!==void 0&&Array.isArray(_c[_g])?_c[_g]:[]))}),serverList:Nf.map(function(bh,_g){return[bh].concat(G(_c!==void 0&&Array.isArray(ch[_g])?ch[_g]:[]))})},ca)},{})})),i.genTimeoutError(ji))}},{key:"loginHandler",value:function(){var h=this,f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:12e3,_=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&_)throw new L("Already logged out, request ignored");_&&this.registerSocketsFailureListener(),this.connection.initConnection();var w=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),j=Date.now();return w.forEach(function(F,K){var _e=h.loginSocketSubs[K].login;_e!==void 0&&_e.unsubscribe(),h.loginSocketSubs[K].login=F.pipe(ba(function(_o){var ca;h.curLoginSockets[K]=_o;var _c=Date.now();hb("Link",{ackedServerIp:_o.address,destServerIp:_o.ip,ec:0,sc:0,elapse:ib(h.startTime),lts:U.fromNumber(_c),responseTime:_c-j,sid:ab(h.instanceId),userId:h.context.uid},(ca=h.context.config.enableCloudProxy)!==null&&ca!==void 0&&ca),h.emit("userJoined",_o.env),_&&h.connection.apClient.apFinish$.next(void 0)})).subscribe(h.lastLoginSockets[K])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),cc.apply(void 0,G(w).concat([jb(this.connection,"connectionInitFailure").pipe(ba(function(F){throw ta(F)||Xa(F)?F:new da("Login failure",{code:cs,originalError:F})}))])).pipe(Pa(1),kb(f),Ja(function(F){return F instanceof sb&&h.warn("Client login timeout"),F&&F.code===ii&&(h.connection.emit("tokenExpired"),h.connection.apClient.apFinish$.next(void 0)),h.clearSockets(0,_),Z(F)}),ba(function(){_||h.registerSocketsFailureListener()}),Tg(function(){_||h.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:function(){var h=J(x.mark(function f(){var _,w,j,F=this;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),_=this.getLoginSockets(),w=_.map(function(_e){return _e.sendPacket("UserQuit",{}),F.connection.waitClosing(_e)}),this.clearSockets(5e3),j=_.map(function(_e){return _e.env}),[0,1].filter(function(_e){return!j.includes(_e)}).forEach(function(_e){F.connection.closeSocket(_e,0)}),K.abrupt("return",cc.apply(void 0,G(w)).toPromise());case 9:case"end":return K.stop()}},f,this)}));return function(){return h.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var h=J(x.mark(function f(_){var w,j,F,K=this;return x.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(this.getLoginSockets().length!==0){_e.next=2;break}throw new L("Client is not logged in. Cannot join the channel",Zr);case 2:return w=jb(this,"channelLeft").pipe(zb(function(_o){return _===_o}),Pa(1)),j=this.incGetSeq(),(F=this.lastLoginSockets.map(function(_o){return _o.pipe(Lc(function(ca,_c){_c!==0&&K.incSeqIfNeeded(ca.env);var ch=_c===0?j:K.seq;return ca.sendPacket("GroupEnter",{account:_,seq:ch}),ca.fromReceived("GroupReply").pipe(aa(function(Nf){return ch.eq(Nf.seq)}),ba(function(Nf){if((Nf=Nf.code)!==0)throw new da(["Channel join failure. The response code is %d",Nf],Vr)}))}),rb(w),De())})).forEach(function(_o,ca){var _c=function(){return K.loginSocketSubs[ca].channels.delete(_)};K.loginSocketSubs[ca].channels.set(_,_o.subscribe({error:_c,complete:_c}))}),_e.next=8,cc.apply(void 0,G(F)).pipe(Pa(1),kb(1e4),Ja(function(_o){return _o instanceof sb&&K.warn("Channel join timeout"),Z(_o)})).toPromise();case 8:case"end":return _e.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(h){this.getLoginSockets().forEach(function(f){f.sendPacket("GroupLeave",{account:h})})}},{key:"requestChannelMemberList",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in. Cannot get the channel members",ZB);var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("GroupAllUsersList",{group:h,pageNumber:0,pageSize:200,seq:_})}),Da.apply(void 0,[i.genTimeoutError(Tr)].concat(G(f.map(function(w){return w.fromReceived("GroupAllUsersResult").pipe(aa(function(j){var F=j.seq;return j.group===h&&_.eq(F)}))}))))}},{key:"requestPeersOnlineStatus",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("UserStatusList",{users:h,seq:_})}),Da.apply(void 0,[i.genTimeoutError(kC)].concat(G(f.map(function(w){return w.fromReceived("UserStatusResult").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(h,f){var _=this,w=this.getLoginSockets();if(w.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return w.forEach(function(F,K){f!==void 0&&K!==f||F.sendPacket("UserAttributeSet",{account:_.context.uid,attributeInfos:Object.entries(h).map(function(_e){return{key:(_e=ua(_e,2))[0],value:_e[1]}}),seq:j})}),Da.apply(void 0,G(w.map(function(F){return F.fromReceived("UserAttributeErr").pipe(aa(function(K){return j.eq(K.seq)}),ea(function(K){throw new da(["The user attributes set failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(w.map(function(F){return F.fromReceived("UserAttributeRsp").pipe(aa(function(K){return j.eq(K.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(h,f,_){var w=this.getLoginSockets();if(w.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return w.forEach(function(F){F.sendPacket("GroupAttributeSet",{broadcast:_,group:h,attributeInfos:Object.entries(f).map(function(K){return{key:(K=ua(K,2))[0],value:K[1]}}),seq:j})}),Da.apply(void 0,G(w.map(function(F){return F.fromReceived("GroupAttributeErr").pipe(aa(function(K){return j.eq(K.seq)}),ea(function(K){throw new da(["The group attributes set failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(w.map(function(F){return F.fromReceived("GroupAttributeRsp").pipe(aa(function(K){return j.eq(K.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(h){var f=this,_=this.getLoginSockets();if(_.length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return _.forEach(function(j){j.sendPacket("UserAttributeMod",{account:f.context.uid,attributeInfos:Object.entries(h).map(function(F){return{key:(F=ua(F,2))[0],value:F[1]}}),seq:w})}),Da.apply(void 0,G(_.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw new da(["The user attributes add or update failure, code %d",F.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(_.map(function(j){return j.fromReceived("UserAttributeRsp").pipe(aa(function(F){return w.eq(F.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(h,f,_){var w=this.getLoginSockets();if(w.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return w.forEach(function(F){F.sendPacket("GroupAttributeMod",{broadcast:_,group:h,attributeInfos:Object.entries(f).map(function(K){return{key:(K=ua(K,2))[0],value:K[1]}}),seq:j})}),Da.apply(void 0,G(w.map(function(F){return F.fromReceived("GroupAttributeErr").pipe(aa(function(K){return j.eq(K.seq)}),ea(function(K){throw new da(["The group attributes add or update failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(w.map(function(F){return F.fromReceived("GroupAttributeRsp").pipe(aa(function(K){return j.eq(K.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(h){var f=this,_=this.getLoginSockets();if(_.length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return _.forEach(function(j){j.sendPacket("UserAttributeDel",{account:f.context.uid,attributes:h,seq:w})}),Da.apply(void 0,G(_.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw new da(["The user attributes delete failure, code %d",F.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(_.map(function(j){return j.fromReceived("UserAttributeRsp").pipe(aa(function(F){return w.eq(F.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(h,f,_){var w=this.getLoginSockets();if(w.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return w.forEach(function(F){F.sendPacket("GroupAttributeDel",{group:h,broadcast:_,attributes:f,seq:j})}),Da.apply(void 0,G(w.map(function(F){return F.fromReceived("GroupAttributeErr").pipe(aa(function(K){return j.eq(K.seq)}),ea(function(K){throw new da(["The channel attributes delete failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(w.map(function(F){return F.fromReceived("GroupAttributeRsp").pipe(aa(function(K){return j.eq(K.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var h=this,f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("UserAttributeSet",{account:h.context.uid,seq:_,attributeInfos:[]})}),Da.apply(void 0,G(f.map(function(w){return w.fromReceived("UserAttributeErr").pipe(aa(function(j){return _.eq(j.seq)}),ea(function(j){throw new da(["The user attributes clear failure, code %d",j.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(f.map(function(w){return w.fromReceived("UserAttributeRsp").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(h,f){var _=this.getLoginSockets();if(_.length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return _.forEach(function(j){j.sendPacket("GroupAttributeSet",{group:h,seq:w,attributeInfos:[],broadcast:f})}),Da.apply(void 0,G(_.map(function(j){return j.fromReceived("GroupAttributeErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw new da(["The channel attributes clear failure, code %d",F.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(_.map(function(j){return j.fromReceived("GroupAttributeRsp").pipe(aa(function(F){return w.eq(F.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(h,f){var _=this.getLoginSockets();if(_.length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return _.forEach(function(j){j.sendPacket("UserAttributeGet",{account:h,seq:w,attributes:f})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(_.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw(F=F.code)===10008?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",F],Xb)}))})),G(_.map(function(j){return j.fromReceived("UserAttributeRet").pipe(aa(function(F){return w.eq(F.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(h,f){var _=this.getLoginSockets();if(_.length===0)throw new L("Client is not logged in");var w=this.incGetSeq();return _.forEach(function(j){j.sendPacket("GroupAttributeGet",{group:h,seq:w,attributes:f})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(_.map(function(j){return j.fromReceived("GroupAttributeErr").pipe(aa(function(F){return w.eq(F.seq)}),ea(function(F){throw new da(["The channel attributes get failure, code %d",F.code],Xb)}))})),G(_.map(function(j){return j.fromReceived("GroupAttributeRet").pipe(aa(function(F){return w.eq(F.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("UserAttributeKeysGet",{account:h,seq:_})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(f.map(function(w){return w.fromReceived("UserAttributeErr").pipe(aa(function(j){return _.eq(j.seq)}),ea(function(j){throw(j=j.code)===10008?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",j],Xb)}))})),G(f.map(function(w){return w.fromReceived("UserAttributeKeysRet").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("GroupAttributeKeysGet",{group:h,seq:_})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(f.map(function(w){return w.fromReceived("GroupAttributeErr").pipe(aa(function(j){return _.eq(j.seq)}),ea(function(j){throw new bd(["Channel attribute operation unknown error code: %d",j.code],Xb)}))})),G(f.map(function(w){return w.fromReceived("GroupAttributeKeysRet").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("GroupStatusList",{groups:h,seq:_})}),Da.apply(void 0,[i.genTimeoutError(Tr)].concat(G(f.map(function(w){return w.fromReceived("GroupStatusResult").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();return f.forEach(function(w){w.sendPacket("SubscribeUserStatus",{seq:_,users:h})}),Da.apply(void 0,[i.genTimeoutError(rC)].concat(G(f.map(function(w){return w.fromReceived("SubscribeResponse").pipe(aa(function(j){return _.eq(j.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(h){var f=this.getLoginSockets();if(f.length===0)throw new L("Client is not logged in");var _=this.incGetSeq();f.forEach(function(w){w.sendPacket("UnsubscribeUserStatus",{seq:_,users:h})})}},{key:"sendInvitationMessage",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v=this;return x.wrap(function(h0){for(;;)switch(h0.prev=h0.next){case 0:if(w=_.peerId,j=_.callId,F=_.extra,K=_.isAcceptAck,_e=_.channelId,_o=_.type,ca={callId:j},K===void 0){h0.next=6;break}if(_o==="CallAccept"){h0.next=5;break}throw Error("invalid invitation type");case 5:ca.type=K?"ack":"request";case 6:return ca.channel=_e,(_o==="CallInvite"||_o==="CallCancel"||_o==="CallReject"||_o==="CallAccept"&&K===!1)&&F!==void 0&&(ca.extra=F),_c=Yg(),this.log("The sent invitation body is %o",ca),ch=function(A0){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:_c,instance:_v.instanceId,dst:w,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:A0,MessageType:_o}).toLong(),payload:new TextEncoder().encode(JSON.stringify(ca)),src:_v.context.uid}},h0.next=14,Ob(this.sendMessageToRetry(ch,!0)).pipe(kb(1e4),Ja(function(A0){return A0 instanceof sb&&_v.warn("Send invitation timeout"),Z(A0)})).toPromise();case 14:return Nf=h0.sent,bh=Nf.code,_g=Nf.retryTimes,h0.abrupt("return",{hasPeerReceived:bh===0,hasReSent:_g!==0});case 18:case"end":return h0.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var h=J(x.mark(function f(_,w,j,F,K,_e){var _o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0,R0,k0,G0,pI,u0,C0,v0,T0,Qv,r0,a0,I0,O0,nI,U0,_I,dI,QI,qI=this;return x.wrap(function(T1){for(;;)switch(T1.prev=T1.next){case 0:if(ca=w.width,_c=ca===void 0?0:ca,ch=w.height,Nf=ch===void 0?0:ch,bh=w.fileName,_g=bh===void 0?"":bh,_v=w.description,h0=_v===void 0?"":_v,A0=w.thumbnail,M0=A0===void 0?new Blob:A0,R0=w.thumbnailHeight,k0=R0===void 0?0:R0,G0=w.thumbnailWidth,pI=G0===void 0?0:G0,u0=w.size,C0=u0===void 0?0:u0,v0=w.mediaId,T0=K.enableOfflineMessaging,Qv=K.enableHistoricalMessaging,Aa(j)){T1.next=4;break}throw new H("The send message arguments are not valid",F?Gl:Ag);case 4:if(!(32768<new Blob([_g,M0,h0]).size)){T1.next=6;break}throw new H("The size of message overflowed ",F?Ie:fi);case 6:return r0=this.chatManager.getChatInfo(j),a0=r0.dialogue,I0=r0.sequence,O0=this.instanceId,this.log('A%s media message is sending to %s: "'.concat(O0,"-").concat(a0,"#").concat(I0,'"'),F?" peer":" channel",pa(j)),m(_o={},"media_description",h0),m(_o,"media_width",_c),m(_o,"media_height",Nf),m(_o,"media_thumbnailwidth",pI),m(_o,"media_thumbnailheight",k0),m(_o,"media_size",C0),m(_o,"media_id",v0),m(_o,"media_filename",_g),nI=Bc(_o,function(h1){return new TextEncoder().encode(h1.toString())}),T1.t0=Uint8Array,T1.next=14,pj(M0);case 14:return T1.t1=T1.sent,nI.media_thumbnail=new T1.t0(T1.t1),U0=F&&_==="IMAGE"?"PeerImageMessage":F&&_==="FILE"?"PeerFileMessage":F||_!=="IMAGE"?"ChannelFileMessage":"ChannelImageMessage",_I=function(h1){return{MiscMap:nI,sequence:I0,dialogue:a0,instance:O0,dst:j,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:h1,CompressionMethod:"Uncompressed",MessageType:U0,ToCache:T0,ToArchive:Qv}).toLong(),payload:new Uint8Array,src:qI.context.uid}},T1.next=20,Ob(this.sendMessageToRetry(_I,!0)).pipe(kb(_e===void 0?1e4:_e),Ja(function(h1){return h1 instanceof sb&&qI.warn("Send message timeout"),Z(h1)})).toPromise();case 20:if(dI=T1.sent,(QI=dI.code)!==2){T1.next=24;break}throw new da("The peer does not support this type of message",jC);case 24:return T1.abrupt("return",{hasPeerReceived:QI===0});case 25:case"end":return T1.stop()}},f,this)}));return function(f,_,w,j,F,K){return h.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var h=J(x.mark(function f(_,w,j,F,K,_e){var _o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0=this;return x.wrap(function(R0){for(;;)switch(R0.prev=R0.next){case 0:if(_o=K.enableOfflineMessaging,ca=K.enableHistoricalMessaging,Aa(j)&&_ instanceof Uint8Array&&typeof w=="string"){R0.next=3;break}throw new H("The send message arguments are not valid",F?Gl:Ag);case 3:if(!(32768<_.byteLength+new Blob([w]).size)){R0.next=5;break}throw new lb("The message size is over the 32KB limit",F?Ie:fi);case 5:return _c=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=_.byteLength,ch=this.chatManager.getChatInfo(j),Nf=ch.dialogue,bh=ch.sequence,_g=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(_g,"-").concat(Nf,"#").concat(bh,'"'),_c?" compressed":"",F?"peer":"channel",pa(j)),_v=function(k0){return{MiscMap:{description:new TextEncoder().encode(w)},sequence:bh,dialogue:Nf,instance:_g,dst:j,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:k0,CompressionMethod:_c?"Zlib":"Uncompressed",MessageType:F?"PeerRawMessage":"ChannelRawMessage",ToCache:_o,ToArchive:ca}).toLong(),payload:_c?bu(_):_,src:M0.context.uid}},R0.next=12,Ob(this.sendMessageToRetry(_v,!0)).pipe(kb(_e===void 0?1e4:_e),Ja(function(k0){return k0 instanceof sb&&M0.warn("Send message timeout"),Z(k0)})).toPromise();case 12:return h0=R0.sent,A0=h0.code,R0.abrupt("return",{hasPeerReceived:A0===0});case 15:case"end":return R0.stop()}},f,this)}));return function(f,_,w,j,F,K){return h.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var h=J(x.mark(function f(_,w,j,F,K){var _e,_o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0=this;return x.wrap(function(R0){for(;;)switch(R0.prev=R0.next){case 0:if(_e=F.enableOfflineMessaging,_o=F.enableHistoricalMessaging,Aa(w)){R0.next=3;break}throw new H("The send message arguments are not valid",j?Gl:Ag);case 3:if(!(32768<new Blob([_]).size)){R0.next=5;break}throw new lb("The message size is over the 32KB limit",j?Ie:fi);case 5:return ca=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([_]).size,_c=this.chatManager.getChatInfo(w),ch=_c.dialogue,Nf=_c.sequence,bh=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(bh,"-").concat(ch,"#").concat(Nf,'"'),ca?" compressed":"",j?"peer":"channel",pa(w)),_g=new TextEncoder().encode(_),_v=function(k0){return{MiscMap:{},sequence:Nf,dialogue:ch,instance:bh,dst:w,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:k0,CompressionMethod:ca?"Zlib":"Uncompressed",MessageType:j?"PeerTextMessage":"ChannelTextMessage",ToCache:_e,ToArchive:_o}).toLong(),payload:ca?bu(_g):_g,src:M0.context.uid}},R0.next=13,Ob(this.sendMessageToRetry(_v,!0)).pipe(kb(K===void 0?1e4:K),Ja(function(k0){return k0 instanceof sb&&M0.warn("Send message timeout"),Z(k0)})).toPromise();case 13:return h0=R0.sent,A0=h0.code,R0.abrupt("return",{hasPeerReceived:A0===0});case 16:case"end":return R0.stop()}},f,this)}));return function(f,_,w,j,F){return h.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(h,f){Object.entries(this.loginSocketSubs[h]).forEach(function(_){var w=(_=ua(_,2))[1];_[0]==="channels"&&f||(Array.isArray(w)||w instanceof Map?w.forEach(function(j){return j.unsubscribe()}):w&&w.unsubscribe())}),this.loginSocketSubs[h]={channels:f?this.loginSocketSubs[h].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch,Nf,bh=this,_g=arguments;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:if(j=2<_g.length&&_g[2]!==void 0?_g[2]:0,this.log("Attempt to send the message ".concat(w?" with retrying, %o":"without retrying"),{retryTimes:j}),(F=this.getLoginSockets()).length!==0){_v.next=5;break}throw Error("no logged-in sockets");case 5:return K=_(j),F.forEach(function(h0){h0.sendPacket("Message",K)}),_e=K.dialogue,_o=K.sequence,ca=K.instance,_c=F.map(function(h0){return h0.fromReceived("Ack").pipe(zb(function(A0){return _e.eq(A0.dialogue)&&_o.eq(A0.sequence)&&ca.eq(A0.instance)}))}),_v.prev=9,_v.next=12,cc.apply(void 0,G(_c)).pipe(kb(6e3),Ja(function(h0){return Xa(h0)&&bh.warn("Message send timeout, retry times %d",j),Z(h0)}),Pa(1)).toPromise();case 12:return ch=_v.sent,Nf=ch.code,this.log("The message has been acked, %o",{code:Nf}),_v.abrupt("return",{code:Nf,retryTimes:j});case 18:if(_v.prev=18,_v.t0=_v.catch(9),!(_v.t0 instanceof sb&&w)){_v.next=22;break}return _v.abrupt("return",this.sendMessageToRetry(_,!1,j+1));case 22:throw _v.t0;case 23:case"end":return _v.stop()}},f,this,[[9,18]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var h=this;this.lastLoginSockets.map(function(f){return f.pipe(Lc(function(_){return Kc(0,2500,pe()?void 0:SF).pipe(ba(function(){h.sendPing(_)}))}))}).forEach(function(f,_){var w=h.loginSocketSubs[_].keepAlive;w!==void 0&&w.unsubscribe(),h.loginSocketSubs[_].keepAlive=f.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var h=this;this.lastLoginSockets.map(function(f){return f.pipe(Lc(function(_){var w,j=!1,F=_.userJoin$.pipe(ba(function(){j=!0})),K=_.input$.pipe(ba(function(_e){rj[_e.uri].slice(0,-3)!=="Ping"&&(j=!1)}));return cc(Kc(6e3,1e4).pipe(Jv(_.receivedPacket),ba(function(_e){_e=ua(_e,2),_e=ua(_e[1],2)[1],w!==_e||j||_.forceReconnect(),w=_e})),F,K)}))}).forEach(function(f,_){var w=h.loginSocketSubs[_].keepAliveReconnector;w!==void 0&&w.unsubscribe(),h.loginSocketSubs[_].keepAliveReconnector=f.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var h=this;this.lastLoginSockets.map(function(f){return f.pipe(Lc(function(_){return cc(jb(_,"reconnect").pipe(ba(h.onSocketReconnect(_))),_.fromReceived("Message").pipe(ba(h.onMessage(_))),_.fromReceived("GroupEnterNotice").pipe(ba(h.onGroupEnterNotice())),_.fromReceived("GroupLeaveNotice").pipe(ba(h.onGroupLeaveNotice())),_.fromReceived("GroupCountNotice").pipe(ba(h.onGroupCountNotice())),_.fromReceived("GroupAttributeAlt").pipe(ba(h.onGroupAttributeAlt())),_.fromReceived("UserJoinNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.ONLINE))),_.fromReceived("UserQuitNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.OFFLINE))),_.fromReceived("UserWaitNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.UNREACHABLE))),_.fromReceived("Pong").pipe(ba(h.onPong())),_.fromReceived("UserDrop").pipe(ba(h.onUserDrop(_)))).pipe(If(void 0))}))}).forEach(function(f,_){h.loginSocketSubs[_].receivers.push(f.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(h,f,_){var w=this;return ln(hd(function(){w.userJoinOptions=new nt(f),h.sendPacket("UserJoin",{account:w.context.uid,instance:w.instanceId,opt:w.userJoinOptions.toLong(),seq:_,ticket:h.ticket})}),h.fromReceived("UserResp").pipe(aa(function(j){return _.eq(j.seq)}),ba(function(j){if((j=j.code)!==0)throw w.clearSockets(),w.logError("Connected to gateway success but the Rtm server rejected login"),new da(["Login failure. The response code from the RTM service is %d",j],Bg);h.attemptsSinceLastError=0,h.loggedIn=!0,w.log("ENV_%d logged in",h.env)}),If(h),kb(6e3))).pipe(zb(function(j){return j!==void 0}),Ja(function(j){return j instanceof sb&&w.warn("Login response timeout, rejoin: %s",f),w.clearSockets(),j.name="loginRespTimeout",w.emit("banEdgeIP",h.ip),Z(j)}))}},{key:"getSocketLoginObservables",value:function(h,f){var _=this;return h.map(function(w){return w.pipe(Lc(function(j,F){return _.incSeqIfNeeded(j.env),_.requestSocketLogin(j,F!==0,F===0?f:_.seq)}),De())})}},{key:"incSeqIfNeeded",value:function(h){if(![0,1].includes(h))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[h]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[h]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var h=this.curLoginSockets,f=-1,_=h==null?0:h.length,w=0,j=[];++f<_;){var F=h[f];F&&(j[w++]=F)}return j}},{key:"emitMessage",value:function(h,f){var _=h.options,w=h.payload,j=h.src,F=h.dst,K=h.instance,_e=h.dialogue,_o=h.sequence,ca=h.ms,_c=h.MiscMap;this.dialogueSequenceLru.set(_e.toString(),_o),K="".concat(K,"-").concat(_e,"#").concat(_o),this.msgDedupLru.has(K)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",f,K):(this.msgDedupLru.set(K,void 0),f=new ke(_),this.lastLoginSockets.forEach(function(){var ch=J(x.mark(function Nf(bh){var _g;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return _v.next=2,bh.pipe(Pa(1)).toPromise();case 2:_g=_v.sent,i.sendMessageAck(h,_g);case 4:case"end":return _v.stop()}},Nf)}));return function(Nf){return ch.apply(this,arguments)}}()),_=f.isZlibCompressed(),f.isInvitation()?(F=ra(_?jm($n(w,Uint8Array.of(0,0,0,0))):w),F=JSON.parse(F),this.log("The received invitation body is %o",F),this.emit("invitationMessage",{body:F,type:f.getInvitationType(),peerId:j,serverReceivedTs:ca.toNumber()})):f.isTextMessage()?(_c=f.isPeerTextMessage(),w=ra(_?jm($n(w,Uint8Array.of(0,0,0,0))):w),this.info("Received a %s %s text message from %s to %s, %s",_?" compressed":"",_c?"peer":"channel",pa(j),pa(F),K),_c?(j={text:w,peerId:j,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:f.isFromCache()}},this.emit("peerTextMessage",j)):this.emit("channelTextMessage",{channelId:F,memberId:j,text:w,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:!1}})):f.isRawMessage()?(_e=f.isRawPeerMessage(),_c=(_c=_c.description)===void 0?"":ra(_c),w=_?jm(w):w,this.info("Received a %s %s raw message from %s to %s, %s",_?" compressed":"",_e?"peer":"channel",pa(j),pa(F),K),_e?(j={desc:_c,raw:w,peerId:j,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:f.isFromCache()}},this.emit("peerRawMessage",j)):this.emit("channelRawMessage",{desc:_c,raw:w,channelId:F,memberId:j,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:!1}})):(f.isImageMessage()||f.isFileMessage())&&(w=f.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",w?"peer":"channel",pa(j),pa(F),K),w?this.emit("peerMediaMessage",{messageType:f.isImageMessage()?"IMAGE":"FILE",details:_c,peerId:j,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:f.isFromCache()}}):this.emit("channelMediaMessage",{messageType:f.isImageMessage()?"IMAGE":"FILE",details:_c,memberId:j,channelId:F,properties:{serverReceivedTs:ca.toNumber(),isOfflineMessage:f.isFromCache()}})))}},{key:"onSocketReconnect",value:function(h){var f=this;return function(){var _=[0,1].filter(function(w){return w!==h.env})[0];(_=f.connection.curOpenSockets[_])&&!_.loggedIn&&f.emit("connectionLost")}}},{key:"onUserDrop",value:function(h){var f=this;return function(_){var w;_=_.code,hb("KickedOff",{code:0,elapse:ib(f.startTime),linkId:parseInt(h.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:h.address,serverCode:_,sid:ab(f.instanceId),userId:f.context.uid},(w=f.context.config.enableCloudProxy)!==null&&w!==void 0&&w),_===10006||_===10001?f.warn("Login too often and kicked off, reconnect and login"):_===10009?(f.warn("The instance ID conflicts, reconnecting"),f.instanceId=Yg(),f.context.sid=ab(f.instanceId),f.emit("instanceChanged",f.instanceId)):[11,14,15,16].includes(_)&&(f.emit("userDrop",_),f.clearSockets())}}},{key:"clearSockets",value:function(){var h=this,f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,_=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(w){h.cleanLoginSubs(w,_),h.connection.closeSocket(w,f)})}},{key:"onMessage",value:function(h){var f=this;return function(_){var w=_.dialogue,j=_.instance,F=_.sequence,K=_.options;if(_.src===f.context.uid)f.log("The message is from the local account, ignored");else{var _e=w.toString(),_o=f.dialPendingMsgSubjectMap.get(_e);if(w="".concat(j,"-").concat(w,"#").concat(F),_o)_o.next(_),f.log("Env_%d: The dialogue has pending messages, next: %s",h.env,w);else{var ca=f.dialogueSequenceLru.get(_e);if(_o=!ca&&F.eq(1),j=ca!==void 0&&F.sub(ca).eq(1),_o||j)f.emitMessage(_,h.env);else{if(ca){if(F.lte(ca))return;f.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",h.env,w)}else f.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",h.env,w);F=new Ua,f.dialPendingMsgSubjectMap.set(_e,F);var _c=F.pipe(Ku(vl),Ug(function(ch,Nf){return[].concat(G(ch),[Nf])},[]),ea(function(ch){return G(ch).sort(function(Nf,bh){return Nf=Nf.sequence,bh=bh.sequence,Nf.eq(bh)?0:Nf.gt(bh)?1:-1})}),vn(1));K=!(K=new ke(K)).isFromCache()&&!K.isBufferedMessage(),_c.pipe(rb(Kc(K?750:1500)),aa(function(ch){if(2>ch.length)return!1;for(var Nf=ca===void 0?U.fromNumber(1,!0):ca.add(1),bh=0;bh<ch.length;Nf=Nf.add(1),bh++)if(!ch[bh].sequence.eq(Nf))return!1;return!0}),Tg(function(){f.dialPendingMsgSubjectMap.delete(_e)})).subscribe(function(ch){ch.forEach(function(Nf){f.emitMessage(Nf,h.env),f.log("Env_%d: The message queue has fully ordered, emitting: %s",h.env,"".concat(Nf.instance,"-").concat(Nf.dialogue,"#").concat(Nf.sequence))})},function(ch){ch instanceof Sg&&_c.pipe(Pa(1)).subscribe(function(Nf){return Nf.forEach(function(bh){f.log("Env_%d: The message pending queue expired, emitting: %s",h.env,"".concat(bh.instance,"-").concat(bh.dialogue,"#").concat(bh.sequence)),f.emitMessage(bh,h.env)})})}),F.next(_)}}}}}},{key:"onPong",value:function(){var h=this;return function(){document.hidden&&h.getLoginSockets().forEach(function(f){h.sendPing(f)})}}},{key:"onGroupEnterNotice",value:function(){var h=this;return function(f){h.emit("memberNotice",{channelId:f.group,seq:f.seq,instance:f.instance,memberId:f.user,type:"MemberJoined",size:f.size})}}},{key:"onGroupLeaveNotice",value:function(){var h=this;return function(f){h.emit("memberNotice",{channelId:f.group,seq:f.seq,instance:f.instance,memberId:f.user,type:"MemberLeft",size:f.size})}}},{key:"onGroupCountNotice",value:function(){var h=this;return function(f){h.emit("memberNotice",{channelId:f.group,seq:f.seq,instance:f.instance,type:"MemberCountUpdated",size:f.size})}}},{key:"onGroupAttributeAlt",value:function(){var h=this;return function(f){var _=f.group;f=yf(f,VF),h.emit("channelAttributesUpdated",wa({channelId:_},f))}}},{key:"onUserNotice",value:function(h){var f=this;return function(_){f.emit("peerOnlineStatusChanged",{peerId:_.user,instance:_.instance,seq:_.seq,state:h})}}},{key:"sendPing",value:function(h){2500>=Date.now()-this.lastPingTime[h.env]||(this.incSeqIfNeeded(h.env),h.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:this.seq}),this.lastPingTime[h.env]=Date.now())}}],[{key:"sendMessageAck",value:function(h,f){var _=new ke(h.options);(_.isInvitation()||_.isPeerMessage())&&f.sendPacket("Ack",{code:0,dialogue:h.dialogue,instance:h.instance,sequence:h.sequence})}}]),i}(wb());m(cu,"genTimeoutError",function(o,i){return eb(void 0).pipe(jd(i===void 0?1e4:i),ea(function(){throw new gb(["Request timed out after %ds",i===void 0?1e4:i],o)}))});var du,km,lm=0,mm=0;de.v1=function(o,i,s){s=i&&s||0;var h=i||[],f=(o=o||{}).node||du,_=o.clockseq!==void 0?o.clockseq:km;if(f==null||_==null){var w=Nr();f==null&&(f=du=[1|w[0],w[1],w[2],w[3],w[4],w[5]]),_==null&&(_=km=16383&(w[6]<<8|w[7]))}w=o.msecs!==void 0?o.msecs:new Date().getTime();var j=o.nsecs!==void 0?o.nsecs:mm+1,F=w-lm+(j-mm)/1e4;if(0>F&&o.clockseq===void 0&&(_=_+1&16383),(0>F||w>lm)&&o.nsecs===void 0&&(j=0),1e4<=j)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(lm=w,mm=j,km=_,o=(1e4*(268435455&(w+=122192928e5))+j)%4294967296,h[s++]=o>>>24&255,h[s++]=o>>>16&255,h[s++]=o>>>8&255,h[s++]=255&o,o=w/4294967296*1e4&268435455,h[s++]=o>>>8&255,h[s++]=255&o,h[s++]=o>>>24&15|16,h[s++]=o>>>16&255,h[s++]=_>>>8|128,h[s++]=255&_,_=0;6>_;++_)h[s+_]=f[_];return i||Or(h)},de.v4=de;var nm=ni(),Ed,uf=S.LocalInvitationFailureReason,Ca=S.LocalInvitationState,WF=(Ed=function(o){function i(h,f,_){X(this,i);var w=s.call(this,_,"RtmLocalInvitation",!0);return m(n(w),"state",Ca.IDLE),m(n(w),"localInvitationEnd$",Da(jb(n(w),"LocalInvitationAccepted"),jb(n(w),"LocalInvitationRefused"),jb(n(w),"LocalInvitationFailure"),jb(n(w),"LocalInvitationCanceled")).pipe(Pa(1))),m(n(w),"callId",de.v4()),m(n(w),"_content",""),m(n(w),"_channelId",""),m(n(w),"_response",""),m(n(w),"calleeId",void 0),m(n(w),"logger",void 0),m(n(w),"getSession",void 0),w.calleeId=h,w.getSession=f,w.logger=_,w}ja(i,o);var s=ka(i);return Ia(i,[{key:"channelId",get:function(){return this._channelId},set:function(h){this.state!==Ca.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=h)}},{key:"content",get:function(){return this._content},set:function(h){this.log("set content for %s",this.callId),this._content=h}},{key:"response",get:function(){return this._response},set:function(h){throw new H('Cannot set the "response" of the LocalInvitation instance.',Ec)}},{key:"send",value:function(){var h,f=this;if(this.state===Ca.SENT_TO_REMOTE||this.state===Ca.RECEIVED_BY_REMOTE)throw new L("The local invitation send failure. The call invitation has already been sent.",cC);if(this.isLocalInvitationEnd())throw new L("The local invitation send failure. The call invitation has ended.",gi);if(0<this._channelId.length&&!Aa(this._channelId))throw new H("Illegal invitation channel ID",Ec);if(!Aa(this.calleeId))throw new H("Illegal invitation callee user ID",Ec);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.state=Ca.SENT_TO_REMOTE,hd(J(x.mark(function _(){var w,j,F;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,f.getSession().sendInvitationMessage({peerId:f.calleeId,callId:f.callId,extra:f._content,type:"CallInvite",channelId:f._channelId});case 2:if(w=K.sent,j=w.hasPeerReceived,F=w.hasReSent,!f.isLocalInvitationEnd()){K.next=7;break}throw new gb("send invitation timeout");case 7:if(f.log("The local invitation has sent to the callee"),j||F){K.next=11;break}throw h=new nm({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(j){K.next=14;break}throw h=new nm({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return K.stop()}},_)}))).pipe(Ce(function(_){return _.pipe(ba(function(w){if(!(w instanceof nm))throw w}),jd(2e3))}),kb(3e4),Ja(function(_){return Xa(_)&&f.warn("local invitation ack timed out"),Z(_)}),rb(this.localInvitationEnd$)).subscribe({next:function(){f.state===Ca.RECEIVED_BY_REMOTE?f.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):f.state!==Ca.SENT_TO_REMOTE?f.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(f.info("The peer received the local invitation %s.",f.callId),f.state=Ca.RECEIVED_BY_REMOTE,f.emit("LocalInvitationReceivedByPeer"),f.localInvitationEnd$.pipe(kb(6e4),Ja(function(_){return Xa(_)&&f.warn("local invitation expired"),Z(_)})).subscribe({error:function(){f.state=Ca.FAILURE,f.emit("LocalInvitationFailure",uf.INVITATION_EXPIRE)}}))},error:function(_){f.isLocalInvitationEnd()?f.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(f.state=Ca.FAILURE,Xa(_)&&h?h.code==="PEER_NOT_ONLINE"?f.emit("LocalInvitationFailure",uf.PEER_OFFLINE):h.code==="RESENT_AND_OFFLINE"&&f.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):Xa(_)?f.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):_.name==="RtmInvalidStatusError"?f.emit("LocalInvitationFailure",uf.NOT_LOGGEDIN):f.emit("LocalInvitationFailure",uf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new L("The local invitation cancel failure",gi);if(this.state===Ca.IDLE)throw new L("The local invitation has not been sent",bC);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Ca.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(h){if(this.isLocalInvitationEnd()&&this.state!==Ca.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Ca.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Ca.ACCEPTED_BY_REMOTE,this._response=h,this.emit("LocalInvitationAccepted",h))}}},{key:"onRefuseReceived",value:function(h){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote refuse it?");this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=h,this.state=Ca.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",h)}}},{key:"isLocalInvitationEnd",value:function(){return[Ca.CANCELED,Ca.FAILURE,Ca.ACCEPTED_BY_REMOTE,Ca.REFUSED_BY_REMOTE].includes(this.state)}}]),i}(wb()),la(Ed.prototype,"send",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"send"),Ed.prototype),la(Ed.prototype,"cancel",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"cancel"),Ed.prototype),Ed),vi=S.RemoteInvitationFailureReason,nb=S.RemoteInvitationState,XF=function(o){function i(h){var f=h.invitationChannel,_=h.extraContent,w=h.callId,j=h.callerId,F=h.logger;h=h.getSession,X(this,i);var K=s.call(this,F,"RtmRemoteInvitation",!0);return m(n(K),"state",nb.INVITATION_RECEIVED),m(n(K),"remoteInvitationEnd$",Da(jb(n(K),"RemoteInvitationCanceled"),jb(n(K),"RemoteInvitationRefused"),jb(n(K),"RemoteInvitationAccepted"),jb(n(K),"RemoteInvitationFailure")).pipe(Pa(1))),m(n(K),"callerId",void 0),m(n(K),"callId",void 0),m(n(K),"_getSession",void 0),m(n(K),"logger",void 0),m(n(K),"_content",void 0),m(n(K),"_channelId",void 0),m(n(K),"_response",""),K._channelId=f,K._content=_,K.callId=w,K.callerId=j,K._getSession=h,K.logger=F,K.remoteInvitationEnd$.pipe(kb(6e4),Ja(function(_e){return Xa(_e)&&K.warn("Remote invitation expired"),Z(_e)})).subscribe({error:function(){K.state=nb.FAILURE,K.emit("RemoteInvitationFailure",vi.INVITATION_EXPIRE)}}),K}ja(i,o);var s=ka(i);return Ia(i,[{key:"channelId",get:function(){return this._channelId},set:function(h){throw new H('Cannot set the "response" of the RemoteInvitation instance.',Ec)}},{key:"content",get:function(){return this._content},set:function(h){throw new H('Cannot set the "content" of the RemoteInvitation instance.',Ec)}},{key:"response",get:function(){return this._response},set:function(h){this._response=h}},{key:"accept",value:function(){var h,f=this;if(this.isRemoteInvitationEnd())throw new L("The local invitation has ended. Cannot accept.",gi);if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.state=nb.ACCEPT_SENT_TO_LOCAL,cc(pn(1e3).pipe(fb(function(){return hd(J(x.mark(function _(){return x.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",f._getSession().sendInvitationMessage({peerId:f.callerId,callId:f.callId,extra:f.response,type:"CallAccept",isAcceptAck:!1,channelId:f.channelId}));case 1:case"end":return w.stop()}},_)})))}),zb(function(_){return h=_.hasPeerReceived}),Pa(1)),jb(this,"RemoteInvitationAccepted")).pipe(kb(5e3),rb(this.remoteInvitationEnd$)).subscribe({error:function(_){if(f.logError(_),f.state=nb.FAILURE,Xa(_))switch(h){case void 0:case!0:return void f.emit("RemoteInvitationFailure",vi.ACCEPT_FAILURE);case!1:return void f.emit("RemoteInvitationFailure",vi.PEER_OFFLINE)}f.emit("RemoteInvitationFailure",vi.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(this.isRemoteInvitationEnd())throw new L("The invitation is end. Cannot refuse",gi);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=nb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(h){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===nb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=h,this.state=nb.CANCELED,this.emit("RemoteInvitationCanceled",h))}},{key:"onAcceptAckReceived",value:function(){this.state!==nb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=nb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[nb.ACCEPTED,nb.REFUSED,nb.CANCELED,nb.FAILURE].includes(this.state)}}]),i}(wb()),YF=function(o){function i(h,f){X(this,i);var _=s.call(this,f,"InvitationManager");return m(n(_),"getSession",void 0),m(n(_),"invitationDispatcher",new ia.EventEmitter),m(n(_),"outgoingLocalInvitations",new Map),m(n(_),"receivedRemoteInvitations",new Ac(void 0,{maxlen:1e4})),m(n(_),"logger",void 0),_.getSession=ho(h),_.logger=f,_.invitationDispatcher.on("remoteInvitationToManager",function(w){var j=w.callId,F=w.extra,K=w.callerId;w=w.channelId,_.receivedRemoteInvitations.has(j)||((F=new XF({callerId:K,callId:j,getSession:_.getSession,logger:f,extraContent:F,invitationChannel:w})).remoteInvitationEnd$.subscribe(function(){_.receivedRemoteInvitations.delete(j)}),_.receivedRemoteInvitations.set(j,F),_.emit("remoteInvitationInstance",F))}),_.invitationDispatcher.on("acceptAckToRemoteInvitation",function(w){(w=_.receivedRemoteInvitations.get(w.callId))&&w.onAcceptAckReceived()}),_.invitationDispatcher.on("cancelToRemoteInvitation",function(w){var j=w.extra;(w=_.receivedRemoteInvitations.get(w.callId))&&w.onCancelReceived(j)}),_.invitationDispatcher.on("acceptToLocalInvitation",function(w){var j=w.extra;(w=_.outgoingLocalInvitations.get(w.callId))&&w.onAcceptReceived(j)}),_.invitationDispatcher.on("refuseToLocalInvitation",function(w){var j=w.extra;(w=_.outgoingLocalInvitations.get(w.callId))&&w.onRefuseReceived(j)}),_}ja(i,o);var s=ka(i);return Ia(i,[{key:"invitationMessageHandler",value:function(h){var f=h.body,_=f.callId,w=f.extra;w=w===void 0?"":w;var j=f.type,F=(f=f.channel)===void 0?"":f,K=h.type;switch(f=h.peerId,h=h.serverReceivedTs,K){case"CallAccept":j==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:_}):j==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:_,extra:w});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:_,callerId:f,extra:w,channelId:F});break;case"CallCancel":if(_==="0"){_="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(F,"_").concat(w),this.getSession().emit("peerTextMessage",{peerId:f,properties:{serverReceivedTs:h,isOfflineMessage:!1},text:_});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:_,extra:w});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:_,extra:w});break;default:throw Nn("invitationType",K)}}},{key:"genLocalInvitation",value:function(h){var f=this,_=new WF(h,this.getSession,this.logger);return _.localInvitationEnd$.subscribe(function(){f.outgoingLocalInvitations.delete(_.callId)}),this.outgoingLocalInvitations.set(_.callId,_),_}}]),i}(wb()),ZF=function(o,i,s){var h=!0,f=!0;if(typeof o!="function")throw new TypeError("Expected a function");return ob(s)&&(h="leading"in s?!!s.leading:h,f="trailing"in s?!!s.trailing:f),mE(o,i,{leading:h,maxWait:i,trailing:f})},xb,vf;(function(o){o[o.JOINED=0]="JOINED",o[o.LEFT=1]="LEFT"})(vf||(vf={}));var om=S.ConnectionState,$F=(xb=function(o){function i(h,f,_,w){X(this,i);var j=s.call(this,w,"RtmChannel",!0);return m(n(j),"onMemberCountUpdated",ZF(function(F){F!==j.memberCount&&(j.memberCount=F,j.emit("MemberCountUpdated",F))},1e3)),m(n(j),"getSession",void 0),m(n(j),"memberCount",0),m(n(j),"joinState","LEFT"),m(n(j),"joinPromise",void 0),m(n(j),"memberJoinedLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"memberLeftLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"memberJoinStateLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"attributesSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"channelId",void 0),m(n(j),"client",void 0),m(n(j),"onChannelMemberCountUpdated",function(F,K){j.channelId===F&&j.onMemberCountUpdated(K)}),m(n(j),"onLogout",function(){try{j.clearChannel(j.getSession())}catch{}}),m(n(j),"onAttributesUpdated",function(F){var K=F.channelId,_e=F.attributeMaps,_o=F.seq;F=F.instance.toString();var ca=j.attributesSeqLru.get(F);if((!ca||_o.greaterThan(ca))&&(j.attributesSeqLru.set(F,_o),K===j.channelId)){for(K={},_o=0;_o<_e.length;_o++){var _c=_e[_o];F=_c.key,ca=_c.ms;var ch=_c.value;if(_c=_c.origin,typeof F!="string"||!U.isLong(ca)||typeof ch!="string"||!Aa(_c))break;K[F]={value:ch,lastUpdateUserId:_c,lastUpdateTs:ca.toNumber()}}j.emit("AttributesUpdated",K)}}),m(n(j),"onChannelTextMessage",function(F){var K=F.memberId,_e=F.text,_o=F.properties;F.channelId===j.channelId&&j.emit("ChannelMessage",{text:_e,messageType:S.MessageType.TEXT},K,_o)}),m(n(j),"onChannelMediaMessage",function(F){var K=F.memberId,_e=F.properties,_o=F.details,ca=F.messageType;F.channelId===j.channelId&&(ca==="FILE"?j.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(ra(_o.media_size),10),description:ra(_o.media_description),fileName:ra(_o.media_filename),mediaId:ra(_o.media_id),thumbnail:new Blob([_o.media_thumbnail])},K,_e):ca==="IMAGE"&&j.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(ra(_o.media_size),10),description:ra(_o.media_description),fileName:ra(_o.media_filename),mediaId:ra(_o.media_id),thumbnail:new Blob([_o.media_thumbnail]),height:parseInt(ra(_o.media_height),10),width:parseInt(ra(_o.media_width),10),thumbnailHeight:parseInt(ra(_o.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(_o.media_thumbnailwidth),10)},K,_e))}),m(n(j),"onChannelRawMessage",function(F){var K=F.desc,_e=F.raw,_o=F.memberId,ca=F.properties;F.channelId===j.channelId&&j.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:_e,description:K},_o,ca)}),m(n(j),"onMemberNotice",function(F){var K=F.memberId,_e=F.type,_o=F.size;if(F.channelId===j.channelId){var ca=F.instance.toString();F=F.seq.toString();var _c={MemberLeft:j.memberLeftLru,MemberJoined:j.memberJoinedLru,MemberCountUpdated:void 0}[_e];if(_c){if(_c.has(ca+F))return void j.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",_e,F,pa(j.channelId),pa(K||""));if(_c.set(ca+F,void 0),typeof K!="string")return;if(K!==j.getSession().context.uid&&((ca=j.memberJoinStateLru.get(K))===vf.JOINED&&_e==="MemberJoined"||ca===vf.LEFT&&_e==="MemberLeft"))return void j.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",_e,F,pa(j.channelId),pa(K||""));j.memberJoinStateLru.set(K,_e==="MemberJoined"?vf.JOINED:vf.LEFT)}j.info("Channel %s - %s, memberId: %s",_e,pa(j.channelId),_e==="MemberCountUpdated"?"[unknown]":pa(K||"")),ca=K===j.getSession().context.uid,_e==="MemberLeft"&&Aa(K)||_e==="MemberJoined"&&Aa(K)?(ca||j.emit(_e,K),j.onMemberCountUpdated(_o)):_e==="MemberCountUpdated"&&typeof _o=="number"&&j.onMemberCountUpdated(_o)}}),j.getSession=ho(f),j.channelId=h,j.client=_,j.info("A channel created, id %s",pa(h)),j}ja(i,o);var s=ka(i);return Ia(i,[{key:"join",value:function(){var h=J(x.mark(function f(){var _,w,j,F,K,_e,_o,ca=this;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:_c.prev=0,_=this.getSession(),_c.next=7;break;case 4:throw _c.prev=4,_c.t0=_c.catch(0),new L("The client is not logged in. Cannot do the operation",Zr);case 7:if(_c.prev=7,Aa(this.channelId)){_c.next=10;break}throw new H(["The %s in the arguments is invalid","channelId"],dC);case 10:if(this.joinState==="LEFT"){_c.next=13;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_.context.uid,elapse:ib(_.startTime),errCode:Yr,sid:ab(_.instanceId)},(F=this.client.context.config.enableCloudProxy)!==null&&F!==void 0&&F),new L("The channel has joined. Cannot rejoin",Yr);case 13:if(!_.usedChannelIds.includes(this.channelId)){_c.next=16;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_.context.uid,elapse:ib(_.startTime),errCode:$r,sid:ab(_.instanceId)},(K=this.client.context.config.enableCloudProxy)!==null&&K!==void 0&&K),new L("A channel of the same channel ID has already joined. Cannot rejoin",$r);case 16:if(!(20<=_.usedChannelIds.length)){_c.next=19;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_.context.uid,elapse:ib(_.startTime),errCode:Xr,sid:ab(_.instanceId)},(_e=this.client.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),new lb("The joined channels has exceeded the limit of 20",Xr);case 19:return hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_.context.uid,elapse:ib(_.startTime),errCode:0,sid:ab(_.instanceId)},(w=this.client.context.config.enableCloudProxy)!==null&&w!==void 0&&w),this.log("Joining the channel %s",pa(this.channelId)),this.joinState="JOINING",_.usedChannelIds.push(this.channelId),this.joinPromise=_.requestChannelJoin(this.channelId).then(function(){ca.joinState="JOINED"}),_c.next=26,this.joinPromise;case 26:hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(_.startTime),errCode:0,sid:ab(_.instanceId),serverErrCode:0,userId:_.context.uid},(j=this.client.context.config.enableCloudProxy)!==null&&j!==void 0&&j),this.info("The channel %s joined successfully",pa(this.channelId)),_.on("channelTextMessage",this.onChannelTextMessage),_.on("channelRawMessage",this.onChannelRawMessage),_.on("channelMediaMessage",this.onChannelMediaMessage),_.on("memberNotice",this.onMemberNotice),_.on("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.on("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.once("LOGOUT",this.onLogout),_c.next=47;break;case 37:if(_c.prev=37,_c.t1=_c.catch(7),this.joinState==="JOINING"&&(this.joinState="LEFT"),this.logError(_c.t1),!ta(_c.t1)){_c.next=43;break}throw _c.t1;case 43:if(!Xa(_c.t1)){_c.next=46;break}throw hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(_.startTime),errCode:Wr,sid:ab(_.instanceId),serverErrCode:0,userId:_.context.uid},(_o=this.client.context.config.enableCloudProxy)!==null&&_o!==void 0&&_o),new gb(["Join channel %s timed out",pa(this.channelId)],Wr);case 46:throw new bd(["The channel %s join failure",pa(this.channelId)],{code:Vr,originalError:_c.t1});case 47:case"end":return _c.stop()}},f,this,[[0,4],[7,37]])}));return function(){return h.apply(this,arguments)}}()},{key:"leave",value:function(){var h=J(x.mark(function f(){var _,w,j,F;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:K.prev=0,w=this.getSession(),K.next=7;break;case 4:throw K.prev=4,K.t0=K.catch(0),new L("The client is not logged in. Cannot do the operation",fC);case 7:if(this.joinState!=="LEFT"){K.next=9;break}throw new L("The channel does not join. Cannot do the operation",eC);case 9:return K.prev=9,w.requestChannelLeave(this.channelId),K.next=13,this.clearChannel(w);case 13:K.next=24;break;case 15:if(K.prev=15,K.t1=K.catch(9),this.logError(K.t1),!ta(K.t1)){K.next=22;break}throw K.t1.code===void 0&&(K.t1.code=bs),hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(w.startTime),errCode:bs,sid:ab(w.instanceId),userId:w.context.uid},(F=this.client.context.config.enableCloudProxy)!==null&&F!==void 0&&F),K.t1;case 22:throw hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(w.startTime),errCode:as,sid:ab(w.instanceId),userId:w.context.uid},(j=this.client.context.config.enableCloudProxy)!==null&&j!==void 0&&j),new bd("The channel leave failure",{code:as,originalError:K.t1});case 24:hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(w.startTime),errCode:0,sid:ab(w.instanceId),userId:w.context.uid},(_=this.client.context.config.enableCloudProxy)!==null&&_!==void 0&&_);case 25:case"end":return K.stop()}},f,this,[[0,4],[9,15]])}));return function(){return h.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e=this,_o=arguments;return x.wrap(function(ca){for(;;)switch(ca.prev=ca.next){case 0:if(w=1<_o.length&&_o[1]!==void 0?_o[1]:{},j=w.enableHistoricalMessaging,F=j!==void 0&&j,Wn(_,fi),this.joinState==="JOINED"){ca.next=4;break}throw new L("The channel does not join. Cannot do the operation",UB);case 4:if(this.client.connectionState!==om.RECONNECTING){ca.next=9;break}return K=Date.now(),ca.next=8,new Promise(function(_c,ch){var Nf=function(){var _g=J(x.mark(function _v(){var h0;return x.wrap(function(A0){for(;;)switch(A0.prev=A0.next){case 0:return h0=Date.now()-K,A0.prev=1,A0.next=4,dh({message:_,peerId:_e.channelId,toPeer:!1,session:_e.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:h0,logger:_e.logger,options:{enableHistoricalMessaging:F,enableOfflineMessaging:!1}});case 4:_c(),A0.next=12;break;case 7:A0.prev=7,A0.t0=A0.catch(1),Xa(A0.t0)&&ch(new gb(he(_e.name,"sendMessageToPeer",1e4),Dl)),ta(A0.t0)&&ch(A0.t0),ch(new da("Channel message send failure",{code:Ag,originalError:A0.t0}));case 12:return A0.prev=12,clearTimeout(bh),A0.finish(12);case 15:case"end":return A0.stop()}},_v,null,[[1,7,12,15]])}));return function(){return _g.apply(this,arguments)}}();_e.client.internalEmitter.once("RECONNECTED",Nf);var bh=setTimeout(function(){_e.client.internalEmitter.off("RECONNECTED",Nf),ch(new gb(he(_e.name,"sendMessageToPeer",1e4),Dl))},9e3)});case 8:return ca.abrupt("return");case 9:if(this.client.connectionState===om.CONNECTED){ca.next=11;break}throw new L("The client is not logged in. Cannot do the operation",El);case 11:return ca.prev=11,ca.next=14,dh({message:_,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:0,logger:this.logger,options:{enableHistoricalMessaging:F,enableOfflineMessaging:!1}});case 14:ca.next=24;break;case 16:if(ca.prev=16,ca.t0=ca.catch(11),!Xa(ca.t0)){ca.next=20;break}throw new gb(he(this.name,"sendMessage",1e4),Dl);case 20:if(!ta(ca.t0)){ca.next=23;break}throw this.logError(ca.t0),ca.t0;case 23:throw new bd("The channel message send failure",Ag);case 24:case"end":return ca.stop()}},f,this,[[11,16]])}));return function(f){return h.apply(this,arguments)}}()},{key:"getMembers",value:function(){var h=J(x.mark(function f(){var _,w;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(j.prev=0,this.client.connectionState===om.CONNECTED){j.next=3;break}throw new L("The client is not logged in. Cannot do the operation",aC);case 3:if(this.joinState==="JOINED"){j.next=5;break}throw new L("The channel does not join. Cannot do the operation",$B);case 5:return _=this.getSession().requestChannelMemberList(this.channelId),j.next=8,_.pipe(ea(function(F){return F.memberInfos.map(function(K){return K.account})})).toPromise();case 8:return w=j.sent,this.info("Channel %s - get members success, %o",pa(this.channelId),w.map(pa)),j.abrupt("return",w);case 13:if(j.prev=13,j.t0=j.catch(0),!ta(j.t0)){j.next=18;break}throw this.logError(j.t0),j.t0;case 18:throw new bd("The channel members get failure",YB);case 19:case"end":return j.stop()}},f,this,[[0,13]])}));return function(){return h.apply(this,arguments)}}()},{key:"clearChannel",value:function(){var h=J(x.mark(function f(_){var w=this;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(_.emit("channelLeft",this.channelId),this.joinState!=="JOINING"){j.next=4;break}return j.next=4,this.joinPromise;case 4:this.joinState="LEFT",this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,_.removeListener("channelTextMessage",this.onChannelTextMessage),_.removeListener("channelRawMessage",this.onChannelRawMessage),_.removeListener("channelMediaMessage",this.onChannelMediaMessage),_.removeListener("memberNotice",this.onMemberNotice),_.removeListener("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.removeListener("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.removeListener("LOGOUT",this.onLogout),_.usedChannelIds=_.usedChannelIds.filter(function(F){return F!==w.channelId});case 18:case"end":return j.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()}]),i}(wb()),la(xb.prototype,"join",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"join"),xb.prototype),la(xb.prototype,"leave",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"leave"),xb.prototype),la(xb.prototype,"sendMessage",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"sendMessage"),xb.prototype),la(xb.prototype,"getMembers",[Ra],Object.getOwnPropertyDescriptor(xb.prototype,"getMembers"),xb.prototype),xb),E,Ib=S.ConnectionChangeReason,T=S.ConnectionState,eu={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},aG={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},bG=(E=function(o){function i(h,f,_,w){X(this,i);var j=s.call(this,f,"RtmClient",!0);return m(n(j),"connectionState",T.DISCONNECTED),m(n(j),"internalEmitter",new ia),m(n(j),"context",void 0),m(n(j),"attributes",{}),m(n(j),"loginPromise",void 0),m(n(j),"attributeDrafts",new Set),m(n(j),"session",void 0),m(n(j),"lastLoginTime",void 0),m(n(j),"reconnId",0),m(n(j),"channelAttributesCacheLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"invitationManager",void 0),m(n(j),"subscribedPeerStatusCache",{}),m(n(j),"pendingPeerStatusSubCount",0),m(n(j),"peerStatusSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"peerUnreachableTimers",{}),m(n(j),"mediaTaskManager",void 0),m(n(j),"setParameters",void 0),m(n(j),"updateConfig",void 0),m(n(j),"blacklistedIP",{}),m(n(j),"userDropHandler",function(F){if(j.connectionState!==T.ABORTED)switch(F){case 11:j.logError("Kicked off by remote session"),j.onConnectionStateChanged(T.ABORTED,Ib.REMOTE_LOGIN);break;case 14:case 15:case 16:j.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[F])),j.onConnectionStateChanged(T.ABORTED,Ib.BANNED_BY_SERVER);break;default:j.logError("User kicked off for unknown code: ".concat(F)),j.onConnectionStateChanged(T.ABORTED,Ib.INTERRUPTED)}}),j.context=new VE(h,_,f),j.mediaTaskManager=new kt(f),j.context.config=_,j.internalEmitter.setMaxListeners(512),j.setParameters=w.bind(n(j)),j.updateConfig=w.bind(n(j)),j.invitationManager=new YF(function(){return j.session},f),j.invitationManager.on("remoteInvitationInstance",function(F){j.emit("RemoteInvitationReceived",F)}),j.setMaxListeners(512),j.internalEmitter.setMaxListeners(512),j}ja(i,o);var s=ka(i);return Ia(i,[{key:"renewToken",value:function(){var h=J(x.mark(function f(_){var w,j,F,K=this;return x.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(typeof _=="string"&&_.length!==0){_e.next=2;break}throw new H("Invalid argument",nC);case 2:if(this.connectionState!==T.ABORTED){_e.next=5;break}return _e.next=5,new Promise(function(){});case 5:if(this.connectionState===T.CONNECTED||this.connectionState===T.RECONNECTING){_e.next=7;break}throw new L("The client is not logged in",qC);case 7:if(this.session!==void 0){_e.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _e.prev=9,w=this.context.token,this.context.token=_,_e.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Md(function(){return Error("No available edge address to connect")}),Ce(function(_o){return _o.pipe(ba(function(ca){if(ta(ca))throw ca}),jd(2500),Pa(4))}),Pa(1),kb(2e4),Ja(function(_o){return Xa(_o)&&K.warn("renewToken timed out"),Z(_o)})).toPromise();case 14:j=_e.sent,F=j.ticket,_e.next=27;break;case 18:if(_e.prev=18,_e.t0=_e.catch(9),this.context.token=w,_e.t0.code!==ds&&_e.t0.code!==es){_e.next=23;break}throw new of("Invalid token",pC);case 23:if(_e.t0.code!==ii){_e.next=25;break}throw new of("The token expired",oC);case 25:if(!Xa(_e.t0)){_e.next=27;break}throw new gb("Renew token timed out",mC);case 27:this.session.curLoginSockets.filter(function(_o){return _o!==void 0}).forEach(function(_o){return _o.ticket=F});case 28:case"end":return _e.stop()}},f,this,[[9,18]])}));return function(f){return h.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var h=J(x.mark(function f(_){var w,j,F=this;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(this.connectionState===T.CONNECTED){K.next=2;break}throw new L("The client is not logged in",lC);case 2:if(this.session!==void 0){K.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(_)||_.length===0||_.some(function(_e){return!Aa(_e)})||256<_.length)){K.next=6;break}throw new H("invalid arguments",is);case 6:return K.next=8,this.session.requestPeersOnlineStatus(_).toPromise();case 8:return w=K.sent,j=Bc(pl(w.userInfos,"account"),function(_e){return!!_e.ts}),Object.keys(j).forEach(function(_e){if(_e in F.subscribedPeerStatusCache&&F.subscribedPeerStatusCache[_e]!==S.PeerOnlineState.UNREACHABLE){var _o=j[_e]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;F.emit("PeersOnlineStatusChanged",m({},_e,_o)),F.subscribedPeerStatusCache[_e]=_o}}),K.abrupt("return",j);case 12:case"end":return K.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(this.connectionState===T.CONNECTED){Nf.next=2;break}throw new L("The client is not logged in",XB);case 2:if(this.session!==void 0){Nf.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_)&&_.every(function(bh){return typeof bh=="string"})&&_.length!==0){Nf.next=6;break}throw new H("Invalid arguments: channelIds",Sr);case 6:if(!(32<_.length)){Nf.next=8;break}throw new H("getChannelMemberCount exceed limit of 32 channelIds",WB);case 8:w=0;case 9:if(!(w<_.length)){Nf.next=16;break}if(Aa(j=_[w])){Nf.next=13;break}throw new H(["getChannelMemberCount channel id %s is invalid",j],Sr);case 13:w++,Nf.next=9;break;case 16:return Nf.next=18,this.session.requestGetChannelMemberCount(_).toPromise();case 18:for(F=Nf.sent,K=F.groupInfos,_e={},_o=0;_o<K.length;_o++)ca=K[_o],_c=ca.group,ch=ca.memberCount,Aa(_c)&&typeof ch=="number"&&(this.internalEmitter.emit("channelMemberCountUpdated",_c,ch),_e[_c]=ch);return Nf.abrupt("return",_e);case 23:case"end":return Nf.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var h=J(x.mark(function f(_){var w,j;return x.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(Mf({attributes:_,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){F.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(this.session!==void 0){F.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return w=this.session.requestSetLocalUserAttributes(_).toPromise(),j={attribute:_,promise:w},this.attributeDrafts.add(j),F.prev=8,F.next=11,w;case 11:this.attributes=_,F.next=19;break;case 14:if(F.prev=14,F.t0=F.catch(8),!ta(F.t0)){F.next=18;break}throw F.t0;case 18:throw new H("arguments is not valid",Oa);case 19:return F.prev=19,this.attributeDrafts.delete(j),F.finish(19);case 22:case"end":return F.stop()}},f,this,[[8,14,19,22]])}));return function(f){return h.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca=arguments;return x.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(j=2<ca.length&&ca[2]!==void 0?ca[2]:{},F=j.enableNotificationToChannelMembers,K=F!==void 0&&F,Mf({attributes:w,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){_c.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_c.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _e=this.session.requestSetChannelAttributes(_,w,K).toPromise(),_c.prev=7,_c.next=10,_e;case 10:_o=Bc(w,function(ch){return new Blob([ch]).size}),this.channelAttributesCacheLru.set(_,_o),_c.next=19;break;case 14:if(_c.prev=14,_c.t0=_c.catch(7),!ta(_c.t0)){_c.next=18;break}throw _c.t0;case 18:throw new H("arguments is not valid",Oa);case 19:case"end":return _c.stop()}},f,this,[[7,14]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var h=J(x.mark(function f(_){var w,j,F;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(w=wa(wa({},this.attributes),_),Mf({attributes:_,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),Mf({attributes:w,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){K.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(this.session!==void 0){K.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return j=this.session.requestAddOrUpdateLocalUserAttributes(_).toPromise(),F={attribute:w,promise:j},this.attributeDrafts.add(F),K.prev=10,K.next=13,j;case 13:this.attributes=w,K.next=21;break;case 16:if(K.prev=16,K.t0=K.catch(10),!ta(K.t0)){K.next=20;break}throw K.t0;case 20:throw new H("arguments is not valid",is);case 21:return K.prev=21,this.attributeDrafts.delete(F),K.finish(21);case 24:case"end":return K.stop()}},f,this,[[10,16,21,24]])}));return function(f){return h.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch=arguments;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(j=2<ch.length&&ch[2]!==void 0?ch[2]:{},F=j.enableNotificationToChannelMembers,K=F!==void 0&&F,_e=this.channelAttributesCacheLru.get(_,{}),_o=Bc(w,function(bh){return new Blob([bh]).size}),ca=wa(wa({},_e),_o),Mf({attributes:w,attrSizeMap:ca,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){Nf.next=7;break}throw new L("The client is not logged in",Zb);case 7:if(this.session!==void 0){Nf.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _c=this.session.requestAddOrUpdateChannelAttributes(_,w,K).toPromise(),Nf.prev=10,Nf.next=13,_c;case 13:this.channelAttributesCacheLru.set(_,ca),Nf.next=21;break;case 16:if(Nf.prev=16,Nf.t0=Nf.catch(10),!ta(Nf.t0)){Nf.next=20;break}throw Nf.t0;case 20:throw new H("arguments is not valid",Oa);case 21:case"end":return Nf.stop()}},f,this,[[10,16]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var h=J(x.mark(function f(_){var w,j,F,K;return x.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(Array.isArray(_)&&_.length!==0&&!_.some(function(_o){return _o.length===0})){_e.next=2;break}throw new L("arguments is not valid",Oa);case 2:if(this.connectionState===T.CONNECTED){_e.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_e.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return w=this.session.requestDeleteLocalUserAttributesByKeys(_).toPromise(),j={attribute:ml(this.attributes,_),promise:w},this.attributeDrafts.add(j),_e.prev=9,_e.next=12,w;case 12:for(F=0;F<_.length;F++)K=_[F],delete this.attributes[K];_e.next=20;break;case 15:if(_e.prev=15,_e.t0=_e.catch(9),!ta(_e.t0)){_e.next=19;break}throw _e.t0;case 19:throw new H("arguments is not valid",Oa);case 20:return _e.prev=20,this.attributeDrafts.delete(j),_e.finish(20);case 23:case"end":return _e.stop()}},f,this,[[9,15,20,23]])}));return function(f){return h.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch=arguments;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(j=2<ch.length&&ch[2]!==void 0?ch[2]:{},F=j.enableNotificationToChannelMembers,K=F!==void 0&&F,Array.isArray(w)&&w.length!==0&&Aa(_)&&!w.some(function(bh){return bh.length===0||512<bh.length})){Nf.next=3;break}throw new L("arguments is not valid",Oa);case 3:if(this.connectionState===T.CONNECTED){Nf.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(this.session!==void 0){Nf.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _e=this.session.requestDeleteChannelAttributesByKeys(_,w,K).toPromise(),Nf.prev=8,Nf.next=11,_e;case 11:if(_o=this.channelAttributesCacheLru.get(_))for(ca=0;ca<w.length;ca++)_c=w[ca],delete _o[_c];Nf.next=20;break;case 15:if(Nf.prev=15,Nf.t0=Nf.catch(8),!ta(Nf.t0)){Nf.next=19;break}throw Nf.t0;case 19:throw new H("arguments is not valid",Oa);case 20:case"end":return Nf.stop()}},f,this,[[8,15]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var h=J(x.mark(function f(){var _,w;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(this.connectionState===T.CONNECTED){j.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){j.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _=this.session.requestClearLocalUserAttributes().toPromise(),w={attribute:{},promise:_},this.attributeDrafts.add(w),j.prev=7,j.next=10,_;case 10:this.attributes={},j.next=18;break;case 13:if(j.prev=13,j.t0=j.catch(7),!ta(j.t0)){j.next=17;break}throw j.t0;case 17:throw new H("arguments is not valid",Oa);case 18:return j.prev=18,this.attributeDrafts.delete(w),j.finish(18);case 21:case"end":return j.stop()}},f,this,[[7,13,18,21]])}));return function(){return h.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e=arguments;return x.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:if(w=1<_e.length&&_e[1]!==void 0?_e[1]:{},j=w.enableNotificationToChannelMembers,F=j!==void 0&&j,this.connectionState===T.CONNECTED){_o.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(this.session!==void 0){_o.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return K=this.session.requestClearChannelAttributes(_,F).toPromise(),_o.prev=6,_o.next=9,K;case 9:this.channelAttributesCacheLru.delete(_),_o.next=17;break;case 12:if(_o.prev=12,_o.t0=_o.catch(6),!ta(_o.t0)){_o.next=16;break}throw _o.t0;case 16:throw new H("arguments is not valid",Oa);case 17:case"end":return _o.stop()}},f,this,[[6,12]])}));return function(f){return h.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var h=J(x.mark(function f(_){var w,j,F;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(Aa(_)){K.next=2;break}throw new H("Not a valid user ID",Oa);case 2:if(this.connectionState===T.CONNECTED){K.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){K.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return K.prev=6,K.next=9,this.session.requestGetUserAttributeKeys(_).toPromise();case 9:return w=K.sent,j=w.keys,K.next=13,this.session.requestGetUserAttributesByKeys(_,j.slice(0,512)).toPromise();case 13:F=K.sent,K.next=21;break;case 16:if(K.prev=16,K.t0=K.catch(6),!ta(K.t0)){K.next=20;break}throw K.t0;case 20:throw new H("arguments is not valid",Oa);case 21:return K.abrupt("return",br(F.attributeInfos.map(function(_e){return[_e.key,_e.value]})));case 22:case"end":return K.stop()}},f,this,[[6,16]])}));return function(f){return h.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch,Nf,bh;return x.wrap(function(_g){for(;;)switch(_g.prev=_g.next){case 0:if(Aa(_)){_g.next=2;break}throw new H("Not a valid channel ID",Oa);case 2:if(this.connectionState===T.CONNECTED){_g.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_g.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _g.prev=6,_g.next=9,this.session.requestGetChannelAttributesKeys(_).toPromise();case 9:return w=_g.sent,j=w.keys,_g.next=13,this.session.requestGetChannelAttributesByKeys(_,j).toPromise();case 13:F=_g.sent,K=F.attributeMaps,_g.next=22;break;case 17:if(_g.prev=17,_g.t0=_g.catch(6),!ta(_g.t0)){_g.next=21;break}throw _g.t0;case 21:throw new H("arguments is not valid",Oa);case 22:_e={},_o=0;case 24:if(!(_o<K.length)){_g.next=32;break}if(ca=K[_o],_c=ca.key,ch=ca.ms,Nf=ca.value,bh=ca.origin,typeof _c=="string"&&U.isLong(ch)&&typeof Nf=="string"&&Aa(bh)){_g.next=28;break}return _g.abrupt("break",32);case 28:_e[_c]={value:Nf,lastUpdateUserId:bh,lastUpdateTs:ch.toNumber()};case 29:_o++,_g.next=24;break;case 32:return this.channelAttributesCacheLru.set(_,Bc(_e,function(_v){return new Blob([_v.value]).size})),_g.abrupt("return",_e);case 34:case"end":return _g.stop()}},f,this,[[6,17]])}));return function(f){return h.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c,ch,Nf,bh;return x.wrap(function(_g){for(;;)switch(_g.prev=_g.next){case 0:if(this.connectionState===T.CONNECTED){_g.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){_g.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(_,w),_g.prev=5,_g.next=8,this.session.requestGetChannelAttributesByKeys(_,w).toPromise();case 8:j=_g.sent,F=j.attributeMaps,_g.next=17;break;case 12:if(_g.prev=12,_g.t0=_g.catch(5),!ta(_g.t0)){_g.next=16;break}throw _g.t0;case 16:throw new H("arguments is not valid",Oa);case 17:K={},_e=this.channelAttributesCacheLru.get(_,{}),_o=0;case 20:if(!(_o<F.length)){_g.next=29;break}if(ca=F[_o],_c=ca.key,ch=ca.ms,Nf=ca.value,bh=ca.origin,typeof _c=="string"&&U.isLong(ch)&&typeof Nf=="string"&&Aa(bh)){_g.next=24;break}return _g.abrupt("break",29);case 24:_e[_c]=new Blob([Nf]).size,K[_c]={value:Nf,lastUpdateUserId:bh,lastUpdateTs:ch.toNumber()};case 26:_o++,_g.next=20;break;case 29:return this.channelAttributesCacheLru.set(_,_e),_g.abrupt("return",K);case 31:case"end":return _g.stop()}},f,this,[[5,12]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var h=J(x.mark(function f(_,w){var j;return x.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(this.connectionState===T.CONNECTED){F.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){F.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(_,w),F.prev=5,F.next=8,this.session.requestGetUserAttributesByKeys(_,w).toPromise();case 8:j=F.sent,F.next=16;break;case 11:if(F.prev=11,F.t0=F.catch(5),!ta(F.t0)){F.next=15;break}throw F.t0;case 15:throw new H("arguments is not valid",Oa);case 16:return F.abrupt("return",br(j.attributeInfos.map(function(K){return[K.key,K.value]})));case 17:case"end":return F.stop()}},f,this,[[5,11]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"login",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e;return x.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:if(wn(!0),j=Yg(),F=_.token,_.token===this.context.appId&&(F=void 0),hb("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:ib(this.session&&this.session.startTime),index:{index1:_.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},installId:zg,lts:U.fromNumber(Date.now()),os:7,sid:ab(j),token:F||"",userId:_.uid,ver:"1.4.5",buildno:415,subVersion:15,version:4},(w=this.context.config.enableCloudProxy)!==null&&w!==void 0&&w,!0),Hd(_)&&Aa(_.uid)){_o.next=7;break}throw new H("not a valid user id",hi);case 7:if(typeof F!="string"||!F){_o.next=11;break}this.context.token=F,_o.next=13;break;case 11:if(typeof F=="string"||F==null){_o.next=13;break}throw new H('The "token" is not a valid string.',hi);case 13:return K=Date.now(),this.context.sid=ab(j),this.loginPromise=this.loginImpl({uid:_.uid,instanceId:j}),this.info("RTM Client logging in as ".concat(pa(_.uid))),_o.prev=17,_o.next=20,this.loginPromise;case 20:_o.next=28;break;case 22:throw _o.prev=22,_o.t0=_o.catch(17),ta(_o.t0)&&hb("Link",{ackedServerIp:"",destServerIp:"",ec:_o.t0.code||1,sc:_o.t0.serverCode,elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-K,sid:ab(j),userId:_.uid},(_e=this.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),this.context.token=void 0,this.context.socketUseProxy=!1,_o.t0;case 28:return _o.prev=28,this.loginPromise=void 0,_o.finish(28);case 31:this.context.socketUseProxy&&this.emit("FallbackProxyConnected"),wn(!1);case 33:case"end":return _o.stop()}},f,this,[[17,22,28,31]])}));return function(f){return h.apply(this,arguments)}}()},{key:"logout",value:function(){var h=J(x.mark(function f(){var _;return x.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this.loginPromise){w.next=3;break}return w.next=3,this.loginPromise;case 3:if(this.connectionState!==T.DISCONNECTED){w.next=6;break}throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);case 6:if(this.internalEmitter.emit("LOGOUT"),this.connectionState!==T.ABORTED){w.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),w.abrupt("return");case 11:if(this.session!==void 0){w.next=14;break}return this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),w.abrupt("return");case 14:return hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),w.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),this.log("Log out success");case 19:case"end":return w.stop()}},f,this)}));return function(){return h.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var h,f=this;if(this.connectionState===T.DISCONNECTED)throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);this.connectionState===T.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&(hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},(h=this.context.config.enableCloudProxy)!==null&&h!==void 0&&h),this.session.logoutHandler().then(function(){f.log("Log out success")})),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var h=J(x.mark(function f(_,w){var j,F,K,_e,_o,ca,_c=this,ch=arguments;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(j=2<ch.length&&ch[2]!==void 0?ch[2]:{},F=j.enableOfflineMessaging,K=F!==void 0&&F,_e=j.enableHistoricalMessaging,_o=_e!==void 0&&_e,Wn(_,Ie),this.connectionState!==T.RECONNECTING){Nf.next=5;break}return ca=Date.now(),Nf.abrupt("return",new Promise(function(bh,_g){var _v=function(){var A0=J(x.mark(function M0(){var R0;return x.wrap(function(k0){for(;;)switch(k0.prev=k0.next){case 0:if(_c.session!==void 0){k0.next=2;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return R0=Date.now()-ca,k0.prev=3,k0.t0=bh,k0.next=7,dh({message:_,peerId:w,toPeer:!0,session:_c.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:R0,logger:_c.logger,options:{enableHistoricalMessaging:_o,enableOfflineMessaging:K}});case 7:k0.t1=k0.sent,(0,k0.t0)(k0.t1),k0.next=16;break;case 11:k0.prev=11,k0.t2=k0.catch(3),Xa(k0.t2)&&_g(new gb(he(_c.name,"sendMessageToPeer",1e4),Fl)),ta(k0.t2)&&_g(k0.t2),_g(new da("Peer-to-peer message send failure",{code:gs,originalError:k0.t2}));case 16:return k0.prev=16,clearTimeout(h0),k0.finish(16);case 19:case"end":return k0.stop()}},M0,null,[[3,11,16,19]])}));return function(){return A0.apply(this,arguments)}}();_c.internalEmitter.once("RECONNECTED",_v);var h0=setTimeout(function(){_c.internalEmitter.off("RECONNECTED",_v),_g(new gb(he(_c.name,"sendMessageToPeer",1e4),Fl))},9e3)}));case 5:if(this.connectionState===T.CONNECTED){Nf.next=7;break}throw new L("Failed to send the peer-to-peer message. The client is not logged in",Hl);case 7:if(this.session!==void 0){Nf.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return Nf.prev=9,Nf.next=12,dh({message:_,peerId:w,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:0,logger:this.logger,options:{enableHistoricalMessaging:_o,enableOfflineMessaging:K}});case 12:return Nf.abrupt("return",Nf.sent);case 15:if(Nf.prev=15,Nf.t0=Nf.catch(9),!Xa(Nf.t0)){Nf.next=19;break}throw new gb(he(this.name,"sendMessageToPeer",1e4),Fl);case 19:if(!ta(Nf.t0)){Nf.next=21;break}throw Nf.t0;case 21:throw new da("Peer-to-peer message send failure",{code:gs,originalError:Nf.t0});case 22:case"end":return Nf.stop()}},f,this,[[9,15]])}));return function(f,_){return h.apply(this,arguments)}}()},{key:"createChannel",value:function(h){var f=this;if(!Aa(h))throw new H(["The %s in the arguments is invalid",Object.keys({channelId:h})[0]],VB);return new $F(h,function(){return f.session},this,this.logger)}},{key:"createLocalInvitation",value:function(h){if(!Aa(h))throw new H(["The %s in the arguments is invalid",Object.keys({calleeId:h})[0]],Ec);return this.invitationManager.genLocalInvitation(h)}},{key:"subscribePeersOnlineStatus",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v,h0=this;return x.wrap(function(A0){for(;;)switch(A0.prev=A0.next){case 0:if(this.connectionState===T.CONNECTED){A0.next=2;break}throw new L("The client is not logged in",Il);case 2:if(this.session!==void 0){A0.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_)&&_.length!==0){A0.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:w=0;case 7:if(!(w<_.length)){A0.next=14;break}if(Aa(j=_[w])){A0.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",j],Cg);case 11:w++,A0.next=7;break;case 14:if(!(512<(F=_&&_.length?bl(_):[]).length+Object.keys(this.subscribedPeerStatusCache).length+this.pendingPeerStatusSubCount)){A0.next=17;break}throw new lb("Subscribed peers overflows",ks);case 17:return this.pendingPeerStatusSubCount+=F.length,A0.next=20,this.session.requestSubscribePeersOnlineStatus(F).toPromise();case 20:K=A0.sent,_e=K.errors,this.pendingPeerStatusSubCount-=F.length,_o=[],ca=[],_c=0;case 26:if(!(_c<_e.length)){A0.next=34;break}if(ch=_e[_c],Nf=ch.code,typeof(bh=ch.account)=="string"){A0.next=30;break}throw new da("Returned account is invalid",js);case 30:Nf!==0&&_o.push(bh);case 31:_c++,A0.next=26;break;case 34:for(_g=0;_g<F.length;_g++)_v=F[_g],_o.includes(_v)||(ca.push(_v),this.subscribedPeerStatusCache[_v]=void 0);if(this.session.requestPeersOnlineStatus(ca).pipe(ea(function(M0){return Bc(pl(M0.userInfos,"account"),function(R0){return!!R0.ts})})).subscribe(function(M0){M0=Bc(M0,function(R0,k0){return R0=R0?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,h0.subscribedPeerStatusCache[k0]=R0}),h0.emit("PeersOnlineStatusChanged",M0)}),_o.length===0){A0.next=38;break}throw new da("Subscription failed",js);case 38:case"end":return A0.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e;return x.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:if(this.connectionState===T.CONNECTED){_o.next=2;break}throw new L("The client is not logged in",Il);case 2:if(this.session!==void 0){_o.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_)&&_.length!==0){_o.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:w=0;case 7:if(!(w<_.length)){_o.next=14;break}if(Aa(j=_[w])){_o.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",j],Cg);case 11:w++,_o.next=7;break;case 14:if(!(512<_.length)){_o.next=16;break}throw new lb("Unsubscribed peers overflows",ks);case 16:for(F=_&&_.length?bl(_):[],this.session.requestUnsubscribePeersOnlineStatus(F),K=0;K<F.length;K++)_e=F[K],delete this.subscribedPeerStatusCache[_e];case 19:case"end":return _o.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var h=J(x.mark(function f(_){return x.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.connectionState===T.CONNECTED){w.next=2;break}throw new L("The client is not logged in",Il);case 2:if(_!==S.PeerSubscriptionOption.ONLINE_STATUS){w.next=4;break}return w.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new H("Subscription option not supported",Cg);case 5:case"end":return w.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"createMessage",value:function(h){return h.messageType==="IMAGE"?wa({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},h):h.messageType==="FILE"?wa({fileName:"",description:"",thumbnail:new Blob,size:0},h):h}},{key:"downloadMedia",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v,h0,A0=this,M0=arguments;return x.wrap(function(R0){for(;;)switch(R0.prev=R0.next){case 0:if(w=1<M0.length&&M0[1]!==void 0?M0[1]:{},typeof _=="string"){R0.next=3;break}throw new H("invalid mediaId format",Jl);case 3:if(R0.prev=3,j=_.split("z"),F=ua(j,3),K=F[0],_e=F[1],_o=F[2],ca=K.slice(1,65),_c=YE(ca),ch=parseInt(K.slice(65),10),Nf=parseInt(_e,10),bh=parseInt(_o,10),!(Number.isNaN(ch)||Number.isNaN(Nf)||Number.isNaN(bh))){R0.next=12;break}throw new H("Invalid mediaId content",Jl);case 12:R0.next=19;break;case 14:if(R0.prev=14,R0.t0=R0.catch(3),!ta(R0.t0)){R0.next=18;break}throw R0.t0;case 18:throw new H("parse mediaId failure",{code:Jl,originalError:R0.t0});case 19:if(this.connectionState===T.CONNECTED){R0.next=21;break}throw new L("The client is not logged in, cannot download",yC);case 21:if(this.session!==void 0){R0.next=23;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return _g=this.mediaTaskManager.addDownloadTask({unit:Nf,zone:ch,hashHexStr:ca,size:bh},function(){if(A0.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return A0.session.requestFileDownloadIndexGet({hash:_c,zone:ch,unit:Nf,size:bh}).toPromise()},w),R0.next=26,this.mediaTaskManager.waitMediaTask(_g);case 26:return _v=R0.sent,h0=_v.payload,R0.abrupt("return",h0);case 29:case"end":return R0.stop()}},f,this,[[3,14]])}));return function(f){return h.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch,Nf,bh,_g,_v,h0,A0,M0,R0,k0,G0,pI,u0,C0,v0,T0,Qv=this,r0=arguments;return x.wrap(function(a0){for(;;)switch(a0.prev=a0.next){case 0:if(w=1<r0.length&&r0[1]!==void 0?r0[1]:{},j=2<r0.length&&r0[2]!==void 0?r0[2]:{},Hd(w)){a0.next=4;break}throw new H("Invalid params",Of);case 4:if(F="thumbnailWidth"in w||"thumbnailHeight"in w||"width"in w||"height"in w,K=w.messageType,_e=K===void 0?F?"IMAGE":"FILE":K,_o=w.description,ca=_o===void 0?"":_o,_c=w.fileName,ch=_c===void 0?"":_c,Nf=w.thumbnail,typeof w.messageType=="string"&&typeof ca=="string"&&typeof ch=="string"&&(Tn(Nf)||Nf===void 0)&&Tn(_)){a0.next=8;break}throw new H("Invalid message params type",Of);case 8:if(!F||_e!=="FILE"){a0.next=10;break}throw new H("Invalid message params, unexpected field in RtmFileMessage",Of);case 10:if(!(33554432<(bh=_.size))){a0.next=13;break}throw new lb("The payload size overflow 32 MB",sC);case 13:return a0.next=15,pj(_);case 15:return _g=a0.sent,a0.next=18,XE(_g);case 18:if(_v=a0.sent,this.connectionState===T.CONNECTED){a0.next=21;break}throw new L("The client is not logged in",uC);case 21:if(_e!=="IMAGE"){a0.next=29;break}return a0.next=24,Sv(w,_g);case 24:h0=a0.sent,A0=h0.height,M0=h0.width,R0=h0.thumbnailWidth,k0=h0.thumbnailHeight;case 29:return G0=this.mediaTaskManager.addUploadTask({file:new Uint8Array(_g),hash:_v},function(){if(Qv.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return Qv.session.fetchFileUploadIndexGet({hash:_v,size:bh})},function(I0,O0){if(Qv.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return Qv.session.requestFileUploadIndexSet({hash:_v,unit:I0,servers:O0}).toPromise()},j),a0.next=32,this.mediaTaskManager.waitMediaTask(G0);case 32:if(pI=a0.sent,u0=pI.zone,C0=pI.retUnit,_e!=="IMAGE"){a0.next=38;break}return v0={height:A0,width:M0,fileName:ch,size:bh,description:ca,thumbnail:Nf,messageType:_e,thumbnailWidth:R0,thumbnailHeight:k0,mediaId:"0".concat(et(_v)).concat(u0,"z").concat(C0,"z").concat(bh,"z").concat(A0,"z").concat(M0)},a0.abrupt("return",v0);case 38:return T0={fileName:ch,size:bh,description:ca,mediaId:"0".concat(et(_v)).concat(u0,"z").concat(C0,"z").concat(bh),thumbnail:Nf,messageType:_e},a0.abrupt("return",T0);case 40:case"end":return a0.stop()}},f,this)}));return function(f){return h.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var h=J(x.mark(function f(_){var w,j,F,K,_e,_o,ca,_c,ch=this;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(w=_.uid,j=_.instanceId,F=_.forceLoginTime,K=F===void 0?0:F,_e=j,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){Nf.next=4;break}throw new nE(["The frequency of login exceeded the limit of %d queries per second",2],iC);case 4:if(this.connectionState===T.DISCONNECTED||K!==0){Nf.next=6;break}throw new L("The SDK is either logging in or has logged in the Agora RTM system",gC);case 6:Nf.prev=6,this.context.uid=w,Nf.next=13;break;case 10:throw Nf.prev=10,Nf.t0=Nf.catch(6),new H(["The %s in the arguments is invalid",Object.keys({uid:w})[0]],hi);case 13:return K===0&&this.onConnectionStateChanged(T.CONNECTING,Ib.LOGIN),(_o=new ct(this.context,this.logger,!1)).blacklistedIP=this.blacklistedIP,this.session=ca=new cu(this.context,_o,_e,this.logger),_c=function(){ch.connectionState===T.CONNECTED&&(ch.onConnectionStateChanged(T.RECONNECTING,Ib.INTERRUPTED),ch.session)&&ch.session.once("userJoined",function(){ch.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS)})},ca.on("connectionLost",_c),ca.on("tokenExpired",function(){ch.emit("TokenExpired")}),ca.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(bh){ch.emit("MessageFromPeer",{text:bh.text,messageType:S.MessageType.TEXT},bh.peerId,bh.properties)}),this.session.on("peerMediaMessage",function(bh){var _g=bh.peerId,_v=bh.properties,h0=bh.messageType;bh=bh.details,h0==="FILE"?ch.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(ra(bh.media_size),10),description:ra(bh.media_description),fileName:ra(bh.media_filename),mediaId:ra(bh.media_id),thumbnail:new Blob([bh.media_thumbnail])},_g,_v):h0==="IMAGE"&&ch.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(ra(bh.media_size),10),description:ra(bh.media_description),fileName:ra(bh.media_filename),mediaId:ra(bh.media_id),thumbnail:new Blob([bh.media_thumbnail]),height:parseInt(ra(bh.media_height),10),width:parseInt(ra(bh.media_width),10),thumbnailHeight:parseInt(ra(bh.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(bh.media_thumbnailwidth),10)},_g,_v)}),this.session.on("peerRawMessage",function(bh){ch.emit("MessageFromPeer",{rawMessage:bh.raw,description:bh.desc,messageType:S.MessageType.RAW},bh.peerId,bh.properties)}),ca.on("instanceChanged",function(bh){return _e=bh}),ca.on("peerOnlineStatusChanged",function(bh){var _g=bh.instance.toString()+bh.state,_v=ch.peerStatusSeqLru.get(_g);!_v||bh.seq.greaterThan(_v)?(ch.peerStatusSeqLru.set(_g,bh.seq),bh.state!==ch.subscribedPeerStatusCache[bh.peerId]&&ch.emit("PeersOnlineStatusChanged",m({},bh.peerId,bh.state)),ch.subscribedPeerStatusCache[bh.peerId]=bh.state,clearTimeout(ch.peerUnreachableTimers[_g]),bh.state===S.PeerOnlineState.UNREACHABLE&&(ch.peerUnreachableTimers[_g]=setTimeout(function(){ch.subscribedPeerStatusCache[bh.peerId]===S.PeerOnlineState.UNREACHABLE&&(ch.subscribedPeerStatusCache[bh.peerId]=S.PeerOnlineState.ONLINE,ch.emit("PeersOnlineStatusChanged",m({},bh.peerId,S.PeerOnlineState.ONLINE)))},3e4))):ch.log("peerOnlineStatusChanged dedup for %s, %d",_g,bh.seq.toNumber())}),ca.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),ca.on("channelAttributesUpdated",function(bh){var _g=bh.channelId;bh=bh.attributeMaps;for(var _v={},h0=0;h0<bh.length;h0++){var A0=bh[h0],M0=A0.key,R0=A0.ms,k0=A0.value;if(A0=A0.origin,typeof M0!="string"||!U.isLong(R0)||typeof k0!="string"||!Aa(A0))break;_v[M0]=new Blob([k0]).size}ch.channelAttributesCacheLru.set(_g,_v)}),ca.on("userJoined",function(bh){if(Object.keys(ch.attributes).length!==0){if(ch.session===void 0)return;ch.session.requestSetLocalUserAttributes(ch.attributes,bh).toPromise()}if(ch.attributeDrafts.size!==0)for(var _g=function(A0,M0){var R0=(A0=M0[A0]).attribute;A0.promise.then(function(){ch.session!==void 0&&ch.session.requestSetLocalUserAttributes(R0,bh).toPromise()})},_v=0,h0=Array.from(ch.attributeDrafts);_v<h0.length;_v++)_g(_v,h0);Object.keys(ch.subscribedPeerStatusCache).length!==0&&ca.requestSubscribePeersOnlineStatus(Object.keys(ch.subscribedPeerStatusCache))}),ca.on("banEdgeIP",function(bh){ch.banIP(bh)}),this.lastLoginTime=Date.now(),Nf.prev=32,Nf.next=35,ca.loginHandler().toPromise();case 35:this.mediaTaskManager.setAuthInfo({ticket:ca.connection.curOpenSockets.filter(function(bh){return bh!==void 0})[0].ticket,instance:ca.instanceId,useNewDomain:.5<=Math.random(),loginOpt:ca.userJoinOptions.toLong()}),Nf.next=54;break;case 38:if(Nf.prev=38,Nf.t1=Nf.catch(32),!(Nf.t1.name==="loginRespTimeout"&&2>K)){Nf.next=47;break}return ca.removeAllListeners(),Nf.next=44,this.loginImpl({uid:w,instanceId:j,forceLoginTime:K+1});case 44:return Nf.abrupt("return");case 47:if(!Xa(Nf.t1)){Nf.next=50;break}throw this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_TIMEOUT),new gb(he(this.name,"login",12e3),hC);case 50:if(this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_FAILURE),!ta(Nf.t1)){Nf.next=53;break}throw Nf.t1;case 53:throw new da("Login failure",{code:cs,originalError:Nf.t1});case 54:this.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS);case 55:case"end":return Nf.stop()}},f,this,[[6,10],[32,38]])}));return function(f){return h.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(h,f){var _,w=this;h===T.RECONNECTING&&(this.reconnId+=1),hb("ConnectionStateChange",{elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:eu[h],oldState:eu[this.connectionState],reason:aG[f],sid:ab(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),this.connectionState===T.RECONNECTING&&h===T.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(ea(function(j){return Bc(pl(j.userInfos,"account"),function(F){return!!F.ts})})).subscribe(function(j){j=Bc(j,function(F,K){return F=F?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,w.subscribedPeerStatusCache[K]=F}),w.emit("PeersOnlineStatusChanged",j)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=h,h!==T.ABORTED&&h!==T.DISCONNECTED||(this.pendingPeerStatusSubCount=this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",h),this.emit("ConnectionStateChanged",h,f)}},{key:"banIP",value:function(h){var f;this.log("ip banned",h);var _=(f=this.blacklistedIP[h])!==null&&f!==void 0?f:0;this.blacklistedIP[h]=_+1}}]),i}(wb()),la(E.prototype,"renewToken",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"renewToken"),E.prototype),la(E.prototype,"queryPeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersOnlineStatus"),E.prototype),la(E.prototype,"getChannelMemberCount",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelMemberCount"),E.prototype),la(E.prototype,"setLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setLocalUserAttributes"),E.prototype),la(E.prototype,"setChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setChannelAttributes"),E.prototype),la(E.prototype,"addOrUpdateLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateLocalUserAttributes"),E.prototype),la(E.prototype,"addOrUpdateChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateChannelAttributes"),E.prototype),la(E.prototype,"deleteLocalUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteLocalUserAttributesByKeys"),E.prototype),la(E.prototype,"deleteChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteChannelAttributesByKeys"),E.prototype),la(E.prototype,"clearLocalUserAttributes",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"clearLocalUserAttributes"),E.prototype),la(E.prototype,"clearChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"clearChannelAttributes"),E.prototype),la(E.prototype,"getUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributes"),E.prototype),la(E.prototype,"getChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributes"),E.prototype),la(E.prototype,"getChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributesByKeys"),E.prototype),la(E.prototype,"getUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributesByKeys"),E.prototype),la(E.prototype,"login",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"login"),E.prototype),la(E.prototype,"logout",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logout"),E.prototype),la(E.prototype,"logoutSync",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logoutSync"),E.prototype),la(E.prototype,"sendMessageToPeer",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"sendMessageToPeer"),E.prototype),la(E.prototype,"createChannel",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createChannel"),E.prototype),la(E.prototype,"createLocalInvitation",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createLocalInvitation"),E.prototype),la(E.prototype,"subscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"subscribePeersOnlineStatus"),E.prototype),la(E.prototype,"unsubscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"unsubscribePeersOnlineStatus"),E.prototype),la(E.prototype,"queryPeersBySubscriptionOption",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersBySubscriptionOption"),E.prototype),la(E.prototype,"createMessage",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMessage"),E.prototype),la(E.prototype,"downloadMedia",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"downloadMedia"),E.prototype),la(E.prototype,"createMediaMessageByUploading",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMediaMessageByUploading"),E.prototype),E),pm,qm,rm,sm,fu=(pm=/Chrome\/([0-9.]+)/.exec((rm=window)===null||rm===void 0||(sm=rm.navigator)===null||sm===void 0?void 0:sm.userAgent))===null||pm===void 0||(qm=pm[1])===null||qm===void 0?void 0:qm.split(".")[0];if(fu&&88<=parseInt(fu,10)&&!pe()){var tm,me=document.createElement("video"),ne=document.createElement("canvas");me.setAttribute("style","display:none"),me.setAttribute("muted",""),me.muted=!0,me.setAttribute("autoplay",""),me.autoplay=!0,me.setAttribute("playsinline",""),ne.setAttribute("style","display:none"),ne.setAttribute("width","1"),ne.setAttribute("height","1"),(tm=ne.getContext("2d"))===null||tm===void 0||tm.fillRect(0,0,1,1),me.srcObject=ne==null?void 0:ne.captureStream()}var gu={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},hu={enableLogUpload:!1,logFilter:gu.LOG_FILTER_INFO,enableCloudProxy:!1},ie=wa(wa({createInstance:function(o){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},s=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(o))throw new H(["The %s in the arguments is invalid",Object.keys({appId:o})[0]],Rr);var h=Object.keys(i).filter(function(_e){return!(_e in hu)});if(h.length!==0)throw new H("Invalid RTM config: ".concat(h.join(", ")),Rr);var f=wa(wa({},hu),i);if(s!==void 0&&(!Array.isArray(s)||s.length===0))throw new H("Invalid area config");if(s!=null){if(!s.every(function(_e){return _e in S.LegacyAreaCode}))throw new H("Invalid area codes: ".concat(s.filter(function(_e){return!(_e in S)}).join(", ")));P=Ke(s.map(function(_e){return vE[_e]}))}s=Ql=Ka.__global_unique_id__=(Ka.__global_unique_id__||0)+1;var _=zE(f);h=AE(f);var w=BE(f),j=CE(s,f),F=Xs(s,f),K=F("RTM:DEBUG","<Entry> ");return Qs.rtmConfig=f,_("The Agora RTM Web SDK version is %s","1.4.5"),i.enableCloudProxy&&_("RTM cloud proxy enabled"),i.enableLogUpload&&_("Log upload enabled"),P&&K("Area is set to %s",Array.from(P.CODES).map(function(_e){return Pf(D).find(function(_o){return D[_o]===_e})}).join(", ")),K("Creating an RtmClient instance"),K('The Git commit ID is "'.concat("v1.4.5-0-g9cf39592",'"')),K("The App ID is %s",Xn(o,4,10,"*".repeat(6))),_("The process ID is %s",zg),K("The build is %s","v1.4.5-0-g9cf39592"),K("NODE_ENV is %s","production"),new bG(o,{genLogger:F,genTracker:j,info:_,warn:h,logError:w,loggerId:s},f,function(_e){for(var _o=0,ca=Pf(_e);_o<ca.length;_o++){var _c=ca[_o];try{var ch=_e[_c];ch!=null&&(_e.enableCloudProxy&&_("RTM cloud proxy enabled"),_e.enableLogUpload&&_("Log upload enabled"),f[_c]=ch)}catch{throw new H(["The %s in the arguments is invalid",_c],void 0)}}})},BUILD:"v1.4.5-0-g9cf39592",VERSION:"1.4.5",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:zg,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},gu),{},{setParameter:function(o,i){Object.keys(lc).includes(o)&&(lc[o]=i)},getParameter:function(o){return lc[o]},setArea:function(o){var i=o.areaCodes;if(o=o.excludedArea,!Array.isArray(i)||i.length===0||!i.every(function(s){return s in S.AreaCode}))throw new H("Invalid area config");if(o!==void 0&&o===S.AreaCode.GLOBAL)throw new H("Excluded area cannot be global");if(o===void 0)P=Ke(i.map(function(s){return D[s]}));else{if(i.includes(o))throw new H("Excluded area cannot be in areaCodes");if(!(o in D))throw new H("Invalid excludedArea:",o);P=Xv({areas:i.map(function(s){return D[s]}),excludedArea:D[o]})}}});return ie})})(agoraRtmSdk);var AgoraRTM__default=getDefaultExportFromCjs(agoraRtmSdk.exports),createLazyClient=function o(){var i;function s(h,f,_){return i||(i=AgoraRTM__default.createInstance(h,f,_)),i}return function(h,f,_){return s(h,f,_)}},createLazyChannel=function o(){var i;function s(h,f){return i||(i=h.createChannel(f)),i}return function(h,f){return s(h,f)}},AreaCode;(function(o){o.GLOBAL="GLOBAL",o.INDIA="INDIA",o.JAPAN="JAPAN",o.ASIA="ASIA",o.EUROPE="EUROPE",o.CHINA="CHINA",o.NORTH_AMERICA="NORTH_AMERICA"})(AreaCode||(AreaCode={}));function _extends(){return _extends=Object.assign||function(o){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(o[h]=s[h])}return o},_extends.apply(this,arguments)}typeof Symbol!="undefined"&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")));typeof Symbol!="undefined"&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function _catch(o,i){try{var s=o()}catch(h){return i(h)}return s&&s.then?s.then(void 0,i):s}var RtcContext=React.createContext({}),RtcProvider=RtcContext.Provider;RtcContext.Consumer;var remoteTrackState;(function(o){o[o.yes=0]="yes",o[o.subbed=1]="subbed",o[o.no=2]="no"})(remoteTrackState||(remoteTrackState={}));var layout;(function(o){o[o.grid=0]="grid",o[o.pin=1]="pin"})(layout||(layout={}));var ToggleState;(function(o){o[o.disabled=0]="disabled",o[o.enabled=1]="enabled",o[o.disabling=2]="disabling",o[o.enabling=3]="enabling"})(ToggleState||(ToggleState={}));var initialValue={rtcProps:{appId:"",channel:"",role:"host"},rtmProps:{}},PropsContext=React.createContext(initialValue),PropsProvider=PropsContext.Provider,MaxUidContext=React.createContext([]),MaxUidProvider=MaxUidContext.Provider,MaxUidConsumer=MaxUidContext.Consumer,MinUidContext=React.createContext([]),MinUidProvider=MinUidContext.Provider,MinUidConsumer=MinUidContext.Consumer,TracksContext=React.createContext({}),TracksProvider=TracksContext.Provider,initState={max:[{uid:0,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}],min:[]},reducer=function o(i,s){var h=initState,f=[].concat(i.max,i.min).map(function(K){return K.uid});switch(s.type){case"update-user-video":h={min:i.min.map(function(K){return K.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:K}),max:i.max.map(function(K){return K.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:K})};break;case"user-joined":if(f.indexOf(s.value[0].uid)===-1){var _=[].concat(i.min,[{uid:s.value[0].uid,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}]);_.length===1&&i.max[0].uid===0?h={max:_,min:i.max}:h={min:_,max:i.max}}break;case"user-unpublished":if(i.max[0].uid===s.value[0].uid)h={max:[{uid:s.value[0].uid,hasAudio:s.value[1]==="audio"?remoteTrackState.no:i.max[0].hasAudio,hasVideo:s.value[1]==="video"?remoteTrackState.no:i.max[0].hasVideo}],min:i.min};else{var w=i.min.find(function(K){return K.uid===s.value[0].uid});if(w){var j=[].concat(i.min.filter(function(K){return K.uid!==s.value[0].uid}),[{uid:s.value[0].uid,hasAudio:s.value[1]==="audio"?remoteTrackState.no:w.hasAudio,hasVideo:s.value[1]==="video"?remoteTrackState.no:w.hasVideo}]);h={min:j,max:i.max}}}break;case"user-published":i.max[0].uid===s.value[0].uid?h={max:[{uid:s.value[0].uid,hasAudio:s.value[1]==="audio"?remoteTrackState.subbed:i.max[0].hasAudio,hasVideo:s.value[1]==="video"?remoteTrackState.subbed:i.max[0].hasVideo}],min:i.min}:h={min:i.min.map(function(K){return K.uid!==s.value[0].uid?K:{uid:K.uid,hasAudio:s.value[1]==="audio"?remoteTrackState.subbed:K.hasAudio,hasVideo:s.value[1]==="video"?remoteTrackState.subbed:K.hasVideo}}),max:i.max};break;case"user-left":if(i.max[0].uid===s.value[0].uid){var F=[].concat(i.min);h={max:[F.pop()],min:F}}else h={min:i.min.filter(function(K){return K.uid!==s.value[0].uid}),max:i.max};break;case"user-swap":i.max[0].uid===s.value[0].uid||(h={max:[s.value[0]],min:[].concat(i.min.filter(function(K){return K.uid!==s.value[0].uid}),[i.max[0]])});break;case"local-user-mute-video":h={min:i.min.map(function(K){return K.uid===0?{uid:0,hasAudio:K.hasAudio,hasVideo:s.value[0]}:K}),max:i.max.map(function(K){return K.uid===0?{uid:0,hasAudio:K.hasAudio,hasVideo:s.value[0]}:K})};break;case"local-user-mute-audio":h={min:i.min.map(function(K){return K.uid===0?{uid:0,hasAudio:s.value[0],hasVideo:K.hasVideo}:K}),max:i.max.map(function(K){return K.uid===0?{uid:0,hasAudio:s.value[0],hasVideo:K.hasVideo}:K})};break;case"remote-user-mute-video":h={min:i.min.map(function(K){return K.uid===s.value[0].uid?{uid:K.uid,hasVideo:s.value[1],hasAudio:K.hasAudio}:K}),max:i.max.map(function(K){return K.uid===s.value[0].uid?{uid:K.uid,hasVideo:s.value[1],hasAudio:K.hasAudio}:K})};break;case"remote-user-mute-audio":h={min:i.min.map(function(K){return K.uid===s.value[0].uid?{uid:K.uid,hasAudio:s.value[1],hasVideo:K.hasVideo}:K}),max:i.max.map(function(K){return K.uid===s.value[0].uid?{uid:K.uid,hasAudio:s.value[1],hasVideo:K.hasVideo}:K})};break;case"leave-channel":h=initState;break;case"ActiveSpeaker":i.max[0].uid===s.value[0]?h=_extends({},i):h={max:[i.min.find(function(K){return K.uid===s.value[0]})],min:[].concat(i.min.filter(function(K){return K.uid!==s.value[0]}),[i.max[0]])};break}return _extends({},i,h)},useClient=createClient({codec:"vp8",mode:"live"}),RtcConfigure=function o(i){var s=react.exports.useRef(),h=react.exports.useContext(TracksContext),f=h.localVideoTrack,_=h.localAudioTrack,w=react.exports.useContext(PropsContext),j=w.callbacks,F=w.rtcProps,K=react.exports.useState(!1),_e=K[0],_o=K[1],ca=react.exports.useState(!1),_c=ca[0],ch=ca[1],Nf=null,bh=react.exports.useRef(new Promise(function(pI,u0){Nf=pI,console.log(u0)})),_g=useClient();F.customRtcClient&&(_g.removeAllListeners(),_g=F.customRtcClient);var _v=!1,h0=!1,A0=react.exports.useRef({}),M0=i.callActive;M0===void 0&&(M0=!0);var R0=react.exports.useReducer(reducer,initState),k0=R0[0],G0=R0[1];return react.exports.useEffect(function(){var pI=function(){try{try{if(console.log(_g),_g.on("user-joined",function(){try{for(var r0=arguments.length,a0=new Array(r0),I0=0;I0<r0;I0++)a0[I0]=arguments[I0];var O0=a0[0];return A0.current[O0.uid]={},G0({type:"user-joined",value:a0}),Promise.resolve()}catch(nI){return Promise.reject(nI)}}),_g.on("user-published",function(){for(var r0=arguments.length,a0=new Array(r0),I0=0;I0<r0;I0++)a0[I0]=arguments[I0];try{var O0=a0[0],nI=a0[1];return console.log("user-published",O0.uid),_g.subscribe(O0,nI).then(function(U0){if(A0.current[O0.uid][nI+"Track"]=O0[nI+"Track"],nI==="audio"){var _I;(_I=O0.audioTrack)===null||_I===void 0||_I.play()}else F.enableDualStream&&F.dualStreamMode&&_g.setStreamFallbackOption(O0.uid,F.dualStreamMode);G0({type:"user-published",value:a0})}).catch(function(U0){return console.log(U0)}),Promise.resolve()}catch(U0){return Promise.reject(U0)}}),_g.on("user-unpublished",function(){try{for(var r0=arguments.length,a0=new Array(r0),I0=0;I0<r0;I0++)a0[I0]=arguments[I0];var O0=a0[0],nI=a0[1];if(console.log("user-unpublished",O0.uid),nI==="audio"){var U0;(U0=O0.audioTrack)===null||U0===void 0||U0.stop()}return G0({type:"user-unpublished",value:a0}),Promise.resolve()}catch(_I){return Promise.reject(_I)}}),_g.on("connection-state-change",function(){try{for(var r0=arguments.length,a0=new Array(r0),I0=0;I0<r0;I0++)a0[I0]=arguments[I0];var O0=a0[0],nI=a0[1],U0=a0[2];return console.log("connection",nI,O0,U0),O0==="CONNECTED"?ch(!0):O0==="DISCONNECTED"?G0({type:"leave-channel",value:null}):ch(!1),Promise.resolve()}catch(_I){return Promise.reject(_I)}}),_g.on("user-left",function(){for(var r0=arguments.length,a0=new Array(r0),I0=0;I0<r0;I0++)a0[I0]=arguments[I0];G0({type:"user-left",value:a0})}),F.tokenUrl){var C0=F.tokenUrl,v0=F.channel,T0=F.uid;_g.on("token-privilege-will-expire",function(){try{return console.log("token will expire"),Promise.resolve(fetch(C0+"/rtc/"+v0+"/publisher/uid/"+(T0||0)+"/")).then(function(r0){return Promise.resolve(r0.json()).then(function(a0){var I0=a0.rtcToken;_g.renewToken(I0)})})}catch(r0){return Promise.reject(r0)}}),_g.on("token-privilege-did-expire",function(){try{return Promise.resolve(fetch(C0+"/rtc/"+v0+"/publisher/uid/"+(T0||0)+"/")).then(function(r0){return Promise.resolve(r0.json()).then(function(a0){var I0=a0.rtcToken;_g.renewToken(I0)})})}catch(r0){return Promise.reject(r0)}})}if(j){var Qv=Object.keys(j);Qv.map(function(r0){try{_g.on(r0,function(){for(var a0=arguments.length,I0=new Array(a0),O0=0;O0<a0;O0++)I0[O0]=arguments[O0];j[r0].apply(null,I0)})}catch(a0){console.log(a0)}})}Nf(!0),_o(!0)}catch(r0){console.log(r0)}return Promise.resolve()}catch(r0){return Promise.reject(r0)}};return Nf?(pI(),function(){try{_g.removeAllListeners()}catch(u0){console.log(u0)}}):function(){}},[F.appId]),react.exports.useEffect(function(){var pI=function(){try{return Promise.resolve(bh.current).then(function(){var C0=F.tokenUrl,v0=F.channel,T0=F.uid,Qv=F.appId,r0=F.token,a0=function(){if(_g){F.role==="audience"?_g.setClientRole(F.role):_g.setClientRole("host");var I0=function(){if(C0){var O0=_catch(function(){return Promise.resolve(fetch(C0+"/rtc/"+v0+"/publisher/uid/"+(T0||0)+"/")).then(function(nI){return Promise.resolve(nI.json()).then(function(U0){var _I=U0.rtcToken;return Promise.resolve(_g.join(Qv,v0,_I,T0||0)).then(function(dI){s.current=dI})})})},function(nI){console.log(nI)});if(O0&&O0.then)return O0.then(function(){})}else return Promise.resolve(_g.join(Qv,v0,r0||null,T0||0)).then(function(nI){s.current=nI})}();if(I0&&I0.then)return I0.then(function(){})}else console.error("trying to join before RTC Engine was initialized")}();if(a0&&a0.then)return a0.then(function(){})})}catch(C0){return Promise.reject(C0)}};return M0?(pI(),console.log("Attempted join: ",F.channel)):console.log("In precall - waiting to join"),function(){M0&&(console.log("Leaving channel"),bh.current=_g.leave().catch(function(u0){return console.log(u0)}))}},[F.channel,F.uid,M0,F.tokenUrl]),react.exports.useEffect(function(){var pI=function(){try{var C0=function(){function Qv(){var a0=function(){if(f!=null&&f.enabled&&_c){var I0=function(){if(!_v)return Promise.resolve(_g.publish([f]).then(function(){_v=!0})).then(function(){})}();if(I0&&I0.then)return I0.then(function(){})}}();if(a0&&a0.then)return a0.then(function(){})}var r0=function(){if(_!=null&&_.enabled&&_c){var a0=function(){if(!h0)return Promise.resolve(_g.publish([_]).then(function(){h0=!0})).then(function(){})}();if(a0&&a0.then)return a0.then(function(){})}}();return r0&&r0.then?r0.then(Qv):Qv(r0)},v0=function(){if(F.enableDualStream)return Promise.resolve(_g.enableDualStream()).then(function(){})}();return Promise.resolve(v0&&v0.then?v0.then(C0):C0(v0))}catch(T0){return Promise.reject(T0)}};console.log("Publish",f,_,M0),M0&&pI()},[M0,f==null?void 0:f.enabled,_==null?void 0:_.enabled,_c]),react.exports.useEffect(function(){f&&_!==null&&(A0.current[0]={audioTrack:_,videoTrack:f},G0({type:"update-user-video",value:[_,f]}))},[F.channel,_c]),react.exports.useEffect(function(){_c&&F.token&&_g.renewToken(F.token).then(function(pI){return console.log("renewed token",pI)})},[F.token,_c]),react.exports.useEffect(function(){F.role&&_g.setClientRole(F.role).then(function(pI){return console.log("changed role",pI)})},[F.role,_c]),react.exports.useEffect(function(){var pI=function(){try{var C0=function(){if(F.activeSpeaker&&F.layout!==layout.grid)return _g.on("volume-indicator",function(v0){var T0=v0.reduce(function(a0,I0){return a0===null||I0.level>a0.level?I0:a0},null),Qv=T0?T0.uid:void 0,r0=Qv===s.current?0:Qv;Qv!==void 0&&G0({type:"ActiveSpeaker",value:[r0]})}),Promise.resolve(_g.enableAudioVolumeIndicator()).then(function(){})}();return Promise.resolve(C0&&C0.then?C0.then(function(){}):void 0)}catch(v0){return Promise.reject(v0)}};return M0&&pI(),function(){_g.removeAllListeners("volume-indicator")}},[F.activeSpeaker,F.layout]),jsx(RtcProvider,{value:{client:_g,mediaStore:A0.current,localVideoTrack:f,localAudioTrack:_,dispatch:G0,localUid:s,channelJoined:_c},children:jsx(MaxUidProvider,{value:k0.max,children:jsx(MinUidProvider,{value:k0.min,children:_e?i.children:null})})})},icons={videocam:jsxs(Fragment,{children:[jsx("polygon",{points:"23 7 16 12 23 17 23 7"}),jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}),videocamOff:jsxs(Fragment,{children:[jsx("path",{d:"M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"}),jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),remoteSwap:jsxs(Fragment,{children:[jsx("polyline",{points:"15 3 21 3 21 9"}),jsx("polyline",{points:"9 21 3 21 3 15"}),jsx("line",{x1:"21",y1:"3",x2:"14",y2:"10"}),jsx("line",{x1:"3",y1:"21",x2:"10",y2:"14"})]}),callEnd:jsxs(Fragment,{children:[jsx("path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"}),jsx("line",{x1:"23",y1:"1",x2:"1",y2:"23"})]}),mic:jsxs(Fragment,{children:[jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),micOff:jsxs(Fragment,{children:[jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),jsx("path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}),jsx("path",{d:"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"}),jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})},BtnTemplate=function o(i){var s=i.onClick,h=i.name,f=i.disabled,_=i.style,w=react.exports.useContext(PropsContext),j=w.styleProps,F=j||{},K=F.theme,_e=F.BtnTemplateStyles,_o=F.iconSize,ca=F.customIcon;return jsx("div",{style:_extends({},{width:35,height:35,borderRadius:"100%",borderWidth:2,borderStyle:"solid",borderColor:"#fff",backgroundColor:"rgba(0,80,180,0.2)",alignItems:"center",justifyContent:"center",display:"flex",cursor:f?"auto":"pointer",margin:4},_e,_),onClick:s,children:ca?jsx("img",{src:ca[h],alt:h}):jsx("svg",{style:{width:_o||24,height:_o||24},xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",opacity:f?"0.5":"1",stroke:K||"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:icons[h]})})};function EndCall(){var o=react.exports.useContext(PropsContext),i=o.styleProps,s=o.callbacks,h=i||{},f=h.localBtnStyles,_=f||{},w=_.endCall;return jsx(BtnTemplate,{style:w||{backgroundColor:"#ef5588",borderColor:"#f00"},name:"callEnd",onClick:function(){return(s==null?void 0:s.EndCall)&&s.EndCall()}})}var LocalContext=react.exports.createContext({}),LocalUserContext=function o(i){var s=react.exports.useContext(MaxUidContext),h=react.exports.useContext(MinUidContext),f;return s[0].uid===0?f=s[0]:f=h.find(function(_){return _.uid===0}),jsx(LocalContext.Provider,{value:f,children:i.children})},muteAudio=function(o,i,s,h){try{var f=function(){if(o.uid===0){var _=o.hasAudio,w=function(){if(_===ToggleState.enabled||_===ToggleState.disabled){var j=_===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;i({type:"local-user-mute-audio",value:[j]}),h&&h["local-user-mute-audio"]&&h["local-user-mute-audio"](j);var F=_catch(function(){return Promise.resolve(s==null?void 0:s.setEnabled(_!==ToggleState.enabled)).then(function(){j=_===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,h&&h["local-user-mute-audio"]&&h["local-user-mute-audio"](j),i({type:"local-user-mute-audio",value:[_===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled]})})},function(){i({type:"local-user-mute-audio",value:[_]})});if(F&&F.then)return F.then(function(){})}}();if(w&&w.then)return w.then(function(){})}}();return Promise.resolve(f&&f.then?f.then(function(){}):void 0)}catch(_){return Promise.reject(_)}};function LocalAudioMute(){var o=react.exports.useContext(PropsContext),i=o.styleProps,s=o.callbacks,h=i||{},f=h.localBtnStyles,_=f||{},w=_.muteLocalAudio,j=react.exports.useContext(RtcContext),F=j.dispatch,K=j.localAudioTrack,_e=react.exports.useContext(LocalContext);return jsx("div",{children:jsx(BtnTemplate,{style:w,name:_e.hasAudio===ToggleState.enabled?"mic":"micOff",onClick:function(){return K&&muteAudio(_e,F,K,s)}})})}var muteVideo=function(o,i,s,h){try{var f=function(){if(o.uid===0){var _=o.hasVideo,w=function(){if(_===ToggleState.enabled||_===ToggleState.disabled){var j=_===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;i({type:"local-user-mute-video",value:[j]}),h&&h["local-user-mute-video"]&&h["local-user-mute-video"](j);var F=_catch(function(){return Promise.resolve(s==null?void 0:s.setEnabled(_!==ToggleState.enabled)).then(function(){j=_===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,h&&h["local-user-mute-video"]&&h["local-user-mute-video"](j),i({type:"local-user-mute-video",value:[j]})})},function(){i({type:"local-user-mute-video",value:[_]})});if(F&&F.then)return F.then(function(){})}}();if(w&&w.then)return w.then(function(){})}}();return Promise.resolve(f&&f.then?f.then(function(){}):void 0)}catch(_){return Promise.reject(_)}};function LocalVideoMute(){var o=react.exports.useContext(PropsContext),i=o.styleProps,s=o.callbacks,h=i||{},f=h.localBtnStyles,_=f||{},w=_.muteLocalVideo,j=react.exports.useContext(RtcContext),F=j.dispatch,K=j.localVideoTrack,_e=react.exports.useContext(LocalContext);return jsx("div",{children:jsx(BtnTemplate,{style:w,name:_e.hasVideo===ToggleState.enabled?"videocam":"videocamOff",onClick:function(){return K&&muteVideo(_e,F,K,s)}})})}function LocalControls(){var o=react.exports.useContext(PropsContext),i=o.styleProps,s=o.rtcProps,h=i||{},f=h.localBtnContainer;return jsxs("div",{style:_extends({},{backgroundColor:"#007bff",width:"100%",height:70,zIndex:10,display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},f),children:[s.role!=="audience"&&jsx(LocalVideoMute,{}),s.role!=="audience"&&jsx(LocalAudioMute,{}),jsx(EndCall,{})]})}var rtmStatusEnum;(function(o){o[o.initFailed=0]="initFailed",o[o.offline=1]="offline",o[o.initialising=2]="initialising",o[o.loggingIn=3]="loggingIn",o[o.loggedIn=4]="loggedIn",o[o.connected=5]="connected",o[o.loginFailed=6]="loginFailed"})(rtmStatusEnum||(rtmStatusEnum={}));var clientRoleRaw;(function(o){o[o.broadcaster=0]="broadcaster",o[o.audience=1]="audience"})(clientRoleRaw||(clientRoleRaw={}));var mutingDevice;(function(o){o[o.camera=0]="camera",o[o.microphone=1]="microphone"})(mutingDevice||(mutingDevice={}));var popUpStateEnum;(function(o){o[o.closed=0]="closed",o[o.muteMic=1]="muteMic",o[o.muteCamera=2]="muteCamera",o[o.unmuteMic=3]="unmuteMic",o[o.unmuteCamera=4]="unmuteCamera"})(popUpStateEnum||(popUpStateEnum={}));var RtmContext=react.exports.createContext(null),RtmProvider=RtmContext.Provider;RtmContext.Consumer;function RemoteVideoMute(o){var i=react.exports.useContext(PropsContext),s=i.styleProps,h=react.exports.useContext(RtmContext),f=h.sendMuteRequest,_=h.uidMap,w=s||{},j=w.remoteBtnStyles,F=j||{},K=F.muteRemoteVideo,_e=o.UIKitUser,_o=_e.hasVideo===remoteTrackState.no;return _e.uid!==0&&_[_e.uid]?jsx("div",{children:jsx(BtnTemplate,{name:_e.hasVideo===remoteTrackState.subbed?"videocam":"videocamOff",style:K,onClick:function(){return f(mutingDevice.camera,_e.uid,!_o)}})}):null}function RemoteAudioMute(o){var i=react.exports.useContext(PropsContext),s=i.styleProps,h=s||{},f=h.remoteBtnStyles,_=react.exports.useContext(RtmContext),w=_.sendMuteRequest,j=_.uidMap,F=f||{},K=F.muteRemoteAudio,_e=o.UIKitUser,_o=_e.hasAudio===remoteTrackState.no;return _e.uid!==0&&j[_e.uid]?jsx("div",{children:jsx(BtnTemplate,{style:K,name:_e.hasAudio===remoteTrackState.subbed?"mic":"micOff",onClick:function(){return w(mutingDevice.microphone,_e.uid,!_o)}})}):null}function SwapUser(o){var i=react.exports.useContext(RtcContext),s=i.dispatch,h=o.UIKitUser;return jsx("div",{children:jsx(BtnTemplate,{name:"remoteSwap",onClick:function(){return s({type:"user-swap",value:[h]})}})})}var VideoPlaceholder=function o(i){var s=react.exports.useContext(PropsContext),h=s.styleProps,f=s.rtcProps,_=h||{},w=_.maxViewStyles,j=_.maxViewOverlayContainer,F=i.user,K=f.CustomVideoPlaceholder;return K?K&&K(_extends({},i),null):jsxs("div",{style:_extends({},style.max,w),children:[jsx("div",{style:style.imgContainer,children:jsx("img",{style:style.img,src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=="})}),i.isShown&&jsx("div",{style:_extends({},style.btnContainer,j),children:i.showButtons&&jsxs(Fragment,{children:[!f.disableRtm&&jsx(RemoteVideoMute,{UIKitUser:F}),!f.disableRtm&&jsx(RemoteAudioMute,{UIKitUser:F}),i.showSwap&&jsx(SwapUser,{UIKitUser:F})]})})]},F.uid)},style={max:{flex:1,display:"flex",backgroundColor:"#007bff33",flexDirection:"row",position:"relative"},imgContainer:{flex:10,display:"flex",justifyContent:"center"},img:{width:100,height:100,position:"absolute",alignSelf:"center",justifySelf:"center",margin:"auto",display:"flex"},btnContainer:{position:"absolute",margin:5,flexDirection:"column",display:"flex"}},Username=function o(i){var s=react.exports.useContext(RtmContext),h=s.usernames,f=react.exports.useContext(PropsContext),_=f.rtmProps,w=f.styleProps,j=i.user;return _!=null&&_.displayUsername?jsx("p",{style:_extends({},styles.username,w==null?void 0:w.usernameText),children:h[j.uid]}):jsx(Fragment,{})},styles={username:{position:"absolute",background:"#007bffaa",padding:"2px 8px",color:"#fff",margin:0,bottom:0,right:0,zIndex:90}},MaxVideoView=function o(i){var s=react.exports.useContext(RtcContext),h=s.mediaStore,f=react.exports.useContext(PropsContext),_=f.styleProps,w=f.rtcProps,j=_||{},F=j.maxViewStyles,K=j.videoMode,_e=j.maxViewOverlayContainer,_o=K==null?void 0:K.max,ca=react.exports.useState(!1),_c=ca[0],ch=ca[1],Nf=i.user;return jsx("div",{style:_extends({},styles$1.container,i.style,F),onMouseEnter:function(){return ch(!0)},onMouseLeave:function(){return ch(!1)},children:Nf.hasVideo===1?jsxs("div",{style:styles$1.videoContainer,children:[!w.disableRtm&&jsx(Username,{user:Nf}),jsx(AgoraVideoPlayer,{style:styles$1.videoplayer,config:{fit:_o||"cover"},videoTrack:h[Nf.uid].videoTrack}),_c&&jsxs("div",{style:_extends({},styles$1.overlay,_e),children:[!w.disableRtm&&jsx(RemoteVideoMute,{UIKitUser:Nf}),!w.disableRtm&&jsx(RemoteAudioMute,{UIKitUser:Nf})]})]}):jsxs("div",{style:styles$1.videoContainer,children:[!w.disableRtm&&jsx(Username,{user:Nf}),jsx(VideoPlaceholder,{user:Nf,isShown:_c,showButtons:!0})]})})},styles$1={container:{display:"flex",flex:1},videoContainer:{display:"flex",flex:1,position:"relative"},videoplayer:{width:"100%",display:"flex",flex:1},overlay:{position:"absolute",margin:5,flexDirection:"column",display:"flex"},username:{position:"absolute",background:"#007bffaa",padding:"2px 8px",color:"#fff",margin:0,bottom:0,right:0,zIndex:90}},MinVideoView=function o(i){var s=react.exports.useContext(RtcContext),h=s.mediaStore,f=react.exports.useContext(PropsContext),_=f.styleProps,w=f.rtcProps,j=_||{},F=j.minViewStyles,K=j.videoMode,_e=j.minViewOverlayContainer,_o=K==null?void 0:K.min,ca=react.exports.useState(!1),_c=ca[0],ch=ca[1],Nf=i.user;return jsx("div",{style:_extends({},{display:"flex",flex:1},F),onMouseEnter:function(){return ch(!0)},onMouseLeave:function(){return ch(!1)},children:Nf.hasVideo===1?jsxs("div",{style:_extends({},{display:"flex",flex:1,position:"relative"}),children:[jsx(AgoraVideoPlayer,{style:{flex:10,display:"flex"},config:{fit:_o!==void 0?_o:"cover"},videoTrack:h[Nf.uid].videoTrack}),_c&&jsxs("div",{style:_extends({},{margin:4,position:"absolute",flex:1,display:"flex",flexDirection:"column"},_e),children:[!w.disableRtm&&jsx(RemoteVideoMute,{UIKitUser:Nf}),!w.disableRtm&&jsx(RemoteAudioMute,{UIKitUser:Nf}),jsx(SwapUser,{UIKitUser:Nf})]})]}):jsx(VideoPlaceholder,{user:Nf,isShown:_c,showButtons:!0,showSwap:!0})})},styles$2={test:"_3ybTi",scrollbar:"_3Sxu7"},PinnedVideo=function o(){var i=react.exports.useContext(PropsContext),s=i.styleProps,h=i.rtcProps,f=s||{},_=f.minViewContainer,w=f.pinnedVideoContainer,j=f.maxViewContainer,F=f.scrollViewContainer,K=react.exports.useRef(null),_e=react.exports.useState(0),_o=_e[0],ca=_e[1],_c=react.exports.useState(0),ch=_c[0],Nf=_c[1],bh=_o>ch;return react.exports.useEffect(function(){var _g=function(){K.current&&(ca(K.current.offsetWidth),Nf(K.current.offsetHeight))};return window.addEventListener("resize",_g),K.current&&(ca(K.current.offsetWidth),Nf(K.current.offsetHeight)),function(){window.removeEventListener("resize",_g)}},[]),jsxs("div",{ref:K,style:_extends({},{display:"flex",flex:1,flexDirection:bh?"row":"column-reverse",overflow:"hidden"},w),children:[jsx("div",{style:_extends({},{display:"flex",flex:bh?5:4},j),children:jsx(MaxUidConsumer,{children:function(_g){return h.role==="audience"&&_g[0].uid===0?null:jsx(MaxVideoView,{user:_g[0]})}})}),jsx("div",{className:styles$2.scrollbar,style:_extends({},{overflowY:bh?"scroll":"hidden",overflowX:bh?"hidden":"scroll",display:"flex",flex:1,flexDirection:bh?"column":"row"},F),children:jsx(MinUidConsumer,{children:function(_g){return _g.map(function(_v){return h.role==="audience"&&_v.uid===0?null:jsx("div",{style:_extends({},{minHeight:bh?"35vh":"99%",minWidth:bh?"99%":"40vw",margin:2,display:"flex"},_),children:jsx(MinVideoView,{user:_v})},_v.uid)})}})})]})},GridVideo=function o(){var i=react.exports.useContext(PropsContext),s=i.styleProps,h=i.rtcProps,f=s||{},_=f.gridVideoCells,w=f.gridVideoContainer,j=react.exports.useContext(MaxUidContext),F=react.exports.useContext(MinUidContext),K=h.role==="audience"?[].concat(j,F).filter(function(h0){return h0.uid!==0}):[].concat(j,F),_e=react.exports.useRef(null),_o=react.exports.useState(window.innerWidth),ca=_o[0],_c=_o[1],ch=react.exports.useState(window.innerHeight),Nf=ch[0],bh=ch[1],_g=ca>Nf,_v="minmax(0, 1fr) ";return react.exports.useEffect(function(){var h0=function(){_e.current&&(_c(_e.current.offsetWidth),bh(_e.current.offsetHeight))};return window.addEventListener("resize",h0),_e.current&&(_c(_e.current.offsetWidth),bh(_e.current.offsetHeight)),function(){window.removeEventListener("resize",h0)}},[]),jsx("div",{ref:_e,style:_extends({},{width:"100%",height:"100%",display:"grid",gridTemplateColumns:_g?K.length>9?_v.repeat(4):K.length>4?_v.repeat(3):K.length>1?_v.repeat(2):_v:K.length>8?_v.repeat(3):K.length>2?_v.repeat(2):_v},w),children:K.map(function(h0){return jsx(MaxVideoView,{user:h0,style:_extends({},{height:"100%",width:"100%"},_)},h0.uid)})})},useTracks=createMicrophoneAndCameraTracks({encoderConfig:{}},{encoderConfig:{}}),TracksConfigure=function o(i){var s=react.exports.useState(!1),h=s[0],f=s[1],_=react.exports.useState(null),w=_[0],j=_[1],F=react.exports.useState(null),K=F[0],_e=F[1],_o=useTracks(),ca=_o.ready,_c=_o.tracks,ch=_o.error,Nf=react.exports.useRef({});return react.exports.useEffect(function(){return _c!==null?(_e(_c[0]),j(_c[1]),Nf.current[0]={audioTrack:_c[0],videoTrack:_c[1]},f(!0)):ch&&(console.error(ch),f(!1)),function(){if(_c){var bh,_g;(bh=_c[0])===null||bh===void 0||bh.close(),(_g=_c[1])===null||_g===void 0||_g.close()}}},[ca,ch]),jsx(TracksProvider,{value:{localVideoTrack:w,localAudioTrack:K},children:h?i.children:null})},timeNow=function o(){return new Date().getTime()},useChannel=createLazyChannel(),useClient$1=createLazyClient(),RtmConfigure=function o(i){var s=react.exports.useContext(PropsContext),h=s.rtcProps,f=s.rtmProps,_=react.exports.useState(!1),w=_[0],j=_[1],F=useClient$1(h.appId),K=useChannel(F,h.channel),_e=react.exports.useRef(""),_o=react.exports.useRef(5),ca=react.exports.useContext(LocalContext),_c=react.exports.useContext(PropsContext),ch=_c.rtmCallbacks,Nf=react.exports.useState({}),bh=Nf[0],_g=Nf[1],_v=react.exports.useState({}),h0=_v[0],A0=_v[1],M0=react.exports.useState({}),R0=M0[0],k0=M0[1],G0=react.exports.useState(popUpStateEnum.closed),pI=G0[0],u0=G0[1],C0=react.exports.useState(rtmStatusEnum.offline),v0=C0[0],T0=C0[1],Qv=react.exports.useContext(RtcContext),r0=Qv.localUid,a0=Qv.localAudioTrack,I0=Qv.localVideoTrack,O0=Qv.dispatch,nI=Qv.channelJoined,U0=function V1(){try{var yI=h.tokenUrl,KI=function(){if(yI){var sI=_catch(function(){return Promise.resolve(fetch(yI+"/rtm/"+((f==null?void 0:f.uid)||_e.current))).then(function(q1){return Promise.resolve(q1.json()).then(function(z_){var CT=z_.rtmToken;return Promise.resolve(F.login({uid:(f==null?void 0:f.uid)||_e.current,token:CT})).then(function(){_o.current=5})})})},function(){setTimeout(function(){try{return _o.current=_o.current+_o.current,V1(),Promise.resolve()}catch(q1){return Promise.reject(q1)}},_o.current*1e3)});if(sI&&sI.then)return sI.then(function(){})}else{var ZI=_catch(function(){return Promise.resolve(F.login({uid:(f==null?void 0:f.uid)||_e.current,token:(f==null?void 0:f.token)||void 0})).then(function(){_o.current=5})},function(){setTimeout(function(){try{return _o.current=_o.current+_o.current,V1(),Promise.resolve()}catch(q1){return Promise.reject(q1)}},_o.current*1e3)});if(ZI&&ZI.then)return ZI.then(function(){})}}();return Promise.resolve(KI&&KI.then?KI.then(function(){}):void 0)}catch(sI){return Promise.reject(sI)}},_I=function V1(){try{var yI=_catch(function(){return Promise.resolve(K.join()).then(function(){_o.current=5})},function(){setTimeout(function(){try{return _o.current=_o.current+_o.current,V1(),Promise.resolve()}catch(KI){return Promise.reject(KI)}},_o.current*1e3)});return Promise.resolve(yI&&yI.then?yI.then(function(){}):void 0)}catch(KI){return Promise.reject(KI)}},dI=function(){try{if(T0(rtmStatusEnum.initialising),h.uid?_e.current=String(h.uid):_e.current=String(timeNow()),F.on("ConnectionStateChanged",function(sI,ZI){console.log(sI,ZI)}),F.on("TokenExpired",function(){try{var sI=h.tokenUrl;console.log("token expired - renewing");var ZI=function(){if(sI){var q1=_catch(function(){return Promise.resolve(fetch(sI+"/rtm/"+((f==null?void 0:f.uid)||_e.current))).then(function(z_){return Promise.resolve(z_.json()).then(function(CT){var u3=CT.rtmToken;return Promise.resolve(F.renewToken(u3)).then(function(){_o.current=5})})})},function(z_){console.error("TokenExpiredError",z_)});if(q1&&q1.then)return q1.then(function(){})}}();return Promise.resolve(ZI&&ZI.then?ZI.then(function(){}):void 0)}catch(q1){return Promise.reject(q1)}}),F.on("MessageFromPeer",function(sI,ZI){T1(sI,ZI)}),K.on("ChannelMessage",function(sI,ZI){T1(sI,ZI)}),K.on("MemberJoined",function(sI){try{return Promise.resolve(I_(QI(),sI)).then(function(){})}catch(ZI){return Promise.reject(ZI)}}),K.on("MemberCountUpdated",function(sI){try{return console.log("RTM-MemberCountUpdated: ",sI),Promise.resolve()}catch(ZI){return Promise.reject(ZI)}}),ch!=null&&ch.channel?Object.keys(ch.channel).map(function(sI){ch.channel&&K.on(sI,ch.channel[sI])}):ch!=null&&ch.client&&Object.keys(ch.client).map(function(sI){ch.client&&F.on(sI,ch.client[sI])}),h.tokenUrl){var yI=h.tokenUrl,KI=h.uid;F.on("TokenExpired",function(){try{return console.log("token expired"),Promise.resolve(fetch(yI+"/rtm/"+(KI||0)+"/")).then(function(sI){return Promise.resolve(sI.json()).then(function(ZI){var q1=ZI.rtmToken;F.renewToken(q1)})})}catch(sI){return Promise.reject(sI)}})}return T0(rtmStatusEnum.loggingIn),Promise.resolve(U0()).then(function(){return T0(rtmStatusEnum.loggedIn),Promise.resolve(_I()).then(function(){T0(rtmStatusEnum.connected),A0(function(sI){return _extends({},sI,{0:f==null?void 0:f.username})}),r_(QI())})})}catch(sI){return Promise.reject(sI)}},QI=function(){return{messageType:"UserData",rtmId:(f==null?void 0:f.uid)||_e.current,rtcId:r0.current,username:f==null?void 0:f.username,role:h.role==="audience"?1:0,uikit:{platform:"web",framework:"react",version:"1.0.8"},agora:{rtm:AgoraRTM__default.VERSION,rtc:AgoraRTC__default.VERSION}}},qI=function(yI,KI,sI){var ZI=(f==null?void 0:f.showPopUpBeforeRemoteMute)===!1,q1={messageType:"MuteRequest",device:yI,rtcId:KI,mute:sI,isForceful:ZI},z_=bh[KI];ZI&&!sI?console.log("cannot send force unmute request"):z_?I_(q1,z_):console.log("peer not found")},T1=function(yI,KI){var sI;if(yI.messageType==="RAW"?sI=parsePayload(yI.rawMessage):yI.messageType==="TEXT"&&(sI=JSON.parse(yI.text)),console.log(sI,KI),sI)switch(sI.messageType){case"UserData":h1(sI);break;case"MuteRequest":M2(sI);break;case"RtmDataRequest":switch(sI.type){case"ping":a3(KI);break;case"userData":c3(KI);break;default:console.log(KI)}break;default:console.log("unknown message content")}else console.log("unknown rtm message type")},h1=function(yI){_g(function(KI){var sI;return _extends({},KI,(sI={},sI[yI.rtcId]=yI.rtmId,sI))}),A0(function(KI){var sI;return _extends({},KI,(sI={},sI[yI.rtcId]=yI.username,sI))}),k0(function(KI){var sI;return _extends({},KI,(sI={},sI[yI.rtmId]=yI,sI))})},M2=function(yI){r0.current===yI.rtcId&&(yI.isForceful?yI.mute?yI.device===mutingDevice.microphone?a0&&muteAudio(ca,O0,a0):yI.device===mutingDevice.camera&&I0&&muteVideo(ca,O0,I0):console.error("cannot force unmute"):yI.device===mutingDevice.microphone?yI.mute?u0(popUpStateEnum.muteMic):u0(popUpStateEnum.unmuteMic):yI.device===mutingDevice.camera&&(yI.mute?u0(popUpStateEnum.muteCamera):u0(popUpStateEnum.unmuteCamera)))},a3=function(yI){I_({messageType:"RtmDataRequest",type:"pong"},yI)},c3=function(yI){I_(QI(),yI)},r_=function(yI){try{var KI=F.createMessage({text:JSON.stringify(yI),messageType:AgoraRTM__default.MessageType.TEXT});return Promise.resolve(K.sendMessage(KI)).then(function(){})}catch(sI){return Promise.reject(sI)}},I_=function(yI,KI){try{var sI=F.createMessage({text:JSON.stringify(yI),messageType:AgoraRTM__default.MessageType.TEXT});return Promise.resolve(F.sendMessageToPeer(sI,String(KI))).then(function(){})}catch(ZI){return Promise.reject(ZI)}},DS=function(){try{return Promise.resolve(F.logout()).then(function(){return Promise.resolve(F.removeAllListeners()).then(function(){})})}catch(yI){return Promise.reject(yI)}};return react.exports.useEffect(function(){return nI&&(dI(),j(!0)),function(){nI&&DS()}},[h.channel,h.appId,nI]),jsx(RtmProvider,{value:{rtmStatus:v0,sendPeerMessage:I_,sendChannelMessage:r_,sendMuteRequest:qI,rtmClient:F,uidMap:bh,usernames:h0,userDataMap:R0,popUpState:pI,setPopUpState:u0},children:w?i.children:jsx(Fragment,{})})};new TextEncoder;var dec=new TextDecoder,parsePayload=function o(i){return JSON.parse(dec.decode(i))};function PopUp(){var o=react.exports.useContext(PropsContext),i=o.styleProps,s=react.exports.useContext(RtmContext),h=s.popUpState,f=s.setPopUpState,_=i||{},w=_.popUpContainer,j=react.exports.useContext(RtcContext),F=j.dispatch,K=j.localVideoTrack,_e=j.localAudioTrack,_o=react.exports.useContext(LocalContext);return h!==popUpStateEnum.closed?jsxs("div",{style:_extends({},styles$3.container,w),children:[jsxs("div",{style:{color:"#fff",fontSize:18,fontWeight:700},children:[h===popUpStateEnum.muteCamera||h===popUpStateEnum.muteMic?"Mute ":"Unmute ",h===popUpStateEnum.muteCamera||h===popUpStateEnum.unmuteCamera?"Camera":"Mic","?"]}),jsxs("div",{style:{flexDirection:"row",display:"flex",width:"100%",justifyContent:"space-around"},children:[jsx("div",{onClick:function(){switch(h){case popUpStateEnum.muteCamera:_o.hasVideo&&K&&muteVideo(_o,F,K);break;case popUpStateEnum.muteMic:_o.hasAudio&&_e&&muteAudio(_o,F,_e);break;case popUpStateEnum.unmuteCamera:!_o.hasVideo&&K&&muteVideo(_o,F,K);break;case popUpStateEnum.unmuteMic:!_o.hasAudio&&_e&&muteAudio(_o,F,_e);break}f(popUpStateEnum.closed)},style:styles$3.button,children:"Confirm"}),jsx("div",{style:styles$3.buttonClose,onClick:function(){return f(popUpStateEnum.closed)},children:"Close"})]})]}):null}var styles$3={button:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},buttonClose:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},container:{backgroundColor:"#007bffaa",position:"absolute",width:240,height:80,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:100,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center"}},AgoraUIKit=function o(i){var s=i.styleProps,h=i.rtcProps,f=s||{},_=f.UIKitContainer;return jsx(PropsProvider,{value:i,children:jsx("div",{style:_extends({},style$1,_),children:h.role==="audience"?jsx(VideocallUI,{}):jsx(TracksConfigure,{children:jsx(VideocallUI,{})})})})},VideocallUI=function o(){var i=react.exports.useContext(PropsContext),s=i.rtcProps;return jsx(RtcConfigure,{callActive:s.callActive,children:jsx(LocalUserContext,{children:s.disableRtm?jsxs(Fragment,{children:[(s==null?void 0:s.layout)===layout.grid?jsx(GridVideo,{}):jsx(PinnedVideo,{}),jsx(LocalControls,{})]}):jsxs(RtmConfigure,{children:[jsx(PopUp,{}),(s==null?void 0:s.layout)===layout.grid?jsx(GridVideo,{}):jsx(PinnedVideo,{}),jsx(LocalControls,{})]})})})},style$1={display:"flex",flex:1,minHeight:0,flexDirection:"column"};export{AgoraUIKit as A};

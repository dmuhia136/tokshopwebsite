import{j as e,d as L,a as t,r as n,e as C,h as v,l as D,i as O}from"./moreBigLibs.00d880fd.js";import{F as P,m as E,I as A,g as T,i as _,r as q,n as H,o as U,p as B,s as G,q as $,u as I,t as V,v as J,w as W,x as Y,T as z,R as K,l as k}from"./index.cb0bc5b0.js";import{S as M}from"./bigLibs.c150cb44.js";import"./agora.0fcbc9c9.js";import"./stripe.ab219216.js";const Q=()=>e("div",{className:"flex flex-col min-h-screen text-5xl items-center",children:"History of rooms"}),X=o=>({setSelf:a,onSet:m})=>{const s=localStorage.getItem(o);s!==null&&a(JSON.parse(s)),m((i,l,d)=>{d?localStorage.removeItem(o):localStorage.setItem(o,JSON.stringify(i))})},N=L({key:"tokShow",default:{title:"",description:"",avatar:"",product:{name:"",id:"",price:"",images:[""],shopId:""},time:"",date:"",cod:!1,mpesa:"",pay:"",roomId:"",now:!0},effects_UNSTABLE:[X("TokShow")]}),j=({number:o,steps:a})=>e("div",{className:"flex flex-row text-black-70 items-center self-center",children:a.map((m,s)=>t("div",{className:"flex text-black-70 items-center w-full",children:[t("div",{className:`${o>=s?"border-black-40 text-black-40 ":"border-gray-400 text-gray-400"} relative  border-2 w-6 h-6 flex rounded-full items-center bg-white`,children:[o>s?e(P,{icon:E,className:"w-5 h-5 text-blue-40 text-2xl"}):null,e("p",{className:"absolute -top-6 right-1/2 translate-x-1/2 w-16",children:m})]}),e("div",{className:`${s===a.length-1?"hidden":"flex h-0.5 w-10 425:w-20 md:w-44 bg-gray-400"}`})]},s))}),Z=({setImg:o,img:a})=>t("div",{className:"flex flex-col w-full item gap-6",children:[e("p",{className:"text-black-70  text-xl font-medium",children:"tokshow avatar"}),e("div",{className:"flex w-full  self-start",children:e(A,{setImg:o,oldImg:a})})]}),ee=({setName:o,setDesc:a,name:m,desc:s})=>t("div",{className:"flex flex-col w-full gap-6",children:[e("p",{className:"text-black-70 text-xl font-medium",children:"Setup your TokShow"}),t("form",{className:"w-full flex flex-col justify-center items-center gap-4 md:gap-16",children:[t("div",{className:"flex flex-col w-full gap-3",children:[e("input",{required:!0,value:m,onChange:i=>o(i.target.value),type:"text",placeholder:"Name",className:"inputs w-full"}),e("p",{className:"text-xs text-black-40",children:"Your unique brand name that will distinguish your shows and products. It will be public-facing and used as a way for your customers to identify you."})]}),e("textarea",{required:!0,value:s,onChange:i=>a(i.target.value),placeholder:"Description",className:"textarea w-full",name:"",id:"",cols:30,rows:6})]})]}),te=()=>{let o=["Tokshow","Product","Get paid"];const[a,m]=n.exports.useState(""),[s,i]=n.exports.useState(""),[l,d]=n.exports.useState(""),[w,x]=n.exports.useState(!1),f=C(N),u=T(),{renderSpinner:c}=_(),{title:r,description:b,avatar:g}=v(N),F=()=>{const p=q(G,"/rooms/avatar");if(l.length>250){x(!0);let h=(l==null?void 0:l.length)>0&&H(l,"roomavatar");const y=U(p,h);y.on("state_changed",R=>{},R=>{M.fire({icon:"error",text:"Storage error"})},async()=>{let R=await B(y.snapshot.ref);x(!1),f(S=>({title:a,description:s,avatar:R,product:S.product,time:S.time,date:S.date,cod:S.cod,mpesa:S.mpesa,pay:S.pay,roomId:S.roomId,now:S.now})),u("/live/two")})}else l.length>0&&l.length<250&&(f(h=>({title:a,description:s,avatar:h.avatar,product:h.product,time:h.time,date:h.date,cod:h.cod,mpesa:h.mpesa,pay:h.pay,roomId:h.roomId,now:h.now})),u("/live/two"))};return n.exports.useEffect(()=>(i(b),m(r),d(g),()=>{}),[]),t("div",{className:"flex flex-col w-full items-center  mt-10 px-10 py-8",children:[e(j,{number:0,steps:o}),t("div",{className:"flex flex-col w-full lg:w-2/3 gap-10 py-10 ",children:[e(ee,{setName:m,setDesc:i,name:a,desc:s}),e(Z,{setImg:d,img:l})]}),c(w),e("button",{onClick:F,disabled:a.length<1||s.length<1||l.length<1||w,className:"blue-btn w-44",children:"Next"})]})},ae=()=>{const{data:o,getObject:a,load:m}=$(),[s,i]=n.exports.useState(!0),[l,d]=n.exports.useState(null),{_id:w}=v(I),{renderSpinner:x}=_(),f=T(),u=C(N);return n.exports.useEffect(()=>{a(`products/get/all/${w}`,"GET",{})},[]),t("div",{className:"flex flex-col w-full  gap-6",children:[e("p",{className:"text-black-70 text-xl font-medium lg:ml-16",children:"Add a product to your room"}),x(m),t("form",{className:"flex flex-col items-start lg:items-start lg:px-20 gap-4",onSubmit:c=>{c.preventDefault()},children:[t("div",{className:"flex gap-4 items-center",children:[e("input",{type:"radio",name:"",id:"free",checked:s,onChange:()=>i(c=>!c)}),e("label",{htmlFor:"free",children:"Add a product from your shop"})]}),e("div",{className:"flex w-full flex-wrap flex-shrink-0 gap-4",children:o==null?void 0:o.map((c,r)=>{var b;return t("div",{onClick:()=>{d(r),u(g=>({title:g.title,description:g.description,avatar:g.avatar,product:{name:c.name,id:c._id,price:c.price,images:c.images,shopId:c.shopId._id},time:g.time,date:g.date,cod:g.cod,mpesa:g.mpesa,pay:g.pay,roomId:g.roomId,now:g.now}))},className:"flex flex-col shadow-lg px-4 py-2 rounded-md cursor-pointer h-32 w-32 relative",children:[e("img",{src:((b=c==null?void 0:c.images)==null?void 0:b.length)>0?c==null?void 0:c.images[0]:"/img/picture.png",alt:"",className:" object-contain h-20 w-20"}),e("p",{className:"text-base text-blue-40 font-semibold",children:c==null?void 0:c.name}),l===r&&e(P,{icon:E,className:"text-blue-40 z-20 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xl"})]},r)})}),t("div",{onClick:()=>f("/myAccount/shops"),className:"flex gap-4 items-center",children:[e("input",{type:"radio",name:"",id:"pay",checked:!s,onChange:()=>i(c=>!c)}),e("label",{htmlFor:"pay",children:"Create a new product"})]})]}),t("div",{className:"flex self-center gap-10",children:[e("button",{onClick:()=>{f("/live")},className:"red-outline-btn w-32 self-center",children:"Previous"}),e("button",{disabled:l===null,onClick:()=>{f("/live/three")},className:"blue-btn w-32 self-center",children:"Next"})]})]})},se=({date:o,time:a,now:m,setDate:s,setTime:i,setNow:l})=>t("div",{className:"flex flex-col w-full gap-6",children:[e("p",{className:"text-black-70 text-xl font-medium lg:ml-16",children:"When do you want to go live?"}),t("form",{className:"flex flex-col items-start lg:items-start lg:px-20 gap-4",children:[t("div",{className:"flex gap-4 items-center",children:[e("input",{checked:m,onChange:()=>l(d=>!d),type:"radio",name:"",id:"now"}),e("label",{htmlFor:"now",children:"Now"})]}),t("div",{className:"flex gap-4 items-center",children:[e("input",{checked:!m,onChange:()=>l(d=>!d),type:"radio",name:"",id:"later"}),e("label",{htmlFor:"later",children:"Later"})]})]}),t("form",{className:`${m?"hidden":"flex flex-col items-start lg:px-20 gap-4"} `,children:[e("input",{onChange:d=>s(d.target.value),value:o,required:!0,type:"date",className:"inputs w-full"}),e("input",{onChange:d=>i(d.target.value),value:a,required:!0,type:"time",className:"inputs w-full"})]})]}),le=()=>{let o=["Tokshow","Product","Get paid"];const[a,m]=n.exports.useState(!0),[s,i]=n.exports.useState(""),[l,d]=n.exports.useState(""),[w,x]=D(N),f=()=>{x(u=>({title:u.title,description:u.description,avatar:u.avatar,product:u.product,time:`${l}`,date:`${s}`,cod:u.cod,mpesa:u.mpesa,pay:u.pay,roomId:u.roomId,now:a}))};return n.exports.useEffect(()=>{f()},[a,s,l]),t("div",{className:"flex flex-col  w-full items-center mt-10 gap-6 px-10",children:[e(j,{number:1,steps:o}),t("div",{className:"flex flex-col items-center w-fu gap-10 py-10 lg:px-60 self-center",children:[e(se,{time:l,setTime:d,date:s,setDate:i,now:a,setNow:m}),e(ae,{})]})]})},oe=({setDone:o})=>{const[a,m]=n.exports.useState(!1);n.exports.useState(!0);const[s,i]=n.exports.useState(""),[l,d]=n.exports.useState("");n.exports.useState("");const[w,x]=n.exports.useState(""),f=C(N),u=v(N),c=()=>{f(r=>({title:r.title,description:r.description,avatar:r.avatar,product:r.product,time:r.time,date:r.date,cod:a,mpesa:w,pay:r.pay,roomId:r.roomId,now:r.now}))};return n.exports.useEffect(()=>(i(u.product.name),d(u.product.price),x(u.mpesa),()=>{c()}),[]),t("div",{className:"flex flex-col w-full items-center gap-4",children:[e("p",{className:"text-black-70 text-xl font-medium self-start",children:"Product details"}),t("form",{onSubmit:r=>{r.preventDefault(),c()},className:"flex flex-col flex-wrap w-full  gap-8",children:[e("input",{disabled:!0,value:s,onChange:r=>i(r.target.value),type:"text",placeholder:"Product name",className:"inputs w-full "}),t("div",{className:"flex flex-col w-full  gap-4",children:[t("div",{className:"flex relative",children:[e("input",{disabled:!0,value:l,onChange:r=>d(r.target.value),type:"number",placeholder:"Price",className:"inputs inputs w-full px-6"}),e(P,{icon:V,className:"absolute top-1/2 left-2 \r -translate-y-1/2"})]}),t("div",{className:"flex items-center gap-2 w-full",children:[t("p",{className:"text-xs md:text-lg",children:["Total:"," ",t("span",{className:"text-red-20 font-semibold",children:["$",(.96*l).toFixed(2)]})]}),t("p",{className:"text-xs md:text-lg",children:["Commission:"," ",t("span",{className:"text-red-20 font-semibold",children:["$",(.04*l).toFixed(2)]})]})]})]}),t("div",{className:"flex flex-col w-full ",children:[e("p",{className:"text-base font-semibold",children:"Allow cash on delivery"}),t("div",{className:"flex items-center gap-2",children:[e("input",{checked:!a,onChange:()=>m(r=>!r),type:"radio",name:"",id:"cash",className:""}),e("label",{htmlFor:"cash",className:"",children:"No"}),e("input",{checked:a,onChange:()=>m(r=>!r),type:"radio",name:"",id:"cash2",className:" ml-8"}),e("label",{htmlFor:"cash2",className:"",children:"Yes"})]})]})]})]})},ne=({setDone:o})=>{const[a,m]=n.exports.useState(0),s=n.exports.useRef(null),[i,l]=n.exports.useState([]),[d,w]=n.exports.useState([]),{uploadToFirebase:x,uris:f}=J(),{renderSpinner:u}=_(),c=C(N),[r,b]=n.exports.useState(!1),g=async p=>{l(y=>[...y,p.target.files[0]]);let h=await Y(p.target.files[0]);w(y=>[...y,h]),m(y=>++y)},F=()=>{x(i,"rooms"),b(!1)};return n.exports.useEffect(()=>(i.length>0?o(!0):o(!1),()=>{F()}),[]),n.exports.useEffect(()=>{f.length>0&&f.length>=i.length&&(c(p=>({title:p.title,description:p.description,avatar:p.avatar,product:{name:p.product.name,id:p.product.id,price:p.product.price,shopId:p.product.shopId,images:f},time:p.time,date:p.date,cod:p.cod,mpesa:p.mpesa,pay:p.pay,roomId:p.roomId,now:p.now})),b(!1))},[f]),t("div",{className:"flex flex-col w-full relative gap-6",children:[e("input",{type:"file",onChange:p=>g(p),id:"",className:"hidden",ref:s},a),e(P,{icon:W,onClick:()=>s.current.click(),className:"text-blue-30 text-6xl absolute top-0 right-0 h-10 w-10"}),e("p",{className:"text-black-70 text-xl font-medium",children:"Click on the plus button to add images"}),u(r),e("div",{className:"flex flex-wrap gap-2 justify-center max-w-md max-h-[200px] overflow-y-auto",children:d.map((p,h)=>e("img",{src:p,alt:"",className:"object-contain w-24 h-24 border-[1px] rounded-md"},h))})]})},ce=({setDone:o})=>{const[a,m]=n.exports.useState(!1),[s,i]=n.exports.useState(0);return T(),D(N),t("div",{className:"flex flex-col w-full items-center",children:[t("p",{className:"text-black-70 text-xl  font-medium mb-4 self-start",children:["Pay-to-Watch"," ",t("span",{className:"text-blue-40",children:["(","optional",")"]})]}),e("p",{className:"text-sm",children:"If enabled, charge viewers a fee to watch your show. Or you can keep it free to watch, but you must sell a product in your show."}),e("form",{className:"flex flex-col  self-start gap-4 mt-6",children:t("div",{className:"flex gap-6  w-full justify-cent h-8 items-center",children:[e("input",{onChange:()=>m(l=>!l),id:"pay",type:"checkbox",checked:a,className:"self-center "}),e("label",{htmlFor:"pay self-center",children:"Pay to view"})]})}),a?t("form",{className:"flex self-start mt-8 items-center gap-6",children:[e("input",{type:"number",min:0,value:s,onChange:l=>i(l.target.value),id:"pay",placeholder:"enter amount",className:"py-1 px-4 focus:outline-none ring-1 ring-red-20 focus:ring-black-70 rounded-md"}),t("p",{className:"text-lg ",children:["Total:"," ",t("span",{className:"text-red-20 font-semibold",children:["$",(.96*s).toFixed(2)]})]}),t("p",{className:"text-lg ",children:["Commission:"," ",t("span",{className:"text-red-20 font-semibold",children:["$",(.04*s).toFixed(2)]})]})]}):null]})},re=()=>{let o=["Tokshow","Product","Get paid"];const[a,m]=D(N),{_id:s}=v(I),[i,l]=n.exports.useState(!1),d=T(),{getObject:w,mongoErr:x,load:f}=$(),{renderSpinner:u}=_(),c=O(N),r=async()=>{a.now?d("/live/show"):await w(`rooms/${s}`,"POST",{title:a.title,token:"",event:!0,eventDate:new Date(`${a.date}:${a.time}`).getTime(),productIds:[a.product.id],hostIds:[s],userIds:[],raisedHands:[],speakerIds:[],invitedIds:[],shopId:a.product.shopId,status:!0,productPrice:a.product.price,productImages:a.product.images})&&(d("/"),c())};return t("div",{className:"flex flex-col w-full  mt-10 gap-6 px-4 py-10",children:[e(j,{number:2,steps:o}),t("div",{className:"flex flex-col gap-10 items-center lg:justify-center mt-6",children:[e("div",{className:"flex w-full lg:w-1/2",children:e(oe,{setDone:l})}),t("div",{className:"flex flex-col w-full lg:w-1/2 gap-10",children:[e(ne,{setDone:l}),e(ce,{setDone:l})]})]}),u(f),t("div",{className:"flex w-full lg:w-1/3 self-center max-w-sm justify-between items-center gap-10",children:[e("button",{disabled:f,onClick:()=>{d("/live/two")},className:"red-outline-btn w-32 ",children:"Previous"}),e("button",{disabled:f,onClick:r,className:"blue-btn ",children:a.now?" Create Show":"Save event"})]})]})},ie=()=>{const o=v(N),{_id:a}=v(I),m=O(N),{getObject:s}=$(),[i,l]=n.exports.useState();let d=v(I);const w=async()=>{let x=await s(`rooms/${a}`,"POST",{title:o.title,token:"",productIds:[o.product.id],hostIds:[a],userIds:[],raisedHands:[],speakerIds:[],invitedIds:[],shopId:o.product.shopId,status:!0,productPrice:o.product.price,productImages:o.product.images,description:o.description}),f=await s("rooms/agora/rooom/generatetoken","POST",{channel:x._id,uid:a}),u=await s(`rooms/rooms/updatenew/${x._id}`,"PUT",{token:f.token,activeTime:Date.now()});l(u)};return n.exports.useEffect(()=>(w(),()=>{m()}),[]),e(z,{room:i,userData:d})},he=()=>e("div",{className:"bg-teal-50 -mt-8 w-full min-h-screen",children:t(K,{children:[e(k,{index:!0,element:e(te,{})}),e(k,{path:"/two",element:e(le,{})}),e(k,{path:"/three",element:e(re,{})}),e(k,{path:"/show",element:e(ie,{})}),e(k,{path:"/history",element:e(Q,{})})]})});export{he as default};
